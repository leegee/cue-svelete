var UD=Object.defineProperty;var WD=(t,e,i)=>e in t?UD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var _c=(t,e,i)=>WD(t,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();function Le(){}function by(t){return t()}function DC(){return Object.create(null)}function gn(t){t.forEach(by)}function _y(t){return typeof t=="function"}function Oi(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function zD(t){return Object.keys(t).length===0}function Dy(t,...e){if(t==null){for(const s of e)s(void 0);return Le}const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function $D(t){let e;return Dy(t,i=>e=i)(),e}function Zr(t,e,i){t.$$.on_destroy.push(Dy(e,i))}function RC(t){return t??""}function Pa(t,e,i){return t.set(i),e}function Ge(t,e){t.appendChild(e)}function pi(t,e,i){t.insertBefore(e,i||null)}function Zt(t){t.parentNode&&t.parentNode.removeChild(t)}function ze(t){return document.createElement(t)}function Eg(t){return document.createTextNode(t)}function hi(){return Eg(" ")}function us(t,e,i,s){return t.addEventListener(e,i,s),()=>t.removeEventListener(e,i,s)}function we(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function jD(t){return Array.from(t.childNodes)}function Ry(t,e){e=""+e,t.data!==e&&(t.data=e)}function AC(t,e){t.value=e??""}function xC(t,e,i,s){t.style.setProperty(e,i,"")}let tl;function Wa(t){tl=t}function qD(){if(!tl)throw new Error("Function called outside component initialization");return tl}function wg(t){qD().$$.on_mount.push(t)}const Un=[],od=[];let eo=[];const PC=[],KD=Promise.resolve();let pp=!1;function YD(){pp||(pp=!0,KD.then(Ay))}function gp(t){eo.push(t)}const Dc=new Set;let Mn=0;function Ay(){if(Mn!==0)return;const t=tl;do{try{for(;Mn<Un.length;){const e=Un[Mn];Mn++,Wa(e),XD(e.$$)}}catch(e){throw Un.length=0,Mn=0,e}for(Wa(null),Un.length=0,Mn=0;od.length;)od.pop()();for(let e=0;e<eo.length;e+=1){const i=eo[e];Dc.has(i)||(Dc.add(i),i())}eo.length=0}while(Un.length);for(;PC.length;)PC.pop()();pp=!1,Dc.clear(),Wa(t)}function XD(t){if(t.fragment!==null){t.update(),gn(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(gp)}}function QD(t){const e=[],i=[];eo.forEach(s=>t.indexOf(s)===-1?e.push(s):i.push(s)),i.forEach(s=>s()),eo=e}const Yu=new Set;let Br;function JD(){Br={r:0,c:[],p:Br}}function ZD(){Br.r||gn(Br.c),Br=Br.p}function di(t,e){t&&t.i&&(Yu.delete(t),t.i(e))}function Ti(t,e,i,s){if(t&&t.o){if(Yu.has(t))return;Yu.add(t),Br.c.push(()=>{Yu.delete(t),s&&(i&&t.d(1),s())}),t.o(e)}else s&&s()}function os(t){t&&t.c()}function Hi(t,e,i){const{fragment:s,after_update:r}=t.$$;s&&s.m(e,i),gp(()=>{const n=t.$$.on_mount.map(by).filter(_y);t.$$.on_destroy?t.$$.on_destroy.push(...n):gn(n),t.$$.on_mount=[]}),r.forEach(gp)}function Ui(t,e){const i=t.$$;i.fragment!==null&&(QD(i.after_update),gn(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function eR(t,e){t.$$.dirty[0]===-1&&(Un.push(t),YD(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Zi(t,e,i,s,r,n,o=null,a=[-1]){const l=tl;Wa(t);const u=t.$$={fragment:null,ctx:[],props:n,update:Le,not_equal:r,bound:DC(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:DC(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let d=!1;if(u.ctx=i?i(t,e.props||{},(c,C,...E)=>{const y=E.length?E[0]:C;return u.ctx&&r(u.ctx[c],u.ctx[c]=y)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](y),d&&eR(t,c)),C}):[],u.update(),d=!0,gn(u.before_update),u.fragment=s?s(u.ctx):!1,e.target){if(e.hydrate){const c=jD(e.target);u.fragment&&u.fragment.l(c),c.forEach(Zt)}else u.fragment&&u.fragment.c();e.intro&&di(t.$$.fragment),Hi(t,e.target,e.anchor),Ay()}Wa(l)}class es{constructor(){_c(this,"$$");_c(this,"$$set")}$destroy(){Ui(this,1),this.$destroy=Le}$on(e,i){if(!_y(i))return Le;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!zD(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const tR="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(tR);const On=[];function Gl(t,e=Le){let i;const s=new Set;function r(a){if(Oi(t,a)&&(t=a,i)){const l=!On.length;for(const u of s)u[1](),On.push(u,t);if(l){for(let u=0;u<On.length;u+=2)On[u][0](On[u+1]);On.length=0}}}function n(a){r(a(t))}function o(a,l=Le){const u=[a,l];return s.add(u),s.size===1&&(i=e(r,n)||Le),a(t),()=>{s.delete(u),s.size===0&&i&&(i(),i=null)}}return{set:r,update:n,subscribe:o}}const Xd=Gl("");function iR(t){try{return new URL(t),!0}catch{return!1}}function sR(){const t=window.location.search?decodeURI(window.location.search.substring(1)):"";iR(t)&&Xd.set(t)}function rR(t){let e,i,s,r,n,o,a,l,u,d;return{c(){e=ze("section"),i=ze("header"),i.innerHTML='<h1 class="svelte-1se5wiz">Spotting Cues</h1>',s=hi(),r=ze("input"),n=hi(),o=ze("button"),o.textContent="Load Video",a=hi(),l=ze("footer"),l.innerHTML=`You can skip this step by putting the video URL after a <q>?</q> in this
        page&#39;s URL.`,we(r,"id","user-video-url"),r.autofocus=!0,we(r,"type","text"),we(r,"placeholder","Enter YouTube URL"),we(r,"class","svelte-1se5wiz"),we(o,"id","load-video-url"),we(o,"class","svelte-1se5wiz"),we(l,"class","svelte-1se5wiz"),we(e,"id","get-url"),we(e,"class","svelte-1se5wiz")},m(c,C){pi(c,e,C),Ge(e,i),Ge(e,s),Ge(e,r),AC(r,t[0]),Ge(e,n),Ge(e,o),Ge(e,a),Ge(e,l),r.focus(),u||(d=[us(r,"input",t[2]),us(o,"click",t[1])],u=!0)},p(c,[C]){C&1&&r.value!==c[0]&&AC(r,c[0])},i:Le,o:Le,d(c){c&&Zt(e),u=!1,gn(d)}}}function nR(t,e,i){let s="";const r=()=>{Xd.set(s)};wg(()=>{sR()});function n(){s=this.value,i(0,s)}return[s,r,n]}class oR extends es{constructor(e){super(),Zi(this,e,nR,rR,Oi,{})}}var il=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Tg(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(i,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),i}var Ia;typeof window<"u"?Ia=window:typeof il<"u"?Ia=il:typeof self<"u"?Ia=self:Ia={};var Qd=Ia;const F=Cr(Qd),aR={},lR=Object.freeze(Object.defineProperty({__proto__:null,default:aR},Symbol.toStringTag,{value:"Module"})),uR=Tg(lR);var IC=typeof il<"u"?il:typeof window<"u"?window:{},dR=uR,La;typeof document<"u"?La=document:(La=IC["__GLOBAL_DOCUMENT_CACHE@4"],La||(La=IC["__GLOBAL_DOCUMENT_CACHE@4"]=dR));var xy=La;const K=Cr(xy);var fp={exports:{}};(function(t,e){function i(l){if(l&&typeof l=="object"){var u=l.which||l.keyCode||l.charCode;u&&(l=u)}if(typeof l=="number")return o[l];var d=String(l),c=s[d.toLowerCase()];if(c)return c;var c=r[d.toLowerCase()];if(c)return c;if(d.length===1)return d.charCodeAt(0)}i.isEventKey=function(u,d){if(u&&typeof u=="object"){var c=u.which||u.keyCode||u.charCode;if(c==null)return!1;if(typeof d=="string"){var C=s[d.toLowerCase()];if(C)return C===c;var C=r[d.toLowerCase()];if(C)return C===c}else if(typeof d=="number")return d===c;return!1}},e=t.exports=i;var s=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(n=97;n<123;n++)s[String.fromCharCode(n)]=n-32;for(var n=48;n<58;n++)s[n-48]=n;for(n=1;n<13;n++)s["f"+n]=n+111;for(n=0;n<10;n++)s["numpad "+n]=n+96;var o=e.names=e.title={};for(n in s)o[s[n]]=n;for(var a in r)s[a]=r[a]})(fp,fp.exports);var hR=fp.exports;const he=Cr(hR);var cR=pR;function pR(t,e){var i,s=null;try{i=JSON.parse(t,e)}catch(r){s=r}return[s,i]}const gR=Cr(cR);var bg={exports:{}};function Di(){return Di=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},Di.apply(null,arguments)}const fR=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Di}},Symbol.toStringTag,{value:"Module"})),mR=Tg(fR);var CR=yR,vR=Object.prototype.toString;function yR(t){if(!t)return!1;var e=vR.call(t);return e==="[object Function]"||typeof t=="function"&&e!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}var SR=Qd,ER=function(e,i){return i===void 0&&(i=!1),function(s,r,n){if(s){e(s);return}if(r.statusCode>=400&&r.statusCode<=599){var o=n;if(i)if(SR.TextDecoder){var a=wR(r.headers&&r.headers["content-type"]);try{o=new TextDecoder(a).decode(n)}catch{}}else o=String.fromCharCode.apply(null,new Uint8Array(n));e({cause:o});return}e(null,n)}};function wR(t){return t===void 0&&(t=""),t.toLowerCase().split(";").reduce(function(e,i){var s=i.split("="),r=s[0],n=s[1];return r.trim()==="charset"?n.trim():e},"utf-8")}var TR=ER,Py=Qd,bR=mR,_R=CR;ms.httpHandler=TR;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var DR=function(e){var i={};return e&&e.trim().split(`
`).forEach(function(s){var r=s.indexOf(":"),n=s.slice(0,r).trim().toLowerCase(),o=s.slice(r+1).trim();typeof i[n]>"u"?i[n]=o:Array.isArray(i[n])?i[n].push(o):i[n]=[i[n],o]}),i};bg.exports=ms;bg.exports.default=ms;ms.XMLHttpRequest=Py.XMLHttpRequest||PR;ms.XDomainRequest="withCredentials"in new ms.XMLHttpRequest?ms.XMLHttpRequest:Py.XDomainRequest;RR(["get","put","post","patch","head","delete"],function(t){ms[t==="delete"?"del":t]=function(e,i,s){return i=Iy(e,i,s),i.method=t.toUpperCase(),Ly(i)}});function RR(t,e){for(var i=0;i<t.length;i++)e(t[i])}function AR(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Iy(t,e,i){var s=t;return _R(e)?(i=e,typeof t=="string"&&(s={uri:t})):s=bR({},e,{uri:t}),s.callback=i,s}function ms(t,e,i){return e=Iy(t,e,i),Ly(e)}function Ly(t){if(typeof t.callback>"u")throw new Error("callback argument missing");var e=!1,i=function(O,L,I){e||(e=!0,t.callback(O,L,I))};function s(){a.readyState===4&&setTimeout(o,0)}function r(){var D=void 0;if(a.response?D=a.response:D=a.responseText||xR(a),_)try{D=JSON.parse(D)}catch{}return D}function n(D){return clearTimeout(b),D instanceof Error||(D=new Error(""+(D||"Unknown XMLHttpRequest Error"))),D.statusCode=0,i(D,R)}function o(){if(!u){var D;clearTimeout(b),t.useXDR&&a.status===void 0?D=200:D=a.status===1223?204:a.status;var O=R,L=null;return D!==0?(O={body:r(),statusCode:D,method:c,headers:{},url:d,rawRequest:a},a.getAllResponseHeaders&&(O.headers=DR(a.getAllResponseHeaders()))):L=new Error("Internal XMLHttpRequest Error"),i(L,O,O.body)}}var a=t.xhr||null;a||(t.cors||t.useXDR?a=new ms.XDomainRequest:a=new ms.XMLHttpRequest);var l,u,d=a.url=t.uri||t.url,c=a.method=t.method||"GET",C=t.body||t.data,E=a.headers=t.headers||{},y=!!t.sync,_=!1,b,R={body:void 0,headers:{},statusCode:0,method:c,url:d,rawRequest:a};if("json"in t&&t.json!==!1&&(_=!0,E.accept||E.Accept||(E.Accept="application/json"),c!=="GET"&&c!=="HEAD"&&(E["content-type"]||E["Content-Type"]||(E["Content-Type"]="application/json"),C=JSON.stringify(t.json===!0?C:t.json))),a.onreadystatechange=s,a.onload=o,a.onerror=n,a.onprogress=function(){},a.onabort=function(){u=!0},a.ontimeout=n,a.open(c,d,!y,t.username,t.password),y||(a.withCredentials=!!t.withCredentials),!y&&t.timeout>0&&(b=setTimeout(function(){if(!u){u=!0,a.abort("timeout");var D=new Error("XMLHttpRequest timeout");D.code="ETIMEDOUT",n(D)}},t.timeout)),a.setRequestHeader)for(l in E)E.hasOwnProperty(l)&&a.setRequestHeader(l,E[l]);else if(t.headers&&!AR(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(a.responseType=t.responseType),"beforeSend"in t&&typeof t.beforeSend=="function"&&t.beforeSend(a),a.send(C||null),a}function xR(t){try{if(t.responseType==="document")return t.responseXML;var e=t.responseXML&&t.responseXML.documentElement.nodeName==="parsererror";if(t.responseType===""&&!e)return t.responseXML}catch{}return null}function PR(){}var IR=bg.exports;const Fy=Cr(IR);var My={exports:{}},LC=xy,_g=Object.create||function(){function t(){}return function(e){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function ci(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}ci.prototype=_g(Error.prototype);ci.prototype.constructor=ci;ci.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function Dg(t){function e(s,r,n,o){return(s|0)*3600+(r|0)*60+(n|0)+(o|0)/1e3}var i=t.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function za(){this.values=_g(null)}za.prototype={set:function(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var s=0;s<i.length;++s)if(e===i[s]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e),e>=0&&e<=100)?(this.set(t,e),!0):!1}};function Fa(t,e,i,s){var r=s?t.split(s):[t];for(var n in r)if(typeof r[n]=="string"){var o=r[n].split(i);if(o.length===2){var a=o[0].trim(),l=o[1].trim();e(a,l)}}}function LR(t,e,i){var s=t;function r(){var a=Dg(t);if(a===null)throw new ci(ci.Errors.BadTimeStamp,"Malformed timestamp: "+s);return t=t.replace(/^[^\sa-zA-Z-]+/,""),a}function n(a,l){var u=new za;Fa(a,function(d,c){switch(d){case"region":for(var C=i.length-1;C>=0;C--)if(i[C].id===c){u.set(d,i[C].region);break}break;case"vertical":u.alt(d,c,["rl","lr"]);break;case"line":var E=c.split(","),y=E[0];u.integer(d,y),u.percent(d,y)&&u.set("snapToLines",!1),u.alt(d,y,["auto"]),E.length===2&&u.alt("lineAlign",E[1],["start","center","end"]);break;case"position":E=c.split(","),u.percent(d,E[0]),E.length===2&&u.alt("positionAlign",E[1],["start","center","end"]);break;case"size":u.percent(d,c);break;case"align":u.alt(d,c,["start","center","end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");try{l.line=u.get("line","auto")}catch{}l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100);try{l.align=u.get("align","center")}catch{l.align=u.get("align","middle")}try{l.position=u.get("position","auto")}catch{l.position=u.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},l.align)}l.positionAlign=u.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},l.align)}function o(){t=t.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),t.substr(0,3)!=="-->")throw new ci(ci.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+s);t=t.substr(3),o(),e.endTime=r(),o(),n(t,e)}var Rc=LC.createElement&&LC.createElement("textarea"),FR={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},FC={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},MR={v:"title",lang:"lang"},MC={rt:"ruby"};function Oy(t,e){function i(){if(!e)return null;function y(b){return e=e.substr(b.length),b}var _=e.match(/^([^<]*)(<[^>]*>?)?/);return y(_[1]?_[1]:_[2])}function s(y){return Rc.innerHTML=y,y=Rc.textContent,Rc.textContent="",y}function r(y,_){return!MC[_.localName]||MC[_.localName]===y.localName}function n(y,_){var b=FR[y];if(!b)return null;var R=t.document.createElement(b),D=MR[y];return D&&_&&(R[D]=_.trim()),R}for(var o=t.document.createElement("div"),a=o,l,u=[];(l=i())!==null;){if(l[0]==="<"){if(l[1]==="/"){u.length&&u[u.length-1]===l.substr(2).replace(">","")&&(u.pop(),a=a.parentNode);continue}var d=Dg(l.substr(1,l.length-2)),c;if(d){c=t.document.createProcessingInstruction("timestamp",d),a.appendChild(c);continue}var C=l.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!C||(c=n(C[1],C[3]),!c)||!r(a,c))continue;if(C[2]){var E=C[2].split(".");E.forEach(function(y){var _=/^bg_/.test(y),b=_?y.slice(3):y;if(FC.hasOwnProperty(b)){var R=_?"background-color":"color",D=FC[b];c.style[R]=D}}),c.className=E.join(" ")}u.push(C[1]),a.appendChild(c),a=c;continue}a.appendChild(t.document.createTextNode(s(l)))}return o}var OC=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function OR(t){for(var e=0;e<OC.length;e++){var i=OC[e];if(t>=i[0]&&t<=i[1])return!0}return!1}function NR(t){var e=[],i="",s;if(!t||!t.childNodes)return"ltr";function r(a,l){for(var u=l.childNodes.length-1;u>=0;u--)a.push(l.childNodes[u])}function n(a){if(!a||!a.length)return null;var l=a.pop(),u=l.textContent||l.innerText;if(u){var d=u.match(/^.*(\n|\r)/);return d?(a.length=0,d[0]):u}if(l.tagName==="ruby")return n(a);if(l.childNodes)return r(a,l),n(a)}for(r(e,t);i=n(e);)for(var o=0;o<i.length;o++)if(s=i.charCodeAt(o),OR(s))return"rtl";return"ltr"}function kR(t){if(typeof t.line=="number"&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,s=0,r=0;r<i.length&&i[r]!==e;r++)i[r].mode==="showing"&&s++;return++s*-1}function Jd(){}Jd.prototype.applyStyles=function(t,e){e=e||this.div;for(var i in t)t.hasOwnProperty(i)&&(e.style[i]=t[i])};Jd.prototype.formatStyle=function(t,e){return t===0?0:t+e};function ad(t,e,i){Jd.call(this),this.cue=e,this.cueDiv=Oy(t,e.text);var s={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(s,this.cueDiv),this.div=t.document.createElement("div"),s={direction:NR(this.cueDiv),writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:e.align==="middle"?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(s),this.div.appendChild(this.cueDiv);var r=0;switch(e.positionAlign){case"start":case"line-left":r=e.position;break;case"center":r=e.position-e.size/2;break;case"end":case"line-right":r=e.position-e.size;break}e.vertical===""?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(n){this.applyStyles({top:this.formatStyle(n.top,"px"),bottom:this.formatStyle(n.bottom,"px"),left:this.formatStyle(n.left,"px"),right:this.formatStyle(n.right,"px"),height:this.formatStyle(n.height,"px"),width:this.formatStyle(n.width,"px")})}}ad.prototype=_g(Jd.prototype);ad.prototype.constructor=ad;function Ft(t){var e,i,s,r;if(t.div){i=t.div.offsetHeight,s=t.div.offsetWidth,r=t.div.offsetTop;var n=(n=t.div.childNodes)&&(n=n[0])&&n.getClientRects&&n.getClientRects();t=t.div.getBoundingClientRect(),e=n?Math.max(n[0]&&n[0].height||0,t.height/n.length):0}this.left=t.left,this.right=t.right,this.top=t.top||r,this.height=t.height||i,this.bottom=t.bottom||r+(t.height||i),this.width=t.width||s,this.lineHeight=e!==void 0?e:t.lineHeight}Ft.prototype.move=function(t,e){switch(e=e!==void 0?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}};Ft.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top};Ft.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1};Ft.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right};Ft.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}};Ft.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),i=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),s=e*i;return s/(this.height*this.width)};Ft.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}};Ft.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,s=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var r={left:t.left,right:t.right,top:t.top||s,height:t.height||e,bottom:t.bottom||s+(t.height||e),width:t.width||i};return r};function GR(t,e,i,s){function r(b,R){for(var D,O=new Ft(b),L=1,I=0;I<R.length;I++){for(;b.overlapsOppositeAxis(i,R[I])||b.within(i)&&b.overlapsAny(s);)b.move(R[I]);if(b.within(i))return b;var k=b.intersectPercentage(i);L>k&&(D=new Ft(b),L=k),b=new Ft(O)}return D||O}var n=new Ft(e),o=e.cue,a=kR(o),l=[];if(o.snapToLines){var u;switch(o.vertical){case"":l=["+y","-y"],u="height";break;case"rl":l=["+x","-x"],u="width";break;case"lr":l=["-x","+x"],u="width";break}var d=n.lineHeight,c=d*Math.round(a),C=i[u]+d,E=l[0];Math.abs(c)>C&&(c=c<0?-1:1,c*=Math.ceil(C/d)*d),a<0&&(c+=o.vertical===""?i.height:i.width,l=l.reverse()),n.move(E,c)}else{var y=n.lineHeight/i.height*100;switch(o.lineAlign){case"center":a-=y/2;break;case"end":a-=y;break}switch(o.vertical){case"":e.applyStyles({top:e.formatStyle(a,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(a,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(a,"%")});break}l=["+y","-x","+x","-y"],n=new Ft(e)}var _=r(n,l);e.move(_.toCSSCompatValues(i))}function Vo(){}Vo.StringDecoder=function(){return{decode:function(t){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};Vo.convertCueToDOMTree=function(t,e){return!t||!e?null:Oy(t,e)};var VR=.05,BR="sans-serif",HR="1.5%";Vo.processCues=function(t,e,i){if(!t||!e||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var s=t.document.createElement("div");s.style.position="absolute",s.style.left="0",s.style.right="0",s.style.top="0",s.style.bottom="0",s.style.margin=HR,i.appendChild(s);function r(d){for(var c=0;c<d.length;c++)if(d[c].hasBeenReset||!d[c].displayState)return!0;return!1}if(!r(e)){for(var n=0;n<e.length;n++)s.appendChild(e[n].displayState);return}var o=[],a=Ft.getSimpleBoxPosition(s),l=Math.round(a.height*VR*100)/100,u={font:l+"px "+BR};(function(){for(var d,c,C=0;C<e.length;C++)c=e[C],d=new ad(t,c,u),s.appendChild(d.div),GR(t,d,a,o),c.displayState=d.div,o.push(Ft.getSimpleBoxPosition(d))})()};Vo.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]};Vo.Parser.prototype={reportOrThrowError:function(t){if(t instanceof ci)this.onparsingerror&&this.onparsingerror(t);else throw t},parse:function(t){var e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){for(var d=e.buffer,c=0;c<d.length&&d[c]!=="\r"&&d[c]!==`
`;)++c;var C=d.substr(0,c);return d[c]==="\r"&&++c,d[c]===`
`&&++c,e.buffer=d.substr(c),C}function s(d){var c=new za;if(Fa(d,function(E,y){switch(E){case"id":c.set(E,y);break;case"width":c.percent(E,y);break;case"lines":c.integer(E,y);break;case"regionanchor":case"viewportanchor":var _=y.split(",");if(_.length!==2)break;var b=new za;if(b.percent("x",_[0]),b.percent("y",_[1]),!b.has("x")||!b.has("y"))break;c.set(E+"X",b.get("x")),c.set(E+"Y",b.get("y"));break;case"scroll":c.alt(E,y,["up"]);break}},/=/,/\s/),c.has("id")){var C=new(e.vttjs.VTTRegion||e.window.VTTRegion);C.width=c.get("width",100),C.lines=c.get("lines",3),C.regionAnchorX=c.get("regionanchorX",0),C.regionAnchorY=c.get("regionanchorY",100),C.viewportAnchorX=c.get("viewportanchorX",0),C.viewportAnchorY=c.get("viewportanchorY",100),C.scroll=c.get("scroll",""),e.onregion&&e.onregion(C),e.regionList.push({id:c.get("id"),region:C})}}function r(d){var c=new za;Fa(d,function(C,E){switch(C){case"MPEGT":c.integer(C+"S",E);break;case"LOCA":c.set(C+"L",Dg(E));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:c.get("MPEGTS"),LOCAL:c.get("LOCAL")})}function n(d){d.match(/X-TIMESTAMP-MAP/)?Fa(d,function(c,C){switch(c){case"X-TIMESTAMP-MAP":r(C);break}},/=/):Fa(d,function(c,C){switch(c){case"Region":s(C);break}},/:/)}try{var o;if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;o=i();var a=o.match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new ci(ci.Errors.BadSignature);e.state="HEADER"}for(var l=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(l?l=!1:o=i(),e.state){case"HEADER":/:/.test(o)?n(o):o||(e.state="ID");continue;case"NOTE":o||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){e.state="NOTE";break}if(!o)continue;e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,"");try{e.cue.align="center"}catch{e.cue.align="middle"}if(e.state="CUE",o.indexOf("-->")===-1){e.cue.id=o;continue}case"CUE":try{LR(o,e.cue,e.regionList)}catch(d){e.reportOrThrowError(d),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var u=o.indexOf("-->")!==-1;if(!o||u&&(l=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+=`
`),e.cue.text+=o.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":o||(e.state="ID");continue}}}catch(d){e.reportOrThrowError(d),e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL")throw new ci(ci.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var UR=Vo,WR="auto",zR={"":1,lr:1,rl:1},$R={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function jR(t){if(typeof t!="string")return!1;var e=zR[t.toLowerCase()];return e?t.toLowerCase():!1}function Ac(t){if(typeof t!="string")return!1;var e=$R[t.toLowerCase()];return e?t.toLowerCase():!1}function Ny(t,e,i){this.hasBeenReset=!1;var s="",r=!1,n=t,o=e,a=i,l=null,u="",d=!0,c="auto",C="start",E="auto",y="auto",_=100,b="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return s},set:function(R){s=""+R}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(R){r=!!R}},startTime:{enumerable:!0,get:function(){return n},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");n=R,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return o},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");o=R,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return a},set:function(R){a=""+R,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(R){l=R,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(R){var D=jR(R);if(D===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");u=D,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return d},set:function(R){d=!!R,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return c},set:function(R){if(typeof R!="number"&&R!==WR)throw new SyntaxError("Line: an invalid number or illegal string was specified.");c=R,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return C},set:function(R){var D=Ac(R);D?(C=D,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return E},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");E=R,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return y},set:function(R){var D=Ac(R);D?(y=D,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return _},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");_=R,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return b},set:function(R){var D=Ac(R);if(!D)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");b=D,this.hasBeenReset=!0}}}),this.displayState=void 0}Ny.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var qR=Ny,KR={"":!0,up:!0};function YR(t){if(typeof t!="string")return!1;var e=KR[t.toLowerCase()];return e?t.toLowerCase():!1}function Ea(t){return typeof t=="number"&&t>=0&&t<=100}function XR(){var t=100,e=3,i=0,s=100,r=0,n=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(a){if(!Ea(a))throw new Error("Width must be between 0 and 100.");t=a}},lines:{enumerable:!0,get:function(){return e},set:function(a){if(typeof a!="number")throw new TypeError("Lines must be set to a number.");e=a}},regionAnchorY:{enumerable:!0,get:function(){return s},set:function(a){if(!Ea(a))throw new Error("RegionAnchorX must be between 0 and 100.");s=a}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(a){if(!Ea(a))throw new Error("RegionAnchorY must be between 0 and 100.");i=a}},viewportAnchorY:{enumerable:!0,get:function(){return n},set:function(a){if(!Ea(a))throw new Error("ViewportAnchorY must be between 0 and 100.");n=a}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(a){if(!Ea(a))throw new Error("ViewportAnchorX must be between 0 and 100.");r=a}},scroll:{enumerable:!0,get:function(){return o},set:function(a){var l=YR(a);l===!1?console.warn("Scroll: an invalid or illegal string was specified."):o=l}}})}var QR=XR,Bs=Qd,fn=My.exports={WebVTT:UR,VTTCue:qR,VTTRegion:QR};Bs.vttjs=fn;Bs.WebVTT=fn.WebVTT;var JR=fn.VTTCue,ZR=fn.VTTRegion,eA=Bs.VTTCue,tA=Bs.VTTRegion;fn.shim=function(){Bs.VTTCue=JR,Bs.VTTRegion=ZR};fn.restore=function(){Bs.VTTCue=eA,Bs.VTTRegion=tA};Bs.VTTCue||fn.shim();var iA=My.exports;const NC=Cr(iA);var ky={exports:{}};(function(t,e){(function(i){var s=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,u,d){if(d=d||{},l=l.trim(),u=u.trim(),!u){if(!d.alwaysNormalize)return l;var c=a.parseURL(l);if(!c)throw new Error("Error trying to parse base URL.");return c.path=a.normalizePath(c.path),a.buildURLFromParts(c)}var C=a.parseURL(u);if(!C)throw new Error("Error trying to parse relative URL.");if(C.scheme)return d.alwaysNormalize?(C.path=a.normalizePath(C.path),a.buildURLFromParts(C)):u;var E=a.parseURL(l);if(!E)throw new Error("Error trying to parse base URL.");if(!E.netLoc&&E.path&&E.path[0]!=="/"){var y=r.exec(E.path);E.netLoc=y[1],E.path=y[2]}E.netLoc&&!E.path&&(E.path="/");var _={scheme:E.scheme,netLoc:C.netLoc,path:null,params:C.params,query:C.query,fragment:C.fragment};if(!C.netLoc&&(_.netLoc=E.netLoc,C.path[0]!=="/"))if(!C.path)_.path=E.path,C.params||(_.params=E.params,C.query||(_.query=E.query));else{var b=E.path,R=b.substring(0,b.lastIndexOf("/")+1)+C.path;_.path=a.normalizePath(R)}return _.path===null&&(_.path=d.alwaysNormalize?a.normalizePath(C.path):C.path),a.buildURLFromParts(_)},parseURL:function(l){var u=s.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(n,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};t.exports=a})()})(ky);var sA=ky.exports;const kC=Cr(sA);var GC="http://example.com",Zd=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=F.location&&F.location.href||"");var s=typeof F.URL=="function",r=/^\/\//.test(e),n=!F.location&&!/\/\//i.test(e);if(s?e=new F.URL(e,F.location||GC):/\/\//i.test(e)||(e=kC.buildAbsoluteURL(F.location&&F.location.href||"",e)),s){var o=new URL(i,e);return n?o.href.slice(GC.length):r?o.href.slice(o.protocol.length):o.href}return kC.buildAbsoluteURL(e,i)},Rg=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(s,r){this.listeners[s]||(this.listeners[s]=[]),this.listeners[s].push(r)},e.off=function(s,r){if(!this.listeners[s])return!1;var n=this.listeners[s].indexOf(r);return this.listeners[s]=this.listeners[s].slice(0),this.listeners[s].splice(n,1),n>-1},e.trigger=function(s){var r=this.listeners[s];if(r)if(arguments.length===2)for(var n=r.length,o=0;o<n;++o)r[o].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),l=r.length,u=0;u<l;++u)r[u].apply(this,a)},e.dispose=function(){this.listeners={}},e.pipe=function(s){this.on("data",function(r){s.push(r)})},t}(),rA=function(e){return F.atob?F.atob(e):Buffer.from(e,"base64").toString("binary")};function nA(t){for(var e=rA(t),i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i}/*! @name m3u8-parser @version 7.1.0 @license Apache-2.0 */class oA extends Rg{constructor(){super(),this.buffer=""}push(e){let i;for(this.buffer+=e,i=this.buffer.indexOf(`
`);i>-1;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}const aA="	",xc=function(t){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},lA=function(){const i="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+i+")")},ai=function(t){const e={};if(!t)return e;const i=t.split(lA());let s=i.length,r;for(;s--;)i[s]!==""&&(r=/([^=]*)=(.*)/.exec(i[s]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),e[r[0]]=r[1]);return e};class uA extends Rg{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let i,s;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((n,o)=>{const a=o(e);return a===e?n:n.concat([a])},[e]).forEach(n=>{for(let o=0;o<this.customParsers.length;o++)if(this.customParsers[o].call(this,n))return;if(n.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:n.slice(1)});return}if(n=n.replace("\r",""),i=/^#EXTM3U/.exec(n),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(n),i){s={type:"tag",tagType:"inf"},i[1]&&(s.duration=parseFloat(i[1])),i[2]&&(s.title=i[2]),this.trigger("data",s);return}if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(n),i){s={type:"tag",tagType:"targetduration"},i[1]&&(s.duration=parseInt(i[1],10)),this.trigger("data",s);return}if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(n),i){s={type:"tag",tagType:"version"},i[1]&&(s.version=parseInt(i[1],10)),this.trigger("data",s);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(n),i){s={type:"tag",tagType:"media-sequence"},i[1]&&(s.number=parseInt(i[1],10)),this.trigger("data",s);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(n),i){s={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(s.number=parseInt(i[1],10)),this.trigger("data",s);return}if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(n),i){s={type:"tag",tagType:"playlist-type"},i[1]&&(s.playlistType=i[1]),this.trigger("data",s);return}if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(n),i){s=Di(xc(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",s);return}if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(n),i){s={type:"tag",tagType:"allow-cache"},i[1]&&(s.allowed=!/NO/.test(i[1])),this.trigger("data",s);return}if(i=/^#EXT-X-MAP:(.*)$/.exec(n),i){if(s={type:"tag",tagType:"map"},i[1]){const o=ai(i[1]);o.URI&&(s.uri=o.URI),o.BYTERANGE&&(s.byterange=xc(o.BYTERANGE))}this.trigger("data",s);return}if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(n),i){if(s={type:"tag",tagType:"stream-inf"},i[1]){if(s.attributes=ai(i[1]),s.attributes.RESOLUTION){const o=s.attributes.RESOLUTION.split("x"),a={};o[0]&&(a.width=parseInt(o[0],10)),o[1]&&(a.height=parseInt(o[1],10)),s.attributes.RESOLUTION=a}s.attributes.BANDWIDTH&&(s.attributes.BANDWIDTH=parseInt(s.attributes.BANDWIDTH,10)),s.attributes["FRAME-RATE"]&&(s.attributes["FRAME-RATE"]=parseFloat(s.attributes["FRAME-RATE"])),s.attributes["PROGRAM-ID"]&&(s.attributes["PROGRAM-ID"]=parseInt(s.attributes["PROGRAM-ID"],10))}this.trigger("data",s);return}if(i=/^#EXT-X-MEDIA:(.*)$/.exec(n),i){s={type:"tag",tagType:"media"},i[1]&&(s.attributes=ai(i[1])),this.trigger("data",s);return}if(i=/^#EXT-X-ENDLIST/.exec(n),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(n),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(n),i){s={type:"tag",tagType:"program-date-time"},i[1]&&(s.dateTimeString=i[1],s.dateTimeObject=new Date(i[1])),this.trigger("data",s);return}if(i=/^#EXT-X-KEY:(.*)$/.exec(n),i){s={type:"tag",tagType:"key"},i[1]&&(s.attributes=ai(i[1]),s.attributes.IV&&(s.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(s.attributes.IV=s.attributes.IV.substring(2)),s.attributes.IV=s.attributes.IV.match(/.{8}/g),s.attributes.IV[0]=parseInt(s.attributes.IV[0],16),s.attributes.IV[1]=parseInt(s.attributes.IV[1],16),s.attributes.IV[2]=parseInt(s.attributes.IV[2],16),s.attributes.IV[3]=parseInt(s.attributes.IV[3],16),s.attributes.IV=new Uint32Array(s.attributes.IV))),this.trigger("data",s);return}if(i=/^#EXT-X-START:(.*)$/.exec(n),i){s={type:"tag",tagType:"start"},i[1]&&(s.attributes=ai(i[1]),s.attributes["TIME-OFFSET"]=parseFloat(s.attributes["TIME-OFFSET"]),s.attributes.PRECISE=/YES/.test(s.attributes.PRECISE)),this.trigger("data",s);return}if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(n),i){s={type:"tag",tagType:"cue-out-cont"},i[1]?s.data=i[1]:s.data="",this.trigger("data",s);return}if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(n),i){s={type:"tag",tagType:"cue-out"},i[1]?s.data=i[1]:s.data="",this.trigger("data",s);return}if(i=/^#EXT-X-CUE-IN:(.*)?$/.exec(n),i){s={type:"tag",tagType:"cue-in"},i[1]?s.data=i[1]:s.data="",this.trigger("data",s);return}if(i=/^#EXT-X-SKIP:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"skip"},s.attributes=ai(i[1]),s.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(s.attributes["SKIPPED-SEGMENTS"]=parseInt(s.attributes["SKIPPED-SEGMENTS"],10)),s.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(s.attributes["RECENTLY-REMOVED-DATERANGES"]=s.attributes["RECENTLY-REMOVED-DATERANGES"].split(aA)),this.trigger("data",s);return}if(i=/^#EXT-X-PART:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"part"},s.attributes=ai(i[1]),["DURATION"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),["INDEPENDENT","GAP"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=/YES/.test(s.attributes[o]))}),s.attributes.hasOwnProperty("BYTERANGE")&&(s.attributes.byterange=xc(s.attributes.BYTERANGE)),this.trigger("data",s);return}if(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"server-control"},s.attributes=ai(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=/YES/.test(s.attributes[o]))}),this.trigger("data",s);return}if(i=/^#EXT-X-PART-INF:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"part-inf"},s.attributes=ai(i[1]),["PART-TARGET"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),this.trigger("data",s);return}if(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"preload-hint"},s.attributes=ai(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(o){if(s.attributes.hasOwnProperty(o)){s.attributes[o]=parseInt(s.attributes[o],10);const a=o==="BYTERANGE-LENGTH"?"length":"offset";s.attributes.byterange=s.attributes.byterange||{},s.attributes.byterange[a]=s.attributes[o],delete s.attributes[o]}}),this.trigger("data",s);return}if(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"rendition-report"},s.attributes=ai(i[1]),["LAST-MSN","LAST-PART"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseInt(s.attributes[o],10))}),this.trigger("data",s);return}if(i=/^#EXT-X-DATERANGE:(.*)$/.exec(n),i&&i[1]){s={type:"tag",tagType:"daterange"},s.attributes=ai(i[1]),["ID","CLASS"].forEach(function(a){s.attributes.hasOwnProperty(a)&&(s.attributes[a]=String(s.attributes[a]))}),["START-DATE","END-DATE"].forEach(function(a){s.attributes.hasOwnProperty(a)&&(s.attributes[a]=new Date(s.attributes[a]))}),["DURATION","PLANNED-DURATION"].forEach(function(a){s.attributes.hasOwnProperty(a)&&(s.attributes[a]=parseFloat(s.attributes[a]))}),["END-ON-NEXT"].forEach(function(a){s.attributes.hasOwnProperty(a)&&(s.attributes[a]=/YES/i.test(s.attributes[a]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(a){s.attributes.hasOwnProperty(a)&&(s.attributes[a]=s.attributes[a].toString(16))});const o=/^X-([A-Z]+-)+[A-Z]+$/;for(const a in s.attributes){if(!o.test(a))continue;const l=/[0-9A-Fa-f]{6}/g.test(s.attributes[a]),u=/^\d+(\.\d+)?$/.test(s.attributes[a]);s.attributes[a]=l?s.attributes[a].toString(16):u?parseFloat(s.attributes[a]):String(s.attributes[a])}this.trigger("data",s);return}if(i=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(n),i){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(i=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(n),i){s={type:"tag",tagType:"content-steering"},s.attributes=ai(i[1]),this.trigger("data",s);return}this.trigger("data",{type:"tag",data:n.slice(4)})})}addParser({expression:e,customType:i,dataParser:s,segment:r}){typeof s!="function"&&(s=n=>n),this.customParsers.push(n=>{if(e.exec(n))return this.trigger("data",{type:"custom",data:s(n),customType:i,segment:r}),!0})}addTagMapper({expression:e,map:i}){const s=r=>e.test(r)?i(r):r;this.tagMappers.push(s)}}const dA=t=>t.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),tr=function(t){const e={};return Object.keys(t).forEach(function(i){e[dA(i)]=t[i]}),e},Pc=function(t){const{serverControl:e,targetDuration:i,partTargetDuration:s}=t;if(!e)return;const r="#EXT-X-SERVER-CONTROL",n="holdBack",o="partHoldBack",a=i&&i*3,l=s&&s*2;i&&!e.hasOwnProperty(n)&&(e[n]=a,this.trigger("info",{message:`${r} defaulting HOLD-BACK to targetDuration * 3 (${a}).`})),a&&e[n]<a&&(this.trigger("warn",{message:`${r} clamping HOLD-BACK (${e[n]}) to targetDuration * 3 (${a})`}),e[n]=a),s&&!e.hasOwnProperty(o)&&(e[o]=s*3,this.trigger("info",{message:`${r} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[o]}).`})),s&&e[o]<l&&(this.trigger("warn",{message:`${r} clamping PART-HOLD-BACK (${e[o]}) to partTargetDuration * 2 (${l}).`}),e[o]=l)};class hA extends Rg{constructor(){super(),this.lineStream=new oA,this.parseStream=new uA,this.lineStream.pipe(this.parseStream),this.lastProgramDateTime=null;const e=this,i=[];let s={},r,n,o=!1;const a=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let d=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],segments:[]};let c=0,C=0;const E={};this.on("end",()=>{s.uri||!s.parts&&!s.preloadHints||(!s.map&&r&&(s.map=r),!s.key&&n&&(s.key=n),!s.timeline&&typeof d=="number"&&(s.timeline=d),this.manifest.preloadSegment=s)}),this.parseStream.on("data",function(y){let _,b;({tag(){({version(){y.version&&(this.manifest.version=y.version)},"allow-cache"(){this.manifest.allowCache=y.allowed,"allowed"in y||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const R={};"length"in y&&(s.byterange=R,R.length=y.length,"offset"in y||(y.offset=c)),"offset"in y&&(s.byterange=R,R.offset=y.offset),c=R.offset+R.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),y.title&&(s.title=y.title),y.duration>0&&(s.duration=y.duration),y.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!y.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(y.attributes.METHOD==="NONE"){n=null;return}if(!y.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(y.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:y.attributes};return}if(y.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:y.attributes.URI};return}if(y.attributes.KEYFORMAT===u){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(y.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(y.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),y.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(y.attributes.KEYID&&y.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:y.attributes.KEYFORMAT,keyId:y.attributes.KEYID.substring(2)},pssh:nA(y.attributes.URI.split(",")[1])};return}y.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:y.attributes.METHOD||"AES-128",uri:y.attributes.URI},typeof y.attributes.IV<"u"&&(n.iv=y.attributes.IV)},"media-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+y.number});return}this.manifest.mediaSequence=y.number},"discontinuity-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+y.number});return}this.manifest.discontinuitySequence=y.number,d=y.number},"playlist-type"(){if(!/VOD|EVENT/.test(y.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+y.playlist});return}this.manifest.playlistType=y.playlistType},map(){r={},y.uri&&(r.uri=y.uri),y.byterange&&(r.byterange=y.byterange),n&&(r.key=n)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||l,!y.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),Di(s.attributes,y.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,!(y.attributes&&y.attributes.TYPE&&y.attributes["GROUP-ID"]&&y.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const R=this.manifest.mediaGroups[y.attributes.TYPE];R[y.attributes["GROUP-ID"]]=R[y.attributes["GROUP-ID"]]||{},_=R[y.attributes["GROUP-ID"]],b={default:/yes/i.test(y.attributes.DEFAULT)},b.default?b.autoselect=!0:b.autoselect=/yes/i.test(y.attributes.AUTOSELECT),y.attributes.LANGUAGE&&(b.language=y.attributes.LANGUAGE),y.attributes.URI&&(b.uri=y.attributes.URI),y.attributes["INSTREAM-ID"]&&(b.instreamId=y.attributes["INSTREAM-ID"]),y.attributes.CHARACTERISTICS&&(b.characteristics=y.attributes.CHARACTERISTICS),y.attributes.FORCED&&(b.forced=/yes/i.test(y.attributes.FORCED)),_[y.attributes.NAME]=b},discontinuity(){d+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=y.dateTimeString,this.manifest.dateTimeObject=y.dateTimeObject),s.dateTimeString=y.dateTimeString,s.dateTimeObject=y.dateTimeObject;const{lastProgramDateTime:R}=this;this.lastProgramDateTime=new Date(y.dateTimeString).getTime(),R===null&&this.manifest.segments.reduceRight((D,O)=>(O.programDateTime=D-O.duration*1e3,O.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(y.duration)||y.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+y.duration});return}this.manifest.targetDuration=y.duration,Pc.call(this,this.manifest)},start(){if(!y.attributes||isNaN(y.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:y.attributes["TIME-OFFSET"],precise:y.attributes.PRECISE}},"cue-out"(){s.cueOut=y.data},"cue-out-cont"(){s.cueOutCont=y.data},"cue-in"(){s.cueIn=y.data},skip(){this.manifest.skip=tr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",y.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const R=this.manifest.segments.length,D=tr(y.attributes);s.parts=s.parts||[],s.parts.push(D),D.byterange&&(D.byterange.hasOwnProperty("offset")||(D.byterange.offset=C),C=D.byterange.offset+D.byterange.length);const O=s.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${O} for segment #${R}`,y.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((L,I)=>{L.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${I} lacks required attribute(s): LAST-PART`})})},"server-control"(){const R=this.manifest.serverControl=tr(y.attributes);R.hasOwnProperty("canBlockReload")||(R.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Pc.call(this,this.manifest),R.canSkipDateranges&&!R.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const R=this.manifest.segments.length,D=tr(y.attributes),O=D.type&&D.type==="PART";s.preloadHints=s.preloadHints||[],s.preloadHints.push(D),D.byterange&&(D.byterange.hasOwnProperty("offset")||(D.byterange.offset=O?C:0,O&&(C=D.byterange.offset+D.byterange.length)));const L=s.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${L} for segment #${R}`,y.attributes,["TYPE","URI"]),!!D.type)for(let I=0;I<s.preloadHints.length-1;I++){const k=s.preloadHints[I];k.type&&k.type===D.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${L} for segment #${R} has the same TYPE ${D.type} as preload hint #${I}`})}},"rendition-report"(){const R=tr(y.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(R);const D=this.manifest.renditionReports.length-1,O=["LAST-MSN","URI"];o&&O.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${D}`,y.attributes,O)},"part-inf"(){this.manifest.partInf=tr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",y.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Pc.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(tr(y.attributes));const R=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${R}`,y.attributes,["ID","START-DATE"]);const D=this.manifest.dateRanges[R];D.endDate&&D.startDate&&new Date(D.endDate)<new Date(D.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),D.duration&&D.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),D.plannedDuration&&D.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const O=!!D.endOnNext;if(O&&!D.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),O&&(D.duration||D.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),D.duration&&D.endDate){const I=D.startDate.getTime()+D.duration*1e3;this.manifest.dateRanges[R].endDate=new Date(I)}if(!E[D.id])E[D.id]=D;else{for(const I in E[D.id])if(D[I]&&JSON.stringify(E[D.id][I])!==JSON.stringify(D[I])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const L=this.manifest.dateRanges.findIndex(I=>I.id===D.id);this.manifest.dateRanges[L]=Di(this.manifest.dateRanges[L],D),E[D.id]=Di(E[D.id],D),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"content-steering"(){this.manifest.contentSteering=tr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",y.attributes,["SERVER-URI"])}}[y.tagType]||a).call(e)},uri(){s.uri=y.uri,i.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),n&&(s.key=n),s.timeline=d,r&&(s.map=r),C=0,this.lastProgramDateTime!==null&&(s.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=s.duration*1e3),s={}},comment(){},custom(){y.segment?(s.custom=s.custom||{},s.custom[y.customType]=y.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[y.customType]=y.data)}})[y.type].call(e)})}warnOnMissingAttributes_(e,i,s){const r=[];s.forEach(function(n){i.hasOwnProperty(n)||r.push(n)}),r.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${r.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var zr={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},cA=["video","audio","text"],VC=["Video","Audio","Text"],Gy=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(i,s,r){var n=("00"+Number(s).toString(16)).slice(-2),o=("00"+Number(r).toString(16)).slice(-2);return"avc1."+n+"00"+o})},as=function(e){e===void 0&&(e="");var i=e.split(","),s=[];return i.forEach(function(r){r=r.trim();var n;cA.forEach(function(o){var a=zr[o].exec(r.toLowerCase());if(!(!a||a.length<=1)){n=o;var l=r.substring(0,a[1].length),u=r.replace(l,"");s.push({type:l,details:u,mediaType:o})}}),n||s.push({type:r,details:"",mediaType:"unknown"})}),s},pA=function(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var s=e.mediaGroups.AUDIO[i];if(!s)return null;for(var r in s){var n=s[r];if(n.default&&n.playlists)return as(n.playlists[0].attributes.CODECS)}return null},Vy=function(e){return e===void 0&&(e=""),zr.audio.test(e.trim().toLowerCase())},gA=function(e){return e===void 0&&(e=""),zr.text.test(e.trim().toLowerCase())},sl=function(e){if(!(!e||typeof e!="string")){var i=e.toLowerCase().split(",").map(function(n){return Gy(n.trim())}),s="video";i.length===1&&Vy(i[0])?s="audio":i.length===1&&gA(i[0])&&(s="application");var r="mp4";return i.every(function(n){return zr.mp4.test(n)})?r="mp4":i.every(function(n){return zr.webm.test(n)})?r="webm":i.every(function(n){return zr.ogg.test(n)})&&(r="ogg"),s+"/"+r+';codecs="'+e+'"'}},Xu=function(e){return e===void 0&&(e=""),F.MediaSource&&F.MediaSource.isTypeSupported&&F.MediaSource.isTypeSupported(sl(e))||!1},Ic=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(i){i=i.trim();for(var s=0;s<VC.length;s++){var r=VC[s];if(zr["muxer"+r].test(i))return!0}return!1})},BC="mp4a.40.2",fA="avc1.4d400d",mA=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,CA=/^application\/dash\+xml/i,By=function(e){return mA.test(e)?"hls":CA.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},vA=function(e){return e.toString(2).length},yA=function(e){return Math.ceil(vA(e)/8)},Hy=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},SA=function(e){return Hy(e)},se=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!SA(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},Et=F.BigInt||Number,mp=[Et("0x1"),Et("0x100"),Et("0x10000"),Et("0x1000000"),Et("0x100000000"),Et("0x10000000000"),Et("0x1000000000000"),Et("0x100000000000000"),Et("0x10000000000000000")];(function(){var t=new Uint16Array([65484]),e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var EA=function(e,i){var s=i===void 0?{}:i,r=s.signed,n=r===void 0?!1:r,o=s.le,a=o===void 0?!1:o;e=se(e);var l=a?"reduce":"reduceRight",u=e[l]?e[l]:Array.prototype[l],d=u.call(e,function(C,E,y){var _=a?y:Math.abs(y+1-e.length);return C+Et(E)*mp[_]},Et(0));if(n){var c=mp[e.length]/Et(2)-Et(1);d=Et(d),d>c&&(d-=c,d-=c,d-=Et(2))}return Number(d)},wA=function(e,i){var s={},r=s.le,n=r===void 0?!1:r;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=Et(e);for(var o=yA(e),a=new Uint8Array(new ArrayBuffer(o)),l=0;l<o;l++){var u=n?l:Math.abs(l+1-a.length);a[u]=Number(e/mp[l]&Et(255)),e<0&&(a[u]=Math.abs(~a[u]),a[u]-=l===0?1:2)}return a},Uy=function(e,i){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;i||(e=unescape(encodeURIComponent(e)));for(var s=new Uint8Array(e.length),r=0;r<e.length;r++)s[r]=e.charCodeAt(r);return s},TA=function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];if(i=i.filter(function(a){return a&&(a.byteLength||a.length)&&typeof a!="string"}),i.length<=1)return se(i[0]);var r=i.reduce(function(a,l,u){return a+(l.byteLength||l.length)},0),n=new Uint8Array(r),o=0;return i.forEach(function(a){a=se(a),n.set(a,o),o+=a.byteLength}),n},Ke=function(e,i,s){var r=s===void 0?{}:s,n=r.offset,o=n===void 0?0:n,a=r.mask,l=a===void 0?[]:a;e=se(e),i=se(i);var u=i.every?i.every:Array.prototype.every;return i.length&&e.length-o>=i.length&&u.call(i,function(d,c){var C=l[c]?l[c]&e[o+c]:e[o+c];return d===C})},bA=function(e,i,s){i.forEach(function(r){for(var n in e.mediaGroups[r])for(var o in e.mediaGroups[r][n]){var a=e.mediaGroups[r][n][o];s(a,r,n,o)}})},_A=function(e){return F.atob?F.atob(e):Buffer.from(e,"base64").toString("binary")};function DA(t){for(var e=_A(t),i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i}var vr={},js={};function RA(t,e,i){if(i===void 0&&(i=Array.prototype),t&&typeof i.find=="function")return i.find.call(t,e);for(var s=0;s<t.length;s++)if(Object.prototype.hasOwnProperty.call(t,s)){var r=t[s];if(e.call(void 0,r,s,t))return r}}function Ag(t,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(t):t}function AA(t,e){if(t===null||typeof t!="object")throw new TypeError("target is not an object");for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}var Wy=Ag({HTML:"text/html",isHTML:function(t){return t===Wy.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),zy=Ag({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===zy.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});js.assign=AA;js.find=RA;js.freeze=Ag;js.MIME_TYPE=Wy;js.NAMESPACE=zy;var $y=js,Cs=$y.find,rl=$y.NAMESPACE;function xA(t){return t!==""}function PA(t){return t?t.split(/[\t\n\f\r ]+/).filter(xA):[]}function IA(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function HC(t){if(!t)return[];var e=PA(t);return Object.keys(e.reduce(IA,{}))}function LA(t){return function(e){return t&&t.indexOf(e)!==-1}}function Vl(t,e){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}function ii(t,e){var i=t.prototype;if(!(i instanceof e)){let r=function(){};var s=r;r.prototype=e.prototype,r=new r,Vl(i,r),t.prototype=i=r}i.constructor!=t&&(typeof t!="function"&&console.error("unknown Class:"+t),i.constructor=t)}var si={},qi=si.ELEMENT_NODE=1,co=si.ATTRIBUTE_NODE=2,ld=si.TEXT_NODE=3,jy=si.CDATA_SECTION_NODE=4,qy=si.ENTITY_REFERENCE_NODE=5,FA=si.ENTITY_NODE=6,Ky=si.PROCESSING_INSTRUCTION_NODE=7,Yy=si.COMMENT_NODE=8,Xy=si.DOCUMENT_NODE=9,Qy=si.DOCUMENT_TYPE_NODE=10,Hs=si.DOCUMENT_FRAGMENT_NODE=11,MA=si.NOTATION_NODE=12,Rt={},vt={};Rt.INDEX_SIZE_ERR=(vt[1]="Index size error",1);Rt.DOMSTRING_SIZE_ERR=(vt[2]="DOMString size error",2);var jt=Rt.HIERARCHY_REQUEST_ERR=(vt[3]="Hierarchy request error",3);Rt.WRONG_DOCUMENT_ERR=(vt[4]="Wrong document",4);Rt.INVALID_CHARACTER_ERR=(vt[5]="Invalid character",5);Rt.NO_DATA_ALLOWED_ERR=(vt[6]="No data allowed",6);Rt.NO_MODIFICATION_ALLOWED_ERR=(vt[7]="No modification allowed",7);var Jy=Rt.NOT_FOUND_ERR=(vt[8]="Not found",8);Rt.NOT_SUPPORTED_ERR=(vt[9]="Not supported",9);var UC=Rt.INUSE_ATTRIBUTE_ERR=(vt[10]="Attribute in use",10);Rt.INVALID_STATE_ERR=(vt[11]="Invalid state",11);Rt.SYNTAX_ERR=(vt[12]="Syntax error",12);Rt.INVALID_MODIFICATION_ERR=(vt[13]="Invalid modification",13);Rt.NAMESPACE_ERR=(vt[14]="Invalid namespace",14);Rt.INVALID_ACCESS_ERR=(vt[15]="Invalid access",15);function ot(t,e){if(e instanceof Error)var i=e;else i=this,Error.call(this,vt[t]),this.message=vt[t],Error.captureStackTrace&&Error.captureStackTrace(this,ot);return i.code=t,e&&(this.message=this.message+": "+e),i}ot.prototype=Error.prototype;Vl(Rt,ot);function ks(){}ks.prototype={length:0,item:function(t){return t>=0&&t<this.length?this[t]:null},toString:function(t,e){for(var i=[],s=0;s<this.length;s++)qn(this[s],i,t,e);return i.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}};function po(t,e){this._node=t,this._refresh=e,xg(this)}function xg(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!==e){var i=t._refresh(t._node);if(dS(t,"length",i.length),!t.$$length||i.length<t.$$length)for(var s=i.length;s in t;s++)Object.prototype.hasOwnProperty.call(t,s)&&delete t[s];Vl(i,t),t._inc=e}}po.prototype.item=function(t){return xg(this),this[t]||null};ii(po,ks);function ud(){}function Zy(t,e){for(var i=t.length;i--;)if(t[i]===e)return i}function WC(t,e,i,s){if(s?e[Zy(e,s)]=i:e[e.length++]=i,t){i.ownerElement=t;var r=t.ownerDocument;r&&(s&&iS(r,t,s),OA(r,t,i))}}function zC(t,e,i){var s=Zy(e,i);if(s>=0){for(var r=e.length-1;s<r;)e[s]=e[++s];if(e.length=r,t){var n=t.ownerDocument;n&&(iS(n,t,i),i.ownerElement=null)}}else throw new ot(Jy,new Error(t.tagName+"@"+i))}ud.prototype={length:0,item:ks.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var i=this[e];if(i.nodeName==t)return i}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new ot(UC);var i=this.getNamedItem(t.nodeName);return WC(this._ownerElement,this,t,i),i},setNamedItemNS:function(t){var e=t.ownerElement,i;if(e&&e!=this._ownerElement)throw new ot(UC);return i=this.getNamedItemNS(t.namespaceURI,t.localName),WC(this._ownerElement,this,t,i),i},removeNamedItem:function(t){var e=this.getNamedItem(t);return zC(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var i=this.getNamedItemNS(t,e);return zC(this._ownerElement,this,i),i},getNamedItemNS:function(t,e){for(var i=this.length;i--;){var s=this[i];if(s.localName==e&&s.namespaceURI==t)return s}return null}};function eS(){}eS.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,i){var s=new Bl;if(s.implementation=this,s.childNodes=new ks,s.doctype=i||null,i&&s.appendChild(i),e){var r=s.createElementNS(t,e);s.appendChild(r)}return s},createDocumentType:function(t,e,i){var s=new eh;return s.name=t,s.nodeName=t,s.publicId=e||"",s.systemId=i||"",s}};function Oe(){}Oe.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return dd(this,t,e)},replaceChild:function(t,e){dd(this,t,e,rS),e&&this.removeChild(e)},removeChild:function(t){return sS(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(t){return Cp(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==ld&&t.nodeType==ld?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var i=e._nsMap;if(i){for(var s in i)if(Object.prototype.hasOwnProperty.call(i,s)&&i[s]===t)return s}e=e.nodeType==co?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var i=e._nsMap;if(i&&Object.prototype.hasOwnProperty.call(i,t))return i[t];e=e.nodeType==co?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return e==null}};function tS(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}Vl(si,Oe);Vl(si,Oe.prototype);function nl(t,e){if(e(t))return!0;if(t=t.firstChild)do if(nl(t,e))return!0;while(t=t.nextSibling)}function Bl(){this.ownerDocument=this}function OA(t,e,i){t&&t._inc++;var s=i.namespaceURI;s===rl.XMLNS&&(e._nsMap[i.prefix?i.localName:""]=i.value)}function iS(t,e,i,s){t&&t._inc++;var r=i.namespaceURI;r===rl.XMLNS&&delete e._nsMap[i.prefix?i.localName:""]}function Pg(t,e,i){if(t&&t._inc){t._inc++;var s=e.childNodes;if(i)s[s.length++]=i;else{for(var r=e.firstChild,n=0;r;)s[n++]=r,r=r.nextSibling;s.length=n,delete s[s.length]}}}function sS(t,e){var i=e.previousSibling,s=e.nextSibling;return i?i.nextSibling=s:t.firstChild=s,s?s.previousSibling=i:t.lastChild=i,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,Pg(t.ownerDocument,t),e}function NA(t){return t&&(t.nodeType===Oe.DOCUMENT_NODE||t.nodeType===Oe.DOCUMENT_FRAGMENT_NODE||t.nodeType===Oe.ELEMENT_NODE)}function kA(t){return t&&(vs(t)||Ig(t)||Us(t)||t.nodeType===Oe.DOCUMENT_FRAGMENT_NODE||t.nodeType===Oe.COMMENT_NODE||t.nodeType===Oe.PROCESSING_INSTRUCTION_NODE)}function Us(t){return t&&t.nodeType===Oe.DOCUMENT_TYPE_NODE}function vs(t){return t&&t.nodeType===Oe.ELEMENT_NODE}function Ig(t){return t&&t.nodeType===Oe.TEXT_NODE}function $C(t,e){var i=t.childNodes||[];if(Cs(i,vs)||Us(e))return!1;var s=Cs(i,Us);return!(e&&s&&i.indexOf(s)>i.indexOf(e))}function jC(t,e){var i=t.childNodes||[];function s(n){return vs(n)&&n!==e}if(Cs(i,s))return!1;var r=Cs(i,Us);return!(e&&r&&i.indexOf(r)>i.indexOf(e))}function GA(t,e,i){if(!NA(t))throw new ot(jt,"Unexpected parent node type "+t.nodeType);if(i&&i.parentNode!==t)throw new ot(Jy,"child not in parent");if(!kA(e)||Us(e)&&t.nodeType!==Oe.DOCUMENT_NODE)throw new ot(jt,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function VA(t,e,i){var s=t.childNodes||[],r=e.childNodes||[];if(e.nodeType===Oe.DOCUMENT_FRAGMENT_NODE){var n=r.filter(vs);if(n.length>1||Cs(r,Ig))throw new ot(jt,"More than one element or text in fragment");if(n.length===1&&!$C(t,i))throw new ot(jt,"Element in fragment can not be inserted before doctype")}if(vs(e)&&!$C(t,i))throw new ot(jt,"Only one element can be added and only after doctype");if(Us(e)){if(Cs(s,Us))throw new ot(jt,"Only one doctype is allowed");var o=Cs(s,vs);if(i&&s.indexOf(o)<s.indexOf(i))throw new ot(jt,"Doctype can only be inserted before an element");if(!i&&o)throw new ot(jt,"Doctype can not be appended since element is present")}}function rS(t,e,i){var s=t.childNodes||[],r=e.childNodes||[];if(e.nodeType===Oe.DOCUMENT_FRAGMENT_NODE){var n=r.filter(vs);if(n.length>1||Cs(r,Ig))throw new ot(jt,"More than one element or text in fragment");if(n.length===1&&!jC(t,i))throw new ot(jt,"Element in fragment can not be inserted before doctype")}if(vs(e)&&!jC(t,i))throw new ot(jt,"Only one element can be added and only after doctype");if(Us(e)){let l=function(u){return Us(u)&&u!==i};var a=l;if(Cs(s,l))throw new ot(jt,"Only one doctype is allowed");var o=Cs(s,vs);if(i&&s.indexOf(o)<s.indexOf(i))throw new ot(jt,"Doctype can only be inserted before an element")}}function dd(t,e,i,s){GA(t,e,i),t.nodeType===Oe.DOCUMENT_NODE&&(s||VA)(t,e,i);var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===Hs){var n=e.firstChild;if(n==null)return e;var o=e.lastChild}else n=o=e;var a=i?i.previousSibling:t.lastChild;n.previousSibling=a,o.nextSibling=i,a?a.nextSibling=n:t.firstChild=n,i==null?t.lastChild=o:i.previousSibling=o;do n.parentNode=t;while(n!==o&&(n=n.nextSibling));return Pg(t.ownerDocument||t,t),e.nodeType==Hs&&(e.firstChild=e.lastChild=null),e}function BA(t,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,Pg(t.ownerDocument,t,e),e}Bl.prototype={nodeName:"#document",nodeType:Xy,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==Hs){for(var i=t.firstChild;i;){var s=i.nextSibling;this.insertBefore(i,e),i=s}return t}return dd(this,t,e),t.ownerDocument=this,this.documentElement===null&&t.nodeType===qi&&(this.documentElement=t),t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),sS(this,t)},replaceChild:function(t,e){dd(this,t,e,rS),t.ownerDocument=this,e&&this.removeChild(e),vs(t)&&(this.documentElement=t)},importNode:function(t,e){return uS(this,t,e)},getElementById:function(t){var e=null;return nl(this.documentElement,function(i){if(i.nodeType==qi&&i.getAttribute("id")==t)return e=i,!0}),e},getElementsByClassName:function(t){var e=HC(t);return new po(this,function(i){var s=[];return e.length>0&&nl(i.documentElement,function(r){if(r!==i&&r.nodeType===qi){var n=r.getAttribute("class");if(n){var o=t===n;if(!o){var a=HC(n);o=e.every(LA(a))}o&&s.push(r)}}}),s})},createElement:function(t){var e=new en;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new ks;var i=e.attributes=new ud;return i._ownerElement=e,e},createDocumentFragment:function(){var t=new th;return t.ownerDocument=this,t.childNodes=new ks,t},createTextNode:function(t){var e=new Lg;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new Fg;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new Mg;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var i=new Ng;return i.ownerDocument=this,i.tagName=i.nodeName=i.target=t,i.nodeValue=i.data=e,i},createAttribute:function(t){var e=new hd;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new Og;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var i=new en,s=e.split(":"),r=i.attributes=new ud;return i.childNodes=new ks,i.ownerDocument=this,i.nodeName=e,i.tagName=e,i.namespaceURI=t,s.length==2?(i.prefix=s[0],i.localName=s[1]):i.localName=e,r._ownerElement=i,i},createAttributeNS:function(t,e){var i=new hd,s=e.split(":");return i.ownerDocument=this,i.nodeName=e,i.name=e,i.namespaceURI=t,i.specified=!0,s.length==2?(i.prefix=s[0],i.localName=s[1]):i.localName=e,i}};ii(Bl,Oe);function en(){this._nsMap={}}en.prototype={nodeType:qi,hasAttribute:function(t){return this.getAttributeNode(t)!=null},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var i=this.ownerDocument.createAttribute(t);i.value=i.nodeValue=""+e,this.setAttributeNode(i)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===Hs?this.insertBefore(t,null):BA(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var i=this.getAttributeNodeNS(t,e);i&&this.removeAttributeNode(i)},hasAttributeNS:function(t,e){return this.getAttributeNodeNS(t,e)!=null},getAttributeNS:function(t,e){var i=this.getAttributeNodeNS(t,e);return i&&i.value||""},setAttributeNS:function(t,e,i){var s=this.ownerDocument.createAttributeNS(t,e);s.value=s.nodeValue=""+i,this.setAttributeNode(s)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new po(this,function(e){var i=[];return nl(e,function(s){s!==e&&s.nodeType==qi&&(t==="*"||s.tagName==t)&&i.push(s)}),i})},getElementsByTagNameNS:function(t,e){return new po(this,function(i){var s=[];return nl(i,function(r){r!==i&&r.nodeType===qi&&(t==="*"||r.namespaceURI===t)&&(e==="*"||r.localName==e)&&s.push(r)}),s})}};Bl.prototype.getElementsByTagName=en.prototype.getElementsByTagName;Bl.prototype.getElementsByTagNameNS=en.prototype.getElementsByTagNameNS;ii(en,Oe);function hd(){}hd.prototype.nodeType=co;ii(hd,Oe);function Hl(){}Hl.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(vt[jt])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,i){var s=this.data.substring(0,t),r=this.data.substring(t+e);i=s+i+r,this.nodeValue=this.data=i,this.length=i.length}};ii(Hl,Oe);function Lg(){}Lg.prototype={nodeName:"#text",nodeType:ld,splitText:function(t){var e=this.data,i=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var s=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling),s}};ii(Lg,Hl);function Fg(){}Fg.prototype={nodeName:"#comment",nodeType:Yy};ii(Fg,Hl);function Mg(){}Mg.prototype={nodeName:"#cdata-section",nodeType:jy};ii(Mg,Hl);function eh(){}eh.prototype.nodeType=Qy;ii(eh,Oe);function nS(){}nS.prototype.nodeType=MA;ii(nS,Oe);function oS(){}oS.prototype.nodeType=FA;ii(oS,Oe);function Og(){}Og.prototype.nodeType=qy;ii(Og,Oe);function th(){}th.prototype.nodeName="#document-fragment";th.prototype.nodeType=Hs;ii(th,Oe);function Ng(){}Ng.prototype.nodeType=Ky;ii(Ng,Oe);function aS(){}aS.prototype.serializeToString=function(t,e,i){return lS.call(t,e,i)};Oe.prototype.toString=lS;function lS(t,e){var i=[],s=this.nodeType==9&&this.documentElement||this,r=s.prefix,n=s.namespaceURI;if(n&&r==null){var r=s.lookupPrefix(n);if(r==null)var o=[{namespace:n,prefix:null}]}return qn(this,i,t,e,o),i.join("")}function qC(t,e,i){var s=t.prefix||"",r=t.namespaceURI;if(!r||s==="xml"&&r===rl.XML||r===rl.XMLNS)return!1;for(var n=i.length;n--;){var o=i[n];if(o.prefix===s)return o.namespace!==r}return!0}function Lc(t,e,i){t.push(" ",e,'="',i.replace(/[<>&"\t\n\r]/g,tS),'"')}function qn(t,e,i,s,r){if(r||(r=[]),s)if(t=s(t),t){if(typeof t=="string"){e.push(t);return}}else return;switch(t.nodeType){case qi:var n=t.attributes,o=n.length,R=t.firstChild,a=t.tagName;i=rl.isHTML(t.namespaceURI)||i;var l=a;if(!i&&!t.prefix&&t.namespaceURI){for(var u,d=0;d<n.length;d++)if(n.item(d).name==="xmlns"){u=n.item(d).value;break}if(!u)for(var c=r.length-1;c>=0;c--){var C=r[c];if(C.prefix===""&&C.namespace===t.namespaceURI){u=C.namespace;break}}if(u!==t.namespaceURI)for(var c=r.length-1;c>=0;c--){var C=r[c];if(C.namespace===t.namespaceURI){C.prefix&&(l=C.prefix+":"+a);break}}}e.push("<",l);for(var E=0;E<o;E++){var y=n.item(E);y.prefix=="xmlns"?r.push({prefix:y.localName,namespace:y.value}):y.nodeName=="xmlns"&&r.push({prefix:"",namespace:y.value})}for(var E=0;E<o;E++){var y=n.item(E);if(qC(y,i,r)){var _=y.prefix||"",b=y.namespaceURI;Lc(e,_?"xmlns:"+_:"xmlns",b),r.push({prefix:_,namespace:b})}qn(y,e,i,s,r)}if(a===l&&qC(t,i,r)){var _=t.prefix||"",b=t.namespaceURI;Lc(e,_?"xmlns:"+_:"xmlns",b),r.push({prefix:_,namespace:b})}if(R||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(e.push(">"),i&&/^script$/i.test(a))for(;R;)R.data?e.push(R.data):qn(R,e,i,s,r.slice()),R=R.nextSibling;else for(;R;)qn(R,e,i,s,r.slice()),R=R.nextSibling;e.push("</",l,">")}else e.push("/>");return;case Xy:case Hs:for(var R=t.firstChild;R;)qn(R,e,i,s,r.slice()),R=R.nextSibling;return;case co:return Lc(e,t.name,t.value);case ld:return e.push(t.data.replace(/[<&>]/g,tS));case jy:return e.push("<![CDATA[",t.data,"]]>");case Yy:return e.push("<!--",t.data,"-->");case Qy:var D=t.publicId,O=t.systemId;if(e.push("<!DOCTYPE ",t.name),D)e.push(" PUBLIC ",D),O&&O!="."&&e.push(" ",O),e.push(">");else if(O&&O!=".")e.push(" SYSTEM ",O,">");else{var L=t.internalSubset;L&&e.push(" [",L,"]"),e.push(">")}return;case Ky:return e.push("<?",t.target," ",t.data,"?>");case qy:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function uS(t,e,i){var s;switch(e.nodeType){case qi:s=e.cloneNode(!1),s.ownerDocument=t;case Hs:break;case co:i=!0;break}if(s||(s=e.cloneNode(!1)),s.ownerDocument=t,s.parentNode=null,i)for(var r=e.firstChild;r;)s.appendChild(uS(t,r,i)),r=r.nextSibling;return s}function Cp(t,e,i){var s=new e.constructor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r];typeof n!="object"&&n!=s[r]&&(s[r]=n)}switch(e.childNodes&&(s.childNodes=new ks),s.ownerDocument=t,s.nodeType){case qi:var o=e.attributes,a=s.attributes=new ud,l=o.length;a._ownerElement=s;for(var u=0;u<l;u++)s.setAttributeNode(Cp(t,o.item(u),!0));break;case co:i=!0}if(i)for(var d=e.firstChild;d;)s.appendChild(Cp(t,d,i)),d=d.nextSibling;return s}function dS(t,e,i){t[e]=i}try{if(Object.defineProperty){let t=function(e){switch(e.nodeType){case qi:case Hs:var i=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&i.push(t(e)),e=e.nextSibling;return i.join("");default:return e.nodeValue}};var I1=t;Object.defineProperty(po.prototype,"length",{get:function(){return xg(this),this.$$length}}),Object.defineProperty(Oe.prototype,"textContent",{get:function(){return t(this)},set:function(e){switch(this.nodeType){case qi:case Hs:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),dS=function(e,i,s){e["$$"+i]=s}}}catch{}vr.DocumentType=eh;vr.DOMException=ot;vr.DOMImplementation=eS;vr.Element=en;vr.Node=Oe;vr.NodeList=ks;vr.XMLSerializer=aS;var ih={},hS={};(function(t){var e=js.freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES})(hS);var kg={},ol=js.NAMESPACE,vp=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,KC=new RegExp("[\\-\\.0-9"+vp.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),YC=new RegExp("^"+vp.source+KC.source+"*(?::"+vp.source+KC.source+"*)?$"),wa=0,ir=1,Nn=2,Ta=3,kn=4,Gn=5,ba=6,ku=7;function go(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,go)}go.prototype=new Error;go.prototype.name=go.name;function cS(){}cS.prototype={parse:function(t,e,i){var s=this.domBuilder;s.startDocument(),pS(e,e={}),HA(t,e,i,s,this.errorHandler),s.endDocument()}};function HA(t,e,i,s,r){function n(Re){if(Re>65535){Re-=65536;var it=55296+(Re>>10),Ps=56320+(Re&1023);return String.fromCharCode(it,Ps)}else return String.fromCharCode(Re)}function o(Re){var it=Re.slice(1,-1);return Object.hasOwnProperty.call(i,it)?i[it]:it.charAt(0)==="#"?n(parseInt(it.substr(1).replace("x","0x"))):(r.error("entity not found:"+Re),Re)}function a(Re){if(Re>_){var it=t.substring(_,Re).replace(/&#?\w+;/g,o);C&&l(_),s.characters(it,0,Re-_),_=Re}}function l(Re,it){for(;Re>=d&&(it=c.exec(t));)u=it.index,d=u+it[0].length,C.lineNumber++;C.columnNumber=Re-u+1}for(var u=0,d=0,c=/.*(?:\r\n?|\n)|.*$/g,C=s.locator,E=[{currentNSMap:e}],y={},_=0;;){try{var b=t.indexOf("<",_);if(b<0){if(!t.substr(_).match(/^\s*$/)){var R=s.doc,D=R.createTextNode(t.substr(_));R.appendChild(D),s.currentElement=D}return}switch(b>_&&a(b),t.charAt(b+1)){case"/":var le=t.indexOf(">",b+3),O=t.substring(b+2,le).replace(/[ \t\n\r]+$/g,""),L=E.pop();le<0?(O=t.substring(b+2).replace(/[\s<].*/,""),r.error("end tag name: "+O+" is not complete:"+L.tagName),le=b+1+O.length):O.match(/\s</)&&(O=O.replace(/[\s<].*/,""),r.error("end tag name: "+O+" maybe not complete"),le=b+1+O.length);var I=L.localNSMap,k=L.tagName==O,H=k||L.tagName&&L.tagName.toLowerCase()==O.toLowerCase();if(H){if(s.endElement(L.uri,L.localName,O),I)for(var ee in I)Object.prototype.hasOwnProperty.call(I,ee)&&s.endPrefixMapping(ee);k||r.fatalError("end tag name: "+O+" is not match the current start tagName:"+L.tagName)}else E.push(L);le++;break;case"?":C&&l(b),le=jA(t,b,s);break;case"!":C&&l(b),le=$A(t,b,s,r);break;default:C&&l(b);var Q=new gS,Ce=E[E.length-1].currentNSMap,le=UA(t,b,Q,Ce,o,r),be=Q.length;if(!Q.closed&&zA(t,le,Q.tagName,y)&&(Q.closed=!0,i.nbsp||r.warning("unclosed xml attribute")),C&&be){for(var Z=XC(C,{}),Ee=0;Ee<be;Ee++){var xt=Q[Ee];l(xt.offset),xt.locator=XC(C,{})}s.locator=Z,QC(Q,s,Ce)&&E.push(Q),s.locator=C}else QC(Q,s,Ce)&&E.push(Q);ol.isHTML(Q.uri)&&!Q.closed?le=WA(t,le,Q.tagName,o,s):le++}}catch(Re){if(Re instanceof go)throw Re;r.error("element parse error: "+Re),le=-1}le>_?_=le:a(Math.max(b,_)+1)}}function XC(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function UA(t,e,i,s,r,n){function o(C,E,y){i.attributeNames.hasOwnProperty(C)&&n.fatalError("Attribute "+C+" redefined"),i.addValue(C,E.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,r),y)}for(var a,l,u=++e,d=wa;;){var c=t.charAt(u);switch(c){case"=":if(d===ir)a=t.slice(e,u),d=Ta;else if(d===Nn)d=Ta;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(d===Ta||d===ir)if(d===ir&&(n.warning('attribute value must after "="'),a=t.slice(e,u)),e=u+1,u=t.indexOf(c,e),u>0)l=t.slice(e,u),o(a,l,e-1),d=Gn;else throw new Error("attribute value no end '"+c+"' match");else if(d==kn)l=t.slice(e,u),o(a,l,e),n.warning('attribute "'+a+'" missed start quot('+c+")!!"),e=u+1,d=Gn;else throw new Error('attribute value must after "="');break;case"/":switch(d){case wa:i.setTagName(t.slice(e,u));case Gn:case ba:case ku:d=ku,i.closed=!0;case kn:case ir:break;case Nn:i.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),d==wa&&i.setTagName(t.slice(e,u)),u;case">":switch(d){case wa:i.setTagName(t.slice(e,u));case Gn:case ba:case ku:break;case kn:case ir:l=t.slice(e,u),l.slice(-1)==="/"&&(i.closed=!0,l=l.slice(0,-1));case Nn:d===Nn&&(l=a),d==kn?(n.warning('attribute "'+l+'" missed quot(")!'),o(a,l,e)):((!ol.isHTML(s[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),o(l,l,e));break;case Ta:throw new Error("attribute value missed!!")}return u;case"":c=" ";default:if(c<=" ")switch(d){case wa:i.setTagName(t.slice(e,u)),d=ba;break;case ir:a=t.slice(e,u),d=Nn;break;case kn:var l=t.slice(e,u);n.warning('attribute "'+l+'" missed quot(")!!'),o(a,l,e);case Gn:d=ba;break}else switch(d){case Nn:i.tagName,(!ol.isHTML(s[""])||!a.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,d=ir;break;case Gn:n.warning('attribute space is required"'+a+'"!!');case ba:d=ir,e=u;break;case Ta:d=kn,e=u;break;case ku:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function QC(t,e,i){for(var s=t.tagName,r=null,c=t.length;c--;){var n=t[c],o=n.qName,a=n.value,C=o.indexOf(":");if(C>0)var l=n.prefix=o.slice(0,C),u=o.slice(C+1),d=l==="xmlns"&&u;else u=o,l=null,d=o==="xmlns"&&"";n.localName=u,d!==!1&&(r==null&&(r={},pS(i,i={})),i[d]=r[d]=a,n.uri=ol.XMLNS,e.startPrefixMapping(d,a))}for(var c=t.length;c--;){n=t[c];var l=n.prefix;l&&(l==="xml"&&(n.uri=ol.XML),l!=="xmlns"&&(n.uri=i[l||""]))}var C=s.indexOf(":");C>0?(l=t.prefix=s.slice(0,C),u=t.localName=s.slice(C+1)):(l=null,u=t.localName=s);var E=t.uri=i[l||""];if(e.startElement(E,u,s,t),t.closed){if(e.endElement(E,u,s),r)for(l in r)Object.prototype.hasOwnProperty.call(r,l)&&e.endPrefixMapping(l)}else return t.currentNSMap=i,t.localNSMap=r,!0}function WA(t,e,i,s,r){if(/^(?:script|textarea)$/i.test(i)){var n=t.indexOf("</"+i+">",e),o=t.substring(e+1,n);if(/[&<]/.test(o))return/^script$/i.test(i)?(r.characters(o,0,o.length),n):(o=o.replace(/&#?\w+;/g,s),r.characters(o,0,o.length),n)}return e+1}function zA(t,e,i,s){var r=s[i];return r==null&&(r=t.lastIndexOf("</"+i+">"),r<e&&(r=t.lastIndexOf("</"+i)),s[i]=r),r<e}function pS(t,e){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}function $A(t,e,i,s){var r=t.charAt(e+2);switch(r){case"-":if(t.charAt(e+3)==="-"){var n=t.indexOf("-->",e+4);return n>e?(i.comment(t,e+4,n-e-4),n+3):(s.error("Unclosed comment"),-1)}else return-1;default:if(t.substr(e+3,6)=="CDATA["){var n=t.indexOf("]]>",e+9);return i.startCDATA(),i.characters(t,e+9,n-e-9),i.endCDATA(),n+3}var o=qA(t,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var l=o[1][0],u=!1,d=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],d=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(d=o[3][0]));var c=o[a-1];return i.startDTD(l,u,d),i.endDTD(),c.index+c[0].length}}return-1}function jA(t,e,i){var s=t.indexOf("?>",e);if(s){var r=t.substring(e,s).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,i.processingInstruction(r[1],r[2]),s+2):-1}return-1}function gS(){this.attributeNames={}}gS.prototype={setTagName:function(t){if(!YC.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,i){if(!YC.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:i}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}};function qA(t,e){var i,s=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=e,r.exec(t);i=r.exec(t);)if(s.push(i),i[1])return s}kg.XMLReader=cS;kg.ParseError=go;var KA=js,YA=vr,JC=hS,fS=kg,XA=YA.DOMImplementation,ZC=KA.NAMESPACE,QA=fS.ParseError,JA=fS.XMLReader;function mS(t){return t.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function CS(t){this.options=t||{locator:{}}}CS.prototype.parseFromString=function(t,e){var i=this.options,s=new JA,r=i.domBuilder||new Ul,n=i.errorHandler,o=i.locator,a=i.xmlns||{},l=/\/x?html?$/.test(e),u=l?JC.HTML_ENTITIES:JC.XML_ENTITIES;o&&r.setDocumentLocator(o),s.errorHandler=ZA(n,r,o),s.domBuilder=i.domBuilder||r,l&&(a[""]=ZC.HTML),a.xml=a.xml||ZC.XML;var d=i.normalizeLineEndings||mS;return t&&typeof t=="string"?s.parse(d(t),a,u):s.errorHandler.error("invalid doc source"),r.doc};function ZA(t,e,i){if(!t){if(e instanceof Ul)return e;t=e}var s={},r=t instanceof Function;i=i||{};function n(o){var a=t[o];!a&&r&&(a=t.length==2?function(l){t(o,l)}:t),s[o]=a&&function(l){a("[xmldom "+o+"]	"+l+yp(i))}||function(){}}return n("warning"),n("error"),n("fatalError"),s}function Ul(){this.cdata=!1}function Vn(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}Ul.prototype={startDocument:function(){this.doc=new XA().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,i,s){var r=this.doc,n=r.createElementNS(t,i||e),o=s.length;Gu(this,n),this.currentElement=n,this.locator&&Vn(this.locator,n);for(var a=0;a<o;a++){var t=s.getURI(a),l=s.getValue(a),i=s.getQName(a),u=r.createAttributeNS(t,i);this.locator&&Vn(s.getLocator(a),u),u.value=u.nodeValue=l,n.setAttributeNode(u)}},endElement:function(t,e,i){var s=this.currentElement;s.tagName,this.currentElement=s.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var i=this.doc.createProcessingInstruction(t,e);this.locator&&Vn(this.locator,i),Gu(this,i)},ignorableWhitespace:function(t,e,i){},characters:function(t,e,i){if(t=ev.apply(this,arguments),t){if(this.cdata)var s=this.doc.createCDATASection(t);else var s=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(s):/^\s*$/.test(t)&&this.doc.appendChild(s),this.locator&&Vn(this.locator,s)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,i){t=ev.apply(this,arguments);var s=this.doc.createComment(t);this.locator&&Vn(this.locator,s),Gu(this,s)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,i){var s=this.doc.implementation;if(s&&s.createDocumentType){var r=s.createDocumentType(t,e,i);this.locator&&Vn(this.locator,r),Gu(this,r),this.doc.doctype=r}},warning:function(t){console.warn("[xmldom warning]	"+t,yp(this.locator))},error:function(t){console.error("[xmldom error]	"+t,yp(this.locator))},fatalError:function(t){throw new QA(t,this.locator)}};function yp(t){if(t)return`
@`+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function ev(t,e,i){return typeof t=="string"?t.substr(e,i):t.length>=e+i||e?new java.lang.String(t,e,i)+"":t}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){Ul.prototype[t]=function(){return null}});function Gu(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}ih.__DOMHandler=Ul;ih.normalizeLineEndings=mS;ih.DOMParser=CS;var ex=ih.DOMParser;/*! @name mpd-parser @version 1.3.0 @license Apache-2.0 */const tv=t=>!!t&&typeof t=="object",mt=(...t)=>t.reduce((e,i)=>(typeof i!="object"||Object.keys(i).forEach(s=>{Array.isArray(e[s])&&Array.isArray(i[s])?e[s]=e[s].concat(i[s]):tv(e[s])&&tv(i[s])?e[s]=mt(e[s],i[s]):e[s]=i[s]}),e),{}),vS=t=>Object.keys(t).map(e=>t[e]),tx=(t,e)=>{const i=[];for(let s=t;s<e;s++)i.push(s);return i},fo=t=>t.reduce((e,i)=>e.concat(i),[]),yS=t=>{if(!t.length)return[];const e=[];for(let i=0;i<t.length;i++)e.push(t[i]);return e},ix=(t,e)=>t.reduce((i,s,r)=>(s[e]&&i.push(r),i),[]),sx=(t,e)=>vS(t.reduce((i,s)=>(s.forEach(r=>{i[e(r)]=r}),i),{}));var mo={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const al=({baseUrl:t="",source:e="",range:i="",indexRange:s=""})=>{const r={uri:e,resolvedUri:Zd(t||"",e)};if(i||s){const o=(i||s).split("-");let a=F.BigInt?F.BigInt(o[0]):parseInt(o[0],10),l=F.BigInt?F.BigInt(o[1]):parseInt(o[1],10);a<Number.MAX_SAFE_INTEGER&&typeof a=="bigint"&&(a=Number(a)),l<Number.MAX_SAFE_INTEGER&&typeof l=="bigint"&&(l=Number(l));let u;typeof l=="bigint"||typeof a=="bigint"?u=F.BigInt(l)-F.BigInt(a)+F.BigInt(1):u=l-a+1,typeof u=="bigint"&&u<Number.MAX_SAFE_INTEGER&&(u=Number(u)),r.byterange={length:u,offset:a}}return r},rx=t=>{let e;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=F.BigInt(t.offset)+F.BigInt(t.length)-F.BigInt(1):e=t.offset+t.length-1,`${t.offset}-${e}`},iv=t=>(t&&typeof t!="number"&&(t=parseInt(t,10)),isNaN(t)?null:t),nx={static(t){const{duration:e,timescale:i=1,sourceDuration:s,periodDuration:r}=t,n=iv(t.endNumber),o=e/i;return typeof n=="number"?{start:0,end:n}:typeof r=="number"?{start:0,end:r/o}:{start:0,end:s/o}},dynamic(t){const{NOW:e,clientOffset:i,availabilityStartTime:s,timescale:r=1,duration:n,periodStart:o=0,minimumUpdatePeriod:a=0,timeShiftBufferDepth:l=1/0}=t,u=iv(t.endNumber),d=(e+i)/1e3,c=s+o,E=d+a-c,y=Math.ceil(E*r/n),_=Math.floor((d-c-l)*r/n),b=Math.floor((d-c)*r/n);return{start:Math.max(0,_),end:typeof u=="number"?u:Math.min(y,b)}}},ox=t=>e=>{const{duration:i,timescale:s=1,periodStart:r,startNumber:n=1}=t;return{number:n+e,duration:i/s,timeline:r,time:e*i}},Gg=t=>{const{type:e,duration:i,timescale:s=1,periodDuration:r,sourceDuration:n}=t,{start:o,end:a}=nx[e](t),l=tx(o,a).map(ox(t));if(e==="static"){const u=l.length-1,d=typeof r=="number"?r:n;l[u].duration=d-i/s*u}return l},SS=t=>{const{baseUrl:e,initialization:i={},sourceDuration:s,indexRange:r="",periodStart:n,presentationTime:o,number:a=0,duration:l}=t;if(!e)throw new Error(mo.NO_BASE_URL);const u=al({baseUrl:e,source:i.sourceURL,range:i.range}),d=al({baseUrl:e,source:e,indexRange:r});if(d.map=u,l){const c=Gg(t);c.length&&(d.duration=c[0].duration,d.timeline=c[0].timeline)}else s&&(d.duration=s,d.timeline=n);return d.presentationTime=o||n,d.number=a,[d]},Vg=(t,e,i)=>{const s=t.sidx.map?t.sidx.map:null,r=t.sidx.duration,n=t.timeline||0,o=t.sidx.byterange,a=o.offset+o.length,l=e.timescale,u=e.references.filter(b=>b.referenceType!==1),d=[],c=t.endList?"static":"dynamic",C=t.sidx.timeline;let E=C,y=t.mediaSequence||0,_;typeof e.firstOffset=="bigint"?_=F.BigInt(a)+e.firstOffset:_=a+e.firstOffset;for(let b=0;b<u.length;b++){const R=e.references[b],D=R.referencedSize,O=R.subsegmentDuration;let L;typeof _=="bigint"?L=_+F.BigInt(D)-F.BigInt(1):L=_+D-1;const I=`${_}-${L}`,H=SS({baseUrl:i,timescale:l,timeline:n,periodStart:C,presentationTime:E,number:y,duration:O,sourceDuration:r,indexRange:I,type:c})[0];s&&(H.map=s),d.push(H),typeof _=="bigint"?_+=F.BigInt(D):_+=D,E+=O/l,y++}return t.segments=d,t},ax=["AUDIO","SUBTITLES"],lx=1/60,ES=t=>sx(t,({timeline:e})=>e).sort((e,i)=>e.timeline>i.timeline?1:-1),ux=(t,e)=>{for(let i=0;i<t.length;i++)if(t[i].attributes.NAME===e)return t[i];return null},sv=t=>{let e=[];return bA(t,ax,(i,s,r,n)=>{e=e.concat(i.playlists||[])}),e},rv=({playlist:t,mediaSequence:e})=>{t.mediaSequence=e,t.segments.forEach((i,s)=>{i.number=t.mediaSequence+s})},dx=({oldPlaylists:t,newPlaylists:e,timelineStarts:i})=>{e.forEach(s=>{s.discontinuitySequence=i.findIndex(function({timeline:l}){return l===s.timeline});const r=ux(t,s.attributes.NAME);if(!r||s.sidx)return;const n=s.segments[0],o=r.segments.findIndex(function(l){return Math.abs(l.presentationTime-n.presentationTime)<lx});if(o===-1){rv({playlist:s,mediaSequence:r.mediaSequence+r.segments.length}),s.segments[0].discontinuity=!0,s.discontinuityStarts.unshift(0),(!r.segments.length&&s.timeline>r.timeline||r.segments.length&&s.timeline>r.segments[r.segments.length-1].timeline)&&s.discontinuitySequence--;return}r.segments[o].discontinuity&&!n.discontinuity&&(n.discontinuity=!0,s.discontinuityStarts.unshift(0),s.discontinuitySequence--),rv({playlist:s,mediaSequence:r.segments[o].number})})},hx=({oldManifest:t,newManifest:e})=>{const i=t.playlists.concat(sv(t)),s=e.playlists.concat(sv(e));return e.timelineStarts=ES([t.timelineStarts,e.timelineStarts]),dx({oldPlaylists:i,newPlaylists:s,timelineStarts:e.timelineStarts}),e},sh=t=>t&&t.uri+"-"+rx(t.byterange),Fc=t=>{const e=t.reduce(function(s,r){return s[r.attributes.baseUrl]||(s[r.attributes.baseUrl]=[]),s[r.attributes.baseUrl].push(r),s},{});let i=[];return Object.values(e).forEach(s=>{const r=vS(s.reduce((n,o)=>{const a=o.attributes.id+(o.attributes.lang||"");return n[a]?(o.segments&&(o.segments[0]&&(o.segments[0].discontinuity=!0),n[a].segments.push(...o.segments)),o.attributes.contentProtection&&(n[a].attributes.contentProtection=o.attributes.contentProtection)):(n[a]=o,n[a].attributes.timelineStarts=[]),n[a].attributes.timelineStarts.push({start:o.attributes.periodStart,timeline:o.attributes.periodStart}),n},{}));i=i.concat(r)}),i.map(s=>(s.discontinuityStarts=ix(s.segments||[],"discontinuity"),s))},Bg=(t,e)=>{const i=sh(t.sidx),s=i&&e[i]&&e[i].sidx;return s&&Vg(t,s,t.sidx.resolvedUri),t},cx=(t,e={})=>{if(!Object.keys(e).length)return t;for(const i in t)t[i]=Bg(t[i],e);return t},px=({attributes:t,segments:e,sidx:i,mediaSequence:s,discontinuitySequence:r,discontinuityStarts:n},o)=>{const a={attributes:{NAME:t.id,BANDWIDTH:t.bandwidth,CODECS:t.codecs,"PROGRAM-ID":1},uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,discontinuitySequence:r,discontinuityStarts:n,timelineStarts:t.timelineStarts,mediaSequence:s,segments:e};return t.contentProtection&&(a.contentProtection=t.contentProtection),t.serviceLocation&&(a.attributes.serviceLocation=t.serviceLocation),i&&(a.sidx=i),o&&(a.attributes.AUDIO="audio",a.attributes.SUBTITLES="subs"),a},gx=({attributes:t,segments:e,mediaSequence:i,discontinuityStarts:s,discontinuitySequence:r})=>{typeof e>"u"&&(e=[{uri:t.baseUrl,timeline:t.periodStart,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration);const n={NAME:t.id,BANDWIDTH:t.bandwidth,"PROGRAM-ID":1};t.codecs&&(n.CODECS=t.codecs);const o={attributes:n,uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,timelineStarts:t.timelineStarts,discontinuityStarts:s,discontinuitySequence:r,mediaSequence:i,segments:e};return t.serviceLocation&&(o.attributes.serviceLocation=t.serviceLocation),o},fx=(t,e={},i=!1)=>{let s;const r=t.reduce((n,o)=>{const a=o.attributes.role&&o.attributes.role.value||"",l=o.attributes.lang||"";let u=o.attributes.label||"main";if(l&&!o.attributes.label){const c=a?` (${a})`:"";u=`${o.attributes.lang}${c}`}n[u]||(n[u]={language:l,autoselect:!0,default:a==="main",playlists:[],uri:""});const d=Bg(px(o,i),e);return n[u].playlists.push(d),typeof s>"u"&&a==="main"&&(s=o,s.default=!0),n},{});if(!s){const n=Object.keys(r)[0];r[n].default=!0}return r},mx=(t,e={})=>t.reduce((i,s)=>{const r=s.attributes.label||s.attributes.lang||"text";return i[r]||(i[r]={language:r,default:!1,autoselect:!1,playlists:[],uri:""}),i[r].playlists.push(Bg(gx(s),e)),i},{}),Cx=t=>t.reduce((e,i)=>(i&&i.forEach(s=>{const{channel:r,language:n}=s;e[n]={autoselect:!1,default:!1,instreamId:r,language:n},s.hasOwnProperty("aspectRatio")&&(e[n].aspectRatio=s.aspectRatio),s.hasOwnProperty("easyReader")&&(e[n].easyReader=s.easyReader),s.hasOwnProperty("3D")&&(e[n]["3D"]=s["3D"])}),e),{}),vx=({attributes:t,segments:e,sidx:i,discontinuityStarts:s})=>{const r={attributes:{NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth,"PROGRAM-ID":1},uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,discontinuityStarts:s,timelineStarts:t.timelineStarts,segments:e};return t.frameRate&&(r.attributes["FRAME-RATE"]=t.frameRate),t.contentProtection&&(r.contentProtection=t.contentProtection),t.serviceLocation&&(r.attributes.serviceLocation=t.serviceLocation),i&&(r.sidx=i),r},yx=({attributes:t})=>t.mimeType==="video/mp4"||t.mimeType==="video/webm"||t.contentType==="video",Sx=({attributes:t})=>t.mimeType==="audio/mp4"||t.mimeType==="audio/webm"||t.contentType==="audio",Ex=({attributes:t})=>t.mimeType==="text/vtt"||t.contentType==="text",wx=(t,e)=>{t.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=e.findIndex(function({timeline:s}){return s===i.timeline}),i.segments&&i.segments.forEach((s,r)=>{s.number=r})})},nv=t=>t?Object.keys(t).reduce((e,i)=>{const s=t[i];return e.concat(s.playlists)},[]):[],Tx=({dashPlaylists:t,locations:e,contentSteering:i,sidxMapping:s={},previousManifest:r,eventStream:n})=>{if(!t.length)return{};const{sourceDuration:o,type:a,suggestedPresentationDelay:l,minimumUpdatePeriod:u}=t[0].attributes,d=Fc(t.filter(yx)).map(vx),c=Fc(t.filter(Sx)),C=Fc(t.filter(Ex)),E=t.map(L=>L.attributes.captionServices).filter(Boolean),y={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:o,playlists:cx(d,s)};u>=0&&(y.minimumUpdatePeriod=u*1e3),e&&(y.locations=e),i&&(y.contentSteering=i),a==="dynamic"&&(y.suggestedPresentationDelay=l),n&&n.length>0&&(y.eventStream=n);const _=y.playlists.length===0,b=c.length?fx(c,s,_):null,R=C.length?mx(C,s):null,D=d.concat(nv(b),nv(R)),O=D.map(({timelineStarts:L})=>L);return y.timelineStarts=ES(O),wx(D,y.timelineStarts),b&&(y.mediaGroups.AUDIO.audio=b),R&&(y.mediaGroups.SUBTITLES.subs=R),E.length&&(y.mediaGroups["CLOSED-CAPTIONS"].cc=Cx(E)),r?hx({oldManifest:r,newManifest:y}):y},bx=(t,e,i)=>{const{NOW:s,clientOffset:r,availabilityStartTime:n,timescale:o=1,periodStart:a=0,minimumUpdatePeriod:l=0}=t,u=(s+r)/1e3,d=n+a,C=u+l-d;return Math.ceil((C*o-e)/i)},wS=(t,e)=>{const{type:i,minimumUpdatePeriod:s=0,media:r="",sourceDuration:n,timescale:o=1,startNumber:a=1,periodStart:l}=t,u=[];let d=-1;for(let c=0;c<e.length;c++){const C=e[c],E=C.d,y=C.r||0,_=C.t||0;d<0&&(d=_),_&&_>d&&(d=_);let b;if(y<0){const O=c+1;O===e.length?i==="dynamic"&&s>0&&r.indexOf("$Number$")>0?b=bx(t,d,E):b=(n*o-d)/E:b=(e[O].t-d)/E}else b=y+1;const R=a+u.length+b;let D=a+u.length;for(;D<R;)u.push({number:D,duration:E/o,time:d,timeline:l}),d+=E,D++}return u},_x=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Dx=t=>(e,i,s,r)=>{if(e==="$$")return"$";if(typeof t[i]>"u")return e;const n=""+t[i];return i==="RepresentationID"||(s?r=parseInt(r,10):r=1,n.length>=r)?n:`${new Array(r-n.length+1).join("0")}${n}`},ov=(t,e)=>t.replace(_x,Dx(e)),Rx=(t,e)=>!t.duration&&!e?[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodStart}]:t.duration?Gg(t):wS(t,e),Ax=(t,e)=>{const i={RepresentationID:t.id,Bandwidth:t.bandwidth||0},{initialization:s={sourceURL:"",range:""}}=t,r=al({baseUrl:t.baseUrl,source:ov(s.sourceURL,i),range:s.range});return Rx(t,e).map(o=>{i.Number=o.number,i.Time=o.time;const a=ov(t.media||"",i),l=t.timescale||1,u=t.presentationTimeOffset||0,d=t.periodStart+(o.time-u)/l;return{uri:a,timeline:o.timeline,duration:o.duration,resolvedUri:Zd(t.baseUrl||"",a),map:r,number:o.number,presentationTime:d}})},xx=(t,e)=>{const{baseUrl:i,initialization:s={}}=t,r=al({baseUrl:i,source:s.sourceURL,range:s.range}),n=al({baseUrl:i,source:e.media,range:e.mediaRange});return n.map=r,n},Px=(t,e)=>{const{duration:i,segmentUrls:s=[],periodStart:r}=t;if(!i&&!e||i&&e)throw new Error(mo.SEGMENT_TIME_UNSPECIFIED);const n=s.map(l=>xx(t,l));let o;return i&&(o=Gg(t)),e&&(o=wS(t,e)),o.map((l,u)=>{if(n[u]){const d=n[u],c=t.timescale||1,C=t.presentationTimeOffset||0;return d.timeline=l.timeline,d.duration=l.duration,d.number=l.number,d.presentationTime=r+(l.time-C)/c,d}}).filter(l=>l)},Ix=({attributes:t,segmentInfo:e})=>{let i,s;e.template?(s=Ax,i=mt(t,e.template)):e.base?(s=SS,i=mt(t,e.base)):e.list&&(s=Px,i=mt(t,e.list));const r={attributes:t};if(!s)return r;const n=s(i,e.segmentTimeline);if(i.duration){const{duration:o,timescale:a=1}=i;i.duration=o/a}else n.length?i.duration=n.reduce((o,a)=>Math.max(o,Math.ceil(a.duration)),0):i.duration=0;return r.attributes=i,r.segments=n,e.base&&i.indexRange&&(r.sidx=n[0],r.segments=[]),r},Lx=t=>t.map(Ix),Xe=(t,e)=>yS(t.childNodes).filter(({tagName:i})=>i===e),Wl=t=>t.textContent.trim(),Fx=t=>parseFloat(t.split("/").reduce((e,i)=>e/i)),Bn=t=>{const a=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(t);if(!a)return 0;const[l,u,d,c,C,E]=a.slice(1);return parseFloat(l||0)*31536e3+parseFloat(u||0)*2592e3+parseFloat(d||0)*86400+parseFloat(c||0)*3600+parseFloat(C||0)*60+parseFloat(E||0)},Mx=t=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t)&&(t+="Z"),Date.parse(t)),av={mediaPresentationDuration(t){return Bn(t)},availabilityStartTime(t){return Mx(t)/1e3},minimumUpdatePeriod(t){return Bn(t)},suggestedPresentationDelay(t){return Bn(t)},type(t){return t},timeShiftBufferDepth(t){return Bn(t)},start(t){return Bn(t)},width(t){return parseInt(t,10)},height(t){return parseInt(t,10)},bandwidth(t){return parseInt(t,10)},frameRate(t){return Fx(t)},startNumber(t){return parseInt(t,10)},timescale(t){return parseInt(t,10)},presentationTimeOffset(t){return parseInt(t,10)},duration(t){const e=parseInt(t,10);return isNaN(e)?Bn(t):e},d(t){return parseInt(t,10)},t(t){return parseInt(t,10)},r(t){return parseInt(t,10)},presentationTime(t){return parseInt(t,10)},DEFAULT(t){return t}},dt=t=>t&&t.attributes?yS(t.attributes).reduce((e,i)=>{const s=av[i.name]||av.DEFAULT;return e[i.name]=s(i.value),e},{}):{},Ox={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},rh=(t,e)=>e.length?fo(t.map(function(i){return e.map(function(s){const r=Wl(s),n=Zd(i.baseUrl,r),o=mt(dt(s),{baseUrl:n});return n!==r&&!o.serviceLocation&&i.serviceLocation&&(o.serviceLocation=i.serviceLocation),o})})):t,Hg=t=>{const e=Xe(t,"SegmentTemplate")[0],i=Xe(t,"SegmentList")[0],s=i&&Xe(i,"SegmentURL").map(c=>mt({tag:"SegmentURL"},dt(c))),r=Xe(t,"SegmentBase")[0],n=i||e,o=n&&Xe(n,"SegmentTimeline")[0],a=i||r||e,l=a&&Xe(a,"Initialization")[0],u=e&&dt(e);u&&l?u.initialization=l&&dt(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});const d={template:u,segmentTimeline:o&&Xe(o,"S").map(c=>dt(c)),list:i&&mt(dt(i),{segmentUrls:s,initialization:dt(l)}),base:r&&mt(dt(r),{initialization:dt(l)})};return Object.keys(d).forEach(c=>{d[c]||delete d[c]}),d},Nx=(t,e,i)=>s=>{const r=Xe(s,"BaseURL"),n=rh(e,r),o=mt(t,dt(s)),a=Hg(s);return n.map(l=>({segmentInfo:mt(i,a),attributes:mt(o,l)}))},kx=t=>t.reduce((e,i)=>{const s=dt(i);s.schemeIdUri&&(s.schemeIdUri=s.schemeIdUri.toLowerCase());const r=Ox[s.schemeIdUri];if(r){e[r]={attributes:s};const n=Xe(i,"cenc:pssh")[0];if(n){const o=Wl(n);e[r].pssh=o&&DA(o)}}return e},{}),Gx=t=>{if(t.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof t.value!="string"?[]:t.value.split(";")).map(i=>{let s,r;return r=i,/^CC\d=/.test(i)?[s,r]=i.split("="):/^CC\d$/.test(i)&&(s=i),{channel:s,language:r}});if(t.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof t.value!="string"?[]:t.value.split(";")).map(i=>{const s={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[r,n=""]=i.split("=");s.channel=r,s.language=i,n.split(",").forEach(o=>{const[a,l]=o.split(":");a==="lang"?s.language=l:a==="er"?s.easyReader=Number(l):a==="war"?s.aspectRatio=Number(l):a==="3D"&&(s["3D"]=Number(l))})}else s.language=i;return s.channel&&(s.channel="SERVICE"+s.channel),s})},Vx=t=>fo(Xe(t.node,"EventStream").map(e=>{const i=dt(e),s=i.schemeIdUri;return Xe(e,"Event").map(r=>{const n=dt(r),o=n.presentationTime||0,a=i.timescale||1,l=n.duration||0,u=o/a+t.attributes.start;return{schemeIdUri:s,value:i.value,id:n.id,start:u,end:u+l/a,messageData:Wl(r)||n.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})})),Bx=(t,e,i)=>s=>{const r=dt(s),n=rh(e,Xe(s,"BaseURL")),o=Xe(s,"Role")[0],a={role:dt(o)};let l=mt(t,r,a);const u=Xe(s,"Accessibility")[0],d=Gx(dt(u));d&&(l=mt(l,{captionServices:d}));const c=Xe(s,"Label")[0];if(c&&c.childNodes.length){const b=c.childNodes[0].nodeValue.trim();l=mt(l,{label:b})}const C=kx(Xe(s,"ContentProtection"));Object.keys(C).length&&(l=mt(l,{contentProtection:C}));const E=Hg(s),y=Xe(s,"Representation"),_=mt(i,E);return fo(y.map(Nx(l,n,_)))},Hx=(t,e)=>(i,s)=>{const r=rh(e,Xe(i.node,"BaseURL")),n=mt(t,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(n.periodDuration=i.attributes.duration);const o=Xe(i.node,"AdaptationSet"),a=Hg(i.node);return fo(o.map(Bx(n,r,a)))},Ux=(t,e)=>{if(t.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!t.length)return null;const i=mt({serverURL:Wl(t[0])},dt(t[0]));return i.queryBeforeStart=i.queryBeforeStart==="true",i},Wx=({attributes:t,priorPeriodAttributes:e,mpdType:i})=>typeof t.start=="number"?t.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&i==="static"?0:null,zx=(t,e={})=>{const{manifestUri:i="",NOW:s=Date.now(),clientOffset:r=0,eventHandler:n=function(){}}=e,o=Xe(t,"Period");if(!o.length)throw new Error(mo.INVALID_NUMBER_OF_PERIOD);const a=Xe(t,"Location"),l=dt(t),u=rh([{baseUrl:i}],Xe(t,"BaseURL")),d=Xe(t,"ContentSteering");l.type=l.type||"static",l.sourceDuration=l.mediaPresentationDuration||0,l.NOW=s,l.clientOffset=r,a.length&&(l.locations=a.map(Wl));const c=[];return o.forEach((C,E)=>{const y=dt(C),_=c[E-1];y.start=Wx({attributes:y,priorPeriodAttributes:_?_.attributes:null,mpdType:l.type}),c.push({node:C,attributes:y})}),{locations:l.locations,contentSteeringInfo:Ux(d,n),representationInfo:fo(c.map(Hx(l,u))),eventStream:fo(c.map(Vx))}},TS=t=>{if(t==="")throw new Error(mo.DASH_EMPTY_MANIFEST);const e=new ex;let i,s;try{i=e.parseFromString(t,"application/xml"),s=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch{}if(!s||s&&s.getElementsByTagName("parsererror").length>0)throw new Error(mo.DASH_INVALID_XML);return s},$x=t=>{const e=Xe(t,"UTCTiming")[0];if(!e)return null;const i=dt(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(mo.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},jx=(t,e={})=>{const i=zx(TS(t),e),s=Lx(i.representationInfo);return Tx({dashPlaylists:s,locations:i.locations,contentSteering:i.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:i.eventStream})},qx=t=>$x(TS(t));var bS=Math.pow(2,32),Kx=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i;return e.getBigUint64?(i=e.getBigUint64(0),i<Number.MAX_SAFE_INTEGER?Number(i):i):e.getUint32(0)*bS+e.getUint32(4)},Yx={getUint64:Kx,MAX_UINT32:bS},lv=Yx.getUint64,Xx=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},s=12;i.version===0?(i.earliestPresentationTime=e.getUint32(s),i.firstOffset=e.getUint32(s+4),s+=8):(i.earliestPresentationTime=lv(t.subarray(s)),i.firstOffset=lv(t.subarray(s+8)),s+=16),s+=2;var r=e.getUint16(s);for(s+=2;r>0;s+=12,r--)i.references.push({referenceType:(t[s]&128)>>>7,referencedSize:e.getUint32(s)&2147483647,subsegmentDuration:e.getUint32(s+4),startsWithSap:!!(t[s+8]&128),sapType:(t[s+8]&112)>>>4,sapDeltaTime:e.getUint32(s+8)&268435455});return i},Qx=Xx;const Jx=Cr(Qx);var Zx=se([73,68,51]),eP=function(e,i){i===void 0&&(i=0),e=se(e);var s=e[i+5],r=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9],n=(s&16)>>4;return n?r+20:r+10},Ma=function t(e,i){return i===void 0&&(i=0),e=se(e),e.length-i<10||!Ke(e,Zx,{offset:i})?i:(i+=eP(e,i),t(e,i))},uv=function(e){return typeof e=="string"?Uy(e):e},tP=function(e){return Array.isArray(e)?e.map(function(i){return uv(i)}):[uv(e)]},iP=function t(e,i,s){s===void 0&&(s=!1),i=tP(i),e=se(e);var r=[];if(!i.length)return r;for(var n=0;n<e.length;){var o=(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3])>>>0,a=e.subarray(n+4,n+8);if(o===0)break;var l=n+o;if(l>e.length){if(s)break;l=e.length}var u=e.subarray(n+8,l);Ke(a,i[0])&&(i.length===1?r.push(u):r.push.apply(r,t(u,i.slice(1),s))),n=l}return r},Vu={EBML:se([26,69,223,163]),DocType:se([66,130]),Segment:se([24,83,128,103]),SegmentInfo:se([21,73,169,102]),Tracks:se([22,84,174,107]),Track:se([174]),TrackNumber:se([215]),DefaultDuration:se([35,227,131]),TrackEntry:se([174]),TrackType:se([131]),FlagDefault:se([136]),CodecID:se([134]),CodecPrivate:se([99,162]),VideoTrack:se([224]),AudioTrack:se([225]),Cluster:se([31,67,182,117]),Timestamp:se([231]),TimestampScale:se([42,215,177]),BlockGroup:se([160]),BlockDuration:se([155]),Block:se([161]),SimpleBlock:se([163])},Sp=[128,64,32,16,8,4,2,1],sP=function(e){for(var i=1,s=0;s<Sp.length&&!(e&Sp[s]);s++)i++;return i},cd=function(e,i,s,r){s===void 0&&(s=!0),r===void 0&&(r=!1);var n=sP(e[i]),o=e.subarray(i,i+n);return s&&(o=Array.prototype.slice.call(e,i,i+n),o[0]^=Sp[n-1]),{length:n,value:EA(o,{signed:r}),bytes:o}},dv=function t(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(i){return t(i)}):typeof e=="number"?wA(e):e},rP=function(e){return Array.isArray(e)?e.map(function(i){return dv(i)}):[dv(e)]},nP=function t(e,i,s){if(s>=i.length)return i.length;var r=cd(i,s,!1);if(Ke(e.bytes,r.bytes))return s;var n=cd(i,s+r.length);return t(e,i,s+n.length+n.value+r.length)},hv=function t(e,i){i=rP(i),e=se(e);var s=[];if(!i.length)return s;for(var r=0;r<e.length;){var n=cd(e,r,!1),o=cd(e,r+n.length),a=r+n.length+o.length;o.value===127&&(o.value=nP(n,e,a),o.value!==e.length&&(o.value-=a));var l=a+o.value>e.length?e.length:a+o.value,u=e.subarray(a,l);Ke(i[0],n.bytes)&&(i.length===1?s.push(u):s=s.concat(t(u,i.slice(1))));var d=n.length+o.length+u.length;r+=d}return s},oP=se([0,0,0,1]),aP=se([0,0,1]),lP=se([0,0,3]),uP=function(e){for(var i=[],s=1;s<e.length-2;)Ke(e.subarray(s,s+3),lP)&&(i.push(s+2),s++),s++;if(i.length===0)return e;var r=e.length-i.length,n=new Uint8Array(r),o=0;for(s=0;s<r;o++,s++)o===i[0]&&(o++,i.shift()),n[s]=e[o];return n},_S=function(e,i,s,r){e=se(e),s=[].concat(s);for(var n=0,o,a=0;n<e.length&&(a<r||o);){var l=void 0;if(Ke(e.subarray(n),oP)?l=4:Ke(e.subarray(n),aP)&&(l=3),!l){n++;continue}if(a++,o)return uP(e.subarray(o,n));var u=void 0;i==="h264"?u=e[n+l]&31:i==="h265"&&(u=e[n+l]>>1&63),s.indexOf(u)!==-1&&(o=n+l),n+=l+(i==="h264"?1:2)}return e.subarray(0,0)},dP=function(e,i,s){return _S(e,"h264",i,s)},hP=function(e,i,s){return _S(e,"h265",i,s)},It={webm:se([119,101,98,109]),matroska:se([109,97,116,114,111,115,107,97]),flac:se([102,76,97,67]),ogg:se([79,103,103,83]),ac3:se([11,119]),riff:se([82,73,70,70]),avi:se([65,86,73]),wav:se([87,65,86,69]),"3gp":se([102,116,121,112,51,103]),mp4:se([102,116,121,112]),fmp4:se([115,116,121,112]),mov:se([102,116,121,112,113,116]),moov:se([109,111,111,118]),moof:se([109,111,111,102])},Co={aac:function(e){var i=Ma(e);return Ke(e,[255,16],{offset:i,mask:[255,22]})},mp3:function(e){var i=Ma(e);return Ke(e,[255,2],{offset:i,mask:[255,6]})},webm:function(e){var i=hv(e,[Vu.EBML,Vu.DocType])[0];return Ke(i,It.webm)},mkv:function(e){var i=hv(e,[Vu.EBML,Vu.DocType])[0];return Ke(i,It.matroska)},mp4:function(e){if(Co["3gp"](e)||Co.mov(e))return!1;if(Ke(e,It.mp4,{offset:4})||Ke(e,It.fmp4,{offset:4})||Ke(e,It.moof,{offset:4})||Ke(e,It.moov,{offset:4}))return!0},mov:function(e){return Ke(e,It.mov,{offset:4})},"3gp":function(e){return Ke(e,It["3gp"],{offset:4})},ac3:function(e){var i=Ma(e);return Ke(e,It.ac3,{offset:i})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var i=0;i+188<e.length&&i<188;){if(e[i]===71&&e[i+188]===71)return!0;i+=1}return!1},flac:function(e){var i=Ma(e);return Ke(e,It.flac,{offset:i})},ogg:function(e){return Ke(e,It.ogg)},avi:function(e){return Ke(e,It.riff)&&Ke(e,It.avi,{offset:8})},wav:function(e){return Ke(e,It.riff)&&Ke(e,It.wav,{offset:8})},h264:function(e){return dP(e,7,3).length},h265:function(e){return hP(e,[32,33],3).length}},Ep=Object.keys(Co).filter(function(t){return t!=="ts"&&t!=="h264"&&t!=="h265"}).concat(["ts","h264","h265"]);Ep.forEach(function(t){var e=Co[t];Co[t]=function(i){return e(se(i))}});var cP=Co,Ug=function(e){e=se(e);for(var i=0;i<Ep.length;i++){var s=Ep[i];if(cP[s](e))return s}return""},pP=function(e){return iP(e,["moof"]).length>0},Wg=9e4,zg,$g,nh,jg,DS,RS,AS;zg=function(t){return t*Wg};$g=function(t,e){return t*e};nh=function(t){return t/Wg};jg=function(t,e){return t/e};DS=function(t,e){return zg(jg(t,e))};RS=function(t,e){return $g(nh(t),e)};AS=function(t,e,i){return nh(i?t:t-e)};var Hr={ONE_SECOND_IN_TS:Wg,secondsToVideoTs:zg,secondsToAudioTs:$g,videoTsToSeconds:nh,audioTsToSeconds:jg,audioTsToVideoTs:DS,videoTsToAudioTs:RS,metadataTsToSeconds:AS};/**
 * @license
 * Video.js 8.12.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var wp="8.12.0";const Os={},lr=function(t,e){return Os[t]=Os[t]||[],e&&(Os[t]=Os[t].concat(e)),Os[t]},gP=function(t,e){lr(t,e)},xS=function(t,e){const i=lr(t).indexOf(e);return i<=-1?!1:(Os[t]=Os[t].slice(),Os[t].splice(i,1),!0)},fP=function(t,e){lr(t,[].concat(e).map(i=>{const s=(...r)=>(xS(t,s),i(...r));return s}))},pd={prefixed:!0},Qu=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],cv=Qu[0];let Oa;for(let t=0;t<Qu.length;t++)if(Qu[t][1]in K){Oa=Qu[t];break}if(Oa){for(let t=0;t<Oa.length;t++)pd[cv[t]]=Oa[t];pd.prefixed=Oa[0]!==cv[0]}let zt=[];const mP=(t,e,i)=>(s,r,n)=>{const o=e.levels[r],a=new RegExp(`^(${o})$`);let l=t;if(s!=="log"&&n.unshift(s.toUpperCase()+":"),i&&(l=`%c${t}`,n.unshift(i)),n.unshift(l+":"),zt){zt.push([].concat(n));const d=zt.length-1e3;zt.splice(0,d>0?d:0)}if(!F.console)return;let u=F.console[s];!u&&s==="debug"&&(u=F.console.info||F.console.log),!(!u||!o||!a.test(s))&&u[Array.isArray(n)?"apply":"call"](F.console,n)};function Tp(t,e=":",i=""){let s="info",r;const n=function(...o){r("log",s,o)};return r=mP(t,n,i),n.createLogger=(o,a,l)=>{const u=a!==void 0?a:e,d=l!==void 0?l:i,c=`${t} ${u} ${o}`;return Tp(c,u,d)},n.createNewLogger=(o,a,l)=>Tp(o,a,l),n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:s},n.level=o=>{if(typeof o=="string"){if(!n.levels.hasOwnProperty(o))throw new Error(`"${o}" in not a valid log level`);s=o}return s},n.history=()=>zt?[].concat(zt):[],n.history.filter=o=>(zt||[]).filter(a=>new RegExp(`.*${o}.*`).test(a[0])),n.history.clear=()=>{zt&&(zt.length=0)},n.history.disable=()=>{zt!==null&&(zt.length=0,zt=null)},n.history.enable=()=>{zt===null&&(zt=[])},n.error=(...o)=>r("error",s,o),n.warn=(...o)=>r("warn",s,o),n.debug=(...o)=>r("debug",s,o),n}const ye=Tp("VIDEOJS"),PS=ye.createLogger,CP=Object.prototype.toString,IS=function(t){return Es(t)?Object.keys(t):[]};function to(t,e){IS(t).forEach(i=>e(t[i],i))}function LS(t,e,i=0){return IS(t).reduce((s,r)=>e(s,t[r],r),i)}function Es(t){return!!t&&typeof t=="object"}function vo(t){return Es(t)&&CP.call(t)==="[object Object]"&&t.constructor===Object}function Ve(...t){const e={};return t.forEach(i=>{i&&to(i,(s,r)=>{if(!vo(s)){e[r]=s;return}vo(e[r])||(e[r]={}),e[r]=Ve(e[r],s)})}),e}function FS(t={}){const e=[];for(const i in t)if(t.hasOwnProperty(i)){const s=t[i];e.push(s)}return e}function oh(t,e,i,s=!0){const r=o=>Object.defineProperty(t,e,{value:o,enumerable:!0,writable:!0}),n={configurable:!0,enumerable:!0,get(){const o=i();return r(o),o}};return s&&(n.set=r),Object.defineProperty(t,e,n)}var vP=Object.freeze({__proto__:null,each:to,reduce:LS,isObject:Es,isPlain:vo,merge:Ve,values:FS,defineLazyProperty:oh});let qg=!1,MS=null,ws=!1,OS,NS=!1,io=!1,so=!1,Ts=!1,Kg=null,ah=null,kS=null,gd=!1,lh=!1,fd=!1,uh=!1,bp=!1,_p=!1,Dp=!1;const ll=!!(Bo()&&("ontouchstart"in F||F.navigator.maxTouchPoints||F.DocumentTouch&&F.document instanceof F.DocumentTouch)),sr=F.navigator&&F.navigator.userAgentData;sr&&sr.platform&&sr.brands&&(ws=sr.platform==="Android",io=!!sr.brands.find(t=>t.brand==="Microsoft Edge"),so=!!sr.brands.find(t=>t.brand==="Chromium"),Ts=!io&&so,Kg=ah=(sr.brands.find(t=>t.brand==="Chromium")||{}).version||null,lh=sr.platform==="Windows");if(!so){const t=F.navigator&&F.navigator.userAgent||"";qg=/iPod/i.test(t),MS=function(){const e=t.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),ws=/Android/i.test(t),OS=function(){const e=t.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const i=e[1]&&parseFloat(e[1]),s=e[2]&&parseFloat(e[2]);return i&&s?parseFloat(e[1]+"."+e[2]):i||null}(),NS=/Firefox/i.test(t),io=/Edg/i.test(t),so=/Chrome/i.test(t)||/CriOS/i.test(t),Ts=!io&&so,Kg=ah=function(){const e=t.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),kS=function(){const e=/MSIE\s(\d+)\.\d/.exec(t);let i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(t)&&/rv:11.0/.test(t)&&(i=11),i}(),bp=/Tizen/i.test(t),_p=/Web0S/i.test(t),Dp=bp||_p,gd=/Safari/i.test(t)&&!Ts&&!ws&&!io&&!Dp,lh=/Windows/i.test(t),fd=/iPad/i.test(t)||gd&&ll&&!/iPhone/i.test(t),uh=/iPhone/i.test(t)&&!fd}const Nt=uh||fd||qg,dh=(gd||Nt)&&!Ts;var GS=Object.freeze({__proto__:null,get IS_IPOD(){return qg},get IOS_VERSION(){return MS},get IS_ANDROID(){return ws},get ANDROID_VERSION(){return OS},get IS_FIREFOX(){return NS},get IS_EDGE(){return io},get IS_CHROMIUM(){return so},get IS_CHROME(){return Ts},get CHROMIUM_VERSION(){return Kg},get CHROME_VERSION(){return ah},get IE_VERSION(){return kS},get IS_SAFARI(){return gd},get IS_WINDOWS(){return lh},get IS_IPAD(){return fd},get IS_IPHONE(){return uh},get IS_TIZEN(){return bp},get IS_WEBOS(){return _p},get IS_SMART_TV(){return Dp},TOUCH_ENABLED:ll,IS_IOS:Nt,IS_ANY_SAFARI:dh});function pv(t){return typeof t=="string"&&!!t.trim()}function yP(t){if(t.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function Bo(){return K===F.document}function Ho(t){return Es(t)&&t.nodeType===1}function VS(){try{return F.parent!==F.self}catch{return!0}}function BS(t){return function(e,i){if(!pv(e))return K[t](null);pv(i)&&(i=K.querySelector(i));const s=Ho(i)?i:K;return s[t]&&s[t](e)}}function fe(t="div",e={},i={},s){const r=K.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(n){const o=e[n];n==="textContent"?yr(r,o):(r[n]!==o||n==="tabIndex")&&(r[n]=o)}),Object.getOwnPropertyNames(i).forEach(function(n){r.setAttribute(n,i[n])}),s&&Yg(r,s),r}function yr(t,e){return typeof t.textContent>"u"?t.innerText=e:t.textContent=e,t}function Rp(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function $a(t,e){return yP(e),t.classList.contains(e)}function $r(t,...e){return t.classList.add(...e.reduce((i,s)=>i.concat(s.split(/\s+/)),[])),t}function hh(t,...e){return t?(t.classList.remove(...e.reduce((i,s)=>i.concat(s.split(/\s+/)),[])),t):(ye.warn("removeClass was called with an element that doesn't exist"),null)}function HS(t,e,i){return typeof i=="function"&&(i=i(t,e)),typeof i!="boolean"&&(i=void 0),e.split(/\s+/).forEach(s=>t.classList.toggle(s,i)),t}function US(t,e){Object.getOwnPropertyNames(e).forEach(function(i){const s=e[i];s===null||typeof s>"u"||s===!1?t.removeAttribute(i):t.setAttribute(i,s===!0?"":s)})}function nr(t){const e={},i=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(t&&t.attributes&&t.attributes.length>0){const s=t.attributes;for(let r=s.length-1;r>=0;r--){const n=s[r].name;let o=s[r].value;i.includes(n)&&(o=o!==null),e[n]=o}}return e}function WS(t,e){return t.getAttribute(e)}function yo(t,e,i){t.setAttribute(e,i)}function ch(t,e){t.removeAttribute(e)}function zS(){K.body.focus(),K.onselectstart=function(){return!1}}function $S(){K.onselectstart=function(){return!0}}function So(t){if(t&&t.getBoundingClientRect&&t.parentNode){const e=t.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(s=>{e[s]!==void 0&&(i[s]=e[s])}),i.height||(i.height=parseFloat(Eo(t,"height"))),i.width||(i.width=parseFloat(Eo(t,"width"))),i}}function ul(t){if(!t||t&&!t.offsetParent)return{left:0,top:0,width:0,height:0};const e=t.offsetWidth,i=t.offsetHeight;let s=0,r=0;for(;t.offsetParent&&t!==K[pd.fullscreenElement];)s+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;return{left:s,top:r,width:e,height:i}}function ph(t,e){const i={x:0,y:0};if(Nt){let d=t;for(;d&&d.nodeName.toLowerCase()!=="html";){const c=Eo(d,"transform");if(/^matrix/.test(c)){const C=c.slice(7,-1).split(/,\s/).map(Number);i.x+=C[4],i.y+=C[5]}else if(/^matrix3d/.test(c)){const C=c.slice(9,-1).split(/,\s/).map(Number);i.x+=C[12],i.y+=C[13]}d=d.parentNode}}const s={},r=ul(e.target),n=ul(t),o=n.width,a=n.height;let l=e.offsetY-(n.top-r.top),u=e.offsetX-(n.left-r.left);return e.changedTouches&&(u=e.changedTouches[0].pageX-n.left,l=e.changedTouches[0].pageY+n.top,Nt&&(u-=i.x,l-=i.y)),s.y=1-Math.max(0,Math.min(1,l/a)),s.x=Math.max(0,Math.min(1,u/o)),s}function jS(t){return Es(t)&&t.nodeType===3}function gh(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function qS(t){return typeof t=="function"&&(t=t()),(Array.isArray(t)?t:[t]).map(e=>{if(typeof e=="function"&&(e=e()),Ho(e)||jS(e))return e;if(typeof e=="string"&&/\S/.test(e))return K.createTextNode(e)}).filter(e=>e)}function Yg(t,e){return qS(e).forEach(i=>t.appendChild(i)),t}function KS(t,e){return Yg(gh(t),e)}function dl(t){return t.button===void 0&&t.buttons===void 0||t.button===0&&t.buttons===void 0||t.type==="mouseup"&&t.button===0&&t.buttons===0?!0:!(t.button!==0||t.buttons!==1)}const ur=BS("querySelector"),YS=BS("querySelectorAll");function Eo(t,e){if(!t||!e)return"";if(typeof F.getComputedStyle=="function"){let i;try{i=F.getComputedStyle(t)}catch{return""}return i?i.getPropertyValue(e)||i[e]:""}return""}function XS(t){[...K.styleSheets].forEach(e=>{try{const i=[...e.cssRules].map(r=>r.cssText).join(""),s=K.createElement("style");s.textContent=i,t.document.head.appendChild(s)}catch{const s=K.createElement("link");s.rel="stylesheet",s.type=e.type,s.media=e.media.mediaText,s.href=e.href,t.document.head.appendChild(s)}})}var QS=Object.freeze({__proto__:null,isReal:Bo,isEl:Ho,isInFrame:VS,createEl:fe,textContent:yr,prependTo:Rp,hasClass:$a,addClass:$r,removeClass:hh,toggleClass:HS,setAttributes:US,getAttributes:nr,getAttribute:WS,setAttribute:yo,removeAttribute:ch,blockTextSelection:zS,unblockTextSelection:$S,getBoundingClientRect:So,findPosition:ul,getPointerPosition:ph,isTextNode:jS,emptyEl:gh,normalizeContent:qS,appendContent:Yg,insertContent:KS,isSingleLeftClick:dl,$:ur,$$:YS,computedStyle:Eo,copyStyleSheetsToWindow:XS});let JS=!1,Ap;const SP=function(){if(Ap.options.autoSetup===!1)return;const t=Array.prototype.slice.call(K.getElementsByTagName("video")),e=Array.prototype.slice.call(K.getElementsByTagName("audio")),i=Array.prototype.slice.call(K.getElementsByTagName("video-js")),s=t.concat(e,i);if(s&&s.length>0)for(let r=0,n=s.length;r<n;r++){const o=s[r];if(o&&o.getAttribute)o.player===void 0&&o.getAttribute("data-setup")!==null&&Ap(o);else{xp(1);break}}else JS||xp(1)};function xp(t,e){Bo()&&(e&&(Ap=e),F.setTimeout(SP,t))}function Pp(){JS=!0,F.removeEventListener("load",Pp)}Bo()&&(K.readyState==="complete"?Pp():F.addEventListener("load",Pp));const ZS=function(t){const e=K.createElement("style");return e.className=t,e},eE=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e};var Mt=new WeakMap;const EP=3;let wP=EP;function Xi(){return wP++}function gv(t,e){if(!Mt.has(t))return;const i=Mt.get(t);i.handlers[e].length===0&&(delete i.handlers[e],t.removeEventListener?t.removeEventListener(e,i.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Mt.delete(t)}function Xg(t,e,i,s){i.forEach(function(r){t(e,r,s)})}function fh(t){if(t.fixed_)return t;function e(){return!0}function i(){return!1}if(!t||!t.isPropagationStopped||!t.isImmediatePropagationStopped){const s=t||F.event;t={};for(const r in s)r!=="layerX"&&r!=="layerY"&&r!=="keyLocation"&&r!=="webkitMovementX"&&r!=="webkitMovementY"&&r!=="path"&&(r==="returnValue"&&s.preventDefault||(t[r]=s[r]));if(t.target||(t.target=t.srcElement||K),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){s.preventDefault&&s.preventDefault(),t.returnValue=!1,s.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){s.stopPropagation&&s.stopPropagation(),t.cancelBubble=!0,s.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=i,t.stopImmediatePropagation=function(){s.stopImmediatePropagation&&s.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=i,t.clientX!==null&&t.clientX!==void 0){const r=K.documentElement,n=K.body;t.pageX=t.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),t.pageY=t.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)}t.which=t.charCode||t.keyCode,t.button!==null&&t.button!==void 0&&(t.button=t.button&1?0:t.button&4?1:t.button&2?2:0)}return t.fixed_=!0,t}let Bu;const TP=function(){if(typeof Bu!="boolean"){Bu=!1;try{const t=Object.defineProperty({},"passive",{get(){Bu=!0}});F.addEventListener("test",null,t),F.removeEventListener("test",null,t)}catch{}}return Bu},bP=["touchstart","touchmove"];function mi(t,e,i){if(Array.isArray(e))return Xg(mi,t,e,i);Mt.has(t)||Mt.set(t,{});const s=Mt.get(t);if(s.handlers||(s.handlers={}),s.handlers[e]||(s.handlers[e]=[]),i.guid||(i.guid=Xi()),s.handlers[e].push(i),s.dispatcher||(s.disabled=!1,s.dispatcher=function(r,n){if(s.disabled)return;r=fh(r);const o=s.handlers[r.type];if(o){const a=o.slice(0);for(let l=0,u=a.length;l<u&&!r.isImmediatePropagationStopped();l++)try{a[l].call(t,r,n)}catch(d){ye.error(d)}}}),s.handlers[e].length===1)if(t.addEventListener){let r=!1;TP()&&bP.indexOf(e)>-1&&(r={passive:!0}),t.addEventListener(e,s.dispatcher,r)}else t.attachEvent&&t.attachEvent("on"+e,s.dispatcher)}function _t(t,e,i){if(!Mt.has(t))return;const s=Mt.get(t);if(!s.handlers)return;if(Array.isArray(e))return Xg(_t,t,e,i);const r=function(o,a){s.handlers[a]=[],gv(o,a)};if(e===void 0){for(const o in s.handlers)Object.prototype.hasOwnProperty.call(s.handlers||{},o)&&r(t,o);return}const n=s.handlers[e];if(n){if(!i){r(t,e);return}if(i.guid)for(let o=0;o<n.length;o++)n[o].guid===i.guid&&n.splice(o--,1);gv(t,e)}}function Uo(t,e,i){const s=Mt.has(t)?Mt.get(t):{},r=t.parentNode||t.ownerDocument;if(typeof e=="string"?e={type:e,target:t}:e.target||(e.target=t),e=fh(e),s.dispatcher&&s.dispatcher.call(t,e,i),r&&!e.isPropagationStopped()&&e.bubbles===!0)Uo.call(null,r,e,i);else if(!r&&!e.defaultPrevented&&e.target&&e.target[e.type]){Mt.has(e.target)||Mt.set(e.target,{});const n=Mt.get(e.target);e.target[e.type]&&(n.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),n.disabled=!1)}return!e.defaultPrevented}function mh(t,e,i){if(Array.isArray(e))return Xg(mh,t,e,i);const s=function(){_t(t,e,s),i.apply(this,arguments)};s.guid=i.guid=i.guid||Xi(),mi(t,e,s)}function Qg(t,e,i){const s=function(){_t(t,e,s),i.apply(this,arguments)};s.guid=i.guid=i.guid||Xi(),mi(t,e,s)}var _P=Object.freeze({__proto__:null,fixEvent:fh,on:mi,off:_t,trigger:Uo,one:mh,any:Qg});const Ii=30,Be=function(t,e,i){e.guid||(e.guid=Xi());const s=e.bind(t);return s.guid=i?i+"_"+e.guid:e.guid,s},bs=function(t,e){let i=F.performance.now();return function(...r){const n=F.performance.now();n-i>=e&&(t(...r),i=n)}},tE=function(t,e,i,s=F){let r;const n=()=>{s.clearTimeout(r),r=null},o=function(){const a=this,l=arguments;let u=function(){r=null,u=null,i||t.apply(a,l)};!r&&i&&t.apply(a,l),s.clearTimeout(r),r=s.setTimeout(u,e)};return o.cancel=n,o};var DP=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Ii,bind_:Be,throttle:bs,debounce:tE});let _a;class Li{on(e,i){const s=this.addEventListener;this.addEventListener=()=>{},mi(this,e,i),this.addEventListener=s}off(e,i){_t(this,e,i)}one(e,i){const s=this.addEventListener;this.addEventListener=()=>{},mh(this,e,i),this.addEventListener=s}any(e,i){const s=this.addEventListener;this.addEventListener=()=>{},Qg(this,e,i),this.addEventListener=s}trigger(e){const i=e.type||e;typeof e=="string"&&(e={type:i}),e=fh(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),Uo(this,e)}queueTrigger(e){_a||(_a=new Map);const i=e.type||e;let s=_a.get(this);s||(s=new Map,_a.set(this,s));const r=s.get(i);s.delete(i),F.clearTimeout(r);const n=F.setTimeout(()=>{s.delete(i),s.size===0&&(s=null,_a.delete(this)),this.trigger(e)},0);s.set(i,n)}}Li.prototype.allowedEvents_={};Li.prototype.addEventListener=Li.prototype.on;Li.prototype.removeEventListener=Li.prototype.off;Li.prototype.dispatchEvent=Li.prototype.trigger;const Ch=t=>typeof t.name=="function"?t.name():typeof t.name=="string"?t.name:t.name_?t.name_:t.constructor&&t.constructor.name?t.constructor.name:typeof t,Gs=t=>t instanceof Li||!!t.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof t[e]=="function"),RP=(t,e)=>{Gs(t)?e():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(e))},Ip=t=>typeof t=="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length,md=(t,e,i)=>{if(!t||!t.nodeName&&!Gs(t))throw new Error(`Invalid target for ${Ch(e)}#${i}; must be a DOM node or evented object.`)},iE=(t,e,i)=>{if(!Ip(t))throw new Error(`Invalid event type for ${Ch(e)}#${i}; must be a non-empty string or array.`)},sE=(t,e,i)=>{if(typeof t!="function")throw new Error(`Invalid listener for ${Ch(e)}#${i}; must be a function.`)},Mc=(t,e,i)=>{const s=e.length<3||e[0]===t||e[0]===t.eventBusEl_;let r,n,o;return s?(r=t.eventBusEl_,e.length>=3&&e.shift(),[n,o]=e):[r,n,o]=e,md(r,t,i),iE(n,t,i),sE(o,t,i),o=Be(t,o),{isTargetingSelf:s,target:r,type:n,listener:o}},Mr=(t,e,i,s)=>{md(t,t,e),t.nodeName?_P[e](t,i,s):t[e](i,s)},AP={on(...t){const{isTargetingSelf:e,target:i,type:s,listener:r}=Mc(this,t,"on");if(Mr(i,"on",s,r),!e){const n=()=>this.off(i,s,r);n.guid=r.guid;const o=()=>this.off("dispose",n);o.guid=r.guid,Mr(this,"on","dispose",n),Mr(i,"on","dispose",o)}},one(...t){const{isTargetingSelf:e,target:i,type:s,listener:r}=Mc(this,t,"one");if(e)Mr(i,"one",s,r);else{const n=(...o)=>{this.off(i,s,n),r.apply(null,o)};n.guid=r.guid,Mr(i,"one",s,n)}},any(...t){const{isTargetingSelf:e,target:i,type:s,listener:r}=Mc(this,t,"any");if(e)Mr(i,"any",s,r);else{const n=(...o)=>{this.off(i,s,n),r.apply(null,o)};n.guid=r.guid,Mr(i,"any",s,n)}},off(t,e,i){if(!t||Ip(t))_t(this.eventBusEl_,t,e);else{const s=t,r=e;md(s,this,"off"),iE(r,this,"off"),sE(i,this,"off"),i=Be(this,i),this.off("dispose",i),s.nodeName?(_t(s,r,i),_t(s,"dispose",i)):Gs(s)&&(s.off(r,i),s.off("dispose",i))}},trigger(t,e){md(this.eventBusEl_,this,"trigger");const i=t&&typeof t!="string"?t.type:t;if(!Ip(i))throw new Error(`Invalid event type for ${Ch(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return Uo(this.eventBusEl_,t,e)}};function Jg(t,e={}){const{eventBusKey:i}=e;if(i){if(!t[i].nodeName)throw new Error(`The eventBusKey "${i}" does not refer to an element.`);t.eventBusEl_=t[i]}else t.eventBusEl_=fe("span",{className:"vjs-event-bus"});return Object.assign(t,AP),t.eventedCallbacks&&t.eventedCallbacks.forEach(s=>{s()}),t.on("dispose",()=>{t.off(),[t,t.el_,t.eventBusEl_].forEach(function(s){s&&Mt.has(s)&&Mt.delete(s)}),F.setTimeout(()=>{t.eventBusEl_=null},0)}),t}const xP={state:{},setState(t){typeof t=="function"&&(t=t());let e;return to(t,(i,s)=>{this.state[s]!==i&&(e=e||{},e[s]={from:this.state[s],to:i}),this.state[s]=i}),e&&Gs(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function rE(t,e){return Object.assign(t,xP),t.state=Object.assign({},t.state,e),typeof t.handleStateChanged=="function"&&Gs(t)&&t.on("statechanged",t.handleStateChanged),t}const ja=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toLowerCase())},et=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toUpperCase())},nE=function(t,e){return et(t)===et(e)};var PP=Object.freeze({__proto__:null,toLowerCase:ja,toTitleCase:et,titleCaseEquals:nE});class W{constructor(e,i,s){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Ve({},this.options_),i=this.options_=Ve(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){const r=e&&e.id&&e.id()||"no_player";this.id_=`${r}_component_${Xi()}`}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(r=>this.addClass(r)),["on","off","one","any","trigger"].forEach(r=>{this[r]=void 0}),i.evented!==!1&&(Jg(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),rE(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(s),i.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,i){}off(e,i){}one(e,i){}any(e,i){}trigger(e,i){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(e){return e?(this.options_=Ve(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,i,s){return fe(e,i,s)}localize(e,i,s=e){const r=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),o=n&&n[r],a=r&&r.split("-")[0],l=n&&n[a];let u=s;return o&&o[e]?u=o[e]:l&&l[e]&&(u=l[e]),i&&(u=u.replace(/\{(\d+)\}/g,function(d,c){const C=i[c-1];let E=C;return typeof C>"u"&&(E=d),E})),u}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((s,r)=>s.concat(r),[]);let i=this;for(let s=0;s<e.length;s++)if(i=i.getChild(e[s]),!i||!i.getChild)return;return i}setIcon(e,i=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const s="http://www.w3.org/2000/svg",r=fe("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),n=K.createElementNS(s,"svg");n.setAttributeNS(null,"viewBox","0 0 512 512");const o=K.createElementNS(s,"use");return n.appendChild(o),o.setAttributeNS(null,"href",`#vjs-icon-${e}`),r.appendChild(n),this.iconIsSet_?i.replaceChild(r,i.querySelector(".vjs-icon-placeholder")):i.appendChild(r),this.iconIsSet_=!0,r}addChild(e,i={},s=this.children_.length){let r,n;if(typeof e=="string"){n=et(e);const o=i.componentClass||n;i.name=n;const a=W.getComponent(o);if(!a)throw new Error(`Component ${o} does not exist`);if(typeof a!="function")return null;r=new a(this.player_||this,i)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(s,0,r),r.parentComponent_=this,typeof r.id=="function"&&(this.childIndex_[r.id()]=r),n=n||r.name&&et(r.name()),n&&(this.childNameIndex_[n]=r,this.childNameIndex_[ja(n)]=r),typeof r.el=="function"&&r.el()){let o=null;this.children_[s+1]&&(this.children_[s+1].el_?o=this.children_[s+1].el_:Ho(this.children_[s+1])&&(o=this.children_[s+1])),this.contentEl().insertBefore(r.el(),o)}return r}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let i=!1;for(let r=this.children_.length-1;r>=0;r--)if(this.children_[r]===e){i=!0,this.children_.splice(r,1);break}if(!i)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[et(e.name())]=null,this.childNameIndex_[ja(e.name())]=null;const s=e.el();s&&s.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const i=this.options_,s=o=>{const a=o.name;let l=o.opts;if(i[a]!==void 0&&(l=i[a]),l===!1)return;l===!0&&(l={}),l.playerOptions=this.options_.playerOptions;const u=this.addChild(a,l);u&&(this[a]=u)};let r;const n=W.getComponent("Tech");Array.isArray(e)?r=e:r=Object.keys(e),r.concat(Object.keys(this.options_).filter(function(o){return!r.some(function(a){return typeof a=="string"?o===a:o===a.name})})).map(o=>{let a,l;return typeof o=="string"?(a=o,l=e[a]||this.options_[a]||{}):(a=o.name,l=o),{name:a,opts:l}}).filter(o=>{const a=W.getComponent(o.opts.componentClass||et(o.name));return a&&!n.isTech(a)}).forEach(s)}}buildCSSClass(){return""}ready(e,i=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}i?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(e,i){return ur(e,i||this.contentEl())}$$(e,i){return YS(e,i||this.contentEl())}hasClass(e){return $a(this.el_,e)}addClass(...e){$r(this.el_,...e)}removeClass(...e){hh(this.el_,...e)}toggleClass(e,i){HS(this.el_,e,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return WS(this.el_,e)}setAttribute(e,i){yo(this.el_,e,i)}removeAttribute(e){ch(this.el_,e)}width(e,i){return this.dimension("width",e,i)}height(e,i){return this.dimension("height",e,i)}dimensions(e,i){this.width(e,!0),this.height(i)}dimension(e,i,s){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[e]=i:i==="auto"?this.el_.style[e]="":this.el_.style[e]=i+"px",s||this.trigger("componentresize");return}if(!this.el_)return 0;const r=this.el_.style[e],n=r.indexOf("px");return parseInt(n!==-1?r.slice(0,n):this.el_["offset"+et(e)],10)}currentDimension(e){let i=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(i=Eo(this.el_,e),i=parseFloat(i),i===0||isNaN(i)){const s=`offset${et(e)}`;i=this.el_[s]}return i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(he.isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,i=null;const s=10,r=200;let n;this.on("touchstart",function(a){a.touches.length===1&&(i={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY},e=F.performance.now(),n=!0)}),this.on("touchmove",function(a){if(a.touches.length>1)n=!1;else if(i){const l=a.touches[0].pageX-i.pageX,u=a.touches[0].pageY-i.pageY;Math.sqrt(l*l+u*u)>s&&(n=!1)}});const o=function(){n=!1};this.on("touchleave",o),this.on("touchcancel",o),this.on("touchend",function(a){i=null,n===!0&&F.performance.now()-e<r&&(a.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=Be(this.player(),this.player().reportUserActivity);let i;this.on("touchstart",function(){e(),this.clearInterval(i),i=this.setInterval(e,250)});const s=function(r){e(),this.clearInterval(i)};this.on("touchmove",e),this.on("touchend",s),this.on("touchcancel",s)}setTimeout(e,i){var s;return e=Be(this,e),this.clearTimersOnDispose_(),s=F.setTimeout(()=>{this.setTimeoutIds_.has(s)&&this.setTimeoutIds_.delete(s),e()},i),this.setTimeoutIds_.add(s),s}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),F.clearTimeout(e)),e}setInterval(e,i){e=Be(this,e),this.clearTimersOnDispose_();const s=F.setInterval(e,i);return this.setIntervalIds_.add(s),s}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),F.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var i;return e=Be(this,e),i=F.requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),e()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(e,i){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),i=Be(this,i);const s=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,s),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),F.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((s,r)=>this[i](r))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,i){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const s=W.getComponent("Tech"),r=s&&s.isTech(i),n=W===i||W.prototype.isPrototypeOf(i.prototype);if(r||!n){let a;throw r?a="techs must be registered using Tech.registerTech()":a="must be a Component subclass",new Error(`Illegal component, "${e}"; ${a}.`)}e=et(e),W.components_||(W.components_={});const o=W.getComponent("Player");if(e==="Player"&&o&&o.players){const a=o.players,l=Object.keys(a);if(a&&l.length>0&&l.map(u=>a[u]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return W.components_[e]=i,W.components_[ja(e)]=i,i}static getComponent(e){if(!(!e||!W.components_))return W.components_[e]}}W.registerComponent("Component",W);function IP(t,e,i){if(typeof e!="number"||e<0||e>i)throw new Error(`Failed to execute '${t}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${i}).`)}function fv(t,e,i,s){return IP(t,s,i.length-1),i[s][e]}function Oc(t){let e;return t===void 0||t.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:t.length,start:fv.bind(null,"start",0,t),end:fv.bind(null,"end",1,t)},F.Symbol&&F.Symbol.iterator&&(e[F.Symbol.iterator]=()=>(t||[]).values()),e}function Ki(t,e){return Array.isArray(t)?Oc(t):t===void 0||e===void 0?Oc():Oc([[t,e]])}const oE=function(t,e){t=t<0?0:t;let i=Math.floor(t%60),s=Math.floor(t/60%60),r=Math.floor(t/3600);const n=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(r=s=i="-"),r=r>0||o>0?r+":":"",s=((r||n>=10)&&s<10?"0"+s:s)+":",i=i<10?"0"+i:i,r+s+i};let Zg=oE;function aE(t){Zg=t}function lE(){Zg=oE}function tn(t,e=t){return Zg(t,e)}var LP=Object.freeze({__proto__:null,createTimeRanges:Ki,createTimeRange:Ki,setFormatTime:aE,resetFormatTime:lE,formatTime:tn});function uE(t,e){let i=0,s,r;if(!e)return 0;(!t||!t.length)&&(t=Ki(0,0));for(let n=0;n<t.length;n++)s=t.start(n),r=t.end(n),r>e&&(r=e),i+=r-s;return i/e}function Ze(t){if(t instanceof Ze)return t;typeof t=="number"?this.code=t:typeof t=="string"?this.message=t:Es(t)&&(typeof t.code=="number"&&(this.code=t.code),Object.assign(this,t)),this.message||(this.message=Ze.defaultMessages[this.code]||"")}Ze.prototype.code=0;Ze.prototype.message="";Ze.prototype.status=null;Ze.prototype.metadata=null;Ze.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Ze.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};Ze.MEDIA_ERR_CUSTOM=0;Ze.prototype.MEDIA_ERR_CUSTOM=0;Ze.MEDIA_ERR_ABORTED=1;Ze.prototype.MEDIA_ERR_ABORTED=1;Ze.MEDIA_ERR_NETWORK=2;Ze.prototype.MEDIA_ERR_NETWORK=2;Ze.MEDIA_ERR_DECODE=3;Ze.prototype.MEDIA_ERR_DECODE=3;Ze.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Ze.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Ze.MEDIA_ERR_ENCRYPTED=5;Ze.prototype.MEDIA_ERR_ENCRYPTED=5;function qa(t){return t!=null&&typeof t.then=="function"}function ds(t){qa(t)&&t.then(null,e=>{})}const Lp=function(t){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((i,s,r)=>(t[s]&&(i[s]=t[s]),i),{cues:t.cues&&Array.prototype.map.call(t.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})},FP=function(t){const e=t.$$("track"),i=Array.prototype.map.call(e,r=>r.track);return Array.prototype.map.call(e,function(r){const n=Lp(r.track);return r.src&&(n.src=r.src),n}).concat(Array.prototype.filter.call(t.textTracks(),function(r){return i.indexOf(r)===-1}).map(Lp))},MP=function(t,e){return t.forEach(function(i){const s=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(r=>s.addCue(r))}),e.textTracks()};var mv={textTracksToJson:FP,jsonToTextTracks:MP,trackToJson_:Lp};const Nc="vjs-modal-dialog";class Wo extends W{constructor(e,i){super(e,i),this.handleKeyDown_=s=>this.handleKeyDown(s),this.close_=s=>this.close(s),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=fe("div",{className:`${Nc}-content`},{role:"document"}),this.descEl_=fe("p",{className:`${Nc}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),yr(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Nc} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const i=this.closeable_=!!e;let s=this.getChild("closeButton");if(i&&!s){const r=this.contentEl_;this.contentEl_=this.el_,s=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(s,"close",this.close_)}!i&&s&&(this.off(s,"close",this.close_),this.removeChild(s),s.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const i=this.contentEl(),s=i.parentNode,r=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,s.removeChild(i),this.empty(),KS(i,e),this.trigger("modalfill"),r?s.insertBefore(i,r):s.appendChild(i);const n=this.getChild("closeButton");n&&s.appendChild(n.el_)}empty(){this.trigger("beforemodalempty"),gh(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=K.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),he.isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!he.isEventKey(e,"Tab"))return;const i=this.focusableEls_(),s=this.el_.querySelector(":focus");let r;for(let n=0;n<i.length;n++)if(s===i[n]){r=n;break}K.activeElement===this.el_&&(r=0),e.shiftKey&&r===0?(i[i.length-1].focus(),e.preventDefault()):!e.shiftKey&&r===i.length-1&&(i[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,i=>(i instanceof F.HTMLAnchorElement||i instanceof F.HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof F.HTMLInputElement||i instanceof F.HTMLSelectElement||i instanceof F.HTMLTextAreaElement||i instanceof F.HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof F.HTMLIFrameElement||i instanceof F.HTMLObjectElement||i instanceof F.HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}Wo.prototype.options_={pauseOnOpen:!0,temporary:!0};W.registerComponent("ModalDialog",Wo);class wo extends Li{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<e.length;i++)this.addTrack(e[i])}addTrack(e){const i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},Gs(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let i;for(let s=0,r=this.length;s<r;s++)if(this[s]===e){i=this[s],i.off&&i.off(),this.tracks_.splice(s,1);break}i&&this.trigger({track:i,type:"removetrack",target:this})}getTrackById(e){let i=null;for(let s=0,r=this.length;s<r;s++){const n=this[s];if(n.id===e){i=n;break}}return i}}wo.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const t in wo.prototype.allowedEvents_)wo.prototype["on"+t]=null;const kc=function(t,e){for(let i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].enabled=!1)};class OP extends wo{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].enabled){kc(e,e[i]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&kc(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,kc(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const Gc=function(t,e){for(let i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].selected=!1)};class NP extends wo{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].selected){Gc(e,e[i]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(e){e.selected&&Gc(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,Gc(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class dE extends wo{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class kP{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let i=0,s=e.length;i<s;i++)this.addTrackElement_(e[i])}addTrackElement_(e){const i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.trackElements_[i]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let i;for(let s=0,r=this.trackElements_.length;s<r;s++)if(e===this.trackElements_[s].track){i=this.trackElements_[s];break}return i}removeTrackElement_(e){for(let i=0,s=this.trackElements_.length;i<s;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}}}class Cd{constructor(e){Cd.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const i=this.length||0;let s=0;const r=e.length;this.cues_=e,this.length_=e.length;const n=function(o){""+o in this||Object.defineProperty(this,""+o,{get(){return this.cues_[o]}})};if(i<r)for(s=i;s<r;s++)n.call(this,s)}getCueById(e){let i=null;for(let s=0,r=this.length;s<r;s++){const n=this[s];if(n.id===e){i=n;break}}return i}}const GP={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},VP={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},BP={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Cv={disabled:"disabled",hidden:"hidden",showing:"showing"};class ef extends Li{constructor(e={}){super();const i={id:e.id||"vjs_track_"+Xi(),kind:e.kind||"",language:e.language||""};let s=e.label||"";for(const r in i)Object.defineProperty(this,r,{get(){return i[r]},set(){}});Object.defineProperty(this,"label",{get(){return s},set(r){r!==s&&(s=r,this.trigger("labelchange"))}})}}const tf=function(t){const e=["protocol","hostname","port","pathname","search","hash","host"],i=K.createElement("a");i.href=t;const s={};for(let r=0;r<e.length;r++)s[e[r]]=i[e[r]];return s.protocol==="http:"&&(s.host=s.host.replace(/:80$/,"")),s.protocol==="https:"&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=F.location.protocol),s.host||(s.host=F.location.host),s},hE=function(t){if(!t.match(/^https?:\/\//)){const e=K.createElement("a");e.href=t,t=e.href}return t},sf=function(t){if(typeof t=="string"){const i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(t);if(i)return i.pop().toLowerCase()}return""},vh=function(t,e=F.location){const i=tf(t);return(i.protocol===":"?e.protocol:i.protocol)+i.host!==e.protocol+e.host};var HP=Object.freeze({__proto__:null,parseUrl:tf,getAbsoluteURL:hE,getFileExtension:sf,isCrossOrigin:vh});const vv=function(t,e){const i=new F.WebVTT.Parser(F,F.vttjs,F.WebVTT.StringDecoder()),s=[];i.oncue=function(r){e.addCue(r)},i.onparsingerror=function(r){s.push(r)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(t),s.length>0&&(F.console&&F.console.groupCollapsed&&F.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),s.forEach(r=>ye.error(r)),F.console&&F.console.groupEnd&&F.console.groupEnd()),i.flush()},yv=function(t,e){const i={uri:t},s=vh(t);s&&(i.cors=s);const r=e.tech_.crossOrigin()==="use-credentials";r&&(i.withCredentials=r),Fy(i,Be(this,function(n,o,a){if(n)return ye.error(n,o);e.loaded_=!0,typeof F.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],l=>{if(l.type==="vttjserror"){ye.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return vv(a,e)}):vv(a,e)}))};class zl extends ef{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const i=Ve(e,{kind:BP[e.kind]||"subtitles",language:e.language||e.srclang||""});let s=Cv[i.mode]||"disabled";const r=i.default;(i.kind==="metadata"||i.kind==="chapters")&&(s="hidden"),super(i),this.tech_=i.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const n=new Cd(this.cues_),o=new Cd(this.activeCues_);let a=!1;this.timeupdateHandler=Be(this,function(u={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,a&&(this.trigger("cuechange"),a=!1),u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const l=()=>{this.stopTracking()};this.tech_.one("dispose",l),s!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return r},set(){}},mode:{get(){return s},set(u){Cv[u]&&s!==u&&(s=u,!this.preload_&&s!=="disabled"&&this.cues.length===0&&yv(this.src,this),this.stopTracking(),s!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?n:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return o;const u=this.tech_.currentTime(),d=[];for(let c=0,C=this.cues.length;c<C;c++){const E=this.cues[c];E.startTime<=u&&E.endTime>=u&&d.push(E)}if(a=!1,d.length!==this.activeCues_.length)a=!0;else for(let c=0;c<d.length;c++)this.activeCues_.indexOf(d[c])===-1&&(a=!0);return this.activeCues_=d,o.setCues_(this.activeCues_),o},set(){}}}),i.src?(this.src=i.src,this.preload_||(this.loaded_=!0),(this.preload_||i.kind!=="subtitles"&&i.kind!=="captions")&&yv(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let i=e;if(!("getCueAsHTML"in i)){i=new F.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const r in e)r in i||(i[r]=e[r]);i.id=e.id,i.originalCue_=e}const s=this.tech_.textTracks();for(let r=0;r<s.length;r++)s[r]!==this&&s[r].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(e){let i=this.cues_.length;for(;i--;){const s=this.cues_[i];if(s===e||s.originalCue_&&s.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}zl.prototype.allowedEvents_={cuechange:"cuechange"};class cE extends ef{constructor(e={}){const i=Ve(e,{kind:VP[e.kind]||""});super(i);let s=!1;Object.defineProperty(this,"enabled",{get(){return s},set(r){typeof r!="boolean"||r===s||(s=r,this.trigger("enabledchange"))}}),i.enabled&&(this.enabled=i.enabled),this.loaded_=!0}}class pE extends ef{constructor(e={}){const i=Ve(e,{kind:GP[e.kind]||""});super(i);let s=!1;Object.defineProperty(this,"selected",{get(){return s},set(r){typeof r!="boolean"||r===s||(s=r,this.trigger("selectedchange"))}}),i.selected&&(this.selected=i.selected)}}class Ws extends Li{constructor(e={}){super();let i;const s=new zl(e);this.kind=s.kind,this.src=s.src,this.srclang=s.language,this.label=s.label,this.default=s.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return s}}}),i=Ws.NONE,s.addEventListener("loadeddata",()=>{i=Ws.LOADED,this.trigger({type:"load",target:this})})}}Ws.prototype.allowedEvents_={load:"load"};Ws.NONE=0;Ws.LOADING=1;Ws.LOADED=2;Ws.ERROR=3;const Ri={audio:{ListClass:OP,TrackClass:cE,capitalName:"Audio"},video:{ListClass:NP,TrackClass:pE,capitalName:"Video"},text:{ListClass:dE,TrackClass:zl,capitalName:"Text"}};Object.keys(Ri).forEach(function(t){Ri[t].getterName=`${t}Tracks`,Ri[t].privateName=`${t}Tracks_`});const To={remoteText:{ListClass:dE,TrackClass:zl,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:kP,TrackClass:Ws,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Lt=Object.assign({},Ri,To);To.names=Object.keys(To);Ri.names=Object.keys(Ri);Lt.names=[].concat(To.names).concat(Ri.names);function UP(t,e,i,s,r={}){const n=t.textTracks();r.kind=e,i&&(r.label=i),s&&(r.language=s),r.tech=t;const o=new Lt.text.TrackClass(r);return n.addTrack(o),o}class pe extends W{constructor(e={},i=function(){}){e.reportTouchActivity=!1,super(null,e,i),this.onDurationChange_=s=>this.onDurationChange(s),this.trackProgress_=s=>this.trackProgress(s),this.trackCurrentTime_=s=>this.trackCurrentTime(s),this.stopTrackingCurrentTime_=s=>this.stopTrackingCurrentTime(s),this.disposeSourceHandler_=s=>this.disposeSourceHandler(s),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Lt.names.forEach(s=>{const r=Lt[s];e&&e[r.getterName]&&(this[r.privateName]=e[r.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(s=>{e[`native${s}Tracks`]===!1&&(this[`featuresNative${s}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Lt.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Be(this,function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,i===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Ki(0,0)}bufferedPercent(){return uE(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Ri.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(i=>{const s=this[`${i}Tracks`]()||[];let r=s.length;for(;r--;){const n=s[r];i==="text"&&this.removeRemoteTextTrack(n),s.removeTrack(n)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let i=e.length;for(;i--;){const s=e[i];this.removeRemoteTextTrack(s)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Ze(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Ki(0,0):Ki()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Ri.names.forEach(e=>{const i=Ri[e],s=()=>{this.trigger(`${e}trackchange`)},r=this[i.getterName]();r.addEventListener("removetrack",s),r.addEventListener("addtrack",s),this.on("dispose",()=>{r.removeEventListener("removetrack",s),r.removeEventListener("addtrack",s)})})}addWebVttScript_(){if(!F.WebVTT)if(K.body.contains(this.el())){if(!this.options_["vtt.js"]&&vo(NC)&&Object.keys(NC).length>0){this.trigger("vttjsloaded");return}const e=K.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),F.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),i=this.remoteTextTracks(),s=a=>e.addTrack(a.track),r=a=>e.removeTrack(a.track);i.on("addtrack",s),i.on("removetrack",r),this.addWebVttScript_();const n=()=>this.trigger("texttrackchange"),o=()=>{n();for(let a=0;a<e.length;a++){const l=e[a];l.removeEventListener("cuechange",n),l.mode==="showing"&&l.addEventListener("cuechange",n)}};o(),e.addEventListener("change",o),e.addEventListener("addtrack",o),e.addEventListener("removetrack",o),this.on("dispose",function(){i.off("addtrack",s),i.off("removetrack",r),e.removeEventListener("change",o),e.removeEventListener("addtrack",o),e.removeEventListener("removetrack",o);for(let a=0;a<e.length;a++)e[a].removeEventListener("cuechange",n)})}addTextTrack(e,i,s){if(!e)throw new Error("TextTrack kind is required but was not provided");return UP(this,e,i,s)}createRemoteTextTrack(e){const i=Ve(e,{tech:this});return new To.remoteTextEl.TrackClass(i)}addRemoteTextTrack(e={},i){const s=this.createRemoteTextTrack(e);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(s),this.remoteTextTracks().addTrack(s.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(s.track)),s}removeRemoteTextTrack(e){const i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const i=Xi();return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),e())})):this.requestNamedAnimationFrame(i,e),i}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,i){return pe.canPlayType(e.type)}static isTech(e){return e.prototype instanceof pe||e instanceof pe||e===pe}static registerTech(e,i){if(pe.techs_||(pe.techs_={}),!pe.isTech(i))throw new Error(`Tech ${e} must be a Tech`);if(!pe.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!pe.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=et(e),pe.techs_[e]=i,pe.techs_[ja(e)]=i,e!=="Tech"&&pe.defaultTechOrder_.push(e),i}static getTech(e){if(e){if(pe.techs_&&pe.techs_[e])return pe.techs_[e];if(e=et(e),F&&F.videojs&&F.videojs[e])return ye.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),F.videojs[e]}}}Lt.names.forEach(function(t){const e=Lt[t];pe.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});pe.prototype.featuresVolumeControl=!0;pe.prototype.featuresMuteControl=!0;pe.prototype.featuresFullscreenResize=!1;pe.prototype.featuresPlaybackRate=!1;pe.prototype.featuresProgressEvents=!1;pe.prototype.featuresSourceset=!1;pe.prototype.featuresTimeupdateEvents=!1;pe.prototype.featuresNativeTextTracks=!1;pe.prototype.featuresVideoFrameCallback=!1;pe.withSourceHandlers=function(t){t.registerSourceHandler=function(i,s){let r=t.sourceHandlers;r||(r=t.sourceHandlers=[]),s===void 0&&(s=r.length),r.splice(s,0,i)},t.canPlayType=function(i){const s=t.sourceHandlers||[];let r;for(let n=0;n<s.length;n++)if(r=s[n].canPlayType(i),r)return r;return""},t.selectSourceHandler=function(i,s){const r=t.sourceHandlers||[];let n;for(let o=0;o<r.length;o++)if(n=r[o].canHandleSource(i,s),n)return r[o];return null},t.canPlaySource=function(i,s){const r=t.selectSourceHandler(i,s);return r?r.canHandleSource(i,s):""},["seekable","seeking","duration"].forEach(function(i){const s=this[i];typeof s=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):s.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(i){let s=t.selectSourceHandler(i,this.options_);s||(t.nativeSourceHandler?s=t.nativeSourceHandler:ye.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),s!==t.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=s.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};W.registerComponent("Tech",pe);pe.registerTech("Tech",pe);pe.defaultTechOrder_=[];const jr={},Fp={},vd={};function WP(t,e){jr[t]=jr[t]||[],jr[t].push(e)}function zP(t,e,i){t.setTimeout(()=>Or(e,jr[e.type],i,t),1)}function $P(t,e){t.forEach(i=>i.setTech&&i.setTech(e))}function jP(t,e,i){return t.reduceRight(rf(i),e[i]())}function qP(t,e,i,s){return e[i](t.reduce(rf(i),s))}function Sv(t,e,i,s=null){const r="call"+et(i),n=t.reduce(rf(r),s),o=n===vd,a=o?null:e[i](n);return XP(t,i,a,o),a}const KP={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},YP={setCurrentTime:1,setMuted:1,setVolume:1},Ev={play:1,pause:1};function rf(t){return(e,i)=>e===vd?vd:i[t]?i[t](e):e}function XP(t,e,i,s){for(let r=t.length-1;r>=0;r--){const n=t[r];n[e]&&n[e](s,i)}}function QP(t){Fp[t.id()]=null}function JP(t,e){const i=Fp[t.id()];let s=null;if(i==null)return s=e(t),Fp[t.id()]=[[e,s]],s;for(let r=0;r<i.length;r++){const[n,o]=i[r];n===e&&(s=o)}return s===null&&(s=e(t),i.push([e,s])),s}function Or(t={},e=[],i,s,r=[],n=!1){const[o,...a]=e;if(typeof o=="string")Or(t,jr[o],i,s,r,n);else if(o){const l=JP(s,o);if(!l.setSource)return r.push(l),Or(t,a,i,s,r,n);l.setSource(Object.assign({},t),function(u,d){if(u)return Or(t,a,i,s,r,n);r.push(l),Or(d,t.type===d.type?a:jr[d.type],i,s,r,n)})}else a.length?Or(t,a,i,s,r,n):n?i(t,r):Or(t,jr["*"],i,s,r,!0)}const ZP={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},yd=function(t=""){const e=sf(t);return ZP[e.toLowerCase()]||""},eI=(t,e)=>{if(!e)return"";if(t.cache_.source.src===e&&t.cache_.source.type)return t.cache_.source.type;const i=t.cache_.sources.filter(r=>r.src===e);if(i.length)return i[0].type;const s=t.$$("source");for(let r=0;r<s.length;r++){const n=s[r];if(n.type&&n.src&&n.src===e)return n.type}return yd(e)},gE=function(t){if(Array.isArray(t)){let e=[];t.forEach(function(i){i=gE(i),Array.isArray(i)?e=e.concat(i):Es(i)&&e.push(i)}),t=e}else typeof t=="string"&&t.trim()?t=[wv({src:t})]:Es(t)&&typeof t.src=="string"&&t.src&&t.src.trim()?t=[wv(t)]:t=[];return t};function wv(t){if(!t.type){const e=yd(t.src);e&&(t.type=e)}return t}var tI=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-twitter">
      <path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;class iI extends W{constructor(e,i,s){const r=Ve({createEl:!1},i);if(super(e,r,s),!i.playerOptions.sources||i.playerOptions.sources.length===0)for(let n=0,o=i.playerOptions.techOrder;n<o.length;n++){const a=et(o[n]);let l=pe.getTech(a);if(a||(l=W.getComponent(a)),l&&l.isSupported()){e.loadTech_(a);break}}else e.src(i.playerOptions.sources)}}W.registerComponent("MediaLoader",iI);class yh extends W{constructor(e,i){super(e,i),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=s=>this.handleMouseOver(s),this.handleMouseOut_=s=>this.handleMouseOut(s),this.handleClick_=s=>this.handleClick(s),this.handleKeyDown_=s=>this.handleKeyDown(s),this.emitTapEvents(),this.enable()}createEl(e="div",i={},s={}){i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),e==="button"&&ye.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),s=Object.assign({role:"button"},s),this.tabIndex_=i.tabIndex;const r=fe(e,i,s);return this.player_.options_.experimentalSvgIcons||r.appendChild(fe("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(r),r}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=fe("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,i=this.el()){if(e===void 0)return this.controlText_||"Need Text";const s=this.localize(e);this.controlText_=e,yr(this.controlTextEl_,s),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&i.setAttribute("title",s)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){he.isEventKey(e,"Space")||he.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}W.registerComponent("ClickableComponent",yh);class Mp extends yh{constructor(e,i){super(e,i),this.update(),this.update_=s=>this.update(s),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return fe("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(fe("picture",{className:"vjs-poster",tabIndex:-1},{},fe("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?ds(this.player_.play()):this.player_.pause())}}Mp.prototype.crossorigin=Mp.prototype.crossOrigin;W.registerComponent("PosterImage",Mp);const Ei="#222",Tv="#ccc",sI={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Vc(t,e){let i;if(t.length===4)i=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else if(t.length===7)i=t.slice(1);else throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function Da(t,e,i){try{t.style[e]=i}catch{return}}function bv(t){return t?`${t}px`:""}class rI extends W{constructor(e,i,s){super(e,i,s);const r=o=>this.updateDisplay(o),n=o=>{this.updateDisplayOverlay(),this.updateDisplay(o)};e.on("loadstart",o=>this.toggleDisplay(o)),e.on("texttrackchange",r),e.on("loadedmetadata",o=>{this.updateDisplayOverlay(),this.preselectTrack(o)}),e.ready(Be(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",n),e.on("playerresize",n);const o=F.screen.orientation||F,a=F.screen.orientation?"change":"orientationchange";o.addEventListener(a,n),e.on("dispose",()=>o.removeEventListener(a,n));const l=this.options_.playerOptions.tracks||[];for(let u=0;u<l.length;u++)this.player_.addRemoteTextTrack(l[u],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},i=this.player_.textTracks(),s=this.player_.cache_.selectedLanguage;let r,n,o;for(let a=0;a<i.length;a++){const l=i[a];s&&s.enabled&&s.language&&s.language===l.language&&l.kind in e?l.kind===s.kind?o=l:o||(o=l):s&&!s.enabled?(o=null,r=null,n=null):l.default&&(l.kind==="descriptions"&&!r?r=l:l.kind in e&&!n&&(n=l))}o?o.mode="showing":n?n.mode="showing":r&&(r.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof F.WebVTT=="function"&&F.WebVTT.processCues(F,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){const o=[];for(let a=0;a<e.length;++a){const l=e[a];l.mode==="showing"&&o.push(l)}this.updateForTrack(o);return}let s=null,r=null,n=e.length;for(;n--;){const o=e[n];o.mode==="showing"&&(o.kind==="descriptions"?s=o:r=o)}r?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):s&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(s))}updateDisplayOverlay(){if(!this.player_.videoHeight()||!F.CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),i=this.player_.currentHeight(),s=e/i,r=this.player_.videoWidth()/this.player_.videoHeight();let n=0,o=0;Math.abs(s-r)>.1&&(s>r?n=Math.round((e-i*r)/2):o=Math.round((i-e/r)/2)),Da(this.el_,"insetInline",bv(n)),Da(this.el_,"insetBlock",bv(o))}updateDisplayState(e){const i=this.player_.textTrackSettings.getValues(),s=e.activeCues;let r=s.length;for(;r--;){const n=s[r];if(!n)continue;const o=n.displayState;if(i.color&&(o.firstChild.style.color=i.color),i.textOpacity&&Da(o.firstChild,"color",Vc(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(o.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&Da(o.firstChild,"backgroundColor",Vc(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?Da(o,"backgroundColor",Vc(i.windowColor,i.windowOpacity)):o.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?o.firstChild.style.textShadow=`2px 2px 3px ${Ei}, 2px 2px 4px ${Ei}, 2px 2px 5px ${Ei}`:i.edgeStyle==="raised"?o.firstChild.style.textShadow=`1px 1px ${Ei}, 2px 2px ${Ei}, 3px 3px ${Ei}`:i.edgeStyle==="depressed"?o.firstChild.style.textShadow=`1px 1px ${Tv}, 0 1px ${Tv}, -1px -1px ${Ei}, 0 -1px ${Ei}`:i.edgeStyle==="uniform"&&(o.firstChild.style.textShadow=`0 0 4px ${Ei}, 0 0 4px ${Ei}, 0 0 4px ${Ei}, 0 0 4px ${Ei}`)),i.fontPercent&&i.fontPercent!==1){const a=F.parseFloat(o.style.fontSize);o.style.fontSize=a*i.fontPercent+"px",o.style.height="auto",o.style.top="auto"}i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=sI[i.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof F.WebVTT!="function"||e.every(s=>!s.activeCues))return;const i=[];for(let s=0;s<e.length;++s){const r=e[s];for(let n=0;n<r.activeCues.length;++n)i.push(r.activeCues[n])}F.WebVTT.processCues(F,i,this.el_);for(let s=0;s<e.length;++s){const r=e[s];for(let n=0;n<r.activeCues.length;++n){const o=r.activeCues[n].displayState;$r(o,"vjs-text-track-cue","vjs-text-track-cue-"+(r.language?r.language:s)),r.language&&yo(o,"lang",r.language)}this.player_.textTrackSettings&&this.updateDisplayState(r)}}}W.registerComponent("TextTrackDisplay",rI);class nI extends W{createEl(){const e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),s=fe("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])}),r=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(s),r}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}W.registerComponent("LoadingSpinner",nI);class gi extends yh{createEl(e,i={},s={}){e="button",i=Object.assign({className:this.buildCSSClass()},i),s=Object.assign({type:"button"},s);const r=fe(e,i,s);return this.player_.options_.experimentalSvgIcons||r.appendChild(fe("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(r),r}addChild(e,i={}){const s=this.constructor.name;return ye.warn(`Adding an actionable (user controllable) child to a Button (${s}) is not supported; use a ClickableComponent instead.`),W.prototype.addChild.call(this,e,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(he.isEventKey(e,"Space")||he.isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}}W.registerComponent("Button",gi);class fE extends gi{constructor(e,i){super(e,i),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",s=>this.handleMouseDown(s))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const i=this.player_.play();if(this.mouseused_&&"clientX"in e&&"clientY"in e){ds(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const s=this.player_.getChild("controlBar"),r=s&&s.getChild("playToggle");if(!r){this.player_.tech(!0).focus();return}const n=()=>r.focus();qa(i)?i.then(n,()=>{}):this.setTimeout(n,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}fE.prototype.controlText_="Play Video";W.registerComponent("BigPlayButton",fE);class oI extends gi{constructor(e,i){super(e,i),this.setIcon("cancel"),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){he.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}W.registerComponent("CloseButton",oI);class mE extends gi{constructor(e,i={}){super(e,i),i.replay=i.replay===void 0||i.replay,this.setIcon("play"),this.on(e,"play",s=>this.handlePlay(s)),this.on(e,"pause",s=>this.handlePause(s)),i.replay&&this.on(e,"ended",s=>this.handleEnded(s))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?ds(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}mE.prototype.controlText_="Play";W.registerComponent("PlayToggle",mE);let zo=class extends W{constructor(e,i){super(e,i),this.on(e,["timeupdate","ended","seeking"],s=>this.update(s)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),i=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),s=fe("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)} `},{role:"presentation"});return i.appendChild(s),this.contentEl_=fe("span",{className:`${e}-display`},{role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=tn(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,ye.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=K.createTextNode(this.formattedTime_),this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}};zo.prototype.labelText_="Time";zo.prototype.controlText_="Time";W.registerComponent("TimeDisplay",zo);class nf extends zo{buildCSSClass(){return"vjs-current-time"}updateContent(e){let i;this.player_.ended()?i=this.player_.duration():i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}nf.prototype.labelText_="Current Time";nf.prototype.controlText_="Current Time";W.registerComponent("CurrentTimeDisplay",nf);class of extends zo{constructor(e,i){super(e,i);const s=r=>this.updateContent(r);this.on(e,"durationchange",s),this.on(e,"loadstart",s),this.on(e,"loadedmetadata",s)}buildCSSClass(){return"vjs-duration"}updateContent(e){const i=this.player_.duration();this.updateTextNode_(i)}}of.prototype.labelText_="Duration";of.prototype.controlText_="Duration";W.registerComponent("DurationDisplay",of);class aI extends W{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),s=super.createEl("span",{textContent:"/"});return i.appendChild(s),e.appendChild(i),e}}W.registerComponent("TimeDivider",aI);class af extends zo{constructor(e,i){super(e,i),this.on(e,"durationchange",s=>this.updateContent(s))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(fe("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let i;this.player_.ended()?i=0:this.player_.remainingTimeDisplay?i=this.player_.remainingTimeDisplay():i=this.player_.remainingTime(),this.updateTextNode_(i)}}af.prototype.labelText_="Remaining Time";af.prototype.controlText_="Remaining Time";W.registerComponent("RemainingTimeDisplay",af);class lI extends W{constructor(e,i){super(e,i),this.updateShowing(),this.on(this.player(),"durationchange",s=>this.updateShowing(s))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=fe("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(fe("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")} `})),this.contentEl_.appendChild(K.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}W.registerComponent("LiveDisplay",lI);class CE extends gi{constructor(e,i){super(e,i),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=s=>this.updateLiveEdgeStatus(s),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=fe("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}CE.prototype.controlText_="Seek to live, currently playing live";W.registerComponent("SeekToLive",CE);function $l(t,e,i){return t=Number(t),Math.min(i,Math.max(e,isNaN(t)?e:t))}var uI=Object.freeze({__proto__:null,clamp:$l});class lf extends W{constructor(e,i){super(e,i),this.handleMouseDown_=s=>this.handleMouseDown(s),this.handleMouseUp_=s=>this.handleMouseUp(s),this.handleKeyDown_=s=>this.handleKeyDown(s),this.handleClick_=s=>this.handleClick(s),this.handleMouseMove_=s=>this.handleMouseMove(s),this.update_=s=>this.update(s),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,i={},s={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),s=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},s),super.createEl(e,i,s)}handleMouseDown(e){const i=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!Ts&&e.preventDefault(),zS(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const i=this.bar.el_.ownerDocument;$S(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const i=this.vertical()?"height":"width";this.bar.el().style[i]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number($l(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const i=ph(this.el_,e);return this.vertical()?i.y:i.x}handleKeyDown(e){he.isEventKey(e,"Left")||he.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):he.isEventKey(e,"Right")||he.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}W.registerComponent("Slider",lf);const Bc=(t,e)=>$l(t/e*100,0,100).toFixed(2)+"%";class dI extends W{constructor(e,i){super(e,i),this.partEls_=[],this.on(e,"progress",s=>this.update(s))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),i=fe("span",{className:"vjs-control-text"}),s=fe("span",{textContent:this.localize("Loaded")}),r=K.createTextNode(": ");return this.percentageEl_=fe("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(i),i.appendChild(s),i.appendChild(r),i.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const i=this.player_.liveTracker,s=this.player_.buffered(),r=i&&i.isLive()?i.seekableEnd():this.player_.duration(),n=this.player_.bufferedEnd(),o=this.partEls_,a=Bc(n,r);this.percent_!==a&&(this.el_.style.width=a,yr(this.percentageEl_,a),this.percent_=a);for(let l=0;l<s.length;l++){const u=s.start(l),d=s.end(l);let c=o[l];c||(c=this.el_.appendChild(fe()),o[l]=c),!(c.dataset.start===u&&c.dataset.end===d)&&(c.dataset.start=u,c.dataset.end=d,c.style.left=Bc(u,n),c.style.width=Bc(d-u,n))}for(let l=o.length;l>s.length;l--)this.el_.removeChild(o[l-1]);o.length=s.length})}}W.registerComponent("LoadProgressBar",dI);class hI extends W{constructor(e,i){super(e,i),this.update=bs(Be(this,this.update),Ii)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,i,s){const r=ul(this.el_),n=So(this.player_.el()),o=e.width*i;if(!n||!r)return;let a=e.left-n.left+o,l=e.width-o+(n.right-e.right);l||(l=e.width-o,a=o);let u=r.width/2;a<u?u+=u-a:l<u&&(u=l),u<0?u=0:u>r.width&&(u=r.width),u=Math.round(u),this.el_.style.right=`-${u}px`,this.write(s)}write(e){yr(this.el_,e)}updateTime(e,i,s,r){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let n;const o=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const a=this.player_.liveTracker.liveWindow(),l=a-i*a;n=(l<1?"":"-")+tn(l,a)}else n=tn(s,o);this.update(e,i,n),r&&r()})}}W.registerComponent("TimeTooltip",hI);class uf extends W{constructor(e,i){super(e,i),this.setIcon("circle"),this.update=bs(Be(this,this.update),Ii)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,i){const s=this.getChild("timeTooltip");if(!s)return;const r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(e,i,r)}}uf.prototype.options_={children:[]};!Nt&&!ws&&uf.prototype.options_.children.push("timeTooltip");W.registerComponent("PlayProgressBar",uf);class vE extends W{constructor(e,i){super(e,i),this.update=bs(Be(this,this.update),Ii)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i){const s=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,s,()=>{this.el_.style.left=`${e.width*i}px`})}}vE.prototype.options_={children:["timeTooltip"]};W.registerComponent("MouseTimeDisplay",vE);const Hu=5,_v=12;class df extends lf{constructor(e,i){super(e,i),this.setEventHandlers_()}setEventHandlers_(){this.update_=Be(this,this.update),this.update=bs(this.update_,Ii),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in K&&"visibilityState"in K&&this.on(K,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){K.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Ii))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(K.visibilityState==="hidden")return;const i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const s=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),r=this.player_.liveTracker;let n=this.player_.duration();r&&r.isLive()&&(n=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),this.percent_=i),(this.currentTime_!==s||this.duration_!==n)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[tn(s,n),tn(n,n)],"{1} of {2}")),this.currentTime_=s,this.duration_=n),this.bar&&this.bar.update(So(this.el()),this.getProgress())}),i}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let i;const s=this.player_.liveTracker;return s&&s.isLive()?(i=(e-s.seekableStart())/s.liveWindow(),s.atLiveEdge()&&(i=1)):i=e/this.player_.duration(),i}handleMouseDown(e){dl(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,i=!1){if(!dl(e)||isNaN(this.player_.duration()))return;!i&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let s;const r=this.calculateDistance(e),n=this.player_.liveTracker;if(!n||!n.isLive())s=r*this.player_.duration(),s===this.player_.duration()&&(s=s-.1);else{if(r>=.99){n.seekToLiveEdge();return}const o=n.seekableStart(),a=n.liveCurrentTime();if(s=o+r*n.liveWindow(),s>=a&&(s=a),s<=o&&(s=o+.1),s===1/0)return}this.userSeek_(s),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?ds(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+Hu)}stepBack(){this.userSeek_(this.player_.currentTime()-Hu)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const i=this.player_.liveTracker;if(he.isEventKey(e,"Space")||he.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(he.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(he.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(he(e))){e.preventDefault(),e.stopPropagation();const s=(he.codes[he(e)]-he.codes[0])*10/100;i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*s):this.userSeek_(this.player_.duration()*s)}else he.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-Hu*_v)):he.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+Hu*_v)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in K&&"visibilityState"in K&&this.off(K,"visibilitychange",this.toggleVisibility_),super.dispose()}}df.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!Nt&&!ws&&df.prototype.options_.children.splice(1,0,"mouseTimeDisplay");W.registerComponent("SeekBar",df);class yE extends W{constructor(e,i){super(e,i),this.handleMouseMove=bs(Be(this,this.handleMouseMove),Ii),this.throttledHandleMouseSeek=bs(Be(this,this.handleMouseSeek),Ii),this.handleMouseUpHandler_=s=>this.handleMouseUp(s),this.handleMouseDownHandler_=s=>this.handleMouseDown(s),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const i=this.getChild("seekBar");if(!i)return;const s=i.getChild("playProgressBar"),r=i.getChild("mouseTimeDisplay");if(!s&&!r)return;const n=i.el(),o=ul(n);let a=ph(n,e).x;a=$l(a,0,1),r&&r.update(o,a),s&&s.update(o,i.getProgress())}handleMouseSeek(e){const i=this.getChild("seekBar");i&&i.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&ds(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const i=this.el_.ownerDocument,s=this.getChild("seekBar");s&&s.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}yE.prototype.options_={children:["seekBar"]};W.registerComponent("ProgressControl",yE);class SE extends gi{constructor(e,i){super(e,i),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],s=>this.handlePictureInPictureChange(s)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],s=>this.handlePictureInPictureEnabledChange(s)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){K.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in F?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof K.exitPictureInPicture=="function"&&super.show()}}SE.prototype.controlText_="Picture-in-Picture";W.registerComponent("PictureInPictureToggle",SE);class EE extends gi{constructor(e,i){super(e,i),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",s=>this.handleFullscreenChange(s)),K[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}EE.prototype.controlText_="Fullscreen";W.registerComponent("FullscreenToggle",EE);const cI=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})};class pI extends W{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}W.registerComponent("VolumeLevel",pI);class gI extends W{constructor(e,i){super(e,i),this.update=bs(Be(this,this.update),Ii)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,i,s,r){if(!s){const n=So(this.el_),o=So(this.player_.el()),a=e.width*i;if(!o||!n)return;const l=e.left-o.left+a,u=e.width-a+(o.right-e.right);let d=n.width/2;l<d?d+=d-l:u<d&&(d=u),d<0?d=0:d>n.width&&(d=n.width),this.el_.style.right=`-${d}px`}this.write(`${r}%`)}write(e){yr(this.el_,e)}updateVolume(e,i,s,r,n){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,i,s,r.toFixed(0)),n&&n()})}}W.registerComponent("VolumeLevelTooltip",gI);class wE extends W{constructor(e,i){super(e,i),this.update=bs(Be(this,this.update),Ii)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i,s){const r=100*i;this.getChild("volumeLevelTooltip").updateVolume(e,i,s,r,()=>{s?this.el_.style.bottom=`${e.height*i}px`:this.el_.style.left=`${e.width*i}px`})}}wE.prototype.options_={children:["volumeLevelTooltip"]};W.registerComponent("MouseVolumeLevelDisplay",wE);class Sh extends lf{constructor(e,i){super(e,i),this.on("slideractive",s=>this.updateLastVolume_(s)),this.on(e,"volumechange",s=>this.updateARIAAttributes(s)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){dl(e)&&super.handleMouseDown(e)}handleMouseMove(e){const i=this.getChild("mouseVolumeLevelDisplay");if(i){const s=this.el(),r=So(s),n=this.vertical();let o=ph(s,e);o=n?o.y:o.x,o=$l(o,0,1),i.update(r,o,n)}dl(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}Sh.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!Nt&&!ws&&Sh.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");Sh.prototype.playerEvent="volumechange";W.registerComponent("VolumeBar",Sh);class TE extends W{constructor(e,i={}){i.vertical=i.vertical||!1,(typeof i.volumeBar>"u"||vo(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(e,i),cI(this,e),this.throttledHandleMouseMove=bs(Be(this,this.handleMouseMove),Ii),this.handleMouseUpHandler_=s=>this.handleMouseUp(s),this.on("mousedown",s=>this.handleMouseDown(s)),this.on("touchstart",s=>this.handleMouseDown(s)),this.on("mousemove",s=>this.handleMouseMove(s)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}TE.prototype.options_={children:["volumeBar"]};W.registerComponent("VolumeControl",TE);const fI=function(t,e){e.tech_&&!e.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})};class bE extends gi{constructor(e,i){super(e,i),fI(this,e),this.on(e,["loadstart","volumechange"],s=>this.update(s))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.volume(),s=this.player_.lastVolume_();if(i===0){const r=s<.1?.1:s;this.player_.volume(r),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let i=3;this.setIcon("volume-high"),Nt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),i=0):e<.33?(this.setIcon("volume-low"),i=1):e<.67&&(this.setIcon("volume-medium"),i=2),hh(this.el_,[0,1,2,3].reduce((s,r)=>s+`${r?" ":""}vjs-vol-${r}`,"")),$r(this.el_,`vjs-vol-${i}`)}updateControlText_(){const i=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}bE.prototype.controlText_="Mute";W.registerComponent("MuteToggle",bE);class _E extends W{constructor(e,i={}){typeof i.inline<"u"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl>"u"||vo(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(e,i),this.handleKeyPressHandler_=s=>this.handleKeyPress(s),this.on(e,["loadstart"],s=>this.volumePanelState_(s)),this.on(this.muteToggle,"keyup",s=>this.handleKeyPress(s)),this.on(this.volumeControl,"keyup",s=>this.handleVolumeControlKeyUp(s)),this.on("keydown",s=>this.handleKeyPress(s)),this.on("mouseover",s=>this.handleMouseOver(s)),this.on("mouseout",s=>this.handleMouseOut(s)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){he.isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),mi(K,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),_t(K,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){he.isEventKey(e,"Esc")&&this.handleMouseOut()}}_E.prototype.options_={children:["muteToggle","volumeControl"]};W.registerComponent("VolumePanel",_E);class DE extends gi{constructor(e,i){super(e,i),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const i=this.player_.currentTime(),s=this.player_.liveTracker,r=s&&s.isLive()?s.seekableEnd():this.player_.duration();let n;i+this.skipTime<=r?n=i+this.skipTime:n=r,this.player_.currentTime(n)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}DE.prototype.controlText_="Skip Forward";W.registerComponent("SkipForward",DE);class RE extends gi{constructor(e,i){super(e,i),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.currentTime(),s=this.player_.liveTracker,r=s&&s.isLive()&&s.seekableStart();let n;r&&i-this.skipTime<=r?n=r:i>=this.skipTime?n=i-this.skipTime:n=0,this.player_.currentTime(n)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}RE.prototype.controlText_="Skip Backward";W.registerComponent("SkipBackward",RE);class AE extends W{constructor(e,i){super(e,i),i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",s=>this.handleKeyDown(s)),this.boundHandleBlur_=s=>this.handleBlur(s),this.boundHandleTapClick_=s=>this.handleTapClick(s)}addEventListenerForItem(e){e instanceof W&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof W&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const i=this.addChild(e);i&&this.addEventListenerForItem(i)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=fe(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),mi(i,"click",function(s){s.preventDefault(),s.stopImmediatePropagation()}),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const i=e.relatedTarget||K.activeElement;if(!this.children().some(s=>s.el()===i)){const s=this.menuButton_;s&&s.buttonPressed_&&i!==s.el().firstChild&&s.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const i=this.children();if(!Array.isArray(i))return;const s=i.filter(r=>r.el()===e.target)[0];if(!s)return;s.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){he.isEventKey(e,"Left")||he.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(he.isEventKey(e,"Right")||he.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())}}W.registerComponent("Menu",AE);class hf extends W{constructor(e,i={}){super(e,i),this.menuButton_=new gi(e,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const s=gi.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+s,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const r=n=>this.handleClick(n);this.handleMenuKeyUp_=n=>this.handleMenuKeyUp(n),this.on(this.menuButton_,"tap",r),this.on(this.menuButton_,"click",r),this.on(this.menuButton_,"keydown",n=>this.handleKeyDown(n)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),mi(K,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",n=>this.handleMouseLeave(n)),this.on("keydown",n=>this.handleSubmenuKeyDown(n))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new AE(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const i=fe("li",{className:"vjs-menu-title",textContent:et(this.options_.title),tabIndex:-1}),s=new W(this.player_,{el:i});e.addItem(s)}if(this.items=this.createItems(),this.items)for(let i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const i=gi.prototype.buildCSSClass();return`vjs-menu-button ${e} ${i} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,i=this.menuButton_.el()){return this.menuButton_.controlText(e,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),_t(K,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){he.isEventKey(e,"Esc")||he.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),he.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(he.isEventKey(e,"Up")||he.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(he.isEventKey(e,"Esc")||he.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(he.isEventKey(e,"Esc")||he.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),he.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Nt&&VS())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}W.registerComponent("MenuButton",hf);class cf extends hf{constructor(e,i){const s=i.tracks;if(super(e,i),this.items.length<=1&&this.hide(),!s)return;const r=Be(this,this.update);s.addEventListener("removetrack",r),s.addEventListener("addtrack",r),s.addEventListener("labelchange",r),this.player_.on("ready",r),this.player_.on("dispose",function(){s.removeEventListener("removetrack",r),s.removeEventListener("addtrack",r),s.removeEventListener("labelchange",r)})}}W.registerComponent("TrackButton",cf);const mI=["Tab","Esc","Up","Down","Right","Left"];class jl extends yh{constructor(e,i){super(e,i),this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,i,s){this.nonIconControl=!0;const r=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),s),n=fe("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?r.appendChild(n):r.replaceChild(n,r.querySelector(".vjs-icon-placeholder")),r}handleKeyDown(e){mI.some(i=>he.isEventKey(e,i))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}W.registerComponent("MenuItem",jl);class ql extends jl{constructor(e,i){const s=i.track,r=e.textTracks();i.label=s.label||s.language||"Unknown",i.selected=s.mode==="showing",super(e,i),this.track=s,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean);const n=(...a)=>{this.handleTracksChange.apply(this,a)},o=(...a)=>{this.handleSelectedLanguageChange.apply(this,a)};if(e.on(["loadstart","texttrackchange"],n),r.addEventListener("change",n),r.addEventListener("selectedlanguagechange",o),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],n),r.removeEventListener("change",n),r.removeEventListener("selectedlanguagechange",o)}),r.onchange===void 0){let a;this.on(["tap","click"],function(){if(typeof F.Event!="object")try{a=new F.Event("change")}catch{}a||(a=K.createEvent("Event"),a.initEvent("change",!0,!0)),r.dispatchEvent(a)})}this.handleTracksChange()}handleClick(e){const i=this.track,s=this.player_.textTracks();if(super.handleClick(e),!!s)for(let r=0;r<s.length;r++){const n=s[r];this.kinds.indexOf(n.kind)!==-1&&(n===i?n.mode!=="showing"&&(n.mode="showing"):n.mode!=="disabled"&&(n.mode="disabled"))}}handleTracksChange(e){const i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}W.registerComponent("TextTrackMenuItem",ql);class xE extends ql{constructor(e,i){i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(e,i)}handleTracksChange(e){const i=this.player().textTracks();let s=!0;for(let r=0,n=i.length;r<n;r++){const o=i[r];if(this.options_.kinds.indexOf(o.kind)>-1&&o.mode==="showing"){s=!1;break}}s!==this.isSelected_&&this.selected(s)}handleSelectedLanguageChange(e){const i=this.player().textTracks();let s=!0;for(let r=0,n=i.length;r<n;r++){const o=i[r];if(["captions","descriptions","subtitles"].indexOf(o.kind)>-1&&o.mode==="showing"){s=!1;break}}s&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}W.registerComponent("OffTextTrackMenuItem",xE);class $o extends cf{constructor(e,i={}){i.tracks=e.textTracks(),super(e,i)}createItems(e=[],i=ql){let s;this.label_&&(s=`${this.label_} off`),e.push(new xE(this.player_,{kinds:this.kinds_,kind:this.kind_,label:s})),this.hideThreshold_+=1;const r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let n=0;n<r.length;n++){const o=r[n];if(this.kinds_.indexOf(o.kind)>-1){const a=new i(this.player_,{track:o,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});a.addClass(`vjs-${o.kind}-menu-item`),e.push(a)}}return e}}W.registerComponent("TextTrackButton",$o);class PE extends jl{constructor(e,i){const s=i.track,r=i.cue,n=e.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=r.text,i.selected=r.startTime<=n&&n<r.endTime,super(e,i),this.track=s,this.cue=r}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}W.registerComponent("ChaptersTrackMenuItem",PE);class pf extends $o{constructor(e,i,s){super(e,i,s),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(r=>{r.selected(this.track_.activeCues[0]===r.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const i=this.findChaptersTrack();i!==this.track_?(this.setTrack(i),super.update()):(!this.items||i&&i.cues&&i.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let i=e.length-1;i>=0;i--){const s=e[i];if(s.kind===this.kind_)return s}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(et(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const i=this.track_.cues;if(!i)return e;for(let s=0,r=i.length;s<r;s++){const n=i[s],o=new PE(this.player_,{track:this.track_,cue:n});e.push(o)}return e}}pf.prototype.kind_="chapters";pf.prototype.controlText_="Chapters";W.registerComponent("ChaptersButton",pf);class gf extends $o{constructor(e,i,s){super(e,i,s),this.setIcon("audio-description");const r=e.textTracks(),n=Be(this,this.handleTracksChange);r.addEventListener("change",n),this.on("dispose",function(){r.removeEventListener("change",n)})}handleTracksChange(e){const i=this.player().textTracks();let s=!1;for(let r=0,n=i.length;r<n;r++){const o=i[r];if(o.kind!==this.kind_&&o.mode==="showing"){s=!0;break}}s?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}gf.prototype.kind_="descriptions";gf.prototype.controlText_="Descriptions";W.registerComponent("DescriptionsButton",gf);class ff extends $o{constructor(e,i,s){super(e,i,s),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}ff.prototype.kind_="subtitles";ff.prototype.controlText_="Subtitles";W.registerComponent("SubtitlesButton",ff);class mf extends ql{constructor(e,i){i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(e,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}W.registerComponent("CaptionSettingsMenuItem",mf);class Cf extends $o{constructor(e,i,s){super(e,i,s),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new mf(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Cf.prototype.kind_="captions";Cf.prototype.controlText_="Captions";W.registerComponent("CaptionsButton",Cf);class IE extends ql{createEl(e,i,s){const r=super.createEl(e,i,s),n=r.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",r):n.appendChild(fe("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),n.appendChild(fe("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),r}}W.registerComponent("SubsCapsMenuItem",IE);class vf extends $o{constructor(e,i={}){super(e,i),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(et(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new mf(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,IE),e}}vf.prototype.kinds_=["captions","subtitles"];vf.prototype.controlText_="Subtitles";W.registerComponent("SubsCapsButton",vf);class LE extends jl{constructor(e,i){const s=i.track,r=e.audioTracks();i.label=s.label||s.language||"Unknown",i.selected=s.enabled,super(e,i),this.track=s,this.addClass(`vjs-${s.kind}-menu-item`);const n=(...o)=>{this.handleTracksChange.apply(this,o)};r.addEventListener("change",n),this.on("dispose",()=>{r.removeEventListener("change",n)})}createEl(e,i,s){const r=super.createEl(e,i,s),n=r.querySelector(".vjs-menu-item-text");return["main-desc","description"].indexOf(this.options_.track.kind)>=0&&(n.appendChild(fe("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),n.appendChild(fe("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),r}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let s=0;s<i.length;s++){const r=i[s];r!==this.track&&(r.enabled=r===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}W.registerComponent("AudioTrackMenuItem",LE);class FE extends cf{constructor(e,i={}){i.tracks=e.audioTracks(),super(e,i),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const i=this.player_.audioTracks();for(let s=0;s<i.length;s++){const r=i[s];e.push(new LE(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e}}FE.prototype.controlText_="Audio Track";W.registerComponent("AudioTrackButton",FE);class yf extends jl{constructor(e,i){const s=i.rate,r=parseFloat(s,10);i.label=s,i.selected=r===e.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(e,i),this.label=s,this.rate=r,this.on(e,"ratechange",n=>this.update(n))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}yf.prototype.contentElType="button";W.registerComponent("PlaybackRateMenuItem",yf);class ME extends hf{constructor(e,i){super(e,i),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",s=>this.updateVisibility(s)),this.on(e,"ratechange",s=>this.updateLabel(s)),this.on(e,"playbackrateschange",s=>this.handlePlaybackRateschange(s))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=fe("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),i=[];for(let s=e.length-1;s>=0;s--)i.push(new yf(this.player(),{rate:e[s]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}ME.prototype.controlText_="Playback Rate";W.registerComponent("PlaybackRateMenuButton",ME);class OE extends W{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",i={},s={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(e,i,s)}}W.registerComponent("Spacer",OE);class CI extends OE{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}}W.registerComponent("CustomControlSpacer",CI);class NE extends W{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}NE.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]};W.registerComponent("ControlBar",NE);class kE extends Wo{constructor(e,i){super(e,i),this.on(e,"error",s=>{this.open(s)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}kE.prototype.options_=Object.assign({},Wo.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});W.registerComponent("ErrorDisplay",kE);const Hc="vjs-text-track-settings",Dv=["#000","Black"],Rv=["#00F","Blue"],Av=["#0FF","Cyan"],xv=["#0F0","Green"],Pv=["#F0F","Magenta"],Iv=["#F00","Red"],Lv=["#FFF","White"],Fv=["#FF0","Yellow"],Uc=["1","Opaque"],Wc=["0.5","Semi-Transparent"],Mv=["0","Transparent"],Vr={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Dv,Lv,Iv,xv,Rv,Fv,Pv,Av]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[Uc,Wc,Mv]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Lv,Dv,Iv,xv,Rv,Fv,Pv,Av]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:t=>t==="1.00"?null:Number(t)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[Uc,Wc]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[Mv,Wc,Uc]}};Vr.windowColor.options=Vr.backgroundColor.options;function GE(t,e){if(e&&(t=e(t)),t&&t!=="none")return t}function vI(t,e){const i=t.options[t.options.selectedIndex].value;return GE(i,e)}function yI(t,e,i){if(e){for(let s=0;s<t.options.length;s++)if(GE(t.options[s].value,i)===e){t.selectedIndex=s;break}}}class SI extends Wo{constructor(e,i){i.temporary=!1,super(e,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=fe("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),to(Vr,s=>{this.on(this.$(s.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,i="",s="label"){const r=Vr[e],n=r.id.replace("%s",this.id_),o=[i,n].join(" ").trim(),a=`vjs_select_${Xi()}`;return[`<${s} id="${n}"${s==="label"?` for="${a}" class="vjs-label"`:""}>`,this.localize(r.label),`</${s}>`,`<select aria-labelledby="${o}" id="${a}">`].concat(r.options.map(l=>{const u=n+"-"+l[1].replace(/\W+/g,"");return[`<option id="${u}" value="${l[0]}" `,`aria-labelledby="${o} ${u}">`,this.localize(l[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",e),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",e),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window vjs-track-setting">',`<legend id="${e}">`,this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",e),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return fe("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return fe("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return fe("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return LS(Vr,(e,i,s)=>{const r=vI(this.$(i.selector),i.parser);return r!==void 0&&(e[s]=r),e},{})}setValues(e){to(Vr,(i,s)=>{yI(this.$(i.selector),e[s],i.parser)})}setDefaults(){to(Vr,e=>{const i=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=i})}restoreSettings(){let e;try{e=JSON.parse(F.localStorage.getItem(Hc))}catch(i){ye.warn(i)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?F.localStorage.setItem(Hc,JSON.stringify(e)):F.localStorage.removeItem(Hc)}catch(i){ye.warn(i)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,i=e&&e.subsCapsButton,s=e&&e.captionsButton;i?i.focus():s&&s.focus()}handleLanguagechange(){this.fill()}}W.registerComponent("TextTrackSettings",SI);class EI extends W{constructor(e,i){let s=i.ResizeObserver||F.ResizeObserver;i.ResizeObserver===null&&(s=!1);const r=Ve({createEl:!s,reportTouchActivity:!1},i);super(e,r),this.ResizeObserver=i.ResizeObserver||F.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=tE(()=>{this.resizeHandler()},100,!1,this),s?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const n=this.debouncedHandler_;let o=this.unloadListener_=function(){_t(this,"resize",n),_t(this,"unload",o),o=null};mi(this.el_.contentWindow,"unload",o),mi(this.el_.contentWindow,"resize",n)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}W.registerComponent("ResizeManager",EI);const wI={trackingThreshold:20,liveTolerance:15};class TI extends W{constructor(e,i){const s=Ve(wI,i,{createEl:!1});super(e,s),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=r=>this.handlePlay(r),this.handleFirstTimeupdate_=r=>this.handleFirstTimeupdate(r),this.handleSeeked_=r=>this.handleSeeked(r),this.seekToLiveEdge_=r=>this.seekToLiveEdge(r),this.reset_(),this.on(this.player_,"durationchange",r=>this.handleDurationchange(r)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const i=Number(F.performance.now().toFixed(4)),s=this.lastTime_===-1?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+s;const r=this.liveCurrentTime(),n=this.player_.currentTime();let o=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-n)>this.options_.liveTolerance;(!this.timeupdateSeen_||r===1/0)&&(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Ii),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),i=[];let s=e?e.length:0;for(;s--;)i.push(e.end(s));return i.length?i.sort()[i.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),i=[];let s=e?e.length:0;for(;s--;)i.push(e.start(s));return i.length?i.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}W.registerComponent("LiveTracker",TI);class bI extends W{constructor(e,i){super(e,i),this.on("statechanged",s=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:fe("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${Xi()}`}),description:fe("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${Xi()}`})},fe("div",{className:"vjs-title-bar"},{},FS(this.els))}updateDom_(){const e=this.player_.tech_,i=e&&e.el_,s={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(r=>{const n=this.state[r],o=this.els[r],a=s[r];gh(o),n&&yr(o,n),i&&(i.removeAttribute(a),n&&i.setAttribute(a,o.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,i=e&&e.el_;i&&(i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}W.registerComponent("TitleBar",bI);const Op=t=>{const e=t.el();if(e.hasAttribute("src"))return t.triggerSourceset(e.src),!0;const i=t.$$("source"),s=[];let r="";if(!i.length)return!1;for(let n=0;n<i.length;n++){const o=i[n].src;o&&s.indexOf(o)===-1&&s.push(o)}return s.length?(s.length===1&&(r=s[0]),t.triggerSourceset(r),!0):!1},_I=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(t){const e=K.createElement(this.nodeName.toLowerCase());e.innerHTML=t;const i=K.createDocumentFragment();for(;e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",F.Element.prototype.appendChild.call(this,i),this.innerHTML}}),VE=(t,e)=>{let i={};for(let s=0;s<t.length&&(i=Object.getOwnPropertyDescriptor(t[s],e),!(i&&i.set&&i.get));s++);return i.enumerable=!0,i.configurable=!0,i},DI=t=>VE([t.el(),F.HTMLMediaElement.prototype,F.Element.prototype,_I],"innerHTML"),Ov=function(t){const e=t.el();if(e.resetSourceWatch_)return;const i={},s=DI(t),r=n=>(...o)=>{const a=n.apply(e,o);return Op(t),a};["append","appendChild","insertAdjacentHTML"].forEach(n=>{e[n]&&(i[n]=e[n],e[n]=r(i[n]))}),Object.defineProperty(e,"innerHTML",Ve(s,{set:r(s.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(i).forEach(n=>{e[n]=i[n]}),Object.defineProperty(e,"innerHTML",s)},t.one("sourceset",e.resetSourceWatch_)},RI=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?hE(F.Element.prototype.getAttribute.call(this,"src")):""},set(t){return F.Element.prototype.setAttribute.call(this,"src",t),t}}),AI=t=>VE([t.el(),F.HTMLMediaElement.prototype,RI],"src"),xI=function(t){if(!t.featuresSourceset)return;const e=t.el();if(e.resetSourceset_)return;const i=AI(t),s=e.setAttribute,r=e.load;Object.defineProperty(e,"src",Ve(i,{set:n=>{const o=i.set.call(e,n);return t.triggerSourceset(e.src),o}})),e.setAttribute=(n,o)=>{const a=s.call(e,n,o);return/src/i.test(n)&&t.triggerSourceset(e.src),a},e.load=()=>{const n=r.call(e);return Op(t)||(t.triggerSourceset(""),Ov(t)),n},e.currentSrc?t.triggerSourceset(e.currentSrc):Op(t)||Ov(t),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=r,e.setAttribute=s,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}};class J extends pe{constructor(e,i){super(e,i);const s=e.source;let r=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",s&&(this.el_.currentSrc!==s.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(s):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const n=this.el_.childNodes;let o=n.length;const a=[];for(;o--;){const l=n[o];l.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack(l.track),this.textTracks().addTrack(l.track),!r&&!this.el_.hasAttribute("crossorigin")&&vh(l.src)&&(r=!0)):a.push(l))}for(let l=0;l<a.length;l++)this.el_.removeChild(a[l])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&r&&ye.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(ll||uh)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),J.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){xI(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let i;const s=()=>{i=[];for(let n=0;n<e.length;n++){const o=e[n];o.kind==="metadata"&&i.push({track:o,storedMode:o.mode})}};s(),e.addEventListener("change",s),this.on("dispose",()=>e.removeEventListener("change",s));const r=()=>{for(let n=0;n<i.length;n++){const o=i[n];o.track.mode==="disabled"&&o.track.mode!==o.storedMode&&(o.track.mode=o.storedMode)}e.removeEventListener("change",r)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",s),e.removeEventListener("change",r),e.addEventListener("change",r)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",s),e.addEventListener("change",s),e.removeEventListener("change",r)})}overrideNative_(e,i){if(i!==this[`featuresNative${e}Tracks`])return;const s=e.toLowerCase();this[`${s}TracksListeners_`]&&Object.keys(this[`${s}TracksListeners_`]).forEach(r=>{this.el()[`${s}Tracks`].removeEventListener(r,this[`${s}TracksListeners_`][r])}),this[`featuresNative${e}Tracks`]=!i,this[`${s}TracksListeners_`]=null,this.proxyNativeTracksForType_(s)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const i=Ri[e],s=this.el()[i.getterName],r=this[i.getterName]();if(!this[`featuresNative${i.capitalName}Tracks`]||!s||!s.addEventListener)return;const n={change:a=>{const l={type:"change",target:r,currentTarget:r,srcElement:r};r.trigger(l),e==="text"&&this[To.remoteText.getterName]().trigger(l)},addtrack(a){r.addTrack(a.track)},removetrack(a){r.removeTrack(a.track)}},o=function(){const a=[];for(let l=0;l<r.length;l++){let u=!1;for(let d=0;d<s.length;d++)if(s[d]===r[l]){u=!0;break}u||a.push(r[l])}for(;a.length;)r.removeTrack(a.shift())};this[i.getterName+"Listeners_"]=n,Object.keys(n).forEach(a=>{const l=n[a];s.addEventListener(a,l),this.on("dispose",u=>s.removeEventListener(a,l))}),this.on("loadstart",o),this.on("dispose",a=>this.off("loadstart",o))}proxyNativeTracks_(){Ri.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const s=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(s,e),J.disposeMediaElement(e),e=s}else{e=K.createElement("video");const s=this.options_.tag&&nr(this.options_.tag),r=Ve({},s);(!ll||this.options_.nativeControlsForTouch!==!0)&&delete r.controls,US(e,Object.assign(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&yo(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let s=0;s<i.length;s++){const r=i[s],n=this.options_[r];typeof n<"u"&&(n?yo(e,r,r):ch(e,r),e[r]=n)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let s=!1;const r=function(){s=!0};this.on("loadstart",r);const n=function(){s||this.trigger("loadstart")};this.on("loadedmetadata",n),this.ready(function(){this.off("loadstart",r),this.off("loadedmetadata",n),s||this.trigger("loadstart")});return}const i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(s){this.trigger(s)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&dh?this.el_.fastSeek(e):this.el_.currentTime=e}catch(i){ye(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&ws&&Ts&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)ds(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){J.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,i,s){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,s):super.addTextTrack(e,i,s)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const i=K.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i}addRemoteTextTrack(e,i){const s=super.addRemoteTextTrack(e,i);return this.featuresNativeTextTracks&&this.el().appendChild(s),s}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const i=this.$$("track");let s=i.length;for(;s--;)(e===i[s]||e===i[s].track)&&this.el().removeChild(i[s])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),F.performance&&(e.creationTime=F.performance.now()),e}}oh(J,"TEST_VID",function(){if(!Bo())return;const t=K.createElement("video"),e=K.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",t.appendChild(e),t});J.isSupported=function(){try{J.TEST_VID.volume=.5}catch{return!1}return!!(J.TEST_VID&&J.TEST_VID.canPlayType)};J.canPlayType=function(t){return J.TEST_VID.canPlayType(t)};J.canPlaySource=function(t,e){return J.canPlayType(t.type)};J.canControlVolume=function(){try{const t=J.TEST_VID.volume;J.TEST_VID.volume=t/2+.1;const e=t!==J.TEST_VID.volume;return e&&Nt?(F.setTimeout(()=>{J&&J.prototype&&(J.prototype.featuresVolumeControl=t!==J.TEST_VID.volume)}),!1):e}catch{return!1}};J.canMuteVolume=function(){try{const t=J.TEST_VID.muted;return J.TEST_VID.muted=!t,J.TEST_VID.muted?yo(J.TEST_VID,"muted","muted"):ch(J.TEST_VID,"muted","muted"),t!==J.TEST_VID.muted}catch{return!1}};J.canControlPlaybackRate=function(){if(ws&&Ts&&ah<58)return!1;try{const t=J.TEST_VID.playbackRate;return J.TEST_VID.playbackRate=t/2+.1,t!==J.TEST_VID.playbackRate}catch{return!1}};J.canOverrideAttributes=function(){try{const t=()=>{};Object.defineProperty(K.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(K.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty(K.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty(K.createElement("audio"),"innerHTML",{get:t,set:t})}catch{return!1}return!0};J.supportsNativeTextTracks=function(){return dh||Nt&&Ts};J.supportsNativeVideoTracks=function(){return!!(J.TEST_VID&&J.TEST_VID.videoTracks)};J.supportsNativeAudioTracks=function(){return!!(J.TEST_VID&&J.TEST_VID.audioTracks)};J.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([t,e]){oh(J.prototype,t,()=>J[e](),!0)});J.prototype.featuresVolumeControl=J.canControlVolume();J.prototype.movingMediaElementInDOM=!Nt;J.prototype.featuresFullscreenResize=!0;J.prototype.featuresProgressEvents=!0;J.prototype.featuresTimeupdateEvents=!0;J.prototype.featuresVideoFrameCallback=!!(J.TEST_VID&&J.TEST_VID.requestVideoFrameCallback);J.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}};J.resetMediaElement=function(t){if(!t)return;const e=t.querySelectorAll("source");let i=e.length;for(;i--;)t.removeChild(e[i]);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){J.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){J.prototype["set"+et(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(t){J.prototype[t]=function(){return this.el_[t]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(t){J.prototype["set"+et(t)]=function(e){this.el_[t]=e}});["pause","load","play"].forEach(function(t){J.prototype[t]=function(){return this.el_[t]()}});pe.withSourceHandlers(J);J.nativeSourceHandler={};J.nativeSourceHandler.canPlayType=function(t){try{return J.TEST_VID.canPlayType(t)}catch{return""}};J.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return J.nativeSourceHandler.canPlayType(t.type);if(t.src){const i=sf(t.src);return J.nativeSourceHandler.canPlayType(`video/${i}`)}return""};J.nativeSourceHandler.handleSource=function(t,e,i){e.setSrc(t.src)};J.nativeSourceHandler.dispose=function(){};J.registerSourceHandler(J.nativeSourceHandler);pe.registerTech("Html5",J);const BE=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],zc={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Np=["tiny","xsmall","small","medium","large","xlarge","huge"],Ju={};Np.forEach(t=>{const e=t.charAt(0)==="x"?`x-${t.substring(1)}`:t;Ju[t]=`vjs-layout-${e}`});const PI={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class $e extends W{constructor(e,i,s){if(e.id=e.id||i.id||`vjs_video_${Xi()}`,i=Object.assign($e.getTagSettings(e),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const o=e.closest("[lang]");o&&(i.language=o.getAttribute("lang"))}if(super(null,i,s),this.boundDocumentFullscreenChange_=o=>this.documentFullscreenChange_(o),this.boundFullWindowOnEscKey_=o=>this.fullWindowOnEscKey(o),this.boundUpdateStyleEl_=o=>this.updateStyleEl_(o),this.boundApplyInitTime_=o=>this.applyInitTime_(o),this.boundUpdateCurrentBreakpoint_=o=>this.updateCurrentBreakpoint_(o),this.boundHandleTechClick_=o=>this.handleTechClick_(o),this.boundHandleTechDoubleClick_=o=>this.handleTechDoubleClick_(o),this.boundHandleTechTouchStart_=o=>this.handleTechTouchStart_(o),this.boundHandleTechTouchMove_=o=>this.handleTechTouchMove_(o),this.boundHandleTechTouchEnd_=o=>this.handleTechTouchEnd_(o),this.boundHandleTechTap_=o=>this.handleTechTap_(o),this.isFullscreen_=!1,this.log=PS(this.id_),this.fsApi_=pd,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&nr(e),this.language(this.options_.language),i.languages){const o={};Object.getOwnPropertyNames(i.languages).forEach(function(a){o[a.toLowerCase()]=i.languages[a]}),this.languages_=o}else this.languages_=$e.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(o=>{if(typeof this[o]!="function")throw new Error(`plugin "${o}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Jg(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(mi(K,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const r=Ve(this.options_);if(i.plugins&&Object.keys(i.plugins).forEach(o=>{this[o](i.plugins[o])}),i.debug&&this.debug(!0),this.options_.playerOptions=r,this.middleware_=[],this.playbackRates(i.playbackRates),i.experimentalSvgIcons){const a=new F.DOMParser().parseFromString(tI,"image/svg+xml");if(a.querySelector("parsererror"))ye.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const u=a.documentElement;u.style.display="none",this.el_.appendChild(u),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),ll&&this.addClass("vjs-touch-enabled"),Nt||this.addClass("vjs-workinghover"),$e.players[this.id_]=this;const n=wp.split(".")[0];this.addClass(`vjs-v${n}`),this.userActive(!0),this.reportUserActivity(),this.one("play",o=>this.listenForUserActivity_(o)),this.on("keydown",o=>this.handleKeyDown(o)),this.on("languagechange",o=>this.handleLanguagechange(o)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),_t(K,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),_t(K,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),$e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),QP(this),Lt.names.forEach(e=>{const i=Lt[e],s=this[i.getterName]();s&&s.off&&s.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,i,s=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const r=this.tag.tagName.toLowerCase()==="video-js";s?i=this.el_=e.parentNode:r||(i=this.el_=super.createEl("div"));const n=nr(e);if(r){for(i=this.el_=e,e=this.tag=K.createElement("video");i.children.length;)e.appendChild(i.firstChild);$a(i,"video-js")||$r(i,"video-js"),i.appendChild(e),s=this.playerElIngest_=i,Object.keys(i).forEach(l=>{try{e[l]=i[l]}catch{}})}e.setAttribute("tabindex","-1"),n.tabindex="-1",Ts&&lh&&(e.setAttribute("role","application"),n.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in n&&delete n.width,"height"in n&&delete n.height,Object.getOwnPropertyNames(n).forEach(function(l){r&&l==="class"||i.setAttribute(l,n[l]),r&&e.setAttribute(l,n[l])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused");const o=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE"].filter(l=>GS[l]).map(l=>"vjs-device-"+l.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(...o),F.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=ZS("vjs-styles-dimensions");const l=ur(".vjs-styles-defaults"),u=ur("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const a=e.getElementsByTagName("a");for(let l=0;l<a.length;l++){const u=a.item(l);$r(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!s&&e.parentNode.insertBefore(i,e),Rp(e,i),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){ye.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,i){const s=e+"_";if(i===void 0)return this[s]||0;if(i===""||i==="auto"){this[s]=void 0,this.updateStyleEl_();return}const r=parseFloat(i);if(isNaN(r)){ye.error(`Improper value "${i}" supplied for for ${e}`);return}this[s]=r,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,Gs(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),RP(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(F.VIDEOJS_NO_DYNAMIC_STYLE===!0){const a=typeof this.width_=="number"?this.width_:this.options_.width,l=typeof this.height_=="number"?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(a>=0&&(u.width=a),l>=0&&(u.height=l));return}let e,i,s,r;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?s=this.aspectRatio_:this.videoWidth()>0?s=this.videoWidth()+":"+this.videoHeight():s="16:9";const n=s.split(":"),o=n[1]/n[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/o:e=this.videoWidth()||300,this.height_!==void 0?i=this.height_:i=e*o,/^[^a-zA-Z]/.test(this.id())?r="dimensions-"+this.id():r=this.id()+"-dimensions",this.addClass(r),eE(this.styleEl_,`
      .${r} {
        width: ${e}px;
        height: ${i}px;
      }

      .${r}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${o*100}%;
      }
    `)}loadTech_(e,i){this.tech_&&this.unloadTech_();const s=et(e),r=e.charAt(0).toLowerCase()+e.slice(1);s!=="Html5"&&this.tag&&(pe.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=s,this.isReady_=!1;let n=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(n=!1);const o={source:i,autoplay:n,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${r}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Lt.names.forEach(l=>{const u=Lt[l];o[u.getterName]=this[u.privateName]}),Object.assign(o,this.options_[s]),Object.assign(o,this.options_[r]),Object.assign(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);const a=pe.getTech(e);if(!a)throw new Error(`No Tech named '${s}' exists! '${s}' should be registered using videojs.registerTech()'`);this.tech_=new a(o),this.tech_.ready(Be(this,this.handleTechReady_),!0),mv.jsonToTextTracks(this.textTracksJson_||[],this.tech_),BE.forEach(l=>{this.on(this.tech_,l,u=>this[`handleTech${et(l)}_`](u))}),Object.keys(zc).forEach(l=>{this.on(this.tech_,l,u=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${zc[l]}_`].bind(this),event:u});return}this[`handleTech${zc[l]}_`](u)})}),this.on(this.tech_,"loadstart",l=>this.handleTechLoadStart_(l)),this.on(this.tech_,"sourceset",l=>this.handleTechSourceset_(l)),this.on(this.tech_,"waiting",l=>this.handleTechWaiting_(l)),this.on(this.tech_,"ended",l=>this.handleTechEnded_(l)),this.on(this.tech_,"seeking",l=>this.handleTechSeeking_(l)),this.on(this.tech_,"play",l=>this.handleTechPlay_(l)),this.on(this.tech_,"pause",l=>this.handleTechPause_(l)),this.on(this.tech_,"durationchange",l=>this.handleTechDurationChange_(l)),this.on(this.tech_,"fullscreenchange",(l,u)=>this.handleTechFullscreenChange_(l,u)),this.on(this.tech_,"fullscreenerror",(l,u)=>this.handleTechFullscreenError_(l,u)),this.on(this.tech_,"enterpictureinpicture",l=>this.handleTechEnterPictureInPicture_(l)),this.on(this.tech_,"leavepictureinpicture",l=>this.handleTechLeavePictureInPicture_(l)),this.on(this.tech_,"error",l=>this.handleTechError_(l)),this.on(this.tech_,"posterchange",l=>this.handleTechPosterChange_(l)),this.on(this.tech_,"textdata",l=>this.handleTechTextData_(l)),this.on(this.tech_,"ratechange",l=>this.handleTechRateChange_(l)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(s!=="Html5"||!this.tag)&&Rp(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Lt.names.forEach(e=>{const i=Lt[e];this[i.privateName]=this[i.getterName]()}),this.textTracksJson_=mv.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&ye.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":wp}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const i=()=>{const r=this.muted();this.muted(!0);const n=()=>{this.muted(r)};this.playTerminatedQueue_.push(n);const o=this.play();if(qa(o))return o.catch(a=>{throw n(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${a||""}`)})};let s;if(e==="any"&&!this.muted()?(s=this.play(),qa(s)&&(s=s.catch(i))):e==="muted"&&!this.muted()?s=i():s=this.play(),!!qa(s))return s.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let i=e,s="";typeof i!="string"&&(i=e.src,s=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!s&&(s=eI(this,i)),this.cache_.source=Ve({},e,{src:i,type:s});const r=this.cache_.sources.filter(l=>l.src&&l.src===i),n=[],o=this.$$("source"),a=[];for(let l=0;l<o.length;l++){const u=nr(o[l]);n.push(u),u.src&&u.src===i&&a.push(u.src)}a.length&&!r.length?this.cache_.sources=n:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(e){if(!this.changingSrc_){let i=n=>this.updateSourceCaches_(n);const s=this.currentSource().src,r=e.src;s&&!/^blob:/.test(s)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==s)&&(i=()=>{}),i(r),e.src||this.tech_.any(["sourceset","loadstart"],n=>{if(n.type==="sourceset")return;const o=this.techGet_("currentSrc");this.lastSource_.tech=o,this.updateSourceCaches_(o)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),i=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?ds(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),s=>s.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const i=e.target.player;if(i&&i!==this)return;const s=this.el();let r=K[this.fsApi_.fullscreenElement]===s;!r&&s.matches&&(r=s.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,i){this.ready(function(){if(e in YP)return qP(this.middleware_,this.tech_,e,i);if(e in Ev)return Sv(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(s){throw ye(s),s}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in KP)return jP(this.middleware_,this.tech_,e);if(e in Ev)return Sv(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){throw this.tech_[e]===void 0?(ye(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,i),i):i.name==="TypeError"?(ye(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,i),this.tech_.isReady_=!1,i):(ye(i),i)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=ds){this.playCallbacks_.push(e);const i=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),s=!!(dh||Nt);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i){this.waitToPlay_=o=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!i&&s&&this.load();return}const r=this.techGet_("play");s&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),r===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(i){i()})}runPlayCallbacks_(e){const i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(s){s(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Ki(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Ki(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=Ki(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return uE(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),i=this.duration();let s=e.end(e.length-1);return s>i&&(s=i),s}volume(e){let i;if(e!==void 0){i=Math.max(0,Math.min(1,e)),this.cache_.volume=i,this.techCall_("setVolume",i),i>0&&this.lastVolume_(i);return}return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const i=this.isFullscreen_;this.isFullscreen_=!!e,this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const i=this;return new Promise((s,r)=>{function n(){i.off("fullscreenerror",a),i.off("fullscreenchange",o)}function o(){n(),s()}function a(u,d){n(),r(d)}i.one("fullscreenchange",o),i.one("fullscreenerror",a);const l=i.requestFullscreenHelper_(e);l&&(l.then(n,n),l.then(s,r))})}requestFullscreenHelper_(e){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(i=e)),this.fsApi_.requestFullscreen){const s=this.el_[this.fsApi_.requestFullscreen](i);return s&&s.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),s}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((i,s)=>{function r(){e.off("fullscreenerror",o),e.off("fullscreenchange",n)}function n(){r(),i()}function o(l,u){r(),s(u)}e.one("fullscreenchange",n),e.one("fullscreenerror",o);const a=e.exitFullscreenHelper_();a&&(a.then(r,r),a.then(i,s))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=K[this.fsApi_.exitFullscreen]();return e&&ds(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=K.documentElement.style.overflow,mi(K,"keydown",this.boundFullWindowOnEscKey_),K.documentElement.style.overflow="hidden",$r(K.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){he.isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,_t(K,"keydown",this.boundFullWindowOnEscKey_),K.documentElement.style.overflow=this.docOrigOverflow,hh(K.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&F.documentPictureInPicture){const e=K.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(fe("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),F.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(i=>(XS(i),this.el_.parentNode.insertBefore(e,this.el_),i.document.body.appendChild(this.el_),i.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:i}),i.addEventListener("pagehide",s=>{const r=s.target.querySelector(".video-js");e.parentNode.replaceChild(r,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),i))}return"pictureInPictureEnabled"in K&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(F.documentPictureInPicture&&F.documentPictureInPicture.window)return F.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in K)return K.exitPictureInPicture()}handleKeyDown(e){const{userActions:i}=this.options_;!i||!i.hotkeys||(r=>{const n=r.tagName.toLowerCase();if(r.isContentEditable)return!0;const o=["button","checkbox","hidden","radio","reset","submit"];return n==="input"?o.indexOf(r.type)===-1:["textarea"].indexOf(n)!==-1})(this.el_.ownerDocument.activeElement)||(typeof i.hotkeys=="function"?i.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const i=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:s=o=>he.isEventKey(o,"f"),muteKey:r=o=>he.isEventKey(o,"m"),playPauseKey:n=o=>he.isEventKey(o,"k")||he.isEventKey(o,"Space")}=i;if(s.call(this,e)){e.preventDefault(),e.stopPropagation();const o=W.getComponent("FullscreenToggle");K[this.fsApi_.fullscreenEnabled]!==!1&&o.prototype.handleClick.call(this,e)}else r.call(this,e)?(e.preventDefault(),e.stopPropagation(),W.getComponent("MuteToggle").prototype.handleClick.call(this,e)):n.call(this,e)&&(e.preventDefault(),e.stopPropagation(),W.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let i;for(let s=0,r=this.options_.techOrder;s<r.length;s++){const n=r[s];let o=pe.getTech(n);if(o||(o=W.getComponent(n)),!o){ye.error(`The "${n}" tech is undefined. Skipped browser support check for that tech.`);continue}if(o.isSupported()&&(i=o.canPlayType(e),i))return i}return""}selectSource(e){const i=this.options_.techOrder.map(a=>[a,pe.getTech(a)]).filter(([a,l])=>l?l.isSupported():(ye.error(`The "${a}" tech is undefined. Skipped browser support check for that tech.`),!1)),s=function(a,l,u){let d;return a.some(c=>l.some(C=>{if(d=u(c,C),d)return!0})),d};let r;const n=a=>(l,u)=>a(u,l),o=([a,l],u)=>{if(l.canPlaySource(u,this.options_[a.toLowerCase()]))return{source:u,tech:a}};return this.options_.sourceOrder?r=s(e,i,n(o)):r=s(i,e,o),r||!1}handleSrc_(e,i){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const s=gE(e);if(!s.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,i||(this.cache_.sources=s),this.updateSourceCaches_(s[0]),zP(this,s[0],(r,n)=>{if(this.middleware_=n,i||(this.cache_.sources=s),this.updateSourceCaches_(r),this.src_(r)){if(s.length>1)return this.handleSrc_(s.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}$P(n,this.tech_)}),s.length>1){const r=()=>{this.error(null),this.handleSrc_(s.slice(1),!0)},n=()=>{this.off("error",r)};this.one("error",r),this.one("playing",n),this.resetRetryOnError_=()=>{this.off("error",r),this.off("playing",n)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const i=this.selectSource([e]);return i?nE(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();ds(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),Gs(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:i,progressControl:s,remainingTimeDisplay:r}=this.controlBar||{},{seekBar:n}=s||{};e&&e.updateContent(),i&&i.updateContent(),r&&r.updateContent(),n&&(n.update(),n.loadProgressBar&&n.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),i=[];return Object.keys(e).length!==0&&i.push(e),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let i;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),i=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,i=typeof i>"u"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(lr("beforeerror").forEach(i=>{const s=i(this,e);if(!(Es(s)&&!Array.isArray(s)||typeof s=="string"||typeof s=="number"||s===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=s}),this.options_.suppressNotSupportedError&&e&&e.code===4){const i=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Ze(e),this.addClass("vjs-error"),ye.error(`(CODE:${this.error_.code} ${Ze.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),lr("error").forEach(i=>i(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,i,s;const r=Be(this,this.reportUserActivity),n=function(c){(c.screenX!==i||c.screenY!==s)&&(i=c.screenX,s=c.screenY,r())},o=function(){r(),this.clearInterval(e),e=this.setInterval(r,250)},a=function(c){r(),this.clearInterval(e)};this.on("mousedown",o),this.on("mousemove",n),this.on("mouseup",a),this.on("mouseleave",a);const l=this.getChild("controlBar");l&&!Nt&&!ws&&(l.on("mouseenter",function(c){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),l.on("mouseleave",function(c){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",r),this.on("keyup",r);let u;const d=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(u);const c=this.options_.inactivityTimeout;c<=0||(u=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},c))};this.setInterval(d,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),i=this.getChild("ControlBar"),s=i&&i.currentHeight();e.forEach(r=>{r!==i&&r.el_&&!r.hasClass("vjs-hidden")&&(r.hide(),this.audioOnlyCache_.hiddenChildren.push(r))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(s),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,i,s){if(this.tech_)return this.tech_.addTextTrack(e,i,s)}addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)}removeRemoteTextTrack(e={}){let{track:i}=e;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),Gs(this)&&this.trigger("languagechange"))}languages(){return Ve($e.prototype.options_.languages,this.languages_)}toJSON(){const e=Ve(this.options_),i=e.tracks;e.tracks=[];for(let s=0;s<i.length;s++){let r=i[s];r=Ve(r),r.player=void 0,e.tracks[s]=r}return e}createModal(e,i){i=i||{},i.content=e||"";const s=new Wo(this,i);return this.addChild(s),s.on("dispose",()=>{this.removeChild(s)}),s.open(),s}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),i=this.currentWidth();for(let s=0;s<Np.length;s++){const r=Np[s],n=this.breakpoints_[r];if(i<=n){if(e===r)return;e&&this.removeClass(Ju[e]),this.addClass(Ju[r]),this.breakpoint_=r;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},PI,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=!!e;const i=this.responsive_;if(e!==i)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Ju[this.breakpoint_]||""}loadMedia(e,i){if(!e||typeof e!="object")return;const s=this.crossOrigin();this.reset(),this.cache_.media=Ve(e);const{artist:r,artwork:n,description:o,poster:a,src:l,textTracks:u,title:d}=this.cache_.media;!n&&a&&(this.cache_.media.artwork=[{src:a,type:yd(a)}]),s&&this.crossOrigin(s),l&&this.src(l),a&&this.poster(a),Array.isArray(u)&&u.forEach(c=>this.addRemoteTextTrack(c,!1)),this.titleBar&&this.titleBar.update({title:d,description:o||r||""}),this.ready(i)}getMedia(){if(!this.cache_.media){const e=this.poster(),i=this.currentSources(),s=Array.prototype.map.call(this.remoteTextTracks(),n=>({kind:n.kind,label:n.label,language:n.language,src:n.src})),r={src:i,textTracks:s};return e&&(r.poster=e,r.artwork=[{src:r.poster,type:yd(r.poster)}]),r}return Ve(this.cache_.media)}static getTagSettings(e){const i={sources:[],tracks:[]},s=nr(e),r=s["data-setup"];if($a(e,"vjs-fill")&&(s.fill=!0),$a(e,"vjs-fluid")&&(s.fluid=!0),r!==null){const[n,o]=gR(r||"{}");n&&ye.error(n),Object.assign(s,o)}if(Object.assign(i,s),e.hasChildNodes()){const n=e.childNodes;for(let o=0,a=n.length;o<a;o++){const l=n[o],u=l.nodeName.toLowerCase();u==="source"?i.sources.push(nr(l)):u==="track"&&i.tracks.push(nr(l))}}return i}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(i=>typeof i=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Lt.names.forEach(function(t){const e=Lt[t];$e.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});$e.prototype.crossorigin=$e.prototype.crossOrigin;$e.players={};const Ra=F.navigator;$e.prototype.options_={techOrder:pe.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Ra&&(Ra.languages&&Ra.languages[0]||Ra.userLanguage||Ra.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,enableSmoothSeeking:!1};BE.forEach(function(t){$e.prototype[`handleTech${et(t)}_`]=function(){return this.trigger(t)}});W.registerComponent("Player",$e);const Sd="plugin",ro="activePlugins_",Kn={},Ed=t=>Kn.hasOwnProperty(t),Zu=t=>Ed(t)?Kn[t]:void 0,HE=(t,e)=>{t[ro]=t[ro]||{},t[ro][e]=!0},wd=(t,e,i)=>{const s=(i?"before":"")+"pluginsetup";t.trigger(s,e),t.trigger(s+":"+e.name,e)},II=function(t,e){const i=function(){wd(this,{name:t,plugin:e,instance:null},!0);const s=e.apply(this,arguments);return HE(this,t),wd(this,{name:t,plugin:e,instance:s}),s};return Object.keys(e).forEach(function(s){i[s]=e[s]}),i},Nv=(t,e)=>(e.prototype.name=t,function(...i){wd(this,{name:t,plugin:e,instance:null},!0);const s=new e(this,...i);return this[t]=()=>s,wd(this,s.getEventHash()),s});class ei{constructor(e){if(this.constructor===ei)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Jg(this),delete this.trigger,rE(this,this.constructor.defaultState),HE(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,i={}){return Uo(this.eventBusEl_,e,this.getEventHash(i))}handleStateChanged(e){}dispose(){const{name:e,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[ro][e]=!1,this.player=this.state=null,i[e]=Nv(e,Kn[e])}static isBasic(e){const i=typeof e=="string"?Zu(e):e;return typeof i=="function"&&!ei.prototype.isPrototypeOf(i.prototype)}static registerPlugin(e,i){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Ed(e))ye.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if($e.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof i}.`);return Kn[e]=i,e!==Sd&&(ei.isBasic(i)?$e.prototype[e]=II(e,i):$e.prototype[e]=Nv(e,i)),i}static deregisterPlugin(e){if(e===Sd)throw new Error("Cannot de-register base plugin.");Ed(e)&&(delete Kn[e],delete $e.prototype[e])}static getPlugins(e=Object.keys(Kn)){let i;return e.forEach(s=>{const r=Zu(s);r&&(i=i||{},i[s]=r)}),i}static getPluginVersion(e){const i=Zu(e);return i&&i.VERSION||""}}ei.getPlugin=Zu;ei.BASE_PLUGIN_NAME=Sd;ei.registerPlugin(Sd,ei);$e.prototype.usingPlugin=function(t){return!!this[ro]&&this[ro][t]===!0};$e.prototype.hasPlugin=function(t){return!!Ed(t)};function LI(t,e){let i=!1;return function(...s){return i||ye.warn(t),i=!0,e.apply(this,s)}}function ts(t,e,i,s){return LI(`${e} is deprecated and will be removed in ${t}.0; please use ${i} instead.`,s)}var FI={UnsupportedSidxContainer:"unsupported-sidx-container-error",DashManifestSidxParsingError:"dash-manifest-sidx-parsing-error",HlsPlaylistRequestError:"hls-playlist-request-error",SegmentUnsupportedMediaFormat:"segment-unsupported-media-format-error",UnsupportedMediaInitialization:"unsupported-media-initialization-error",SegmentSwitchError:"segment-switch-error",SegmentExceedsSourceBufferQuota:"segment-exceeds-source-buffer-quota-error",SegmentAppendError:"segment-append-error",VttLoadError:"vtt-load-error",VttCueParsingError:"vtt-cue-parsing-error",AdsBeforePrerollError:"ads-before-preroll-error",AdsPrerollError:"ads-preroll-error",AdsMidrollError:"ads-midroll-error",AdsPostrollError:"ads-postroll-error",AdsMacroReplacementFailed:"ads-macro-replacement-failed",AdsResumeContentFailed:"ads-resume-content-failed",EMEFailedToRequestMediaKeySystemAccess:"eme-failed-request-media-key-system-access",EMEFailedToCreateMediaKeys:"eme-failed-create-media-keys",EMEFailedToAttachMediaKeysToVideoElement:"eme-failed-attach-media-keys-to-video",EMEFailedToCreateMediaKeySession:"eme-failed-create-media-key-session",EMEFailedToSetServerCertificate:"eme-failed-set-server-certificate",EMEFailedToGenerateLicenseRequest:"eme-failed-generate-license-request",EMEFailedToUpdateSessionWithReceivedLicenseKeys:"eme-failed-update-session",EMEFailedToCloseSession:"eme-failed-close-session",EMEFailedToRemoveKeysFromSession:"eme-failed-remove-keys",EMEFailedToLoadSessionBySessionId:"eme-failed-load-session"};const UE=t=>t.indexOf("#")===0?t.slice(1):t;function V(t,e,i){let s=V.getPlayer(t);if(s)return e&&ye.warn(`Player "${t}" is already initialised. Options will not be applied.`),i&&s.ready(i),s;const r=typeof t=="string"?ur("#"+UE(t)):t;if(!Ho(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");const o=("getRootNode"in r?r.getRootNode()instanceof F.ShadowRoot:!1)?r.getRootNode():r.ownerDocument.body;(!r.ownerDocument.defaultView||!o.contains(r))&&ye.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(r.parentNode&&r.parentNode.hasAttribute("data-vjs-player")?r.parentNode:r).cloneNode(!0)),lr("beforesetup").forEach(l=>{const u=l(r,Ve(e));if(!Es(u)||Array.isArray(u)){ye.error("please return an object in beforesetup hooks");return}e=Ve(e,u)});const a=W.getComponent("Player");return s=new a(r,e,i),lr("setup").forEach(l=>l(s)),s}V.hooks_=Os;V.hooks=lr;V.hook=gP;V.hookOnce=fP;V.removeHook=xS;if(F.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Bo()){let t=ur(".vjs-styles-defaults");if(!t){t=ZS("vjs-styles-defaults");const e=ur("head");e&&e.insertBefore(t,e.firstChild),eE(t,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}xp(1,V);V.VERSION=wp;V.options=$e.prototype.options_;V.getPlayers=()=>$e.players;V.getPlayer=t=>{const e=$e.players;let i;if(typeof t=="string"){const s=UE(t),r=e[s];if(r)return r;i=ur("#"+s)}else i=t;if(Ho(i)){const{player:s,playerId:r}=i;if(s||e[r])return s||e[r]}};V.getAllPlayers=()=>Object.keys($e.players).map(t=>$e.players[t]).filter(Boolean);V.players=$e.players;V.getComponent=W.getComponent;V.registerComponent=(t,e)=>(pe.isTech(e)&&ye.warn(`The ${t} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),W.registerComponent.call(W,t,e));V.getTech=pe.getTech;V.registerTech=pe.registerTech;V.use=WP;Object.defineProperty(V,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(V.middleware,"TERMINATOR",{value:vd,writeable:!1,enumerable:!0});V.browser=GS;V.obj=vP;V.mergeOptions=ts(9,"videojs.mergeOptions","videojs.obj.merge",Ve);V.defineLazyProperty=ts(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",oh);V.bind=ts(9,"videojs.bind","native Function.prototype.bind",Be);V.registerPlugin=ei.registerPlugin;V.deregisterPlugin=ei.deregisterPlugin;V.plugin=(t,e)=>(ye.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),ei.registerPlugin(t,e));V.getPlugins=ei.getPlugins;V.getPlugin=ei.getPlugin;V.getPluginVersion=ei.getPluginVersion;V.addLanguage=function(t,e){return t=(""+t).toLowerCase(),V.options.languages=Ve(V.options.languages,{[t]:e}),V.options.languages[t]};V.log=ye;V.createLogger=PS;V.time=LP;V.createTimeRange=ts(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Ki);V.createTimeRanges=ts(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Ki);V.formatTime=ts(9,"videojs.formatTime","videojs.time.formatTime",tn);V.setFormatTime=ts(9,"videojs.setFormatTime","videojs.time.setFormatTime",aE);V.resetFormatTime=ts(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",lE);V.parseUrl=ts(9,"videojs.parseUrl","videojs.url.parseUrl",tf);V.isCrossOrigin=ts(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",vh);V.EventTarget=Li;V.any=Qg;V.on=mi;V.one=mh;V.off=_t;V.trigger=Uo;V.xhr=Fy;V.TextTrack=zl;V.AudioTrack=cE;V.VideoTrack=pE;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(t=>{V[t]=function(){return ye.warn(`videojs.${t}() is deprecated; use videojs.dom.${t}() instead`),QS[t].apply(null,arguments)}});V.computedStyle=ts(9,"videojs.computedStyle","videojs.dom.computedStyle",Eo);V.dom=QS;V.fn=DP;V.num=uI;V.str=PP;V.url=HP;V.Error=FI;/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */class MI{constructor(e){let i=this;return i.id=e.id,i.label=i.id,i.width=e.width,i.height=e.height,i.bitrate=e.bandwidth,i.frameRate=e.frameRate,i.enabled_=e.enabled,Object.defineProperty(i,"enabled",{get(){return i.enabled_()},set(s){i.enabled_(s)}}),i}}class Td extends V.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let i=this.getQualityLevelById(e.id);if(i)return i;const s=this.levels_.length;return i=new MI(e),""+s in this||Object.defineProperty(this,s,{get(){return this.levels_[s]}}),this.levels_.push(i),this.trigger({qualityLevel:i,type:"addqualitylevel"}),i}removeQualityLevel(e){let i=null;for(let s=0,r=this.length;s<r;s++)if(this[s]===e){i=this.levels_.splice(s,1)[0],this.selectedIndex_===s?this.selectedIndex_=-1:this.selectedIndex_>s&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),i}getQualityLevelById(e){for(let i=0,s=this.length;i<s;i++){const r=this[i];if(r.id===e)return r}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Td.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const t in Td.prototype.allowedEvents_)Td.prototype["on"+t]=null;var WE="4.1.0";const OI=function(t,e){const i=t.qualityLevels,s=new Td,r=function(){s.dispose(),t.qualityLevels=i,t.off("dispose",r)};return t.on("dispose",r),t.qualityLevels=()=>s,t.qualityLevels.VERSION=WE,s},zE=function(t){return OI(this,V.obj.merge({},t))};V.registerPlugin("qualityLevels",zE);zE.VERSION=WE;/*! @name @videojs/http-streaming @version 3.12.1 @license Apache-2.0 */const qt=Zd,bd=(t,e)=>e&&e.responseURL&&t!==e.responseURL?e.responseURL:t,Ni=t=>V.log.debug?V.log.debug.bind(V,"VHS:",`${t} >`):function(){};function Ie(...t){const e=V.obj||V;return(e.merge||e.mergeOptions).apply(e,t)}function bt(...t){const e=V.time||V;return(e.createTimeRanges||e.createTimeRanges).apply(e,t)}function NI(t){if(t.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let i=0;i<t.length;i++){const s=t.start(i),r=t.end(i);e+=`${s} --> ${r}. Duration (${r-s})
`}return e}const hs=1/30,cs=hs*3,$E=function(t,e){const i=[];let s;if(t&&t.length)for(s=0;s<t.length;s++)e(t.start(s),t.end(s))&&i.push([t.start(s),t.end(s)]);return bt(i)},Yn=function(t,e){return $E(t,function(i,s){return i-cs<=e&&s+cs>=e})},Uu=function(t,e){return $E(t,function(i){return i-hs>=e})},kI=function(t){if(t.length<2)return bt();const e=[];for(let i=1;i<t.length;i++){const s=t.end(i-1),r=t.start(i);e.push([s,r])}return bt(e)},GI=function(t,e){let i=null,s=null,r=0;const n=[],o=[];if(!t||!t.length||!e||!e.length)return bt();let a=t.length;for(;a--;)n.push({time:t.start(a),type:"start"}),n.push({time:t.end(a),type:"end"});for(a=e.length;a--;)n.push({time:e.start(a),type:"start"}),n.push({time:e.end(a),type:"end"});for(n.sort(function(l,u){return l.time-u.time}),a=0;a<n.length;a++)n[a].type==="start"?(r++,r===2&&(i=n[a].time)):n[a].type==="end"&&(r--,r===1&&(s=n[a].time)),i!==null&&s!==null&&(o.push([i,s]),i=null,s=null);return bt(o)},jE=t=>{const e=[];if(!t||!t.length)return"";for(let i=0;i<t.length;i++)e.push(t.start(i)+" => "+t.end(i));return e.join(", ")},VI=function(t,e,i=1){return((t.length?t.end(t.length-1):0)-e)/i},Ur=t=>{const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e},BI=function(t,e){if(t===e)return!1;if(!t&&e||!e&&t||t.length!==e.length)return!0;for(let i=0;i<t.length;i++)if(t.start(i)!==e.start(i)||t.end(i)!==e.end(i))return!0;return!1},$c=function(t){if(!(!t||!t.length||!t.end))return t.end(t.length-1)},Sf=function(t,e){let i=0;if(!t||!t.length)return i;for(let s=0;s<t.length;s++){const r=t.start(s),n=t.end(s);if(!(e>n)){if(e>r&&e<=n){i+=n-e;continue}i+=n-r}}return i},Ef=(t,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(s){i+=s.duration}),(e.preloadHints||[]).forEach(function(s){s.type==="PART"&&(i+=t.partTargetDuration)}),i},kp=t=>(t.segments||[]).reduce((e,i,s)=>(i.parts?i.parts.forEach(function(r,n){e.push({duration:r.duration,segmentIndex:s,partIndex:n,part:r,segment:i})}):e.push({duration:i.duration,segmentIndex:s,partIndex:null,segment:i,part:null}),e),[]),qE=t=>{const e=t.segments&&t.segments.length&&t.segments[t.segments.length-1];return e&&e.parts||[]},KE=({preloadSegment:t})=>{if(!t)return;const{parts:e,preloadHints:i}=t;let s=(i||[]).reduce((r,n)=>r+(n.type==="PART"?1:0),0);return s+=e&&e.length?e.length:0,s},YE=(t,e)=>{if(e.endList)return 0;if(t&&t.suggestedPresentationDelay)return t.suggestedPresentationDelay;const i=qE(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},HI=function(t,e){let i=0,s=e-t.mediaSequence,r=t.segments[s];if(r){if(typeof r.start<"u")return{result:r.start,precise:!0};if(typeof r.end<"u")return{result:r.end-r.duration,precise:!0}}for(;s--;){if(r=t.segments[s],typeof r.end<"u")return{result:i+r.end,precise:!0};if(i+=Ef(t,r),typeof r.start<"u")return{result:i+r.start,precise:!0}}return{result:i,precise:!1}},UI=function(t,e){let i=0,s,r=e-t.mediaSequence;for(;r<t.segments.length;r++){if(s=t.segments[r],typeof s.start<"u")return{result:s.start-i,precise:!0};if(i+=Ef(t,s),typeof s.end<"u")return{result:s.end-i,precise:!0}}return{result:-1,precise:!1}},XE=function(t,e,i){if(typeof e>"u"&&(e=t.mediaSequence+t.segments.length),e<t.mediaSequence)return 0;const s=HI(t,e);if(s.precise)return s.result;const r=UI(t,e);return r.precise?r.result:s.result+i},QE=function(t,e,i){if(!t)return 0;if(typeof i!="number"&&(i=0),typeof e>"u"){if(t.totalDuration)return t.totalDuration;if(!t.endList)return F.Infinity}return XE(t,e,i)},Ka=function({defaultDuration:t,durationList:e,startIndex:i,endIndex:s}){let r=0;if(i>s&&([i,s]=[s,i]),i<0){for(let n=i;n<Math.min(0,s);n++)r+=t;i=0}for(let n=i;n<s;n++)r+=e[n].duration;return r},JE=function(t,e,i,s){if(!t||!t.segments)return null;if(t.endList)return QE(t);if(e===null)return null;e=e||0;let r=XE(t,t.mediaSequence+t.segments.length,e);return i&&(s=typeof s=="number"?s:YE(null,t),r-=s),Math.max(0,r)},WI=function(t,e,i){const r=e||0;let n=JE(t,e,!0,i);return n===null?bt():(n<r&&(n=r),bt(r,n))},zI=function({playlist:t,currentTime:e,startingSegmentIndex:i,startingPartIndex:s,startTime:r,exactManifestTimings:n}){let o=e-r;const a=kp(t);let l=0;for(let u=0;u<a.length;u++){const d=a[u];if(i===d.segmentIndex&&!(typeof s=="number"&&typeof d.partIndex=="number"&&s!==d.partIndex)){l=u;break}}if(o<0){if(l>0)for(let u=l-1;u>=0;u--){const d=a[u];if(o+=d.duration,n){if(o<0)continue}else if(o+hs<=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:r-Ka({defaultDuration:t.targetDuration,durationList:a,startIndex:l,endIndex:u})}}return{partIndex:a[0]&&a[0].partIndex||null,segmentIndex:a[0]&&a[0].segmentIndex||0,startTime:e}}if(l<0){for(let u=l;u<0;u++)if(o-=t.targetDuration,o<0)return{partIndex:a[0]&&a[0].partIndex||null,segmentIndex:a[0]&&a[0].segmentIndex||0,startTime:e};l=0}for(let u=l;u<a.length;u++){const d=a[u];o-=d.duration;const c=d.duration>hs,C=o===0,E=c&&o+hs>=0;if(!((C||E)&&u!==a.length-1)){if(n){if(o>0)continue}else if(o-hs>=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:r+Ka({defaultDuration:t.targetDuration,durationList:a,startIndex:l,endIndex:u})}}}return{segmentIndex:a[a.length-1].segmentIndex,partIndex:a[a.length-1].partIndex,startTime:e}},ZE=function(t){return t.excludeUntil&&t.excludeUntil>Date.now()},wf=function(t){return t.excludeUntil&&t.excludeUntil===1/0},Eh=function(t){const e=ZE(t);return!t.disabled&&!e},$I=function(t){return t.disabled},jI=function(t){for(let e=0;e<t.segments.length;e++)if(t.segments[e].key)return!0;return!1},ew=function(t,e){return e.attributes&&e.attributes[t]},qI=function(t,e,i,s=0){return ew("BANDWIDTH",i)?(t*i.attributes.BANDWIDTH-s*8)/e:NaN},Gp=(t,e)=>{if(t.playlists.length===1)return!0;const i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter(s=>Eh(s)?(s.attributes.BANDWIDTH||0)<i:!1).length===0},Tf=(t,e)=>!t&&!e||!t&&e||t&&!e?!1:!!(t===e||t.id&&e.id&&t.id===e.id||t.resolvedUri&&e.resolvedUri&&t.resolvedUri===e.resolvedUri||t.uri&&e.uri&&t.uri===e.uri),kv=function(t,e){const i=t&&t.mediaGroups&&t.mediaGroups.AUDIO||{};let s=!1;for(const r in i){for(const n in i[r])if(s=e(i[r][n]),s)break;if(s)break}return!!s},Kl=t=>{if(!t||!t.playlists||!t.playlists.length)return kv(t,i=>i.playlists&&i.playlists.length||i.uri);for(let e=0;e<t.playlists.length;e++){const i=t.playlists[e],s=i.attributes&&i.attributes.CODECS;if(!(s&&s.split(",").every(n=>Vy(n))||kv(t,n=>Tf(i,n))))return!1}return!0};var Kt={liveEdgeDelay:YE,duration:QE,seekable:WI,getMediaInfoForTime:zI,isEnabled:Eh,isDisabled:$I,isExcluded:ZE,isIncompatible:wf,playlistEnd:JE,isAes:jI,hasAttribute:ew,estimateSegmentRequestTime:qI,isLowestEnabledRendition:Gp,isAudioOnly:Kl,playlistMatch:Tf,segmentDurationWithParts:Ef};const{log:tw}=V,no=(t,e)=>`${t}-${e}`,iw=(t,e,i)=>`placeholder-uri-${t}-${e}-${i}`,KI=({onwarn:t,oninfo:e,manifestString:i,customTagParsers:s=[],customTagMappers:r=[],llhls:n})=>{const o=new hA;t&&o.on("warn",t),e&&o.on("info",e),s.forEach(u=>o.addParser(u)),r.forEach(u=>o.addTagMapper(u)),o.push(i),o.end();const a=o.manifest;if(n||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(u){a.hasOwnProperty(u)&&delete a[u]}),a.segments&&a.segments.forEach(function(u){["parts","preloadHints"].forEach(function(d){u.hasOwnProperty(d)&&delete u[d]})})),!a.targetDuration){let u=10;a.segments&&a.segments.length&&(u=a.segments.reduce((d,c)=>Math.max(d,c.duration),0)),t&&t({message:`manifest has no targetDuration defaulting to ${u}`}),a.targetDuration=u}const l=qE(a);if(l.length&&!a.partTargetDuration){const u=l.reduce((d,c)=>Math.max(d,c.duration),0);t&&(t({message:`manifest has no partTargetDuration defaulting to ${u}`}),tw.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),a.partTargetDuration=u}return a},jo=(t,e)=>{t.mediaGroups&&["AUDIO","SUBTITLES"].forEach(i=>{if(t.mediaGroups[i])for(const s in t.mediaGroups[i])for(const r in t.mediaGroups[i][s]){const n=t.mediaGroups[i][s][r];e(n,i,s,r)}})},sw=({playlist:t,uri:e,id:i})=>{t.id=i,t.playlistErrors_=0,e&&(t.uri=e),t.attributes=t.attributes||{}},YI=t=>{let e=t.playlists.length;for(;e--;){const i=t.playlists[e];sw({playlist:i,id:no(e,i.uri)}),i.resolvedUri=qt(t.uri,i.uri),t.playlists[i.id]=i,t.playlists[i.uri]=i,i.attributes.BANDWIDTH||tw.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},XI=t=>{jo(t,e=>{e.uri&&(e.resolvedUri=qt(t.uri,e.uri))})},QI=(t,e)=>{const i=no(0,e),s={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:F.location.href,resolvedUri:F.location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return s.playlists[i]=s.playlists[0],s.playlists[e]=s.playlists[0],s},rw=(t,e,i=iw)=>{t.uri=e;for(let r=0;r<t.playlists.length;r++)if(!t.playlists[r].uri){const n=`placeholder-uri-${r}`;t.playlists[r].uri=n}const s=Kl(t);jo(t,(r,n,o,a)=>{if(!r.playlists||!r.playlists.length){if(s&&n==="AUDIO"&&!r.uri)for(let l=0;l<t.playlists.length;l++){const u=t.playlists[l];if(u.attributes&&u.attributes.AUDIO&&u.attributes.AUDIO===o)return}r.playlists=[Di({},r)]}r.playlists.forEach(function(l,u){const d=i(n,o,a,l),c=no(u,d);l.uri?l.resolvedUri=l.resolvedUri||qt(t.uri,l.uri):(l.uri=u===0?d:c,l.resolvedUri=l.uri),l.id=l.id||c,l.attributes=l.attributes||{},t.playlists[l.id]=l,t.playlists[l.uri]=l})}),YI(t),XI(t)};class Gv{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[i]=e;i.programDateTime!==void 0&&(this.offset_=i.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[i]=e,s=i.startDate.getTime();this.trimProcessedDateRanges_(s),this.pendingDateRanges_=e.reduce((r,n)=>(r.set(n.id,n),r),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},i=[];this.pendingDateRanges_.forEach((s,r)=>{if(!this.processedDateRanges_.has(r)&&(s.startTime=s.startDate.getTime()/1e3-this.offset_,s.processDateRange=()=>this.processDateRange(s),i.push(s),!!s.class))if(e[s.class]){const n=e[s.class].push(s);s.classListIndex=n-1}else e[s.class]=[s],s.classListIndex=0});for(const s of i){const r=e[s.class]||[];s.endDate?s.endTime=s.endDate.getTime()/1e3-this.offset_:s.endOnNext&&r[s.classListIndex+1]?s.endTime=r[s.classListIndex+1].startTime:s.duration?s.endTime=s.startTime+s.duration:s.plannedDuration?s.endTime=s.startTime+s.plannedDuration:s.endTime=s.startTime}return i}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((s,r)=>{s.startDate.getTime()<e&&this.processedDateRanges_.delete(r)})}}const{EventTarget:JI}=V,ZI=(t,e)=>{if(e.endList||!e.serverControl)return t;const i={};if(e.serverControl.canBlockReload){const{preloadSegment:s}=e;let r=e.mediaSequence+e.segments.length;if(s){const n=s.parts||[],o=KE(e)-1;o>-1&&o!==n.length-1&&(i._HLS_part=o),(o>-1||n.length)&&r--}i._HLS_msn=r}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){const s=new F.URL(t);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(r){i.hasOwnProperty(r)&&s.searchParams.set(r,i[r])}),t=s.toString()}return t},eL=(t,e)=>{if(!t)return e;const i=Ie(t,e);if(t.preloadHints&&!e.preloadHints&&delete i.preloadHints,t.parts&&!e.parts)delete i.parts;else if(t.parts&&e.parts)for(let s=0;s<e.parts.length;s++)t.parts&&t.parts[s]&&(i.parts[s]=Ie(t.parts[s],e.parts[s]));return!t.skipped&&e.skipped&&(i.skipped=!1),t.preload&&!e.preload&&(i.preload=!1),i},tL=(t,e,i)=>{const s=t.slice(),r=e.slice();i=i||0;const n=[];let o;for(let a=0;a<r.length;a++){const l=s[a+i],u=r[a];l?(o=l.map||o,n.push(eL(l,u))):(o&&!u.map&&(u.map=o),n.push(u))}return n},nw=(t,e)=>{!t.resolvedUri&&t.uri&&(t.resolvedUri=qt(e,t.uri)),t.key&&!t.key.resolvedUri&&(t.key.resolvedUri=qt(e,t.key.uri)),t.map&&!t.map.resolvedUri&&(t.map.resolvedUri=qt(e,t.map.uri)),t.map&&t.map.key&&!t.map.key.resolvedUri&&(t.map.key.resolvedUri=qt(e,t.map.key.uri)),t.parts&&t.parts.length&&t.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=qt(e,i.uri))}),t.preloadHints&&t.preloadHints.length&&t.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=qt(e,i.uri))})},ow=function(t){const e=t.segments||[],i=t.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let s=0;s<i.preloadHints.length;s++)if(i.preloadHints[s].type==="MAP")return e}i.duration=t.targetDuration,i.preload=!0,e.push(i)}return e},aw=(t,e)=>t===e||t.segments&&e.segments&&t.segments.length===e.segments.length&&t.endList===e.endList&&t.mediaSequence===e.mediaSequence&&t.preloadSegment===e.preloadSegment,Vp=(t,e,i=aw)=>{const s=Ie(t,{}),r=s.playlists[e.id];if(!r||i(r,e))return null;e.segments=ow(e);const n=Ie(r,e);if(n.preloadSegment&&!e.preloadSegment&&delete n.preloadSegment,r.segments){if(e.skip){e.segments=e.segments||[];for(let o=0;o<e.skip.skippedSegments;o++)e.segments.unshift({skipped:!0})}n.segments=tL(r.segments,e.segments,e.mediaSequence-r.mediaSequence)}n.segments.forEach(o=>{nw(o,n.resolvedUri)});for(let o=0;o<s.playlists.length;o++)s.playlists[o].id===e.id&&(s.playlists[o]=n);return s.playlists[e.id]=n,s.playlists[e.uri]=n,jo(t,(o,a,l,u)=>{if(o.playlists)for(let d=0;d<o.playlists.length;d++)e.id===o.playlists[d].id&&(o.playlists[d]=n)}),s},Bp=(t,e)=>{const i=t.segments||[],s=i[i.length-1],r=s&&s.parts&&s.parts[s.parts.length-1],n=r&&r.duration||s&&s.duration;return e&&n?n*1e3:(t.partTargetDuration||t.targetDuration||10)*500};class Xn extends JI{constructor(e,i,s={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Ni("PlaylistLoader");const{withCredentials:r=!1}=s;this.src=e,this.vhs_=i,this.withCredentials=r,this.addDateRangesToTextTrack_=s.addDateRangesToTextTrack;const n=i.options_;this.customTagParsers=n&&n.customTagParsers||[],this.customTagMappers=n&&n.customTagMappers||[],this.llhls=n&&n.llhls,this.dateRangesStorage_=new Gv,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const i=this.dateRangesStorage_.getDateRangesToProcess();!i.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(i)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let i=qt(this.main.uri,e.uri);this.llhls&&(i=ZI(i,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials,requestType:"hls-playlist"},(s,r)=>{if(this.request){if(s)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,i,s){const{uri:r,id:n}=i;this.request=null,s&&(this.state=s),this.error={playlist:this.main.playlists[n],status:e.status,message:`HLS playlist request error at URL: ${r}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:{errorType:V.Error.HlsPlaylistRequestError}},this.trigger("error")}parseManifest_({url:e,manifestString:i}){return KI({onwarn:({message:s})=>this.logger_(`m3u8-parser warn for ${e}: ${s}`),oninfo:({message:s})=>this.logger_(`m3u8-parser info for ${e}: ${s}`),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:i,url:s,id:r}){this.request=null,this.state="HAVE_METADATA";const n=i||this.parseManifest_({url:s,manifestString:e});n.lastRequest=Date.now(),sw({playlist:n,uri:s,id:r});const o=Vp(this.main,n);this.targetDuration=n.partTargetDuration||n.targetDuration,this.pendingMedia_=null,o?(this.main=o,this.media_=this.main.playlists[r]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Bp(this.media(),!!o)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),F.clearTimeout(this.mediaUpdateTimeout),F.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new Gv,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,i){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(F.clearTimeout(this.finalRenditionTimeout),i){const o=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=F.setTimeout(this.media.bind(this,e,!1),o);return}const s=this.state,r=!this.media_||e.id!==this.media_.id,n=this.main.playlists[e.id];if(n&&n.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),s==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(Bp(e,!0)),!!r){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(o,a)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=bd(e.resolvedUri,a),o)return this.playlistRequestError(this.request,e,s);this.haveMetadata({playlistString:a.responseText,url:e.uri,id:e.id}),s==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const i=this.media();if(e){const s=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=F.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},s);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=F.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=F.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(e,i)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2,metadata:{errorType:V.Error.HlsPlaylistRequestError}},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=bd(this.src,i);const s=this.parseManifest_({manifestString:i.responseText,url:this.src});this.setupInitialPlaylist(s)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,rw(this.main,this.srcUri()),e.playlists.forEach(s=>{s.segments=ow(s),s.segments.forEach(r=>{nw(r,s.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const i=this.srcUri()||F.location.href;this.main=QI(e,i),this.haveMetadata({playlistObject:e,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,i){const s=this.main,r=e.ID;let n=s.playlists.length;for(;n--;){const o=s.playlists[n];if(o.attributes["PATHWAY-ID"]===r){const a=o.resolvedUri,l=o.id;if(i){const u=this.createCloneURI_(o.resolvedUri,e),d=no(r,u),c=this.createCloneAttributes_(r,o.attributes),C=this.createClonePlaylist_(o,d,e,c);s.playlists[n]=C,s.playlists[d]=C,s.playlists[u]=C}else s.playlists.splice(n,1);delete s.playlists[l],delete s.playlists[a]}}this.updateOrDeleteCloneMedia(e,i)}updateOrDeleteCloneMedia(e,i){const s=this.main,r=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(n=>{if(!(!s.mediaGroups[n]||!s.mediaGroups[n][r])){for(const o in s.mediaGroups[n])if(o===r){for(const a in s.mediaGroups[n][o])s.mediaGroups[n][o][a].playlists.forEach((u,d)=>{const c=s.playlists[u.id],C=c.id,E=c.resolvedUri;delete s.playlists[C],delete s.playlists[E]});delete s.mediaGroups[n][o]}}}),i&&this.createClonedMediaGroups_(e)}addClonePathway(e,i={}){const s=this.main,r=s.playlists.length,n=this.createCloneURI_(i.resolvedUri,e),o=no(e.ID,n),a=this.createCloneAttributes_(e.ID,i.attributes),l=this.createClonePlaylist_(i,o,e,a);s.playlists[r]=l,s.playlists[o]=l,s.playlists[n]=l,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const i=e.ID,s=e["BASE-ID"],r=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(n=>{if(!(!r.mediaGroups[n]||r.mediaGroups[n][i]))for(const o in r.mediaGroups[n]){if(o===s)r.mediaGroups[n][i]={};else continue;for(const a in r.mediaGroups[n][o]){const l=r.mediaGroups[n][o][a];r.mediaGroups[n][i][a]=Di({},l);const u=r.mediaGroups[n][i][a],d=this.createCloneURI_(l.resolvedUri,e);u.resolvedUri=d,u.uri=d,u.playlists=[],l.playlists.forEach((c,C)=>{const E=r.playlists[c.id],y=iw(n,i,a),_=no(i,y);if(E&&!r.playlists[_]){const b=this.createClonePlaylist_(E,_,e),R=b.resolvedUri;r.playlists[_]=b,r.playlists[R]=b}u.playlists[C]=this.createClonePlaylist_(c,_,e)})}}})}createClonePlaylist_(e,i,s,r){const n=this.createCloneURI_(e.resolvedUri,s),o={resolvedUri:n,uri:n,id:i};return e.segments&&(o.segments=[]),r&&(o.attributes=r),Ie(e,o)}createCloneURI_(e,i){const s=new URL(e);s.hostname=i["URI-REPLACEMENT"].HOST;const r=i["URI-REPLACEMENT"].PARAMS;for(const n of Object.keys(r))s.searchParams.set(n,r[n]);return s.href}createCloneAttributes_(e,i){const s={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(r=>{i[r]&&(s[r]=e)}),s}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const s in e.contentProtection){const r=e.contentProtection[s].attributes.keyId;r&&i.add(r.toLowerCase())}return i}}}const Hp=function(t,e,i,s){const r=t.responseType==="arraybuffer"?t.response:t.responseText;!e&&r&&(t.responseTime=Date.now(),t.roundTripTime=t.responseTime-t.requestTime,t.bytesReceived=r.byteLength||r.length,t.bandwidth||(t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3))),i.headers&&(t.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(t.timedout=!0),!e&&!t.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(t&&(r||t.responseText)))),s(e,t)},iL=(t,e)=>{if(!t||!t.size)return;let i=e;return t.forEach(s=>{i=s(i)}),i},sL=(t,e,i,s)=>{!t||!t.size||t.forEach(r=>{r(e,i,s)})},lw=function(){const t=function e(i,s){i=Ie({timeout:45e3},i);const r=e.beforeRequest||V.Vhs.xhr.beforeRequest,n=e._requestCallbackSet||V.Vhs.xhr._requestCallbackSet||new Set,o=e._responseCallbackSet||V.Vhs.xhr._responseCallbackSet;r&&typeof r=="function"&&(V.log.warn("beforeRequest is deprecated, use onRequest instead."),n.add(r));const a=V.Vhs.xhr.original===!0?V.xhr:V.Vhs.xhr,l=iL(n,i);n.delete(r);const u=a(l||i,function(c,C){return sL(o,u,c,C),Hp(u,c,C,s)}),d=u.abort;return u.abort=function(){return u.aborted=!0,d.apply(u,arguments)},u.uri=i.uri,u.requestTime=Date.now(),u};return t.original=!0,t},rL=function(t){let e;const i=t.offset;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=F.BigInt(t.offset)+F.BigInt(t.length)-F.BigInt(1):e=t.offset+t.length-1,"bytes="+i+"-"+e},Up=function(t){const e={};return t.byterange&&(e.Range=rL(t.byterange)),e},nL=function(t,e){return t.start(e)+"-"+t.end(e)},oL=function(t,e){const i=t.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},aL=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},uw=function(t){const e={};return Object.keys(t).forEach(i=>{const s=t[i];Hy(s)?e[i]={bytes:s.buffer,byteOffset:s.byteOffset,byteLength:s.byteLength}:e[i]=s}),e},_d=function(t){const e=t.byterange||{length:1/0,offset:0};return[e.length,e.offset,t.resolvedUri].join(",")},dw=function(t){return t.resolvedUri},hw=t=>{const e=Array.prototype.slice.call(t),i=16;let s="",r,n;for(let o=0;o<e.length/i;o++)r=e.slice(o*i,o*i+i).map(oL).join(""),n=e.slice(o*i,o*i+i).map(aL).join(""),s+=r+" "+n+`
`;return s},lL=({bytes:t})=>hw(t),uL=t=>{let e="",i;for(i=0;i<t.length;i++)e+=nL(t,i)+" ";return e};var dL=Object.freeze({__proto__:null,createTransferableMessage:uw,initSegmentId:_d,segmentKeyId:dw,hexDump:hw,tagDump:lL,textRanges:uL});const cw=.25,hL=(t,e)=>{if(!e.dateTimeObject)return null;const i=e.videoTimingInfo.transmuxerPrependedSeconds,r=e.videoTimingInfo.transmuxedPresentationStart+i,n=t-r;return new Date(e.dateTimeObject.getTime()+n*1e3)},cL=t=>t.transmuxedPresentationEnd-t.transmuxedPresentationStart-t.transmuxerPrependedSeconds,pL=(t,e)=>{let i;try{i=new Date(t)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let s=e.segments[0];if(i<new Date(s.dateTimeObject))return null;for(let l=0;l<e.segments.length-1;l++){s=e.segments[l];const u=new Date(e.segments[l+1].dateTimeObject);if(i<u)break}const r=e.segments[e.segments.length-1],n=r.dateTimeObject,o=r.videoTimingInfo?cL(r.videoTimingInfo):r.duration+r.duration*cw,a=new Date(n.getTime()+o*1e3);return i>a?null:(i>new Date(n)&&(s=r),{segment:s,estimatedStart:s.videoTimingInfo?s.videoTimingInfo.transmuxedPresentationStart:Kt.duration(e,e.mediaSequence+e.segments.indexOf(s)),type:s.videoTimingInfo?"accurate":"estimate"})},gL=(t,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let i=0,s;for(let n=0;n<e.segments.length&&(s=e.segments[n],i=s.videoTimingInfo?s.videoTimingInfo.transmuxedPresentationEnd:i+s.duration,!(t<=i));n++);const r=e.segments[e.segments.length-1];if(r.videoTimingInfo&&r.videoTimingInfo.transmuxedPresentationEnd<t)return null;if(t>i){if(t>i+r.duration*cw)return null;s=r}return{segment:s,estimatedStart:s.videoTimingInfo?s.videoTimingInfo.transmuxedPresentationStart:i-s.duration,type:s.videoTimingInfo?"accurate":"estimate"}},fL=(t,e)=>{let i,s;try{i=new Date(t),s=new Date(e)}catch{}const r=i.getTime();return(s.getTime()-r)/1e3},mL=t=>{if(!t.segments||t.segments.length===0)return!1;for(let e=0;e<t.segments.length;e++)if(!t.segments[e].dateTimeObject)return!1;return!0},CL=({playlist:t,time:e=void 0,callback:i})=>{if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||e===void 0)return i({message:"getProgramTime: playlist and time must be provided"});const s=gL(e,t);if(!s)return i({message:"valid programTime was not found"});if(s.type==="estimate")return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart});const r={mediaSeconds:e},n=hL(e,s.segment);return n&&(r.programDateTime=n.toISOString()),i(null,r)},pw=({programTime:t,playlist:e,retryCount:i=2,seekTo:s,pauseAfterSeek:r=!0,tech:n,callback:o})=>{if(!o)throw new Error("seekToProgramTime: callback must be provided");if(typeof t>"u"||!e||!s)return o({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!n.hasStarted_)return o({message:"player must be playing a live stream to start buffering"});if(!mL(e))return o({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const a=pL(t,e);if(!a)return o({message:`${t} was not found in the stream`});const l=a.segment,u=fL(l.dateTimeObject,t);if(a.type==="estimate"){if(i===0)return o({message:`${t} is not buffered yet. Try again`});s(a.estimatedStart+u),n.one("seeked",()=>{pw({programTime:t,playlist:e,retryCount:i-1,seekTo:s,pauseAfterSeek:r,tech:n,callback:o})});return}const d=l.start+u,c=()=>o(null,n.currentTime());n.one("seeked",c),r&&n.pause(),s(d)},jc=(t,e)=>{if(t.readyState===4)return e()},vL=(t,e,i)=>{let s=[],r,n=!1;const o=function(d,c,C,E){return c.abort(),n=!0,i(d,c,C,E)},a=function(d,c){if(n)return;if(d)return o(d,c,"",s);const C=c.responseText.substring(s&&s.byteLength||0,c.responseText.length);if(s=TA(s,Uy(C,!0)),r=r||Ma(s),s.length<10||r&&s.length<r+2)return jc(c,()=>o(d,c,"",s));const E=Ug(s);return E==="ts"&&s.length<188?jc(c,()=>o(d,c,"",s)):!E&&s.length<376?jc(c,()=>o(d,c,"",s)):o(null,c,E,s)},u=e({uri:t,beforeSend(d){d.overrideMimeType("text/plain; charset=x-user-defined"),d.addEventListener("progress",function({total:c,loaded:C}){return Hp(d,null,{statusCode:d.status},a)})}},function(d,c){return Hp(u,d,c,a)});return u},{EventTarget:yL}=V,Vv=function(t,e){if(!aw(t,e)||t.sidx&&e.sidx&&(t.sidx.offset!==e.sidx.offset||t.sidx.length!==e.sidx.length))return!1;if(!t.sidx&&e.sidx||t.sidx&&!e.sidx||t.segments&&!e.segments||!t.segments&&e.segments)return!1;if(!t.segments&&!e.segments)return!0;for(let i=0;i<t.segments.length;i++){const s=t.segments[i],r=e.segments[i];if(s.uri!==r.uri)return!1;if(!s.byterange&&!r.byterange)continue;const n=s.byterange,o=r.byterange;if(n&&!o||!n&&o||n.offset!==o.offset||n.length!==o.length)return!1}return!0},SL=(t,e,i,s)=>{const r=s.attributes.NAME||i;return`placeholder-uri-${t}-${e}-${r}`},EL=({mainXml:t,srcUrl:e,clientOffset:i,sidxMapping:s,previousManifest:r})=>{const n=jx(t,{manifestUri:e,clientOffset:i,sidxMapping:s,previousManifest:r});return rw(n,e,SL),n},wL=(t,e)=>{jo(t,(i,s,r,n)=>{n in e.mediaGroups[s][r]||delete t.mediaGroups[s][r][n]})},TL=(t,e,i)=>{let s=!0,r=Ie(t,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let n=0;n<e.playlists.length;n++){const o=e.playlists[n];if(o.sidx){const l=sh(o.sidx);i&&i[l]&&i[l].sidx&&Vg(o,i[l].sidx,o.sidx.resolvedUri)}const a=Vp(r,o,Vv);a&&(r=a,s=!1)}return jo(e,(n,o,a,l)=>{if(n.playlists&&n.playlists.length){const u=n.playlists[0].id,d=Vp(r,n.playlists[0],Vv);d&&(r=d,l in r.mediaGroups[o][a]||(r.mediaGroups[o][a][l]=n),r.mediaGroups[o][a][l].playlists[0]=r.playlists[u],s=!1)}}),wL(r,e),e.minimumUpdatePeriod!==t.minimumUpdatePeriod&&(s=!1),s?null:r},bL=(t,e)=>(!t.map&&!e.map||!!(t.map&&e.map&&t.map.byterange.offset===e.map.byterange.offset&&t.map.byterange.length===e.map.byterange.length))&&t.uri===e.uri&&t.byterange.offset===e.byterange.offset&&t.byterange.length===e.byterange.length,Bv=(t,e)=>{const i={};for(const s in t){const n=t[s].sidx;if(n){const o=sh(n);if(!e[o])break;const a=e[o].sidxInfo;bL(a,n)&&(i[o]=e[o])}}return i},_L=(t,e)=>{let s=Bv(t.playlists,e);return jo(t,(r,n,o,a)=>{if(r.playlists&&r.playlists.length){const l=r.playlists;s=Ie(s,Bv(l,e))}}),s};class Wp extends yL{constructor(e,i,s={},r){super(),this.mainPlaylistLoader_=r||this,r||(this.isMain_=!0);const{withCredentials:n=!1}=s;if(this.vhs_=i,this.withCredentials=n,this.addMetadataToTextTrack=s.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Ni("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,i,s){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2,metadata:e.metadata},s&&(this.state=s),this.trigger("error"),!0}addSidxSegments_(e,i,s){const r=e.sidx&&sh(e.sidx);if(!e.sidx||!r||this.mainPlaylistLoader_.sidxMapping_[r]){this.mediaRequest_=F.setTimeout(()=>s(!1),0);return}const n=bd(e.sidx.resolvedUri),o=(a,l)=>{if(this.requestErrored_(a,l,i))return;const u=this.mainPlaylistLoader_.sidxMapping_;let d;try{d=Jx(se(l.response).subarray(8))}catch(c){c.metadata={errorType:V.Error.DashManifestSidxParsingError},this.requestErrored_(c,l,i);return}return u[r]={sidxInfo:e.sidx,sidx:d},Vg(e,d,e.sidx.resolvedUri),s(!0)};this.request=vL(n,this.vhs_.xhr,(a,l,u,d)=>{if(a)return o(a,l);if(!u||u!=="mp4"){const E=u||"unknown";return o({status:l.status,message:`Unsupported ${E} container type for sidx segment at URL: ${n}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2,metadata:{errorType:V.Error.UnsupportedSidxContainer,sidxContainer:E}},l)}const{offset:c,length:C}=e.sidx.byterange;if(d.length>=C+c)return o(a,{response:d.subarray(c,c+C),status:l.status,uri:l.uri});this.request=this.vhs_.xhr({uri:n,responseType:"arraybuffer",headers:Up({byterange:e.sidx.byterange})},o)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},F.clearTimeout(this.minimumUpdatePeriodTimeout_),F.clearTimeout(this.mediaRequest_),F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const s=!this.media_||e.id!==this.media_.id;if(s&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,s&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}s&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,i,r=>{this.haveMetadata({startingState:i,playlist:e})}))}haveMetadata({startingState:e,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(F.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){F.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const i=this.media();if(e){const s=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=F.setTimeout(()=>this.load(),s);return}if(!this.started){this.start();return}i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=F.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,i)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(i,s)=>{if(this.requestErrored_(i,s)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const r=s.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=s.responseText,s.responseHeaders&&s.responseHeaders.date?this.mainLoaded_=Date.parse(s.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=bd(this.mainPlaylistLoader_.srcUrl,s),r){this.handleMain_(),this.syncClientServerClock_(()=>e(s,r));return}return e(s,r)})}syncClientServerClock_(e){const i=qx(this.mainPlaylistLoader_.mainXml_);if(i===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(i.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),e();this.request=this.vhs_.xhr({uri:qt(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(s,r)=>{if(!this.request)return;if(s)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let n;i.method==="HEAD"?!r.responseHeaders||!r.responseHeaders.date?n=this.mainLoaded_:n=Date.parse(r.responseHeaders.date):n=Date.parse(r.responseText),this.mainPlaylistLoader_.clientOffset_=n-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let i=EL({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(i=TL(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const s=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return s&&s!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=s),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),!!i}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(F.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let i=e.main&&e.main.minimumUpdatePeriod;if(i===0&&(e.media()?i=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof i!="number"||i<=0){i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`);return}this.createMUPTimeout_(i)}createMUPTimeout_(e){const i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=F.setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,i)=>{i&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=_L(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,s=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const i=this.mainPlaylistLoader_.main.playlists,s=!this.media_||this.media_!==i[e];if(s?this.media_=i[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const r=()=>{this.media().endList||(this.mediaUpdateTimeout=F.setTimeout(()=>{this.trigger("mediaupdatetimeout"),r()},Bp(this.media(),!!s)))};r()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const i=this.mainPlaylistLoader_.main.eventStream.map(s=>({cueTime:s.start,frames:[{data:s.messageData}]}));this.addMetadataToTextTrack("EventStream",i,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const s in e.contentProtection){const r=e.contentProtection[s].attributes["cenc:default_KID"];r&&i.add(r.replace(/-/g,"").toLowerCase())}return i}}}var ft={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const DL=t=>{const e=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e.buffer},gw=function(t){return t.on=t.addEventListener,t.off=t.removeEventListener,t},RL=function(t){try{return URL.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch{const i=new BlobBuilder;return i.append(t),URL.createObjectURL(i.getBlob())}},fw=function(t){return function(){const e=RL(t),i=gw(new Worker(e));i.objURL=e;const s=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),s.call(this)},i}},mw=function(t){return`var browserWorkerPolyFill = ${gw.toString()};
browserWorkerPolyFill(self);
`+t},Cw=function(t){return t.toString().replace(/^function.+?{/,"").slice(0,-1)},AL=mw(Cw(function(){var t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var h={};this.on=function(p,m){h[p]||(h[p]=[]),h[p]=h[p].concat(m)},this.off=function(p,m){var f;return h[p]?(f=h[p].indexOf(m),h[p]=h[p].slice(),h[p].splice(f,1),f>-1):!1},this.trigger=function(p){var m,f,v,w;if(m=h[p],!!m)if(arguments.length===2)for(v=m.length,f=0;f<v;++f)m[f].call(this,arguments[1]);else{for(w=[],f=arguments.length,f=1;f<arguments.length;++f)w.push(arguments[f]);for(v=m.length,f=0;f<v;++f)m[f].apply(this,w)}},this.dispose=function(){h={}}}};e.prototype.pipe=function(h){return this.on("data",function(p){h.push(p)}),this.on("done",function(p){h.flush(p)}),this.on("partialdone",function(p){h.partialFlush(p)}),this.on("endedtimeline",function(p){h.endTimeline(p)}),this.on("reset",function(p){h.reset(p)}),h},e.prototype.push=function(h){this.trigger("data",h)},e.prototype.flush=function(h){this.trigger("done",h)},e.prototype.partialFlush=function(h){this.trigger("partialdone",h)},e.prototype.endTimeline=function(h){this.trigger("endedtimeline",h)},e.prototype.reset=function(h){this.trigger("reset",h)};var i=e,s=Math.pow(2,32),r=function(h){var p=new DataView(h.buffer,h.byteOffset,h.byteLength),m;return p.getBigUint64?(m=p.getBigUint64(0),m<Number.MAX_SAFE_INTEGER?Number(m):m):p.getUint32(0)*s+p.getUint32(4)},n={getUint64:r,MAX_UINT32:s},o=n.MAX_UINT32,a,l,u,d,c,C,E,y,_,b,R,D,O,L,I,k,H,ee,Q,Ce,le,be,Z,Ee,xt,Re,it,Ps,_r,Dr,Rr,Ar,hu,xm,Pm,Im;(function(){var h;if(Z={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(h in Z)Z.hasOwnProperty(h)&&(Z[h]=[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]);Ee=new Uint8Array([105,115,111,109]),Re=new Uint8Array([97,118,99,49]),xt=new Uint8Array([0,0,0,1]),it=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Ps=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),_r={video:it,audio:Ps},Ar=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Rr=new Uint8Array([0,0,0,0,0,0,0,0]),hu=new Uint8Array([0,0,0,0,0,0,0,0]),xm=hu,Pm=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Im=hu,Dr=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),a=function(h){var p=[],m=0,f,v,w;for(f=1;f<arguments.length;f++)p.push(arguments[f]);for(f=p.length;f--;)m+=p[f].byteLength;for(v=new Uint8Array(m+8),w=new DataView(v.buffer,v.byteOffset,v.byteLength),w.setUint32(0,v.byteLength),v.set(h,4),f=0,m=8;f<p.length;f++)v.set(p[f],m),m+=p[f].byteLength;return v},l=function(){return a(Z.dinf,a(Z.dref,Ar))},u=function(h){return a(Z.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,h.audioobjecttype<<3|h.samplingfrequencyindex>>>1,h.samplingfrequencyindex<<7|h.channelcount<<3,6,1,2]))},d=function(){return a(Z.ftyp,Ee,xt,Ee,Re)},k=function(h){return a(Z.hdlr,_r[h])},c=function(h){return a(Z.mdat,h)},I=function(h){var p=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,h.duration>>>24&255,h.duration>>>16&255,h.duration>>>8&255,h.duration&255,85,196,0,0]);return h.samplerate&&(p[12]=h.samplerate>>>24&255,p[13]=h.samplerate>>>16&255,p[14]=h.samplerate>>>8&255,p[15]=h.samplerate&255),a(Z.mdhd,p)},L=function(h){return a(Z.mdia,I(h),k(h.type),E(h))},C=function(h){return a(Z.mfhd,new Uint8Array([0,0,0,0,(h&4278190080)>>24,(h&16711680)>>16,(h&65280)>>8,h&255]))},E=function(h){return a(Z.minf,h.type==="video"?a(Z.vmhd,Dr):a(Z.smhd,Rr),l(),ee(h))},y=function(h,p){for(var m=[],f=p.length;f--;)m[f]=Ce(p[f]);return a.apply(null,[Z.moof,C(h)].concat(m))},_=function(h){for(var p=h.length,m=[];p--;)m[p]=D(h[p]);return a.apply(null,[Z.moov,R(4294967295)].concat(m).concat(b(h)))},b=function(h){for(var p=h.length,m=[];p--;)m[p]=le(h[p]);return a.apply(null,[Z.mvex].concat(m))},R=function(h){var p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(h&4278190080)>>24,(h&16711680)>>16,(h&65280)>>8,h&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a(Z.mvhd,p)},H=function(h){var p=h.samples||[],m=new Uint8Array(4+p.length),f,v;for(v=0;v<p.length;v++)f=p[v].flags,m[v+4]=f.dependsOn<<4|f.isDependedOn<<2|f.hasRedundancy;return a(Z.sdtp,m)},ee=function(h){return a(Z.stbl,Q(h),a(Z.stts,Im),a(Z.stsc,xm),a(Z.stsz,Pm),a(Z.stco,hu))},function(){var h,p;Q=function(m){return a(Z.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),m.type==="video"?h(m):p(m))},h=function(m){var f=m.sps||[],v=m.pps||[],w=[],A=[],x,P;for(x=0;x<f.length;x++)w.push((f[x].byteLength&65280)>>>8),w.push(f[x].byteLength&255),w=w.concat(Array.prototype.slice.call(f[x]));for(x=0;x<v.length;x++)A.push((v[x].byteLength&65280)>>>8),A.push(v[x].byteLength&255),A=A.concat(Array.prototype.slice.call(v[x]));if(P=[Z.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(m.width&65280)>>8,m.width&255,(m.height&65280)>>8,m.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a(Z.avcC,new Uint8Array([1,m.profileIdc,m.profileCompatibility,m.levelIdc,255].concat([f.length],w,[v.length],A))),a(Z.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],m.sarRatio){var M=m.sarRatio[0],G=m.sarRatio[1];P.push(a(Z.pasp,new Uint8Array([(M&4278190080)>>24,(M&16711680)>>16,(M&65280)>>8,M&255,(G&4278190080)>>24,(G&16711680)>>16,(G&65280)>>8,G&255])))}return a.apply(null,P)},p=function(m){return a(Z.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(m.channelcount&65280)>>8,m.channelcount&255,(m.samplesize&65280)>>8,m.samplesize&255,0,0,0,0,(m.samplerate&65280)>>8,m.samplerate&255,0,0]),u(m))}}(),O=function(h){var p=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,0,(h.duration&4278190080)>>24,(h.duration&16711680)>>16,(h.duration&65280)>>8,h.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(h.width&65280)>>8,h.width&255,0,0,(h.height&65280)>>8,h.height&255,0,0]);return a(Z.tkhd,p)},Ce=function(h){var p,m,f,v,w,A,x;return p=a(Z.tfhd,new Uint8Array([0,0,0,58,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),A=Math.floor(h.baseMediaDecodeTime/o),x=Math.floor(h.baseMediaDecodeTime%o),m=a(Z.tfdt,new Uint8Array([1,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255,x>>>24&255,x>>>16&255,x>>>8&255,x&255])),w=92,h.type==="audio"?(f=be(h,w),a(Z.traf,p,m,f)):(v=H(h),f=be(h,v.length+w),a(Z.traf,p,m,f,v))},D=function(h){return h.duration=h.duration||4294967295,a(Z.trak,O(h),L(h))},le=function(h){var p=new Uint8Array([0,0,0,0,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.type!=="video"&&(p[p.length-1]=0),a(Z.trex,p)},function(){var h,p,m;m=function(f,v){var w=0,A=0,x=0,P=0;return f.length&&(f[0].duration!==void 0&&(w=1),f[0].size!==void 0&&(A=2),f[0].flags!==void 0&&(x=4),f[0].compositionTimeOffset!==void 0&&(P=8)),[0,0,w|A|x|P,1,(f.length&4278190080)>>>24,(f.length&16711680)>>>16,(f.length&65280)>>>8,f.length&255,(v&4278190080)>>>24,(v&16711680)>>>16,(v&65280)>>>8,v&255]},p=function(f,v){var w,A,x,P,M,G;for(P=f.samples||[],v+=20+16*P.length,x=m(P,v),A=new Uint8Array(x.length+P.length*16),A.set(x),w=x.length,G=0;G<P.length;G++)M=P[G],A[w++]=(M.duration&4278190080)>>>24,A[w++]=(M.duration&16711680)>>>16,A[w++]=(M.duration&65280)>>>8,A[w++]=M.duration&255,A[w++]=(M.size&4278190080)>>>24,A[w++]=(M.size&16711680)>>>16,A[w++]=(M.size&65280)>>>8,A[w++]=M.size&255,A[w++]=M.flags.isLeading<<2|M.flags.dependsOn,A[w++]=M.flags.isDependedOn<<6|M.flags.hasRedundancy<<4|M.flags.paddingValue<<1|M.flags.isNonSyncSample,A[w++]=M.flags.degradationPriority&61440,A[w++]=M.flags.degradationPriority&15,A[w++]=(M.compositionTimeOffset&4278190080)>>>24,A[w++]=(M.compositionTimeOffset&16711680)>>>16,A[w++]=(M.compositionTimeOffset&65280)>>>8,A[w++]=M.compositionTimeOffset&255;return a(Z.trun,A)},h=function(f,v){var w,A,x,P,M,G;for(P=f.samples||[],v+=20+8*P.length,x=m(P,v),w=new Uint8Array(x.length+P.length*8),w.set(x),A=x.length,G=0;G<P.length;G++)M=P[G],w[A++]=(M.duration&4278190080)>>>24,w[A++]=(M.duration&16711680)>>>16,w[A++]=(M.duration&65280)>>>8,w[A++]=M.duration&255,w[A++]=(M.size&4278190080)>>>24,w[A++]=(M.size&16711680)>>>16,w[A++]=(M.size&65280)>>>8,w[A++]=M.size&255;return a(Z.trun,w)},be=function(f,v){return f.type==="audio"?h(f,v):p(f,v)}}();var xb={ftyp:d,mdat:c,moof:y,moov:_,initSegment:function(h){var p=d(),m=_(h),f;return f=new Uint8Array(p.byteLength+m.byteLength),f.set(p),f.set(m,p.byteLength),f}},Pb=function(h){var p,m,f=[],v=[];for(v.byteLength=0,v.nalCount=0,v.duration=0,f.byteLength=0,p=0;p<h.length;p++)m=h[p],m.nalUnitType==="access_unit_delimiter_rbsp"?(f.length&&(f.duration=m.dts-f.dts,v.byteLength+=f.byteLength,v.nalCount+=f.length,v.duration+=f.duration,v.push(f)),f=[m],f.byteLength=m.data.byteLength,f.pts=m.pts,f.dts=m.dts):(m.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(f.keyFrame=!0),f.duration=m.dts-f.dts,f.byteLength+=m.data.byteLength,f.push(m));return v.length&&(!f.duration||f.duration<=0)&&(f.duration=v[v.length-1].duration),v.byteLength+=f.byteLength,v.nalCount+=f.length,v.duration+=f.duration,v.push(f),v},Ib=function(h){var p,m,f=[],v=[];for(f.byteLength=0,f.nalCount=0,f.duration=0,f.pts=h[0].pts,f.dts=h[0].dts,v.byteLength=0,v.nalCount=0,v.duration=0,v.pts=h[0].pts,v.dts=h[0].dts,p=0;p<h.length;p++)m=h[p],m.keyFrame?(f.length&&(v.push(f),v.byteLength+=f.byteLength,v.nalCount+=f.nalCount,v.duration+=f.duration),f=[m],f.nalCount=m.length,f.byteLength=m.byteLength,f.pts=m.pts,f.dts=m.dts,f.duration=m.duration):(f.duration+=m.duration,f.nalCount+=m.length,f.byteLength+=m.byteLength,f.push(m));return v.length&&f.duration<=0&&(f.duration=v[v.length-1].duration),v.byteLength+=f.byteLength,v.nalCount+=f.nalCount,v.duration+=f.duration,v.push(f),v},Lb=function(h){var p;return!h[0][0].keyFrame&&h.length>1&&(p=h.shift(),h.byteLength-=p.byteLength,h.nalCount-=p.nalCount,h[0][0].dts=p.dts,h[0][0].pts=p.pts,h[0][0].duration+=p.duration),h},Fb=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Lm=function(h,p){var m=Fb();return m.dataOffset=p,m.compositionTimeOffset=h.pts-h.dts,m.duration=h.duration,m.size=4*h.length,m.size+=h.byteLength,h.keyFrame&&(m.flags.dependsOn=2,m.flags.isNonSyncSample=0),m},Mb=function(h,p){var m,f,v,w,A,x=p||0,P=[];for(m=0;m<h.length;m++)for(w=h[m],f=0;f<w.length;f++)A=w[f],v=Lm(A,x),x+=v.size,P.push(v);return P},Ob=function(h){var p,m,f,v,w,A,x=0,P=h.byteLength,M=h.nalCount,G=P+4*M,B=new Uint8Array(G),X=new DataView(B.buffer);for(p=0;p<h.length;p++)for(v=h[p],m=0;m<v.length;m++)for(w=v[m],f=0;f<w.length;f++)A=w[f],X.setUint32(x,A.data.byteLength),x+=4,B.set(A.data,x),x+=A.data.byteLength;return B},Nb=function(h,p){var m,f=p||0,v=[];return m=Lm(h,f),v.push(m),v},kb=function(h){var p,m,f=0,v=h.byteLength,w=h.length,A=v+4*w,x=new Uint8Array(A),P=new DataView(x.buffer);for(p=0;p<h.length;p++)m=h[p],P.setUint32(f,m.data.byteLength),f+=4,x.set(m.data,f),f+=m.data.byteLength;return x},Gb={groupNalsIntoFrames:Pb,groupFramesIntoGops:Ib,extendFirstKeyFrame:Lb,generateSampleTable:Mb,concatenateNalData:Ob,generateSampleTableForFrame:Nb,concatenateNalDataForFrame:kb},Zs=[33,16,5,32,164,27],tc=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Fe=function(h){for(var p=[];h--;)p.push(0);return p},Vb=function(h){return Object.keys(h).reduce(function(p,m){return p[m]=new Uint8Array(h[m].reduce(function(f,v){return f.concat(v)},[])),p},{})},ic,Bb=function(){if(!ic){var h={96e3:[Zs,[227,64],Fe(154),[56]],88200:[Zs,[231],Fe(170),[56]],64e3:[Zs,[248,192],Fe(240),[56]],48e3:[Zs,[255,192],Fe(268),[55,148,128],Fe(54),[112]],44100:[Zs,[255,192],Fe(268),[55,163,128],Fe(84),[112]],32e3:[Zs,[255,192],Fe(268),[55,234],Fe(226),[112]],24e3:[Zs,[255,192],Fe(268),[55,255,128],Fe(268),[111,112],Fe(126),[224]],16e3:[Zs,[255,192],Fe(268),[55,255,128],Fe(268),[111,255],Fe(269),[223,108],Fe(195),[1,192]],12e3:[tc,Fe(268),[3,127,248],Fe(268),[6,255,240],Fe(268),[13,255,224],Fe(268),[27,253,128],Fe(259),[56]],11025:[tc,Fe(268),[3,127,248],Fe(268),[6,255,240],Fe(268),[13,255,224],Fe(268),[27,255,192],Fe(268),[55,175,128],Fe(108),[112]],8e3:[tc,Fe(268),[3,121,16],Fe(47),[7]]};ic=Vb(h)}return ic},sc=9e4,rc,nc,cu,oc,Fm,Mm,Om;rc=function(h){return h*sc},nc=function(h,p){return h*p},cu=function(h){return h/sc},oc=function(h,p){return h/p},Fm=function(h,p){return rc(oc(h,p))},Mm=function(h,p){return nc(cu(h),p)},Om=function(h,p,m){return cu(m?h:h-p)};var We={ONE_SECOND_IN_TS:sc,secondsToVideoTs:rc,secondsToAudioTs:nc,videoTsToSeconds:cu,audioTsToSeconds:oc,audioTsToVideoTs:Fm,videoTsToAudioTs:Mm,metadataTsToSeconds:Om},Hb=Bb,pu=We,Ub=function(h){var p,m,f=0;for(p=0;p<h.length;p++)m=h[p],f+=m.data.byteLength;return f},Wb=function(h,p,m,f){var v,w=0,A=0,x=0,P=0,M,G,B;if(p.length&&(v=pu.audioTsToVideoTs(h.baseMediaDecodeTime,h.samplerate),w=Math.ceil(pu.ONE_SECOND_IN_TS/(h.samplerate/1024)),m&&f&&(A=v-Math.max(m,f),x=Math.floor(A/w),P=x*w),!(x<1||P>pu.ONE_SECOND_IN_TS/2))){for(M=Hb()[h.samplerate],M||(M=p[0].data),G=0;G<x;G++)B=p[0],p.splice(0,0,{data:M,dts:B.dts-w,pts:B.pts-w});return h.baseMediaDecodeTime-=Math.floor(pu.videoTsToAudioTs(P,h.samplerate)),P}},zb=function(h,p,m){return p.minSegmentDts>=m?h:(p.minSegmentDts=1/0,h.filter(function(f){return f.dts>=m?(p.minSegmentDts=Math.min(p.minSegmentDts,f.dts),p.minSegmentPts=p.minSegmentDts,!0):!1}))},$b=function(h){var p,m,f=[];for(p=0;p<h.length;p++)m=h[p],f.push({size:m.data.byteLength,duration:1024});return f},jb=function(h){var p,m,f=0,v=new Uint8Array(Ub(h));for(p=0;p<h.length;p++)m=h[p],v.set(m.data,f),f+=m.data.byteLength;return v},qb={prefixWithSilence:Wb,trimAdtsFramesByEarliestDts:zb,generateSampleTable:$b,concatenateFrameData:jb},Kb=We.ONE_SECOND_IN_TS,Yb=function(h,p){typeof p.pts=="number"&&(h.timelineStartInfo.pts===void 0&&(h.timelineStartInfo.pts=p.pts),h.minSegmentPts===void 0?h.minSegmentPts=p.pts:h.minSegmentPts=Math.min(h.minSegmentPts,p.pts),h.maxSegmentPts===void 0?h.maxSegmentPts=p.pts:h.maxSegmentPts=Math.max(h.maxSegmentPts,p.pts)),typeof p.dts=="number"&&(h.timelineStartInfo.dts===void 0&&(h.timelineStartInfo.dts=p.dts),h.minSegmentDts===void 0?h.minSegmentDts=p.dts:h.minSegmentDts=Math.min(h.minSegmentDts,p.dts),h.maxSegmentDts===void 0?h.maxSegmentDts=p.dts:h.maxSegmentDts=Math.max(h.maxSegmentDts,p.dts))},Xb=function(h){delete h.minSegmentDts,delete h.maxSegmentDts,delete h.minSegmentPts,delete h.maxSegmentPts},Qb=function(h,p){var m,f,v=h.minSegmentDts;return p||(v-=h.timelineStartInfo.dts),m=h.timelineStartInfo.baseMediaDecodeTime,m+=v,m=Math.max(0,m),h.type==="audio"&&(f=h.samplerate/Kb,m*=f,m=Math.floor(m)),m},Jb={clearDtsInfo:Xb,calculateTrackBaseMediaDecodeTime:Qb,collectDtsInfo:Yb},Nm=4,Zb=128,e_=function(h){for(var p=0,m={payloadType:-1,payloadSize:0},f=0,v=0;p<h.byteLength&&h[p]!==Zb;){for(;h[p]===255;)f+=255,p++;for(f+=h[p++];h[p]===255;)v+=255,p++;if(v+=h[p++],!m.payload&&f===Nm){var w=String.fromCharCode(h[p+3],h[p+4],h[p+5],h[p+6]);if(w==="GA94"){m.payloadType=f,m.payloadSize=v,m.payload=h.subarray(p,p+v);break}else m.payload=void 0}p+=v,f=0,v=0}return m},t_=function(h){return h.payload[0]!==181||(h.payload[1]<<8|h.payload[2])!==49||String.fromCharCode(h.payload[3],h.payload[4],h.payload[5],h.payload[6])!=="GA94"||h.payload[7]!==3?null:h.payload.subarray(8,h.payload.length-1)},i_=function(h,p){var m=[],f,v,w,A;if(!(p[0]&64))return m;for(v=p[0]&31,f=0;f<v;f++)w=f*3,A={type:p[w+2]&3,pts:h},p[w+2]&4&&(A.ccData=p[w+3]<<8|p[w+4],m.push(A));return m},s_=function(h){for(var p=h.byteLength,m=[],f=1,v,w;f<p-2;)h[f]===0&&h[f+1]===0&&h[f+2]===3?(m.push(f+2),f+=2):f++;if(m.length===0)return h;v=p-m.length,w=new Uint8Array(v);var A=0;for(f=0;f<v;A++,f++)A===m[0]&&(A++,m.shift()),w[f]=h[A];return w},km={parseSei:e_,parseUserData:t_,parseCaptionPackets:i_,discardEmulationPreventionBytes:s_,USER_DATA_REGISTERED_ITU_T_T35:Nm},ac=i,gu=km,Wt=function(h){h=h||{},Wt.prototype.init.call(this),this.parse708captions_=typeof h.parse708captions=="boolean"?h.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new qe(0,0),new qe(0,1),new qe(1,0),new qe(1,1)],this.parse708captions_&&(this.cc708Stream_=new ke({captionServices:h.captionServices})),this.reset(),this.ccStreams_.forEach(function(p){p.on("data",this.trigger.bind(this,"data")),p.on("partialdone",this.trigger.bind(this,"partialdone")),p.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Wt.prototype=new ac,Wt.prototype.push=function(h){var p,m,f;if(h.nalUnitType==="sei_rbsp"&&(p=gu.parseSei(h.escapedRBSP),!!p.payload&&p.payloadType===gu.USER_DATA_REGISTERED_ITU_T_T35&&(m=gu.parseUserData(p),!!m))){if(h.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(h.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}f=gu.parseCaptionPackets(h.pts,m),this.captionPackets_=this.captionPackets_.concat(f),this.latestDts_!==h.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=h.dts}},Wt.prototype.flushCCStreams=function(h){this.ccStreams_.forEach(function(p){return h==="flush"?p.flush():p.partialFlush()},this)},Wt.prototype.flushStream=function(h){if(!this.captionPackets_.length){this.flushCCStreams(h);return}this.captionPackets_.forEach(function(p,m){p.presortIndex=m}),this.captionPackets_.sort(function(p,m){return p.pts===m.pts?p.presortIndex-m.presortIndex:p.pts-m.pts}),this.captionPackets_.forEach(function(p){p.type<2?this.dispatchCea608Packet(p):this.dispatchCea708Packet(p)},this),this.captionPackets_.length=0,this.flushCCStreams(h)},Wt.prototype.flush=function(){return this.flushStream("flush")},Wt.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Wt.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(h){h.reset()})},Wt.prototype.dispatchCea608Packet=function(h){this.setsTextOrXDSActive(h)?this.activeCea608Channel_[h.type]=null:this.setsChannel1Active(h)?this.activeCea608Channel_[h.type]=0:this.setsChannel2Active(h)&&(this.activeCea608Channel_[h.type]=1),this.activeCea608Channel_[h.type]!==null&&this.ccStreams_[(h.type<<1)+this.activeCea608Channel_[h.type]].push(h)},Wt.prototype.setsChannel1Active=function(h){return(h.ccData&30720)===4096},Wt.prototype.setsChannel2Active=function(h){return(h.ccData&30720)===6144},Wt.prototype.setsTextOrXDSActive=function(h){return(h.ccData&28928)===256||(h.ccData&30974)===4138||(h.ccData&30974)===6186},Wt.prototype.dispatchCea708Packet=function(h){this.parse708captions_&&this.cc708Stream_.push(h)};var r_={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},n_=function(h){var p=r_[h]||h;return h&4096&&h===p?"":String.fromCharCode(p)},fu=function(h){return 32<=h&&h<=127||160<=h&&h<=255},Is=function(h){this.windowNum=h,this.reset()};Is.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Is.prototype.getText=function(){return this.rows.join(`
`)},Is.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Is.prototype.newLine=function(h){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(h),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Is.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Is.prototype.addText=function(h){this.rows[this.rowIdx]+=h},Is.prototype.backspace=function(){if(!this.isEmpty()){var h=this.rows[this.rowIdx];this.rows[this.rowIdx]=h.substr(0,h.length-1)}};var mu=function(h,p,m){this.serviceNum=h,this.text="",this.currentWindow=new Is(-1),this.windows=[],this.stream=m,typeof p=="string"&&this.createTextDecoder(p)};mu.prototype.init=function(h,p){this.startPts=h;for(var m=0;m<8;m++)this.windows[m]=new Is(m),typeof p=="function"&&(this.windows[m].beforeRowOverflow=p)},mu.prototype.setCurrentWindow=function(h){this.currentWindow=this.windows[h]},mu.prototype.createTextDecoder=function(h){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(h)}catch(p){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+h+" encoding. "+p})}};var ke=function(h){h=h||{},ke.prototype.init.call(this);var p=this,m=h.captionServices||{},f={},v;Object.keys(m).forEach(w=>{v=m[w],/^SERVICE/.test(w)&&(f[w]=v.encoding)}),this.serviceEncodings=f,this.current708Packet=null,this.services={},this.push=function(w){w.type===3?(p.new708Packet(),p.add708Bytes(w)):(p.current708Packet===null&&p.new708Packet(),p.add708Bytes(w))}};ke.prototype=new ac,ke.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},ke.prototype.add708Bytes=function(h){var p=h.ccData,m=p>>>8,f=p&255;this.current708Packet.ptsVals.push(h.pts),this.current708Packet.data.push(m),this.current708Packet.data.push(f)},ke.prototype.push708Packet=function(){var h=this.current708Packet,p=h.data,m=null,f=null,v=0,w=p[v++];for(h.seq=w>>6,h.sizeCode=w&63;v<p.length;v++)w=p[v++],m=w>>5,f=w&31,m===7&&f>0&&(w=p[v++],m=w),this.pushServiceBlock(m,v,f),f>0&&(v+=f-1)},ke.prototype.pushServiceBlock=function(h,p,m){var f,v=p,w=this.current708Packet.data,A=this.services[h];for(A||(A=this.initService(h,v));v<p+m&&v<w.length;v++)f=w[v],fu(f)?v=this.handleText(v,A):f===24?v=this.multiByteCharacter(v,A):f===16?v=this.extendedCommands(v,A):128<=f&&f<=135?v=this.setCurrentWindow(v,A):152<=f&&f<=159?v=this.defineWindow(v,A):f===136?v=this.clearWindows(v,A):f===140?v=this.deleteWindows(v,A):f===137?v=this.displayWindows(v,A):f===138?v=this.hideWindows(v,A):f===139?v=this.toggleWindows(v,A):f===151?v=this.setWindowAttributes(v,A):f===144?v=this.setPenAttributes(v,A):f===145?v=this.setPenColor(v,A):f===146?v=this.setPenLocation(v,A):f===143?A=this.reset(v,A):f===8?A.currentWindow.backspace():f===12?A.currentWindow.clearText():f===13?A.currentWindow.pendingNewLine=!0:f===14?A.currentWindow.clearText():f===141&&v++},ke.prototype.extendedCommands=function(h,p){var m=this.current708Packet.data,f=m[++h];return fu(f)&&(h=this.handleText(h,p,{isExtended:!0})),h},ke.prototype.getPts=function(h){return this.current708Packet.ptsVals[Math.floor(h/2)]},ke.prototype.initService=function(h,p){var f="SERVICE"+h,m=this,f,v;return f in this.serviceEncodings&&(v=this.serviceEncodings[f]),this.services[h]=new mu(h,v,m),this.services[h].init(this.getPts(p),function(w){m.flushDisplayed(w,m.services[h])}),this.services[h]},ke.prototype.handleText=function(h,p,m){var f=m&&m.isExtended,v=m&&m.isMultiByte,w=this.current708Packet.data,A=f?4096:0,x=w[h],P=w[h+1],M=p.currentWindow,G,B;function X(j){return j.map(ne=>("0"+(ne&255).toString(16)).slice(-2)).join("")}if(v?(B=[x,P],h++):B=[x],p.textDecoder_&&!f)G=p.textDecoder_.decode(new Uint8Array(B));else if(v){const j=X(B);G=String.fromCharCode(parseInt(j,16))}else G=n_(A|x);return M.pendingNewLine&&!M.isEmpty()&&M.newLine(this.getPts(h)),M.pendingNewLine=!1,M.addText(G),h},ke.prototype.multiByteCharacter=function(h,p){var m=this.current708Packet.data,f=m[h+1],v=m[h+2];return fu(f)&&fu(v)&&(h=this.handleText(++h,p,{isMultiByte:!0})),h},ke.prototype.setCurrentWindow=function(h,p){var m=this.current708Packet.data,f=m[h],v=f&7;return p.setCurrentWindow(v),h},ke.prototype.defineWindow=function(h,p){var m=this.current708Packet.data,f=m[h],v=f&7;p.setCurrentWindow(v);var w=p.currentWindow;return f=m[++h],w.visible=(f&32)>>5,w.rowLock=(f&16)>>4,w.columnLock=(f&8)>>3,w.priority=f&7,f=m[++h],w.relativePositioning=(f&128)>>7,w.anchorVertical=f&127,f=m[++h],w.anchorHorizontal=f,f=m[++h],w.anchorPoint=(f&240)>>4,w.rowCount=f&15,f=m[++h],w.columnCount=f&63,f=m[++h],w.windowStyle=(f&56)>>3,w.penStyle=f&7,w.virtualRowCount=w.rowCount+1,h},ke.prototype.setWindowAttributes=function(h,p){var m=this.current708Packet.data,f=m[h],v=p.currentWindow.winAttr;return f=m[++h],v.fillOpacity=(f&192)>>6,v.fillRed=(f&48)>>4,v.fillGreen=(f&12)>>2,v.fillBlue=f&3,f=m[++h],v.borderType=(f&192)>>6,v.borderRed=(f&48)>>4,v.borderGreen=(f&12)>>2,v.borderBlue=f&3,f=m[++h],v.borderType+=(f&128)>>5,v.wordWrap=(f&64)>>6,v.printDirection=(f&48)>>4,v.scrollDirection=(f&12)>>2,v.justify=f&3,f=m[++h],v.effectSpeed=(f&240)>>4,v.effectDirection=(f&12)>>2,v.displayEffect=f&3,h},ke.prototype.flushDisplayed=function(h,p){for(var m=[],f=0;f<8;f++)p.windows[f].visible&&!p.windows[f].isEmpty()&&m.push(p.windows[f].getText());p.endPts=h,p.text=m.join(`

`),this.pushCaption(p),p.startPts=h},ke.prototype.pushCaption=function(h){h.text!==""&&(this.trigger("data",{startPts:h.startPts,endPts:h.endPts,text:h.text,stream:"cc708_"+h.serviceNum}),h.text="",h.startPts=h.endPts)},ke.prototype.displayWindows=function(h,p){var m=this.current708Packet.data,f=m[++h],v=this.getPts(h);this.flushDisplayed(v,p);for(var w=0;w<8;w++)f&1<<w&&(p.windows[w].visible=1);return h},ke.prototype.hideWindows=function(h,p){var m=this.current708Packet.data,f=m[++h],v=this.getPts(h);this.flushDisplayed(v,p);for(var w=0;w<8;w++)f&1<<w&&(p.windows[w].visible=0);return h},ke.prototype.toggleWindows=function(h,p){var m=this.current708Packet.data,f=m[++h],v=this.getPts(h);this.flushDisplayed(v,p);for(var w=0;w<8;w++)f&1<<w&&(p.windows[w].visible^=1);return h},ke.prototype.clearWindows=function(h,p){var m=this.current708Packet.data,f=m[++h],v=this.getPts(h);this.flushDisplayed(v,p);for(var w=0;w<8;w++)f&1<<w&&p.windows[w].clearText();return h},ke.prototype.deleteWindows=function(h,p){var m=this.current708Packet.data,f=m[++h],v=this.getPts(h);this.flushDisplayed(v,p);for(var w=0;w<8;w++)f&1<<w&&p.windows[w].reset();return h},ke.prototype.setPenAttributes=function(h,p){var m=this.current708Packet.data,f=m[h],v=p.currentWindow.penAttr;return f=m[++h],v.textTag=(f&240)>>4,v.offset=(f&12)>>2,v.penSize=f&3,f=m[++h],v.italics=(f&128)>>7,v.underline=(f&64)>>6,v.edgeType=(f&56)>>3,v.fontStyle=f&7,h},ke.prototype.setPenColor=function(h,p){var m=this.current708Packet.data,f=m[h],v=p.currentWindow.penColor;return f=m[++h],v.fgOpacity=(f&192)>>6,v.fgRed=(f&48)>>4,v.fgGreen=(f&12)>>2,v.fgBlue=f&3,f=m[++h],v.bgOpacity=(f&192)>>6,v.bgRed=(f&48)>>4,v.bgGreen=(f&12)>>2,v.bgBlue=f&3,f=m[++h],v.edgeRed=(f&48)>>4,v.edgeGreen=(f&12)>>2,v.edgeBlue=f&3,h},ke.prototype.setPenLocation=function(h,p){var m=this.current708Packet.data,f=m[h],v=p.currentWindow.penLoc;return p.currentWindow.pendingNewLine=!0,f=m[++h],v.row=f&15,f=m[++h],v.column=f&63,h},ke.prototype.reset=function(h,p){var m=this.getPts(h);return this.flushDisplayed(m,p),this.initService(p.serviceNum,h)};var o_={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Cu=function(h){return h===null?"":(h=o_[h]||h,String.fromCharCode(h))},vu=14,a_=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],xr=function(){for(var h=[],p=vu+1;p--;)h.push({text:"",indent:0,offset:0});return h},qe=function(h,p){qe.prototype.init.call(this),this.field_=h||0,this.dataChannel_=p||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(m){var f,v,w,A,x;if(f=m.ccData&32639,f===this.lastControlCode_){this.lastControlCode_=null;return}if((f&61440)===4096?this.lastControlCode_=f:f!==this.PADDING_&&(this.lastControlCode_=null),w=f>>>8,A=f&255,f!==this.PADDING_)if(f===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(f===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(m.pts),this.flushDisplayed(m.pts),v=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=v,this.startPts_=m.pts;else if(f===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(m.pts);else if(f===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(m.pts);else if(f===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(m.pts);else if(f===this.CARRIAGE_RETURN_)this.clearFormatting(m.pts),this.flushDisplayed(m.pts),this.shiftRowsUp_(),this.startPts_=m.pts;else if(f===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(f===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(m.pts),this.displayed_=xr();else if(f===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=xr();else if(f===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(m.pts),this.displayed_=xr()),this.mode_="paintOn",this.startPts_=m.pts;else if(this.isSpecialCharacter(w,A))w=(w&3)<<8,x=Cu(w|A),this[this.mode_](m.pts,x),this.column_++;else if(this.isExtCharacter(w,A))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),w=(w&3)<<8,x=Cu(w|A),this[this.mode_](m.pts,x),this.column_++;else if(this.isMidRowCode(w,A))this.clearFormatting(m.pts),this[this.mode_](m.pts," "),this.column_++,(A&14)===14&&this.addFormatting(m.pts,["i"]),(A&1)===1&&this.addFormatting(m.pts,["u"]);else if(this.isOffsetControlCode(w,A)){const M=A&3;this.nonDisplayed_[this.row_].offset=M,this.column_+=M}else if(this.isPAC(w,A)){var P=a_.indexOf(f&7968);if(this.mode_==="rollUp"&&(P-this.rollUpRows_+1<0&&(P=this.rollUpRows_-1),this.setRollUp(m.pts,P)),P!==this.row_&&P>=0&&P<=14&&(this.clearFormatting(m.pts),this.row_=P),A&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(m.pts,["u"]),(f&16)===16){const M=(f&14)>>1;this.column_=M*4,this.nonDisplayed_[this.row_].indent+=M}this.isColorPAC(A)&&(A&14)===14&&this.addFormatting(m.pts,["i"])}else this.isNormalChar(w)&&(A===0&&(A=null),x=Cu(w),x+=Cu(A),this[this.mode_](m.pts,x),this.column_+=x.length)}};qe.prototype=new ac,qe.prototype.flushDisplayed=function(h){const p=f=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+f+"."})},m=[];this.displayed_.forEach((f,v)=>{if(f&&f.text&&f.text.length){try{f.text=f.text.trim()}catch{p(v)}f.text.length&&m.push({text:f.text,line:v+1,position:10+Math.min(70,f.indent*10)+f.offset*2.5})}else f==null&&p(v)}),m.length&&this.trigger("data",{startPts:this.startPts_,endPts:h,content:m,stream:this.name_})},qe.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=xr(),this.nonDisplayed_=xr(),this.lastControlCode_=null,this.column_=0,this.row_=vu,this.rollUpRows_=2,this.formatting_=[]},qe.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},qe.prototype.isSpecialCharacter=function(h,p){return h===this.EXT_&&p>=48&&p<=63},qe.prototype.isExtCharacter=function(h,p){return(h===this.EXT_+1||h===this.EXT_+2)&&p>=32&&p<=63},qe.prototype.isMidRowCode=function(h,p){return h===this.EXT_&&p>=32&&p<=47},qe.prototype.isOffsetControlCode=function(h,p){return h===this.OFFSET_&&p>=33&&p<=35},qe.prototype.isPAC=function(h,p){return h>=this.BASE_&&h<this.BASE_+8&&p>=64&&p<=127},qe.prototype.isColorPAC=function(h){return h>=64&&h<=79||h>=96&&h<=127},qe.prototype.isNormalChar=function(h){return h>=32&&h<=127},qe.prototype.setRollUp=function(h,p){if(this.mode_!=="rollUp"&&(this.row_=vu,this.mode_="rollUp",this.flushDisplayed(h),this.nonDisplayed_=xr(),this.displayed_=xr()),p!==void 0&&p!==this.row_)for(var m=0;m<this.rollUpRows_;m++)this.displayed_[p-m]=this.displayed_[this.row_-m],this.displayed_[this.row_-m]={text:"",indent:0,offset:0};p===void 0&&(p=this.row_),this.topRow_=p-this.rollUpRows_+1},qe.prototype.addFormatting=function(h,p){this.formatting_=this.formatting_.concat(p);var m=p.reduce(function(f,v){return f+"<"+v+">"},"");this[this.mode_](h,m)},qe.prototype.clearFormatting=function(h){if(this.formatting_.length){var p=this.formatting_.reverse().reduce(function(m,f){return m+"</"+f+">"},"");this.formatting_=[],this[this.mode_](h,p)}},qe.prototype.popOn=function(h,p){var m=this.nonDisplayed_[this.row_].text;m+=p,this.nonDisplayed_[this.row_].text=m},qe.prototype.rollUp=function(h,p){var m=this.displayed_[this.row_].text;m+=p,this.displayed_[this.row_].text=m},qe.prototype.shiftRowsUp_=function(){var h;for(h=0;h<this.topRow_;h++)this.displayed_[h]={text:"",indent:0,offset:0};for(h=this.row_+1;h<vu+1;h++)this.displayed_[h]={text:"",indent:0,offset:0};for(h=this.topRow_;h<this.row_;h++)this.displayed_[h]=this.displayed_[h+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},qe.prototype.paintOn=function(h,p){var m=this.displayed_[this.row_].text;m+=p,this.displayed_[this.row_].text=m};var Gm={CaptionStream:Wt,Cea608Stream:qe,Cea708Stream:ke},yu={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},l_=i,u_=8589934592,d_=4294967296,Vm="shared",lc=function(h,p){var m=1;for(h>p&&(m=-1);Math.abs(p-h)>d_;)h+=m*u_;return h},uc=function(h){var p,m;uc.prototype.init.call(this),this.type_=h||Vm,this.push=function(f){if(f.type==="metadata"){this.trigger("data",f);return}this.type_!==Vm&&f.type!==this.type_||(m===void 0&&(m=f.dts),f.dts=lc(f.dts,m),f.pts=lc(f.pts,m),p=f.dts,this.trigger("data",f))},this.flush=function(){m=p,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){m=void 0,p=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};uc.prototype=new l_;var Bm={TimestampRolloverStream:uc,handleRollover:lc},h_=(h,p,m)=>{if(!h)return-1;for(var f=m;f<h.length;f++)if(h[f]===p)return f;return-1},c_={typedArrayIndexOf:h_},Su=c_.typedArrayIndexOf,Eu={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Hm=function(h,p,m){var f,v="";for(f=p;f<m;f++)v+="%"+("00"+h[f].toString(16)).slice(-2);return v},ua=function(h,p,m){return decodeURIComponent(Hm(h,p,m))},da=function(h,p,m){return unescape(Hm(h,p,m))},ha=function(h){return h[0]<<21|h[1]<<14|h[2]<<7|h[3]},ca={APIC:function(h){var p=1,m,f,v="-->";h.data[0]===Eu.Utf8&&(m=Su(h.data,0,p),!(m<0)&&(h.mimeType=da(h.data,p,m),p=m+1,h.pictureType=h.data[p],p++,f=Su(h.data,0,p),!(f<0)&&(h.description=ua(h.data,p,f),p=f+1,h.mimeType===v?h.url=da(h.data,p,h.data.length):h.pictureData=h.data.subarray(p,h.data.length))))},"T*":function(h){h.data[0]===Eu.Utf8&&(h.value=ua(h.data,1,h.data.length).replace(/\0*$/,""),h.values=h.value.split("\0"))},TXXX:function(h){var p;h.data[0]===Eu.Utf8&&(p=Su(h.data,0,1),p!==-1&&(h.description=ua(h.data,1,p),h.value=ua(h.data,p+1,h.data.length).replace(/\0*$/,""),h.data=h.value))},"W*":function(h){h.url=da(h.data,0,h.data.length).replace(/\0.*$/,"")},WXXX:function(h){var p;h.data[0]===Eu.Utf8&&(p=Su(h.data,0,1),p!==-1&&(h.description=ua(h.data,1,p),h.url=da(h.data,p+1,h.data.length).replace(/\0.*$/,"")))},PRIV:function(h){var p;for(p=0;p<h.data.length;p++)if(h.data[p]===0){h.owner=da(h.data,0,p);break}h.privateData=h.data.subarray(p+1),h.data=h.privateData}},p_=function(h){var p,m,f=10,v=0,w=[];if(!(h.length<10||h[0]!==73||h[1]!==68||h[2]!==51)){v=ha(h.subarray(6,10)),v+=10;var A=h[5]&64;A&&(f+=4,f+=ha(h.subarray(10,14)),v-=ha(h.subarray(16,20)));do{if(p=ha(h.subarray(f+4,f+8)),p<1)break;m=String.fromCharCode(h[f],h[f+1],h[f+2],h[f+3]);var x={id:m,data:h.subarray(f+10,f+p+10)};x.key=x.id,ca[x.id]?ca[x.id](x):x.id[0]==="T"?ca["T*"](x):x.id[0]==="W"&&ca["W*"](x),w.push(x),f+=10,f+=p}while(f<v);return w}},Um={parseId3Frames:p_,parseSyncSafeInteger:ha,frameParsers:ca},g_=i,f_=yu,er=Um,wu;wu=function(h){var p={descriptor:h&&h.descriptor},m=0,f=[],v=0,w;if(wu.prototype.init.call(this),this.dispatchType=f_.METADATA_STREAM_TYPE.toString(16),p.descriptor)for(w=0;w<p.descriptor.length;w++)this.dispatchType+=("00"+p.descriptor[w].toString(16)).slice(-2);this.push=function(A){var x,P,M,G,B,X;if(A.type==="timed-metadata"){if(A.dataAlignmentIndicator&&(v=0,f.length=0),f.length===0&&(A.data.length<10||A.data[0]!==73||A.data[1]!==68||A.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(f.push(A),v+=A.data.byteLength,f.length===1&&(m=er.parseSyncSafeInteger(A.data.subarray(6,10)),m+=10),!(v<m)){for(x={data:new Uint8Array(m),frames:[],pts:f[0].pts,dts:f[0].dts},B=0;B<m;)x.data.set(f[0].data.subarray(0,m-B),B),B+=f[0].data.byteLength,v-=f[0].data.byteLength,f.shift();P=10,x.data[5]&64&&(P+=4,P+=er.parseSyncSafeInteger(x.data.subarray(10,14)),m-=er.parseSyncSafeInteger(x.data.subarray(16,20)));do{if(M=er.parseSyncSafeInteger(x.data.subarray(P+4,P+8)),M<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(X=String.fromCharCode(x.data[P],x.data[P+1],x.data[P+2],x.data[P+3]),G={id:X,data:x.data.subarray(P+10,P+M+10)},G.key=G.id,er.frameParsers[G.id]?er.frameParsers[G.id](G):G.id[0]==="T"?er.frameParsers["T*"](G):G.id[0]==="W"&&er.frameParsers["W*"](G),G.owner==="com.apple.streaming.transportStreamTimestamp"){var j=G.data,ne=(j[3]&1)<<30|j[4]<<22|j[5]<<14|j[6]<<6|j[7]>>>2;ne*=4,ne+=j[7]&3,G.timeStamp=ne,x.pts===void 0&&x.dts===void 0&&(x.pts=G.timeStamp,x.dts=G.timeStamp),this.trigger("timestamp",G)}x.frames.push(G),P+=10,P+=M}while(P<m);this.trigger("data",x)}}}},wu.prototype=new g_;var m_=wu,dc=i,hc=Gm,Vi=yu,C_=Bm.TimestampRolloverStream,Tu,pa,bu,Pn=188,cc=71;Tu=function(){var h=new Uint8Array(Pn),p=0;Tu.prototype.init.call(this),this.push=function(m){var f=0,v=Pn,w;for(p?(w=new Uint8Array(m.byteLength+p),w.set(h.subarray(0,p)),w.set(m,p),p=0):w=m;v<w.byteLength;){if(w[f]===cc&&w[v]===cc){this.trigger("data",w.subarray(f,v)),f+=Pn,v+=Pn;continue}f++,v++}f<w.byteLength&&(h.set(w.subarray(f),0),p=w.byteLength-f)},this.flush=function(){p===Pn&&h[0]===cc&&(this.trigger("data",h),p=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){p=0,this.trigger("reset")}},Tu.prototype=new dc,pa=function(){var h,p,m,f;pa.prototype.init.call(this),f=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,h=function(v,w){var A=0;w.payloadUnitStartIndicator&&(A+=v[A]+1),w.type==="pat"?p(v.subarray(A),w):m(v.subarray(A),w)},p=function(v,w){w.section_number=v[7],w.last_section_number=v[8],f.pmtPid=(v[10]&31)<<8|v[11],w.pmtPid=f.pmtPid},m=function(v,w){var A,x,P,M;if(v[5]&1){for(f.programMapTable={video:null,audio:null,"timed-metadata":{}},A=(v[1]&15)<<8|v[2],x=3+A-4,P=(v[10]&15)<<8|v[11],M=12+P;M<x;){var G=v[M],B=(v[M+1]&31)<<8|v[M+2];G===Vi.H264_STREAM_TYPE&&f.programMapTable.video===null?f.programMapTable.video=B:G===Vi.ADTS_STREAM_TYPE&&f.programMapTable.audio===null?f.programMapTable.audio=B:G===Vi.METADATA_STREAM_TYPE&&(f.programMapTable["timed-metadata"][B]=G),M+=((v[M+3]&15)<<8|v[M+4])+5}w.programMapTable=f.programMapTable}},this.push=function(v){var w={},A=4;if(w.payloadUnitStartIndicator=!!(v[1]&64),w.pid=v[1]&31,w.pid<<=8,w.pid|=v[2],(v[3]&48)>>>4>1&&(A+=v[A]+1),w.pid===0)w.type="pat",h(v.subarray(A),w),this.trigger("data",w);else if(w.pid===this.pmtPid)for(w.type="pmt",h(v.subarray(A),w),this.trigger("data",w);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([v,A,w]):this.processPes_(v,A,w)},this.processPes_=function(v,w,A){A.pid===this.programMapTable.video?A.streamType=Vi.H264_STREAM_TYPE:A.pid===this.programMapTable.audio?A.streamType=Vi.ADTS_STREAM_TYPE:A.streamType=this.programMapTable["timed-metadata"][A.pid],A.type="pes",A.data=v.subarray(w),this.trigger("data",A)}},pa.prototype=new dc,pa.STREAM_TYPES={h264:27,adts:15},bu=function(){var h=this,p=!1,m={data:[],size:0},f={data:[],size:0},v={data:[],size:0},w,A=function(P,M){var G;const B=P[0]<<16|P[1]<<8|P[2];M.data=new Uint8Array,B===1&&(M.packetLength=6+(P[4]<<8|P[5]),M.dataAlignmentIndicator=(P[6]&4)!==0,G=P[7],G&192&&(M.pts=(P[9]&14)<<27|(P[10]&255)<<20|(P[11]&254)<<12|(P[12]&255)<<5|(P[13]&254)>>>3,M.pts*=4,M.pts+=(P[13]&6)>>>1,M.dts=M.pts,G&64&&(M.dts=(P[14]&14)<<27|(P[15]&255)<<20|(P[16]&254)<<12|(P[17]&255)<<5|(P[18]&254)>>>3,M.dts*=4,M.dts+=(P[18]&6)>>>1)),M.data=P.subarray(9+P[8]))},x=function(P,M,G){var B=new Uint8Array(P.size),X={type:M},j=0,ne=0,ue=!1,ct;if(!(!P.data.length||P.size<9)){for(X.trackId=P.data[0].pid,j=0;j<P.data.length;j++)ct=P.data[j],B.set(ct.data,ne),ne+=ct.data.byteLength;A(B,X),ue=M==="video"||X.packetLength<=P.size,(G||ue)&&(P.size=0,P.data.length=0),ue&&h.trigger("data",X)}};bu.prototype.init.call(this),this.push=function(P){({pat:function(){},pes:function(){var M,G;switch(P.streamType){case Vi.H264_STREAM_TYPE:M=m,G="video";break;case Vi.ADTS_STREAM_TYPE:M=f,G="audio";break;case Vi.METADATA_STREAM_TYPE:M=v,G="timed-metadata";break;default:return}P.payloadUnitStartIndicator&&x(M,G,!0),M.data.push(P),M.size+=P.data.byteLength},pmt:function(){var M={type:"metadata",tracks:[]};w=P.programMapTable,w.video!==null&&M.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.video,codec:"avc",type:"video"}),w.audio!==null&&M.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.audio,codec:"adts",type:"audio"}),p=!0,h.trigger("data",M)}})[P.type]()},this.reset=function(){m.size=0,m.data.length=0,f.size=0,f.data.length=0,this.trigger("reset")},this.flushStreams_=function(){x(m,"video"),x(f,"audio"),x(v,"timed-metadata")},this.flush=function(){if(!p&&w){var P={type:"metadata",tracks:[]};w.video!==null&&P.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.video,codec:"avc",type:"video"}),w.audio!==null&&P.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.audio,codec:"adts",type:"audio"}),h.trigger("data",P)}p=!1,this.flushStreams_(),this.trigger("done")}},bu.prototype=new dc;var Wm={PAT_PID:0,MP2T_PACKET_LENGTH:Pn,TransportPacketStream:Tu,TransportParseStream:pa,ElementaryStream:bu,TimestampRolloverStream:C_,CaptionStream:hc.CaptionStream,Cea608Stream:hc.Cea608Stream,Cea708Stream:hc.Cea708Stream,MetadataStream:m_};for(var pc in Vi)Vi.hasOwnProperty(pc)&&(Wm[pc]=Vi[pc]);var v_=Wm,y_=i,S_=We.ONE_SECOND_IN_TS,_u,zm=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];_u=function(h){var p,m=0;_u.prototype.init.call(this),this.skipWarn_=function(f,v){this.trigger("log",{level:"warn",message:`adts skiping bytes ${f} to ${v} in frame ${m} outside syncword`})},this.push=function(f){var v=0,w,A,x,P,M;if(h||(m=0),f.type==="audio"){p&&p.length?(x=p,p=new Uint8Array(x.byteLength+f.data.byteLength),p.set(x),p.set(f.data,x.byteLength)):p=f.data;for(var G;v+7<p.length;){if(p[v]!==255||(p[v+1]&246)!==240){typeof G!="number"&&(G=v),v++;continue}if(typeof G=="number"&&(this.skipWarn_(G,v),G=null),A=(~p[v+1]&1)*2,w=(p[v+3]&3)<<11|p[v+4]<<3|(p[v+5]&224)>>5,P=((p[v+6]&3)+1)*1024,M=P*S_/zm[(p[v+2]&60)>>>2],p.byteLength-v<w)break;this.trigger("data",{pts:f.pts+m*M,dts:f.dts+m*M,sampleCount:P,audioobjecttype:(p[v+2]>>>6&3)+1,channelcount:(p[v+2]&1)<<2|(p[v+3]&192)>>>6,samplerate:zm[(p[v+2]&60)>>>2],samplingfrequencyindex:(p[v+2]&60)>>>2,samplesize:16,data:p.subarray(v+7+A,v+w)}),m++,v+=w}typeof G=="number"&&(this.skipWarn_(G,v),G=null),p=p.subarray(v)}},this.flush=function(){m=0,this.trigger("done")},this.reset=function(){p=void 0,this.trigger("reset")},this.endTimeline=function(){p=void 0,this.trigger("endedtimeline")}},_u.prototype=new y_;var E_=_u,$m;$m=function(h){var p=h.byteLength,m=0,f=0;this.length=function(){return 8*p},this.bitsAvailable=function(){return 8*p+f},this.loadWord=function(){var v=h.byteLength-p,w=new Uint8Array(4),A=Math.min(4,p);if(A===0)throw new Error("no bytes available");w.set(h.subarray(v,v+A)),m=new DataView(w.buffer).getUint32(0),f=A*8,p-=A},this.skipBits=function(v){var w;f>v?(m<<=v,f-=v):(v-=f,w=Math.floor(v/8),v-=w*8,p-=w,this.loadWord(),m<<=v,f-=v)},this.readBits=function(v){var w=Math.min(f,v),A=m>>>32-w;return f-=w,f>0?m<<=w:p>0&&this.loadWord(),w=v-w,w>0?A<<w|this.readBits(w):A},this.skipLeadingZeros=function(){var v;for(v=0;v<f;++v)if(m&2147483648>>>v)return m<<=v,f-=v,v;return this.loadWord(),v+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var v=this.skipLeadingZeros();return this.readBits(v+1)-1},this.readExpGolomb=function(){var v=this.readUnsignedExpGolomb();return 1&v?1+v>>>1:-1*(v>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var w_=$m,jm=i,T_=w_,Du,ga,qm;ga=function(){var h=0,p,m;ga.prototype.init.call(this),this.push=function(f){var v;m?(v=new Uint8Array(m.byteLength+f.data.byteLength),v.set(m),v.set(f.data,m.byteLength),m=v):m=f.data;for(var w=m.byteLength;h<w-3;h++)if(m[h+2]===1){p=h+5;break}for(;p<w;)switch(m[p]){case 0:if(m[p-1]!==0){p+=2;break}else if(m[p-2]!==0){p++;break}h+3!==p-2&&this.trigger("data",m.subarray(h+3,p-2));do p++;while(m[p]!==1&&p<w);h=p-2,p+=3;break;case 1:if(m[p-1]!==0||m[p-2]!==0){p+=3;break}this.trigger("data",m.subarray(h+3,p-2)),h=p-2,p+=3;break;default:p+=3;break}m=m.subarray(h),p-=h,h=0},this.reset=function(){m=null,h=0,this.trigger("reset")},this.flush=function(){m&&m.byteLength>3&&this.trigger("data",m.subarray(h+3)),m=null,h=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},ga.prototype=new jm,qm={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Du=function(){var h=new ga,p,m,f,v,w,A,x;Du.prototype.init.call(this),p=this,this.push=function(P){P.type==="video"&&(m=P.trackId,f=P.pts,v=P.dts,h.push(P))},h.on("data",function(P){var M={trackId:m,pts:f,dts:v,data:P,nalUnitTypeCode:P[0]&31};switch(M.nalUnitTypeCode){case 5:M.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:M.nalUnitType="sei_rbsp",M.escapedRBSP=w(P.subarray(1));break;case 7:M.nalUnitType="seq_parameter_set_rbsp",M.escapedRBSP=w(P.subarray(1)),M.config=A(M.escapedRBSP);break;case 8:M.nalUnitType="pic_parameter_set_rbsp";break;case 9:M.nalUnitType="access_unit_delimiter_rbsp";break}p.trigger("data",M)}),h.on("done",function(){p.trigger("done")}),h.on("partialdone",function(){p.trigger("partialdone")}),h.on("reset",function(){p.trigger("reset")}),h.on("endedtimeline",function(){p.trigger("endedtimeline")}),this.flush=function(){h.flush()},this.partialFlush=function(){h.partialFlush()},this.reset=function(){h.reset()},this.endTimeline=function(){h.endTimeline()},x=function(P,M){var G=8,B=8,X,j;for(X=0;X<P;X++)B!==0&&(j=M.readExpGolomb(),B=(G+j+256)%256),G=B===0?G:B},w=function(P){for(var M=P.byteLength,G=[],B=1,X,j;B<M-2;)P[B]===0&&P[B+1]===0&&P[B+2]===3?(G.push(B+2),B+=2):B++;if(G.length===0)return P;X=M-G.length,j=new Uint8Array(X);var ne=0;for(B=0;B<X;ne++,B++)ne===G[0]&&(ne++,G.shift()),j[B]=P[ne];return j},A=function(P){var M=0,G=0,B=0,X=0,j,ne,ue,ct,Si,Lr,EC,wC,TC,bc,bC,rt=[1,1],_C,Fr;if(j=new T_(P),ne=j.readUnsignedByte(),ct=j.readUnsignedByte(),ue=j.readUnsignedByte(),j.skipUnsignedExpGolomb(),qm[ne]&&(Si=j.readUnsignedExpGolomb(),Si===3&&j.skipBits(1),j.skipUnsignedExpGolomb(),j.skipUnsignedExpGolomb(),j.skipBits(1),j.readBoolean()))for(bC=Si!==3?8:12,Fr=0;Fr<bC;Fr++)j.readBoolean()&&(Fr<6?x(16,j):x(64,j));if(j.skipUnsignedExpGolomb(),Lr=j.readUnsignedExpGolomb(),Lr===0)j.readUnsignedExpGolomb();else if(Lr===1)for(j.skipBits(1),j.skipExpGolomb(),j.skipExpGolomb(),EC=j.readUnsignedExpGolomb(),Fr=0;Fr<EC;Fr++)j.skipExpGolomb();if(j.skipUnsignedExpGolomb(),j.skipBits(1),wC=j.readUnsignedExpGolomb(),TC=j.readUnsignedExpGolomb(),bc=j.readBits(1),bc===0&&j.skipBits(1),j.skipBits(1),j.readBoolean()&&(M=j.readUnsignedExpGolomb(),G=j.readUnsignedExpGolomb(),B=j.readUnsignedExpGolomb(),X=j.readUnsignedExpGolomb()),j.readBoolean()&&j.readBoolean()){switch(_C=j.readUnsignedByte(),_C){case 1:rt=[1,1];break;case 2:rt=[12,11];break;case 3:rt=[10,11];break;case 4:rt=[16,11];break;case 5:rt=[40,33];break;case 6:rt=[24,11];break;case 7:rt=[20,11];break;case 8:rt=[32,11];break;case 9:rt=[80,33];break;case 10:rt=[18,11];break;case 11:rt=[15,11];break;case 12:rt=[64,33];break;case 13:rt=[160,99];break;case 14:rt=[4,3];break;case 15:rt=[3,2];break;case 16:rt=[2,1];break;case 255:{rt=[j.readUnsignedByte()<<8|j.readUnsignedByte(),j.readUnsignedByte()<<8|j.readUnsignedByte()];break}}rt&&rt[0]/rt[1]}return{profileIdc:ne,levelIdc:ue,profileCompatibility:ct,width:(wC+1)*16-M*2-G*2,height:(2-bc)*(TC+1)*16-B*2-X*2,sarRatio:rt}}},Du.prototype=new jm;var b_={H264Stream:Du,NalByteStream:ga},__=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Km=function(h,p){var m=h[p+6]<<21|h[p+7]<<14|h[p+8]<<7|h[p+9],f=h[p+5],v=(f&16)>>4;return m=m>=0?m:0,v?m+20:m+10},Ym=function(h,p){return h.length-p<10||h[p]!==73||h[p+1]!==68||h[p+2]!==51?p:(p+=Km(h,p),Ym(h,p))},D_=function(h){var p=Ym(h,0);return h.length>=p+2&&(h[p]&255)===255&&(h[p+1]&240)===240&&(h[p+1]&22)===16},Xm=function(h){return h[0]<<21|h[1]<<14|h[2]<<7|h[3]},R_=function(h,p,m){var f,v="";for(f=p;f<m;f++)v+="%"+("00"+h[f].toString(16)).slice(-2);return v},A_=function(h,p,m){return unescape(R_(h,p,m))},x_=function(h,p){var m=(h[p+5]&224)>>5,f=h[p+4]<<3,v=h[p+3]&6144;return v|f|m},P_=function(h,p){return h[p]===73&&h[p+1]===68&&h[p+2]===51?"timed-metadata":h[p]&!0&&(h[p+1]&240)===240?"audio":null},I_=function(h){for(var p=0;p+5<h.length;){if(h[p]!==255||(h[p+1]&246)!==240){p++;continue}return __[(h[p+2]&60)>>>2]}return null},L_=function(h){var p,m,f,v;p=10,h[5]&64&&(p+=4,p+=Xm(h.subarray(10,14)));do{if(m=Xm(h.subarray(p+4,p+8)),m<1)return null;if(v=String.fromCharCode(h[p],h[p+1],h[p+2],h[p+3]),v==="PRIV"){f=h.subarray(p+10,p+m+10);for(var w=0;w<f.byteLength;w++)if(f[w]===0){var A=A_(f,0,w);if(A==="com.apple.streaming.transportStreamTimestamp"){var x=f.subarray(w+1),P=(x[3]&1)<<30|x[4]<<22|x[5]<<14|x[6]<<6|x[7]>>>2;return P*=4,P+=x[7]&3,P}break}}p+=10,p+=m}while(p<h.byteLength);return null},gc={isLikelyAacData:D_,parseId3TagSize:Km,parseAdtsSize:x_,parseType:P_,parseSampleRate:I_,parseAacTimestamp:L_},F_=i,Qm=gc,Ru;Ru=function(){var h=new Uint8Array,p=0;Ru.prototype.init.call(this),this.setTimestamp=function(m){p=m},this.push=function(m){var f=0,v=0,w,A,x,P;for(h.length?(P=h.length,h=new Uint8Array(m.byteLength+P),h.set(h.subarray(0,P)),h.set(m,P)):h=m;h.length-v>=3;){if(h[v]===73&&h[v+1]===68&&h[v+2]===51){if(h.length-v<10||(f=Qm.parseId3TagSize(h,v),v+f>h.length))break;A={type:"timed-metadata",data:h.subarray(v,v+f)},this.trigger("data",A),v+=f;continue}else if((h[v]&255)===255&&(h[v+1]&240)===240){if(h.length-v<7||(f=Qm.parseAdtsSize(h,v),v+f>h.length))break;x={type:"audio",data:h.subarray(v,v+f),pts:p,dts:p},this.trigger("data",x),v+=f;continue}v++}w=h.length-v,w>0?h=h.subarray(v):h=new Uint8Array},this.reset=function(){h=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){h=new Uint8Array,this.trigger("endedtimeline")}},Ru.prototype=new F_;var M_=Ru,O_=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],N_=O_,k_=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],G_=k_,Au=i,fa=xb,ma=Gb,xu=qb,Bi=Jb,Ls=v_,Pu=We,Jm=E_,V_=b_.H264Stream,B_=M_,H_=gc.isLikelyAacData,U_=We.ONE_SECOND_IN_TS,fc=N_,mc=G_,Ca,In,Iu,Pr,W_=function(h,p){p.stream=h,this.trigger("log",p)},Zm=function(h,p){for(var m=Object.keys(p),f=0;f<m.length;f++){var v=m[f];v==="headOfPipeline"||!p[v].on||p[v].on("log",W_.bind(h,v))}},eC=function(h,p){var m;if(h.length!==p.length)return!1;for(m=0;m<h.length;m++)if(h[m]!==p[m])return!1;return!0},Cc=function(h,p,m,f,v,w){var A=m-p,x=f-p,P=v-m;return{start:{dts:h,pts:h+A},end:{dts:h+x,pts:h+P},prependedContentDuration:w,baseMediaDecodeTime:h}};In=function(h,p){var m=[],f,v=0,w=0,A=1/0;p=p||{},f=p.firstSequenceNumber||0,In.prototype.init.call(this),this.push=function(x){Bi.collectDtsInfo(h,x),h&&fc.forEach(function(P){h[P]=x[P]}),m.push(x)},this.setEarliestDts=function(x){v=x},this.setVideoBaseMediaDecodeTime=function(x){A=x},this.setAudioAppendStart=function(x){w=x},this.flush=function(){var x,P,M,G,B,X,j;if(m.length===0){this.trigger("done","AudioSegmentStream");return}x=xu.trimAdtsFramesByEarliestDts(m,h,v),h.baseMediaDecodeTime=Bi.calculateTrackBaseMediaDecodeTime(h,p.keepOriginalTimestamps),j=xu.prefixWithSilence(h,x,w,A),h.samples=xu.generateSampleTable(x),M=fa.mdat(xu.concatenateFrameData(x)),m=[],P=fa.moof(f,[h]),G=new Uint8Array(P.byteLength+M.byteLength),f++,G.set(P),G.set(M,P.byteLength),Bi.clearDtsInfo(h),B=Math.ceil(U_*1024/h.samplerate),x.length&&(X=x.length*B,this.trigger("segmentTimingInfo",Cc(Pu.audioTsToVideoTs(h.baseMediaDecodeTime,h.samplerate),x[0].dts,x[0].pts,x[0].dts+X,x[0].pts+X,j||0)),this.trigger("timingInfo",{start:x[0].pts,end:x[0].pts+X})),this.trigger("data",{track:h,boxes:G}),this.trigger("done","AudioSegmentStream")},this.reset=function(){Bi.clearDtsInfo(h),m=[],this.trigger("reset")}},In.prototype=new Au,Ca=function(h,p){var m,f=[],v=[],w,A;p=p||{},m=p.firstSequenceNumber||0,Ca.prototype.init.call(this),delete h.minPTS,this.gopCache_=[],this.push=function(x){Bi.collectDtsInfo(h,x),x.nalUnitType==="seq_parameter_set_rbsp"&&!w&&(w=x.config,h.sps=[x.data],mc.forEach(function(P){h[P]=w[P]},this)),x.nalUnitType==="pic_parameter_set_rbsp"&&!A&&(A=x.data,h.pps=[x.data]),f.push(x)},this.flush=function(){for(var x,P,M,G,B,X,j=0,ne,ue;f.length&&f[0].nalUnitType!=="access_unit_delimiter_rbsp";)f.shift();if(f.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(x=ma.groupNalsIntoFrames(f),M=ma.groupFramesIntoGops(x),M[0][0].keyFrame||(P=this.getGopForFusion_(f[0],h),P?(j=P.duration,M.unshift(P),M.byteLength+=P.byteLength,M.nalCount+=P.nalCount,M.pts=P.pts,M.dts=P.dts,M.duration+=P.duration):M=ma.extendFirstKeyFrame(M)),v.length){var ct;if(p.alignGopsAtEnd?ct=this.alignGopsAtEnd_(M):ct=this.alignGopsAtStart_(M),!ct){this.gopCache_.unshift({gop:M.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),f=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}Bi.clearDtsInfo(h),M=ct}Bi.collectDtsInfo(h,M),h.samples=ma.generateSampleTable(M),B=fa.mdat(ma.concatenateNalData(M)),h.baseMediaDecodeTime=Bi.calculateTrackBaseMediaDecodeTime(h,p.keepOriginalTimestamps),this.trigger("processedGopsInfo",M.map(function(Si){return{pts:Si.pts,dts:Si.dts,byteLength:Si.byteLength}})),ne=M[0],ue=M[M.length-1],this.trigger("segmentTimingInfo",Cc(h.baseMediaDecodeTime,ne.dts,ne.pts,ue.dts+ue.duration,ue.pts+ue.duration,j)),this.trigger("timingInfo",{start:M[0].pts,end:M[M.length-1].pts+M[M.length-1].duration}),this.gopCache_.unshift({gop:M.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),f=[],this.trigger("baseMediaDecodeTime",h.baseMediaDecodeTime),this.trigger("timelineStartInfo",h.timelineStartInfo),G=fa.moof(m,[h]),X=new Uint8Array(G.byteLength+B.byteLength),m++,X.set(G),X.set(B,G.byteLength),this.trigger("data",{track:h,boxes:X}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),f=[],this.gopCache_.length=0,v.length=0,this.trigger("reset")},this.resetStream_=function(){Bi.clearDtsInfo(h),w=void 0,A=void 0},this.getGopForFusion_=function(x){var P=45e3,M=1e4,G=1/0,B,X,j,ne,ue;for(ue=0;ue<this.gopCache_.length;ue++)ne=this.gopCache_[ue],j=ne.gop,!(!(h.pps&&eC(h.pps[0],ne.pps[0]))||!(h.sps&&eC(h.sps[0],ne.sps[0])))&&(j.dts<h.timelineStartInfo.dts||(B=x.dts-j.dts-j.duration,B>=-M&&B<=P&&(!X||G>B)&&(X=ne,G=B)));return X?X.gop:null},this.alignGopsAtStart_=function(x){var P,M,G,B,X,j,ne,ue;for(X=x.byteLength,j=x.nalCount,ne=x.duration,P=M=0;P<v.length&&M<x.length&&(G=v[P],B=x[M],G.pts!==B.pts);){if(B.pts>G.pts){P++;continue}M++,X-=B.byteLength,j-=B.nalCount,ne-=B.duration}return M===0?x:M===x.length?null:(ue=x.slice(M),ue.byteLength=X,ue.duration=ne,ue.nalCount=j,ue.pts=ue[0].pts,ue.dts=ue[0].dts,ue)},this.alignGopsAtEnd_=function(x){var P,M,G,B,X,j;for(P=v.length-1,M=x.length-1,X=null,j=!1;P>=0&&M>=0;){if(G=v[P],B=x[M],G.pts===B.pts){j=!0;break}if(G.pts>B.pts){P--;continue}P===v.length-1&&(X=M),M--}if(!j&&X===null)return null;var ne;if(j?ne=M:ne=X,ne===0)return x;var ue=x.slice(ne),ct=ue.reduce(function(Si,Lr){return Si.byteLength+=Lr.byteLength,Si.duration+=Lr.duration,Si.nalCount+=Lr.nalCount,Si},{byteLength:0,duration:0,nalCount:0});return ue.byteLength=ct.byteLength,ue.duration=ct.duration,ue.nalCount=ct.nalCount,ue.pts=ue[0].pts,ue.dts=ue[0].dts,ue},this.alignGopsWith=function(x){v=x}},Ca.prototype=new Au,Pr=function(h,p){this.numberOfTracks=0,this.metadataStream=p,h=h||{},typeof h.remux<"u"?this.remuxTracks=!!h.remux:this.remuxTracks=!0,typeof h.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=h.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Pr.prototype.init.call(this),this.push=function(m){if(m.content||m.text)return this.pendingCaptions.push(m);if(m.frames)return this.pendingMetadata.push(m);this.pendingTracks.push(m.track),this.pendingBytes+=m.boxes.byteLength,m.track.type==="video"&&(this.videoTrack=m.track,this.pendingBoxes.push(m.boxes)),m.track.type==="audio"&&(this.audioTrack=m.track,this.pendingBoxes.unshift(m.boxes))}},Pr.prototype=new Au,Pr.prototype.flush=function(h){var p=0,m={captions:[],captionStreams:{},metadata:[],info:{}},f,v,w,A=0,x;if(this.pendingTracks.length<this.numberOfTracks){if(h!=="VideoSegmentStream"&&h!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(A=this.videoTrack.timelineStartInfo.pts,mc.forEach(function(P){m.info[P]=this.videoTrack[P]},this)):this.audioTrack&&(A=this.audioTrack.timelineStartInfo.pts,fc.forEach(function(P){m.info[P]=this.audioTrack[P]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?m.type=this.pendingTracks[0].type:m.type="combined",this.emittedTracks+=this.pendingTracks.length,w=fa.initSegment(this.pendingTracks),m.initSegment=new Uint8Array(w.byteLength),m.initSegment.set(w),m.data=new Uint8Array(this.pendingBytes),x=0;x<this.pendingBoxes.length;x++)m.data.set(this.pendingBoxes[x],p),p+=this.pendingBoxes[x].byteLength;for(x=0;x<this.pendingCaptions.length;x++)f=this.pendingCaptions[x],f.startTime=Pu.metadataTsToSeconds(f.startPts,A,this.keepOriginalTimestamps),f.endTime=Pu.metadataTsToSeconds(f.endPts,A,this.keepOriginalTimestamps),m.captionStreams[f.stream]=!0,m.captions.push(f);for(x=0;x<this.pendingMetadata.length;x++)v=this.pendingMetadata[x],v.cueTime=Pu.metadataTsToSeconds(v.pts,A,this.keepOriginalTimestamps),m.metadata.push(v);for(m.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",m),x=0;x<m.captions.length;x++)f=m.captions[x],this.trigger("caption",f);for(x=0;x<m.metadata.length;x++)v=m.metadata[x],this.trigger("id3Frame",v)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Pr.prototype.setRemux=function(h){this.remuxTracks=h},Iu=function(h){var p=this,m=!0,f,v;Iu.prototype.init.call(this),h=h||{},this.baseMediaDecodeTime=h.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var w={};this.transmuxPipeline_=w,w.type="aac",w.metadataStream=new Ls.MetadataStream,w.aacStream=new B_,w.audioTimestampRolloverStream=new Ls.TimestampRolloverStream("audio"),w.timedMetadataTimestampRolloverStream=new Ls.TimestampRolloverStream("timed-metadata"),w.adtsStream=new Jm,w.coalesceStream=new Pr(h,w.metadataStream),w.headOfPipeline=w.aacStream,w.aacStream.pipe(w.audioTimestampRolloverStream).pipe(w.adtsStream),w.aacStream.pipe(w.timedMetadataTimestampRolloverStream).pipe(w.metadataStream).pipe(w.coalesceStream),w.metadataStream.on("timestamp",function(A){w.aacStream.setTimestamp(A.timeStamp)}),w.aacStream.on("data",function(A){A.type!=="timed-metadata"&&A.type!=="audio"||w.audioSegmentStream||(v=v||{timelineStartInfo:{baseMediaDecodeTime:p.baseMediaDecodeTime},codec:"adts",type:"audio"},w.coalesceStream.numberOfTracks++,w.audioSegmentStream=new In(v,h),w.audioSegmentStream.on("log",p.getLogTrigger_("audioSegmentStream")),w.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),w.adtsStream.pipe(w.audioSegmentStream).pipe(w.coalesceStream),p.trigger("trackinfo",{hasAudio:!!v,hasVideo:!!f}))}),w.coalesceStream.on("data",this.trigger.bind(this,"data")),w.coalesceStream.on("done",this.trigger.bind(this,"done")),Zm(this,w)},this.setupTsPipeline=function(){var w={};this.transmuxPipeline_=w,w.type="ts",w.metadataStream=new Ls.MetadataStream,w.packetStream=new Ls.TransportPacketStream,w.parseStream=new Ls.TransportParseStream,w.elementaryStream=new Ls.ElementaryStream,w.timestampRolloverStream=new Ls.TimestampRolloverStream,w.adtsStream=new Jm,w.h264Stream=new V_,w.captionStream=new Ls.CaptionStream(h),w.coalesceStream=new Pr(h,w.metadataStream),w.headOfPipeline=w.packetStream,w.packetStream.pipe(w.parseStream).pipe(w.elementaryStream).pipe(w.timestampRolloverStream),w.timestampRolloverStream.pipe(w.h264Stream),w.timestampRolloverStream.pipe(w.adtsStream),w.timestampRolloverStream.pipe(w.metadataStream).pipe(w.coalesceStream),w.h264Stream.pipe(w.captionStream).pipe(w.coalesceStream),w.elementaryStream.on("data",function(A){var x;if(A.type==="metadata"){for(x=A.tracks.length;x--;)!f&&A.tracks[x].type==="video"?(f=A.tracks[x],f.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime):!v&&A.tracks[x].type==="audio"&&(v=A.tracks[x],v.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime);f&&!w.videoSegmentStream&&(w.coalesceStream.numberOfTracks++,w.videoSegmentStream=new Ca(f,h),w.videoSegmentStream.on("log",p.getLogTrigger_("videoSegmentStream")),w.videoSegmentStream.on("timelineStartInfo",function(P){v&&!h.keepOriginalTimestamps&&(v.timelineStartInfo=P,w.audioSegmentStream.setEarliestDts(P.dts-p.baseMediaDecodeTime))}),w.videoSegmentStream.on("processedGopsInfo",p.trigger.bind(p,"gopInfo")),w.videoSegmentStream.on("segmentTimingInfo",p.trigger.bind(p,"videoSegmentTimingInfo")),w.videoSegmentStream.on("baseMediaDecodeTime",function(P){v&&w.audioSegmentStream.setVideoBaseMediaDecodeTime(P)}),w.videoSegmentStream.on("timingInfo",p.trigger.bind(p,"videoTimingInfo")),w.h264Stream.pipe(w.videoSegmentStream).pipe(w.coalesceStream)),v&&!w.audioSegmentStream&&(w.coalesceStream.numberOfTracks++,w.audioSegmentStream=new In(v,h),w.audioSegmentStream.on("log",p.getLogTrigger_("audioSegmentStream")),w.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),w.audioSegmentStream.on("segmentTimingInfo",p.trigger.bind(p,"audioSegmentTimingInfo")),w.adtsStream.pipe(w.audioSegmentStream).pipe(w.coalesceStream)),p.trigger("trackinfo",{hasAudio:!!v,hasVideo:!!f})}}),w.coalesceStream.on("data",this.trigger.bind(this,"data")),w.coalesceStream.on("id3Frame",function(A){A.dispatchType=w.metadataStream.dispatchType,p.trigger("id3Frame",A)}),w.coalesceStream.on("caption",this.trigger.bind(this,"caption")),w.coalesceStream.on("done",this.trigger.bind(this,"done")),Zm(this,w)},this.setBaseMediaDecodeTime=function(w){var A=this.transmuxPipeline_;h.keepOriginalTimestamps||(this.baseMediaDecodeTime=w),v&&(v.timelineStartInfo.dts=void 0,v.timelineStartInfo.pts=void 0,Bi.clearDtsInfo(v),A.audioTimestampRolloverStream&&A.audioTimestampRolloverStream.discontinuity()),f&&(A.videoSegmentStream&&(A.videoSegmentStream.gopCache_=[]),f.timelineStartInfo.dts=void 0,f.timelineStartInfo.pts=void 0,Bi.clearDtsInfo(f),A.captionStream.reset()),A.timestampRolloverStream&&A.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(w){v&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(w)},this.setRemux=function(w){var A=this.transmuxPipeline_;h.remux=w,A&&A.coalesceStream&&A.coalesceStream.setRemux(w)},this.alignGopsWith=function(w){f&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(w)},this.getLogTrigger_=function(w){var A=this;return function(x){x.stream=w,A.trigger("log",x)}},this.push=function(w){if(m){var A=H_(w);A&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!A&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),m=!1}this.transmuxPipeline_.headOfPipeline.push(w)},this.flush=function(){m=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Iu.prototype=new Au;var z_={Transmuxer:Iu,VideoSegmentStream:Ca,AudioSegmentStream:In,AUDIO_PROPERTIES:fc,VIDEO_PROPERTIES:mc,generateSegmentTimingInfo:Cc},$_=function(h){return h>>>0},j_=function(h){return("00"+h.toString(16)).slice(-2)},Lu={toUnsigned:$_,toHexString:j_},q_=function(h){var p="";return p+=String.fromCharCode(h[0]),p+=String.fromCharCode(h[1]),p+=String.fromCharCode(h[2]),p+=String.fromCharCode(h[3]),p},tC=q_,K_=Lu.toUnsigned,Y_=tC,iC=function(h,p){var m=[],f,v,w,A,x;if(!p.length)return null;for(f=0;f<h.byteLength;)v=K_(h[f]<<24|h[f+1]<<16|h[f+2]<<8|h[f+3]),w=Y_(h.subarray(f+4,f+8)),A=v>1?f+v:h.byteLength,w===p[0]&&(p.length===1?m.push(h.subarray(f+8,A)):(x=iC(h.subarray(f+8,A),p.slice(1)),x.length&&(m=m.concat(x)))),f=A;return m},sC=iC,X_=Lu.toUnsigned,Q_=n.getUint64,J_=function(h){var p={version:h[0],flags:new Uint8Array(h.subarray(1,4))};return p.version===1?p.baseMediaDecodeTime=Q_(h.subarray(4)):p.baseMediaDecodeTime=X_(h[4]<<24|h[5]<<16|h[6]<<8|h[7]),p},rC=J_,Z_=function(h){return{isLeading:(h[0]&12)>>>2,dependsOn:h[0]&3,isDependedOn:(h[1]&192)>>>6,hasRedundancy:(h[1]&48)>>>4,paddingValue:(h[1]&14)>>>1,isNonSyncSample:h[1]&1,degradationPriority:h[2]<<8|h[3]}},eD=Z_,nC=eD,tD=function(h){var p={version:h[0],flags:new Uint8Array(h.subarray(1,4)),samples:[]},m=new DataView(h.buffer,h.byteOffset,h.byteLength),f=p.flags[2]&1,v=p.flags[2]&4,w=p.flags[1]&1,A=p.flags[1]&2,x=p.flags[1]&4,P=p.flags[1]&8,M=m.getUint32(4),G=8,B;for(f&&(p.dataOffset=m.getInt32(G),G+=4),v&&M&&(B={flags:nC(h.subarray(G,G+4))},G+=4,w&&(B.duration=m.getUint32(G),G+=4),A&&(B.size=m.getUint32(G),G+=4),P&&(p.version===1?B.compositionTimeOffset=m.getInt32(G):B.compositionTimeOffset=m.getUint32(G),G+=4),p.samples.push(B),M--);M--;)B={},w&&(B.duration=m.getUint32(G),G+=4),A&&(B.size=m.getUint32(G),G+=4),x&&(B.flags=nC(h.subarray(G,G+4)),G+=4),P&&(p.version===1?B.compositionTimeOffset=m.getInt32(G):B.compositionTimeOffset=m.getUint32(G),G+=4),p.samples.push(B);return p},oC=tD,iD=function(h){var p=new DataView(h.buffer,h.byteOffset,h.byteLength),m={version:h[0],flags:new Uint8Array(h.subarray(1,4)),trackId:p.getUint32(4)},f=m.flags[2]&1,v=m.flags[2]&2,w=m.flags[2]&8,A=m.flags[2]&16,x=m.flags[2]&32,P=m.flags[0]&65536,M=m.flags[0]&131072,G;return G=8,f&&(G+=4,m.baseDataOffset=p.getUint32(12),G+=4),v&&(m.sampleDescriptionIndex=p.getUint32(G),G+=4),w&&(m.defaultSampleDuration=p.getUint32(G),G+=4),A&&(m.defaultSampleSize=p.getUint32(G),G+=4),x&&(m.defaultSampleFlags=p.getUint32(G)),P&&(m.durationIsEmpty=!0),!f&&M&&(m.baseDataOffsetIsMoof=!0),m},aC=iD,va;typeof window<"u"?va=window:typeof t<"u"?va=t:typeof self<"u"?va=self:va={};var lC=va,sD=km.discardEmulationPreventionBytes,rD=Gm.CaptionStream,ya=sC,nD=rC,oD=oC,aD=aC,uC=lC,lD=function(h,p){for(var m=h,f=0;f<p.length;f++){var v=p[f];if(m<v.size)return v;m-=v.size}return null},uD=function(h,p,m){var f=new DataView(h.buffer,h.byteOffset,h.byteLength),v={logs:[],seiNals:[]},w,A,x,P;for(A=0;A+4<h.length;A+=x)if(x=f.getUint32(A),A+=4,!(x<=0))switch(h[A]&31){case 6:var M=h.subarray(A+1,A+1+x),G=lD(A,p);if(w={nalUnitType:"sei_rbsp",size:x,data:M,escapedRBSP:sD(M),trackId:m},G)w.pts=G.pts,w.dts=G.dts,P=G;else if(P)w.pts=P.pts,w.dts=P.dts;else{v.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+A+" for trackId "+m+". See mux.js#223."});break}v.seiNals.push(w);break}return v},dD=function(h,p,m){var f=p,v=m.defaultSampleDuration||0,w=m.defaultSampleSize||0,A=m.trackId,x=[];return h.forEach(function(P){var M=oD(P),G=M.samples;G.forEach(function(B){B.duration===void 0&&(B.duration=v),B.size===void 0&&(B.size=w),B.trackId=A,B.dts=f,B.compositionTimeOffset===void 0&&(B.compositionTimeOffset=0),typeof f=="bigint"?(B.pts=f+uC.BigInt(B.compositionTimeOffset),f+=uC.BigInt(B.duration)):(B.pts=f+B.compositionTimeOffset,f+=B.duration)}),x=x.concat(G)}),x},hD=function(h,p){var m=ya(h,["moof","traf"]),f=ya(h,["mdat"]),v={},w=[];return f.forEach(function(A,x){var P=m[x];w.push({mdat:A,traf:P})}),w.forEach(function(A){var x=A.mdat,P=A.traf,M=ya(P,["tfhd"]),G=aD(M[0]),B=G.trackId,X=ya(P,["tfdt"]),j=X.length>0?nD(X[0]).baseMediaDecodeTime:0,ne=ya(P,["trun"]),ue,ct;p===B&&ne.length>0&&(ue=dD(ne,j,G),ct=uD(x,ue,B),v[B]||(v[B]={seiNals:[],logs:[]}),v[B].seiNals=v[B].seiNals.concat(ct.seiNals),v[B].logs=v[B].logs.concat(ct.logs))}),v},cD=function(h,p,m){var f;if(p===null)return null;f=hD(h,p);var v=f[p]||{};return{seiNals:v.seiNals,logs:v.logs,timescale:m}},pD=function(){var h=!1,p,m,f,v,w,A;this.isInitialized=function(){return h},this.init=function(x){p=new rD,h=!0,A=x?x.isPartial:!1,p.on("data",function(P){P.startTime=P.startPts/v,P.endTime=P.endPts/v,w.captions.push(P),w.captionStreams[P.stream]=!0}),p.on("log",function(P){w.logs.push(P)})},this.isNewInit=function(x,P){return x&&x.length===0||P&&typeof P=="object"&&Object.keys(P).length===0?!1:f!==x[0]||v!==P[f]},this.parse=function(x,P,M){var G;if(this.isInitialized()){if(!P||!M)return null;if(this.isNewInit(P,M))f=P[0],v=M[f];else if(f===null||!v)return m.push(x),null}else return null;for(;m.length>0;){var B=m.shift();this.parse(B,P,M)}return G=cD(x,f,v),G&&G.logs&&(w.logs=w.logs.concat(G.logs)),G===null||!G.seiNals?w.logs.length?{logs:w.logs,captions:[],captionStreams:[]}:null:(this.pushNals(G.seiNals),this.flushStream(),w)},this.pushNals=function(x){if(!this.isInitialized()||!x||x.length===0)return null;x.forEach(function(P){p.push(P)})},this.flushStream=function(){if(!this.isInitialized())return null;A?p.partialFlush():p.flush()},this.clearParsedCaptions=function(){w.captions=[],w.captionStreams={},w.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;p.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){m=[],f=null,v=null,w?this.clearParsedCaptions():w={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},gD=pD,fD=function(h){for(var p=0,m=String.fromCharCode(h[p]),f="";m!=="\0";)f+=m,p++,m=String.fromCharCode(h[p]);return f+=m,f},mD={uint8ToCString:fD},Fu=mD.uint8ToCString,CD=n.getUint64,vD=function(h){var p=4,m=h[0],f,v,w,A,x,P,M,G;if(m===0){f=Fu(h.subarray(p)),p+=f.length,v=Fu(h.subarray(p)),p+=v.length;var B=new DataView(h.buffer);w=B.getUint32(p),p+=4,x=B.getUint32(p),p+=4,P=B.getUint32(p),p+=4,M=B.getUint32(p),p+=4}else if(m===1){var B=new DataView(h.buffer);w=B.getUint32(p),p+=4,A=CD(h.subarray(p)),p+=8,P=B.getUint32(p),p+=4,M=B.getUint32(p),p+=4,f=Fu(h.subarray(p)),p+=f.length,v=Fu(h.subarray(p)),p+=v.length}G=new Uint8Array(h.subarray(p,h.byteLength));var X={scheme_id_uri:f,value:v,timescale:w||1,presentation_time:A,presentation_time_delta:x,event_duration:P,id:M,message_data:G};return SD(m,X)?X:void 0},yD=function(h,p,m,f){return h||h===0?h/p:f+m/p},SD=function(h,p){var m=p.scheme_id_uri!=="\0",f=h===0&&dC(p.presentation_time_delta)&&m,v=h===1&&dC(p.presentation_time)&&m;return!(h>1)&&f||v},dC=function(h){return h!==void 0||h!==null},ED={parseEmsgBox:vD,scaleTime:yD},Mu=Lu.toUnsigned,Sa=Lu.toHexString,st=sC,Ln=tC,vc=ED,wD=aC,TD=oC,bD=rC,_D=n.getUint64,hC,cC,pC,gC,fC,yc,mC,Sc=lC,DD=Um.parseId3Frames;hC=function(h){var p={},m=st(h,["moov","trak"]);return m.reduce(function(f,v){var w,A,x,P,M;return w=st(v,["tkhd"])[0],!w||(A=w[0],x=A===0?12:20,P=Mu(w[x]<<24|w[x+1]<<16|w[x+2]<<8|w[x+3]),M=st(v,["mdia","mdhd"])[0],!M)?null:(A=M[0],x=A===0?12:20,f[P]=Mu(M[x]<<24|M[x+1]<<16|M[x+2]<<8|M[x+3]),f)},p)},cC=function(h,p){var m;m=st(p,["moof","traf"]);var f=m.reduce(function(v,w){var A=st(w,["tfhd"])[0],x=Mu(A[4]<<24|A[5]<<16|A[6]<<8|A[7]),P=h[x]||9e4,M=st(w,["tfdt"])[0],G=new DataView(M.buffer,M.byteOffset,M.byteLength),B;M[0]===1?B=_D(M.subarray(4,12)):B=G.getUint32(4);let X;return typeof B=="bigint"?X=B/Sc.BigInt(P):typeof B=="number"&&!isNaN(B)&&(X=B/P),X<Number.MAX_SAFE_INTEGER&&(X=Number(X)),X<v&&(v=X),v},1/0);return typeof f=="bigint"||isFinite(f)?f:0},pC=function(h,p){var m=st(p,["moof","traf"]),f=0,v=0,w;if(m&&m.length){var A=st(m[0],["tfhd"])[0],x=st(m[0],["trun"])[0],P=st(m[0],["tfdt"])[0];if(A){var M=wD(A);w=M.trackId}if(P){var G=bD(P);f=G.baseMediaDecodeTime}if(x){var B=TD(x);B.samples&&B.samples.length&&(v=B.samples[0].compositionTimeOffset||0)}}var X=h[w]||9e4;typeof f=="bigint"&&(v=Sc.BigInt(v),X=Sc.BigInt(X));var j=(f+v)/X;return typeof j=="bigint"&&j<Number.MAX_SAFE_INTEGER&&(j=Number(j)),j},gC=function(h){var p=st(h,["moov","trak"]),m=[];return p.forEach(function(f){var v=st(f,["mdia","hdlr"]),w=st(f,["tkhd"]);v.forEach(function(A,x){var P=Ln(A.subarray(8,12)),M=w[x],G,B,X;P==="vide"&&(G=new DataView(M.buffer,M.byteOffset,M.byteLength),B=G.getUint8(0),X=B===0?G.getUint32(12):G.getUint32(20),m.push(X))})}),m},yc=function(h){var p=h[0],m=p===0?12:20;return Mu(h[m]<<24|h[m+1]<<16|h[m+2]<<8|h[m+3])},fC=function(h){var p=st(h,["moov","trak"]),m=[];return p.forEach(function(f){var v={},w=st(f,["tkhd"])[0],A,x;w&&(A=new DataView(w.buffer,w.byteOffset,w.byteLength),x=A.getUint8(0),v.id=x===0?A.getUint32(12):A.getUint32(20));var P=st(f,["mdia","hdlr"])[0];if(P){var M=Ln(P.subarray(8,12));M==="vide"?v.type="video":M==="soun"?v.type="audio":v.type=M}var G=st(f,["mdia","minf","stbl","stsd"])[0];if(G){var B=G.subarray(8);v.codec=Ln(B.subarray(4,8));var X=st(B,[v.codec])[0],j,ne;X&&(/^[asm]vc[1-9]$/i.test(v.codec)?(j=X.subarray(78),ne=Ln(j.subarray(4,8)),ne==="avcC"&&j.length>11?(v.codec+=".",v.codec+=Sa(j[9]),v.codec+=Sa(j[10]),v.codec+=Sa(j[11])):v.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(v.codec)?(j=X.subarray(28),ne=Ln(j.subarray(4,8)),ne==="esds"&&j.length>20&&j[19]!==0?(v.codec+="."+Sa(j[19]),v.codec+="."+Sa(j[20]>>>2&63).replace(/^0/,"")):v.codec="mp4a.40.2"):v.codec=v.codec.toLowerCase())}var ue=st(f,["mdia","mdhd"])[0];ue&&(v.timescale=yc(ue)),m.push(v)}),m},mC=function(h,p=0){var m=st(h,["emsg"]);return m.map(f=>{var v=vc.parseEmsgBox(new Uint8Array(f)),w=DD(v.message_data);return{cueTime:vc.scaleTime(v.presentation_time,v.timescale,v.presentation_time_delta,p),duration:vc.scaleTime(v.event_duration,v.timescale),frames:w}})};var Ec={findBox:st,parseType:Ln,timescale:hC,startTime:cC,compositionStartTime:pC,videoTrackIds:gC,tracks:fC,getTimescaleFromMediaHeader:yc,getEmsgID3:mC},wc=yu,CC=function(h){var p=h[1]&31;return p<<=8,p|=h[2],p},Ou=function(h){return!!(h[1]&64)},Nu=function(h){var p=0;return(h[3]&48)>>>4>1&&(p+=h[4]+1),p},RD=function(h,p){var m=CC(h);return m===0?"pat":m===p?"pmt":p?"pes":null},AD=function(h){var p=Ou(h),m=4+Nu(h);return p&&(m+=h[m]+1),(h[m+10]&31)<<8|h[m+11]},xD=function(h){var p={},m=Ou(h),f=4+Nu(h);if(m&&(f+=h[f]+1),!!(h[f+5]&1)){var v,w,A;v=(h[f+1]&15)<<8|h[f+2],w=3+v-4,A=(h[f+10]&15)<<8|h[f+11];for(var x=12+A;x<w;){var P=f+x;p[(h[P+1]&31)<<8|h[P+2]]=h[P],x+=((h[P+3]&15)<<8|h[P+4])+5}return p}},PD=function(h,p){var m=CC(h),f=p[m];switch(f){case wc.H264_STREAM_TYPE:return"video";case wc.ADTS_STREAM_TYPE:return"audio";case wc.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},ID=function(h){var p=Ou(h);if(!p)return null;var m=4+Nu(h);if(m>=h.byteLength)return null;var f=null,v;return v=h[m+7],v&192&&(f={},f.pts=(h[m+9]&14)<<27|(h[m+10]&255)<<20|(h[m+11]&254)<<12|(h[m+12]&255)<<5|(h[m+13]&254)>>>3,f.pts*=4,f.pts+=(h[m+13]&6)>>>1,f.dts=f.pts,v&64&&(f.dts=(h[m+14]&14)<<27|(h[m+15]&255)<<20|(h[m+16]&254)<<12|(h[m+17]&255)<<5|(h[m+18]&254)>>>3,f.dts*=4,f.dts+=(h[m+18]&6)>>>1)),f},Tc=function(h){switch(h){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},LD=function(h){for(var p=4+Nu(h),m=h.subarray(p),f=0,v=0,w=!1,A;v<m.byteLength-3;v++)if(m[v+2]===1){f=v+5;break}for(;f<m.byteLength;)switch(m[f]){case 0:if(m[f-1]!==0){f+=2;break}else if(m[f-2]!==0){f++;break}v+3!==f-2&&(A=Tc(m[v+3]&31),A==="slice_layer_without_partitioning_rbsp_idr"&&(w=!0));do f++;while(m[f]!==1&&f<m.length);v=f-2,f+=3;break;case 1:if(m[f-1]!==0||m[f-2]!==0){f+=3;break}A=Tc(m[v+3]&31),A==="slice_layer_without_partitioning_rbsp_idr"&&(w=!0),v=f-2,f+=3;break;default:f+=3;break}return m=m.subarray(v),f-=v,v=0,m&&m.byteLength>3&&(A=Tc(m[v+3]&31),A==="slice_layer_without_partitioning_rbsp_idr"&&(w=!0)),w},FD={parseType:RD,parsePat:AD,parsePmt:xD,parsePayloadUnitStartIndicator:Ou,parsePesType:PD,parsePesTime:ID,videoPacketContainsKeyFrame:LD},vC=yu,Fn=Bm.handleRollover,Me={};Me.ts=FD,Me.aac=gc;var Ir=We.ONE_SECOND_IN_TS,Pt=188,ss=71,MD=function(h,p){for(var m=0,f=Pt,v,w;f<h.byteLength;){if(h[m]===ss&&h[f]===ss){switch(v=h.subarray(m,f),w=Me.ts.parseType(v,p.pid),w){case"pat":p.pid=Me.ts.parsePat(v);break;case"pmt":var A=Me.ts.parsePmt(v);p.table=p.table||{},Object.keys(A).forEach(function(x){p.table[x]=A[x]});break}m+=Pt,f+=Pt;continue}m++,f++}},yC=function(h,p,m){for(var f=0,v=Pt,w,A,x,P,M,G=!1;v<=h.byteLength;){if(h[f]===ss&&(h[v]===ss||v===h.byteLength)){switch(w=h.subarray(f,v),A=Me.ts.parseType(w,p.pid),A){case"pes":x=Me.ts.parsePesType(w,p.table),P=Me.ts.parsePayloadUnitStartIndicator(w),x==="audio"&&P&&(M=Me.ts.parsePesTime(w),M&&(M.type="audio",m.audio.push(M),G=!0));break}if(G)break;f+=Pt,v+=Pt;continue}f++,v++}for(v=h.byteLength,f=v-Pt,G=!1;f>=0;){if(h[f]===ss&&(h[v]===ss||v===h.byteLength)){switch(w=h.subarray(f,v),A=Me.ts.parseType(w,p.pid),A){case"pes":x=Me.ts.parsePesType(w,p.table),P=Me.ts.parsePayloadUnitStartIndicator(w),x==="audio"&&P&&(M=Me.ts.parsePesTime(w),M&&(M.type="audio",m.audio.push(M),G=!0));break}if(G)break;f-=Pt,v-=Pt;continue}f--,v--}},OD=function(h,p,m){for(var f=0,v=Pt,w,A,x,P,M,G,B,X,j=!1,ne={data:[],size:0};v<h.byteLength;){if(h[f]===ss&&h[v]===ss){switch(w=h.subarray(f,v),A=Me.ts.parseType(w,p.pid),A){case"pes":if(x=Me.ts.parsePesType(w,p.table),P=Me.ts.parsePayloadUnitStartIndicator(w),x==="video"&&(P&&!j&&(M=Me.ts.parsePesTime(w),M&&(M.type="video",m.video.push(M),j=!0)),!m.firstKeyFrame)){if(P&&ne.size!==0){for(G=new Uint8Array(ne.size),B=0;ne.data.length;)X=ne.data.shift(),G.set(X,B),B+=X.byteLength;if(Me.ts.videoPacketContainsKeyFrame(G)){var ue=Me.ts.parsePesTime(G);ue?(m.firstKeyFrame=ue,m.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}ne.size=0}ne.data.push(w),ne.size+=w.byteLength}break}if(j&&m.firstKeyFrame)break;f+=Pt,v+=Pt;continue}f++,v++}for(v=h.byteLength,f=v-Pt,j=!1;f>=0;){if(h[f]===ss&&h[v]===ss){switch(w=h.subarray(f,v),A=Me.ts.parseType(w,p.pid),A){case"pes":x=Me.ts.parsePesType(w,p.table),P=Me.ts.parsePayloadUnitStartIndicator(w),x==="video"&&P&&(M=Me.ts.parsePesTime(w),M&&(M.type="video",m.video.push(M),j=!0));break}if(j)break;f-=Pt,v-=Pt;continue}f--,v--}},ND=function(h,p){if(h.audio&&h.audio.length){var m=p;(typeof m>"u"||isNaN(m))&&(m=h.audio[0].dts),h.audio.forEach(function(w){w.dts=Fn(w.dts,m),w.pts=Fn(w.pts,m),w.dtsTime=w.dts/Ir,w.ptsTime=w.pts/Ir})}if(h.video&&h.video.length){var f=p;if((typeof f>"u"||isNaN(f))&&(f=h.video[0].dts),h.video.forEach(function(w){w.dts=Fn(w.dts,f),w.pts=Fn(w.pts,f),w.dtsTime=w.dts/Ir,w.ptsTime=w.pts/Ir}),h.firstKeyFrame){var v=h.firstKeyFrame;v.dts=Fn(v.dts,f),v.pts=Fn(v.pts,f),v.dtsTime=v.dts/Ir,v.ptsTime=v.pts/Ir}}},kD=function(h){for(var p=!1,m=0,f=null,v=null,w=0,A=0,x;h.length-A>=3;){var P=Me.aac.parseType(h,A);switch(P){case"timed-metadata":if(h.length-A<10){p=!0;break}if(w=Me.aac.parseId3TagSize(h,A),w>h.length){p=!0;break}v===null&&(x=h.subarray(A,A+w),v=Me.aac.parseAacTimestamp(x)),A+=w;break;case"audio":if(h.length-A<7){p=!0;break}if(w=Me.aac.parseAdtsSize(h,A),w>h.length){p=!0;break}f===null&&(x=h.subarray(A,A+w),f=Me.aac.parseSampleRate(x)),m++,A+=w;break;default:A++;break}if(p)return null}if(f===null||v===null)return null;var M=Ir/f,G={audio:[{type:"audio",dts:v,pts:v},{type:"audio",dts:v+m*1024*M,pts:v+m*1024*M}]};return G},GD=function(h){var p={pid:null,table:null},m={};MD(h,p);for(var f in p.table)if(p.table.hasOwnProperty(f)){var v=p.table[f];switch(v){case vC.H264_STREAM_TYPE:m.video=[],OD(h,p,m),m.video.length===0&&delete m.video;break;case vC.ADTS_STREAM_TYPE:m.audio=[],yC(h,p,m),m.audio.length===0&&delete m.audio;break}}return m},VD=function(h,p){var m=Me.aac.isLikelyAacData(h),f;return m?f=kD(h):f=GD(h),!f||!f.audio&&!f.video?null:(ND(f,p),f)},BD={inspect:VD,parseAudioPes_:yC};const HD=function(h,p){p.on("data",function(m){const f=m.initSegment;m.initSegment={data:f.buffer,byteOffset:f.byteOffset,byteLength:f.byteLength};const v=m.data;m.data=v.buffer,h.postMessage({action:"data",segment:m,byteOffset:v.byteOffset,byteLength:v.byteLength},[m.data])}),p.on("done",function(m){h.postMessage({action:"done"})}),p.on("gopInfo",function(m){h.postMessage({action:"gopInfo",gopInfo:m})}),p.on("videoSegmentTimingInfo",function(m){const f={start:{decode:We.videoTsToSeconds(m.start.dts),presentation:We.videoTsToSeconds(m.start.pts)},end:{decode:We.videoTsToSeconds(m.end.dts),presentation:We.videoTsToSeconds(m.end.pts)},baseMediaDecodeTime:We.videoTsToSeconds(m.baseMediaDecodeTime)};m.prependedContentDuration&&(f.prependedContentDuration=We.videoTsToSeconds(m.prependedContentDuration)),h.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:f})}),p.on("audioSegmentTimingInfo",function(m){const f={start:{decode:We.videoTsToSeconds(m.start.dts),presentation:We.videoTsToSeconds(m.start.pts)},end:{decode:We.videoTsToSeconds(m.end.dts),presentation:We.videoTsToSeconds(m.end.pts)},baseMediaDecodeTime:We.videoTsToSeconds(m.baseMediaDecodeTime)};m.prependedContentDuration&&(f.prependedContentDuration=We.videoTsToSeconds(m.prependedContentDuration)),h.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:f})}),p.on("id3Frame",function(m){h.postMessage({action:"id3Frame",id3Frame:m})}),p.on("caption",function(m){h.postMessage({action:"caption",caption:m})}),p.on("trackinfo",function(m){h.postMessage({action:"trackinfo",trackInfo:m})}),p.on("audioTimingInfo",function(m){h.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:We.videoTsToSeconds(m.start),end:We.videoTsToSeconds(m.end)}})}),p.on("videoTimingInfo",function(m){h.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:We.videoTsToSeconds(m.start),end:We.videoTsToSeconds(m.end)}})}),p.on("log",function(m){h.postMessage({action:"log",log:m})})};class SC{constructor(p,m){this.options=m||{},this.self=p,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new z_.Transmuxer(this.options),HD(this.self,this.transmuxer)}pushMp4Captions(p){this.captionParser||(this.captionParser=new gD,this.captionParser.init());const m=new Uint8Array(p.data,p.byteOffset,p.byteLength),f=this.captionParser.parse(m,p.trackIds,p.timescales);this.self.postMessage({action:"mp4Captions",captions:f&&f.captions||[],logs:f&&f.logs||[],data:m.buffer},[m.buffer])}probeMp4StartTime({timescales:p,data:m}){const f=Ec.startTime(p,m);this.self.postMessage({action:"probeMp4StartTime",startTime:f,data:m},[m.buffer])}probeMp4Tracks({data:p}){const m=Ec.tracks(p);this.self.postMessage({action:"probeMp4Tracks",tracks:m,data:p},[p.buffer])}probeEmsgID3({data:p,offset:m}){const f=Ec.getEmsgID3(p,m);this.self.postMessage({action:"probeEmsgID3",id3Frames:f,emsgData:p},[p.buffer])}probeTs({data:p,baseStartTime:m}){const f=typeof m=="number"&&!isNaN(m)?m*We.ONE_SECOND_IN_TS:void 0,v=BD.inspect(p,f);let w=null;v&&(w={hasVideo:v.video&&v.video.length===2||!1,hasAudio:v.audio&&v.audio.length===2||!1},w.hasVideo&&(w.videoStart=v.video[0].ptsTime),w.hasAudio&&(w.audioStart=v.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:w,data:p},[p.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(p){const m=new Uint8Array(p.data,p.byteOffset,p.byteLength);this.transmuxer.push(m)}reset(){this.transmuxer.reset()}setTimestampOffset(p){const m=p.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(We.secondsToVideoTs(m)))}setAudioAppendStart(p){this.transmuxer.setAudioAppendStart(Math.ceil(We.secondsToVideoTs(p.appendStart)))}setRemux(p){this.transmuxer.setRemux(p.remux)}flush(p){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(p){this.transmuxer.alignGopsWith(p.gopsToAlignWith.slice())}}self.onmessage=function(h){if(h.data.action==="init"&&h.data.options){this.messageHandlers=new SC(self,h.data.options);return}this.messageHandlers||(this.messageHandlers=new SC(self)),h.data&&h.data.action&&h.data.action!=="init"&&this.messageHandlers[h.data.action]&&this.messageHandlers[h.data.action](h.data)}}));var xL=fw(AL);const PL=(t,e,i)=>{const{type:s,initSegment:r,captions:n,captionStreams:o,metadata:a,videoFrameDtsTime:l,videoFramePtsTime:u}=t.data.segment;e.buffer.push({captions:n,captionStreams:o,metadata:a});const d=t.data.segment.boxes||{data:t.data.segment.data},c={type:s,data:new Uint8Array(d.data,d.data.byteOffset,d.data.byteLength),initSegment:new Uint8Array(r.data,r.byteOffset,r.byteLength)};typeof l<"u"&&(c.videoFrameDtsTime=l),typeof u<"u"&&(c.videoFramePtsTime=u),i(c)},IL=({transmuxedData:t,callback:e})=>{t.buffer=[],e(t)},LL=(t,e)=>{e.gopInfo=t.data.gopInfo},vw=t=>{const{transmuxer:e,bytes:i,audioAppendStart:s,gopsToAlignWith:r,remux:n,onData:o,onTrackInfo:a,onAudioTimingInfo:l,onVideoTimingInfo:u,onVideoSegmentTimingInfo:d,onAudioSegmentTimingInfo:c,onId3:C,onCaptions:E,onDone:y,onEndedTimeline:_,onTransmuxerLog:b,isEndOfTimeline:R}=t,D={buffer:[]};let O=R;const L=I=>{e.currentTransmux===t&&(I.data.action==="data"&&PL(I,D,o),I.data.action==="trackinfo"&&a(I.data.trackInfo),I.data.action==="gopInfo"&&LL(I,D),I.data.action==="audioTimingInfo"&&l(I.data.audioTimingInfo),I.data.action==="videoTimingInfo"&&u(I.data.videoTimingInfo),I.data.action==="videoSegmentTimingInfo"&&d(I.data.videoSegmentTimingInfo),I.data.action==="audioSegmentTimingInfo"&&c(I.data.audioSegmentTimingInfo),I.data.action==="id3Frame"&&C([I.data.id3Frame],I.data.id3Frame.dispatchType),I.data.action==="caption"&&E(I.data.caption),I.data.action==="endedtimeline"&&(O=!1,_()),I.data.action==="log"&&b(I.data.log),I.data.type==="transmuxed"&&(O||(e.onmessage=null,IL({transmuxedData:D,callback:y}),yw(e))))};if(e.onmessage=L,s&&e.postMessage({action:"setAudioAppendStart",appendStart:s}),Array.isArray(r)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:r}),typeof n<"u"&&e.postMessage({action:"setRemux",remux:n}),i.byteLength){const I=i instanceof ArrayBuffer?i:i.buffer,k=i instanceof ArrayBuffer?0:i.byteOffset;e.postMessage({action:"push",data:I,byteOffset:k,byteLength:i.byteLength},[I])}R&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},yw=t=>{t.currentTransmux=null,t.transmuxQueue.length&&(t.currentTransmux=t.transmuxQueue.shift(),typeof t.currentTransmux=="function"?t.currentTransmux():vw(t.currentTransmux))},Hv=(t,e)=>{t.postMessage({action:e}),yw(t)},Sw=(t,e)=>{if(!e.currentTransmux){e.currentTransmux=t,Hv(e,t);return}e.transmuxQueue.push(Hv.bind(null,e,t))},FL=t=>{Sw("reset",t)},ML=t=>{Sw("endTimeline",t)},Ew=t=>{if(!t.transmuxer.currentTransmux){t.transmuxer.currentTransmux=t,vw(t);return}t.transmuxer.transmuxQueue.push(t)},OL=t=>{const e=new xL;e.currentTransmux=null,e.transmuxQueue=[];const i=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)),e.postMessage({action:"init",options:t}),e};var qc={reset:FL,endTimeline:ML,transmux:Ew,createTransmuxer:OL};const Ya=function(t){const e=t.transmuxer,i=t.endAction||t.action,s=t.callback,r=Di({},t,{endAction:null,transmuxer:null,callback:null}),n=o=>{o.data.action===i&&(e.removeEventListener("message",n),o.data.data&&(o.data.data=new Uint8Array(o.data.data,t.byteOffset||0,t.byteLength||o.data.data.byteLength),t.data&&(t.data=o.data.data)),s(o.data))};if(e.addEventListener("message",n),t.data){const o=t.data instanceof ArrayBuffer;r.byteOffset=o?0:t.data.byteOffset,r.byteLength=t.data.byteLength;const a=[o?t.data:t.data.buffer];e.postMessage(r,a)}else e.postMessage(r)},ps={FAILURE:2,TIMEOUT:-101,ABORTED:-102},zp=t=>{t.forEach(e=>{e.abort()})},NL=t=>({bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}),kL=t=>{const e=t.target,s={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return s.bytesReceived=t.loaded,s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3),s},bf=(t,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:ps.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:ps.ABORTED,xhr:e}:t?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:ps.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:ps.FAILURE,xhr:e}:null,Uv=(t,e,i)=>(s,r)=>{const n=r.response,o=bf(s,r);if(o)return i(o,t);if(n.byteLength!==16)return i({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:ps.FAILURE,xhr:r},t);const a=new DataView(n),l=new Uint32Array([a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12)]);for(let u=0;u<e.length;u++)e[u].bytes=l;return i(null,t)},ww=(t,e)=>{const i=Ug(t.map.bytes);if(i!=="mp4"){const s=t.map.resolvedUri||t.map.uri,r=i||"unknown";return e({internal:!0,message:`Found unsupported ${r} container for initialization segment at URL: ${s}`,code:ps.FAILURE,metadata:{errorType:V.Error.UnsupportedMediaInitialization,mediaType:r}})}Ya({action:"probeMp4Tracks",data:t.map.bytes,transmuxer:t.transmuxer,callback:({tracks:s,data:r})=>(t.map.bytes=r,s.forEach(function(n){t.map.tracks=t.map.tracks||{},!t.map.tracks[n.type]&&(t.map.tracks[n.type]=n,typeof n.id=="number"&&n.timescale&&(t.map.timescales=t.map.timescales||{},t.map.timescales[n.id]=n.timescale))}),e(null))})},GL=({segment:t,finishProcessingFn:e})=>(i,s)=>{const r=bf(i,s);if(r)return e(r,t);const n=new Uint8Array(s.response);if(t.map.key)return t.map.encryptedBytes=n,e(null,t);t.map.bytes=n,ww(t,function(o){if(o)return o.xhr=s,o.status=s.status,e(o,t);e(null,t)})},VL=({segment:t,finishProcessingFn:e,responseType:i})=>(s,r)=>{const n=bf(s,r);if(n)return e(n,t);const o=i==="arraybuffer"||!r.responseText?r.response:DL(r.responseText.substring(t.lastReachedChar||0));return t.stats=NL(r),t.key?t.encryptedBytes=new Uint8Array(o):t.bytes=new Uint8Array(o),e(null,t)},BL=({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})=>{const E=t.map&&t.map.tracks||{},y=!!(E.audio&&E.video);let _=s.bind(null,t,"audio","start");const b=s.bind(null,t,"audio","end");let R=s.bind(null,t,"video","start");const D=s.bind(null,t,"video","end"),O=()=>Ew({bytes:e,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:y,onData:L=>{L.type=L.type==="combined"?"video":L.type,d(t,L)},onTrackInfo:L=>{i&&(y&&(L.isMuxed=!0),i(t,L))},onAudioTimingInfo:L=>{_&&typeof L.start<"u"&&(_(L.start),_=null),b&&typeof L.end<"u"&&b(L.end)},onVideoTimingInfo:L=>{R&&typeof L.start<"u"&&(R(L.start),R=null),D&&typeof L.end<"u"&&D(L.end)},onVideoSegmentTimingInfo:L=>{r(L)},onAudioSegmentTimingInfo:L=>{n(L)},onId3:(L,I)=>{o(t,L,I)},onCaptions:L=>{a(t,[L])},isEndOfTimeline:l,onEndedTimeline:()=>{u()},onTransmuxerLog:C,onDone:L=>{c&&(L.type=L.type==="combined"?"video":L.type,c(null,t,L))}});Ya({action:"probeTs",transmuxer:t.transmuxer,data:e,baseStartTime:t.baseStartTime,callback:L=>{t.bytes=e=L.data;const I=L.result;I&&(i(t,{hasAudio:I.hasAudio,hasVideo:I.hasVideo,isMuxed:y}),i=null),O()}})},Tw=({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})=>{let E=new Uint8Array(e);if(pP(E)){t.isFmp4=!0;const{tracks:y}=t.map,_={isFmp4:!0,hasVideo:!!y.video,hasAudio:!!y.audio};y.audio&&y.audio.codec&&y.audio.codec!=="enca"&&(_.audioCodec=y.audio.codec),y.video&&y.video.codec&&y.video.codec!=="encv"&&(_.videoCodec=y.video.codec),y.video&&y.audio&&(_.isMuxed=!0),i(t,_);const b=(R,D)=>{d(t,{data:E,type:_.hasAudio&&!_.isMuxed?"audio":"video"}),D&&D.length&&o(t,D),R&&R.length&&a(t,R),c(null,t,{})};Ya({action:"probeMp4StartTime",timescales:t.map.timescales,data:E,transmuxer:t.transmuxer,callback:({data:R,startTime:D})=>{e=R.buffer,t.bytes=E=R,_.hasAudio&&!_.isMuxed&&s(t,"audio","start",D),_.hasVideo&&s(t,"video","start",D),Ya({action:"probeEmsgID3",data:E,transmuxer:t.transmuxer,offset:D,callback:({emsgData:O,id3Frames:L})=>{if(e=O.buffer,t.bytes=E=O,!y.video||!O.byteLength||!t.transmuxer){b(void 0,L);return}Ya({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:E,timescales:t.map.timescales,trackIds:[y.video.id],callback:I=>{e=I.data.buffer,t.bytes=E=I.data,I.logs.forEach(function(k){C(Ie(k,{stream:"mp4CaptionParser"}))}),b(I.captions,L)}})}})}});return}if(!t.transmuxer){c(null,t,{});return}if(typeof t.container>"u"&&(t.container=Ug(E)),t.container!=="ts"&&t.container!=="aac"){i(t,{hasAudio:!1,hasVideo:!1}),c(null,t,{});return}BL({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})},bw=function({id:t,key:e,encryptedBytes:i,decryptionWorker:s},r){const n=a=>{if(a.data.source===t){s.removeEventListener("message",n);const l=a.data.decrypted;r(new Uint8Array(l.bytes,l.byteOffset,l.byteLength))}};s.addEventListener("message",n);let o;e.bytes.slice?o=e.bytes.slice():o=new Uint32Array(Array.prototype.slice.call(e.bytes)),s.postMessage(uw({source:t,encrypted:i,key:o,iv:e.iv}),[i.buffer,o.buffer])},HL=({decryptionWorker:t,segment:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})=>{bw({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:t},E=>{e.bytes=E,Tw({segment:e,bytes:e.bytes,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})})},UL=({activeXhrs:t,decryptionWorker:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})=>{let E=0,y=!1;return(_,b)=>{if(!y){if(_)return y=!0,zp(t),c(_,b);if(E+=1,E===t.length){const R=function(){if(b.encryptedBytes)return HL({decryptionWorker:e,segment:b,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C});Tw({segment:b,bytes:b.bytes,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:c,onTransmuxerLog:C})};if(b.endOfAllRequests=Date.now(),b.map&&b.map.encryptedBytes&&!b.map.bytes)return bw({decryptionWorker:e,id:b.requestId+"-init",encryptedBytes:b.map.encryptedBytes,key:b.map.key},D=>{b.map.bytes=D,ww(b,O=>{if(O)return zp(t),c(O,b);R()})});R()}}}},WL=({loadendState:t,abortFn:e})=>i=>{i.target.aborted&&e&&!t.calledAbortFn&&(e(),t.calledAbortFn=!0)},zL=({segment:t,progressFn:e,trackInfoFn:i,timingInfoFn:s,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:n,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d})=>c=>{if(!c.target.aborted)return t.stats=Ie(t.stats,kL(c)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),e(c,t)},$L=({xhr:t,xhrOptions:e,decryptionWorker:i,segment:s,abortFn:r,progressFn:n,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:c,isEndOfTimeline:C,endedTimelineFn:E,dataFn:y,doneFn:_,onTransmuxerLog:b})=>{const R=[],D=UL({activeXhrs:R,decryptionWorker:i,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:c,isEndOfTimeline:C,endedTimelineFn:E,dataFn:y,doneFn:_,onTransmuxerLog:b});if(s.key&&!s.key.bytes){const H=[s.key];s.map&&!s.map.bytes&&s.map.key&&s.map.key.resolvedUri===s.key.resolvedUri&&H.push(s.map.key);const ee=Ie(e,{uri:s.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),Q=Uv(s,H,D),Ce=t(ee,Q);R.push(Ce)}if(s.map&&!s.map.bytes){if(s.map.key&&(!s.key||s.key.resolvedUri!==s.map.key.resolvedUri)){const le=Ie(e,{uri:s.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),be=Uv(s,[s.map.key],D),Z=t(le,be);R.push(Z)}const ee=Ie(e,{uri:s.map.resolvedUri,responseType:"arraybuffer",headers:Up(s.map),requestType:"segment-media-initialization"}),Q=GL({segment:s,finishProcessingFn:D}),Ce=t(ee,Q);R.push(Ce)}const O=Ie(e,{uri:s.part&&s.part.resolvedUri||s.resolvedUri,responseType:"arraybuffer",headers:Up(s),requestType:"segment"}),L=VL({segment:s,finishProcessingFn:D,responseType:O.responseType}),I=t(O,L);I.addEventListener("progress",zL({segment:s,progressFn:n,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:c,isEndOfTimeline:C,endedTimelineFn:E,dataFn:y})),R.push(I);const k={};return R.forEach(H=>{H.addEventListener("loadend",WL({loadendState:k,abortFn:r}))}),()=>zp(R)},jL=Ni("CodecUtils"),qL=function(t){const e=t.attributes||{};if(e.CODECS)return as(e.CODECS)},_w=(t,e)=>{const i=e.attributes||{};return t&&t.mediaGroups&&t.mediaGroups.AUDIO&&i.AUDIO&&t.mediaGroups.AUDIO[i.AUDIO]},KL=(t,e)=>{if(!_w(t,e))return!0;const i=e.attributes||{},s=t.mediaGroups.AUDIO[i.AUDIO];for(const r in s)if(!s[r].uri&&!s[r].playlists)return!0;return!1},Dd=function(t){const e={};return t.forEach(({mediaType:i,type:s,details:r})=>{e[i]=e[i]||[],e[i].push(Gy(`${s}${r}`))}),Object.keys(e).forEach(function(i){if(e[i].length>1){jL(`multiple ${i} codecs found as attributes: ${e[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[i]=null;return}e[i]=e[i][0]}),e},Wv=function(t){let e=0;return t.audio&&e++,t.video&&e++,e},Xa=function(t,e){const i=e.attributes||{},s=Dd(qL(e)||[]);if(_w(t,e)&&!s.audio&&!KL(t,e)){const r=Dd(pA(t,i.AUDIO)||[]);r.audio&&(s.audio=r.audio)}return s},Wu=Ni("PlaylistSelector"),zv=function(t){if(!t||!t.playlist)return;const e=t.playlist;return JSON.stringify({id:e.id,bandwidth:t.bandwidth,width:t.width,height:t.height,codecs:e.attributes&&e.attributes.CODECS||""})},Rd=function(t,e){if(!t)return"";const i=F.getComputedStyle(t);return i?i[e]:""},oo=function(t,e){const i=t.slice();t.sort(function(s,r){const n=e(s,r);return n===0?i.indexOf(s)-i.indexOf(r):n})},_f=function(t,e){let i,s;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||F.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(s=e.attributes.BANDWIDTH),s=s||F.Number.MAX_VALUE,i-s},YL=function(t,e){let i,s;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||F.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(s=e.attributes.RESOLUTION.width),s=s||F.Number.MAX_VALUE,i===s&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?t.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-s};let Dw=function(t,e,i,s,r,n){if(!t)return;const o={bandwidth:e,width:i,height:s,limitRenditionByPlayerDimensions:r};let a=t.playlists;Kt.isAudioOnly(t)&&(a=n.getAudioTrackPlaylists_(),o.audioOnly=!0);let l=a.map(I=>{let k;const H=I.attributes&&I.attributes.RESOLUTION&&I.attributes.RESOLUTION.width,ee=I.attributes&&I.attributes.RESOLUTION&&I.attributes.RESOLUTION.height;return k=I.attributes&&I.attributes.BANDWIDTH,k=k||F.Number.MAX_VALUE,{bandwidth:k,width:H,height:ee,playlist:I}});oo(l,(I,k)=>I.bandwidth-k.bandwidth),l=l.filter(I=>!Kt.isIncompatible(I.playlist));let u=l.filter(I=>Kt.isEnabled(I.playlist));u.length||(u=l.filter(I=>!Kt.isDisabled(I.playlist)));const d=u.filter(I=>I.bandwidth*ft.BANDWIDTH_VARIANCE<e);let c=d[d.length-1];const C=d.filter(I=>I.bandwidth===c.bandwidth)[0];if(r===!1){const I=C||u[0]||l[0];if(I&&I.playlist){let k="sortedPlaylistReps";return C&&(k="bandwidthBestRep"),u[0]&&(k="enabledPlaylistReps"),Wu(`choosing ${zv(I)} using ${k} with options`,o),I.playlist}return Wu("could not choose a playlist with options",o),null}const E=d.filter(I=>I.width&&I.height);oo(E,(I,k)=>I.width-k.width);const y=E.filter(I=>I.width===i&&I.height===s);c=y[y.length-1];const _=y.filter(I=>I.bandwidth===c.bandwidth)[0];let b,R,D;_||(b=E.filter(I=>I.width>i||I.height>s),R=b.filter(I=>I.width===b[0].width&&I.height===b[0].height),c=R[R.length-1],D=R.filter(I=>I.bandwidth===c.bandwidth)[0]);let O;if(n.leastPixelDiffSelector){const I=E.map(k=>(k.pixelDiff=Math.abs(k.width-i)+Math.abs(k.height-s),k));oo(I,(k,H)=>k.pixelDiff===H.pixelDiff?H.bandwidth-k.bandwidth:k.pixelDiff-H.pixelDiff),O=I[0]}const L=O||D||_||C||u[0]||l[0];if(L&&L.playlist){let I="sortedPlaylistReps";return O?I="leastPixelDiffRep":D?I="resolutionPlusOneRep":_?I="resolutionBestRep":C?I="bandwidthBestRep":u[0]&&(I="enabledPlaylistReps"),Wu(`choosing ${zv(L)} using ${I} with options`,o),L.playlist}return Wu("could not choose a playlist with options",o),null};const $v=function(){let t=this.useDevicePixelRatio&&F.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(t=this.customPixelRatio),Dw(this.playlists.main,this.systemBandwidth,parseInt(Rd(this.tech_.el(),"width"),10)*t,parseInt(Rd(this.tech_.el(),"height"),10)*t,this.limitRenditionByPlayerDimensions,this.playlistController_)},XL=function(t){let e=-1,i=-1;if(t<0||t>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let s=this.useDevicePixelRatio&&F.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(s=this.customPixelRatio),e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=t*this.systemBandwidth+(1-t)*e,i=this.systemBandwidth),Dw(this.playlists.main,e,parseInt(Rd(this.tech_.el(),"width"),10)*s,parseInt(Rd(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.playlistController_)}},QL=function(t){const{main:e,currentTime:i,bandwidth:s,duration:r,segmentDuration:n,timeUntilRebuffer:o,currentTimeline:a,syncController:l}=t,u=e.playlists.filter(y=>!Kt.isIncompatible(y));let d=u.filter(Kt.isEnabled);d.length||(d=u.filter(y=>!Kt.isDisabled(y)));const C=d.filter(Kt.hasAttribute.bind(null,"BANDWIDTH")).map(y=>{const b=l.getSyncPoint(y,r,a,i)?1:2,D=Kt.estimateSegmentRequestTime(n,s,y)*b-o;return{playlist:y,rebufferingImpact:D}}),E=C.filter(y=>y.rebufferingImpact<=0);return oo(E,(y,_)=>_f(_.playlist,y.playlist)),E.length?E[0]:(oo(C,(y,_)=>y.rebufferingImpact-_.rebufferingImpact),C[0]||null)},JL=function(){const t=this.playlists.main.playlists.filter(Kt.isEnabled);return oo(t,(i,s)=>_f(i,s)),t.filter(i=>!!Xa(this.playlists.main,i).video)[0]||null},ZL=t=>{let e=0,i;return t.bytes&&(i=new Uint8Array(t.bytes),t.segments.forEach(s=>{i.set(s,e),e+=s.byteLength})),i};function Rw(t){try{return new URL(t).pathname.split("/").slice(-2).join("/")}catch{return""}}const eF=function(t,e,i){if(!t[i]){e.trigger({type:"usage",name:"vhs-608"});let s=i;/^cc708_/.test(i)&&(s="SERVICE"+i.split("_")[1]);const r=e.textTracks().getTrackById(s);if(r)t[i]=r;else{const n=e.options_.vhs&&e.options_.vhs.captionServices||{};let o=i,a=i,l=!1;const u=n[s];u&&(o=u.label,a=u.language,l=u.default),t[i]=e.addRemoteTextTrack({kind:"captions",id:s,default:l,label:o,language:a},!1).track}}},tF=function({inbandTextTracks:t,captionArray:e,timestampOffset:i}){if(!e)return;const s=F.WebKitDataCue||F.VTTCue;e.forEach(r=>{const n=r.stream;r.content?r.content.forEach(o=>{const a=new s(r.startTime+i,r.endTime+i,o.text);a.line=o.line,a.align="left",a.position=o.position,a.positionAlign="line-left",t[n].addCue(a)}):t[n].addCue(new s(r.startTime+i,r.endTime+i,r.text))})},iF=function(t){Object.defineProperties(t.frame,{id:{get(){return V.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get(){return V.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get(){return V.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},sF=({inbandTextTracks:t,metadataArray:e,timestampOffset:i,videoDuration:s})=>{if(!e)return;const r=F.WebKitDataCue||F.VTTCue,n=t.metadataTrack_;if(!n||(e.forEach(d=>{const c=d.cueTime+i;typeof c!="number"||F.isNaN(c)||c<0||!(c<1/0)||!d.frames||!d.frames.length||d.frames.forEach(C=>{const E=new r(c,c,C.value||C.url||C.data||"");E.frame=C,E.value=C,iF(E),n.addCue(E)})}),!n.cues||!n.cues.length))return;const o=n.cues,a=[];for(let d=0;d<o.length;d++)o[d]&&a.push(o[d]);const l=a.reduce((d,c)=>{const C=d[c.startTime]||[];return C.push(c),d[c.startTime]=C,d},{}),u=Object.keys(l).sort((d,c)=>Number(d)-Number(c));u.forEach((d,c)=>{const C=l[d],E=isFinite(s)?s:d,y=Number(u[c+1])||E;C.forEach(_=>{_.endTime=y})})},rF={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},nF=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),oF=({inbandTextTracks:t,dateRanges:e})=>{const i=t.metadataTrack_;if(!i)return;const s=F.WebKitDataCue||F.VTTCue;e.forEach(r=>{for(const n of Object.keys(r)){if(nF.has(n))continue;const o=new s(r.startTime,r.endTime,"");o.id=r.id,o.type="com.apple.quicktime.HLS",o.value={key:rF[n],data:r[n]},(n==="scte35Out"||n==="scte35In")&&(o.value.data=new Uint8Array(o.value.data.match(/[\da-f]{2}/gi)).buffer),i.addCue(o)}r.processDateRange()})},jv=(t,e,i)=>{t.metadataTrack_||(t.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,V.browser.IS_ANY_SAFARI||(t.metadataTrack_.inBandMetadataTrackDispatchType=e))},Na=function(t,e,i){let s,r;if(i&&i.cues)for(s=i.cues.length;s--;)r=i.cues[s],r.startTime>=t&&r.endTime<=e&&i.removeCue(r)},aF=function(t){const e=t.cues;if(!e)return;const i={};for(let s=e.length-1;s>=0;s--){const r=e[s],n=`${r.startTime}-${r.endTime}-${r.text}`;i[n]?t.removeCue(r):i[n]=r}},lF=(t,e,i)=>{if(typeof e>"u"||e===null||!t.length)return[];const s=Math.ceil((e-i+3)*Hr.ONE_SECOND_IN_TS);let r;for(r=0;r<t.length&&!(t[r].pts>s);r++);return t.slice(r)},uF=(t,e,i)=>{if(!e.length)return t;if(i)return e.slice();const s=e[0].pts;let r=0;for(r;r<t.length&&!(t[r].pts>=s);r++);return t.slice(0,r).concat(e)},dF=(t,e,i,s)=>{const r=Math.ceil((e-s)*Hr.ONE_SECOND_IN_TS),n=Math.ceil((i-s)*Hr.ONE_SECOND_IN_TS),o=t.slice();let a=t.length;for(;a--&&!(t[a].pts<=n););if(a===-1)return o;let l=a+1;for(;l--&&!(t[l].pts<=r););return l=Math.max(l,0),o.splice(l,a-l+1),o},hF=function(t,e){if(!t&&!e||!t&&e||t&&!e)return!1;if(t===e)return!0;const i=Object.keys(t).sort(),s=Object.keys(e).sort();if(i.length!==s.length)return!1;for(let r=0;r<i.length;r++){const n=i[r];if(n!==s[r]||t[n]!==e[n])return!1}return!0},Aw=22,cF=function(t,e,i){e=e||[];const s=[];let r=0;for(let n=0;n<e.length;n++){const o=e[n];if(t===o.timeline&&(s.push(n),r+=o.duration,r>i))return n}return s.length===0?0:s[s.length-1]},Aa=1,pF=500,qv=t=>typeof t=="number"&&isFinite(t),zu=1/60,gF=(t,e,i)=>t!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,fF=(t,e,i)=>{let s=e-ft.BACK_BUFFER_LENGTH;t.length&&(s=Math.max(s,t.start(0)));const r=e-i;return Math.min(r,s)},Hn=t=>{const{startOfSegment:e,duration:i,segment:s,part:r,playlist:{mediaSequence:n,id:o,segments:a=[]},mediaIndex:l,partIndex:u,timeline:d}=t,c=a.length-1;let C="mediaIndex/partIndex increment";t.getMediaInfoForTime?C=`getMediaInfoForTime (${t.getMediaInfoForTime})`:t.isSyncRequest&&(C="getSyncSegmentCandidate (isSyncRequest)"),t.independent&&(C+=` with independent ${t.independent}`);const E=typeof u=="number",y=t.segment.uri?"segment":"pre-segment",_=E?KE({preloadSegment:s})-1:0;return`${y} [${n+l}/${n+c}]`+(E?` part [${u}/${_}]`:"")+` segment start/end [${s.start} => ${s.end}]`+(E?` part start/end [${r.start} => ${r.end}]`:"")+` startOfSegment [${e}] duration [${i}] timeline [${d}] selected by [${C}] playlist [${o}]`},Kv=t=>`${t}TimingInfo`,mF=({segmentTimeline:t,currentTimeline:e,startOfSegment:i,buffered:s,overrideCheck:r})=>!r&&t===e?null:t<e?i:s.length?s.end(s.length-1):i,Yv=({timelineChangeController:t,currentTimeline:e,segmentTimeline:i,loaderType:s,audioDisabled:r})=>{if(e===i)return!1;if(s==="audio"){const n=t.lastTimelineChange({type:"main"});return!n||n.to!==i}if(s==="main"&&r){const n=t.pendingTimelineChange({type:"audio"});return!(n&&n.to===i)}return!1},CF=t=>{let e=0;return["video","audio"].forEach(function(i){const s=t[`${i}TimingInfo`];if(!s)return;const{start:r,end:n}=s;let o;typeof r=="bigint"||typeof n=="bigint"?o=F.BigInt(n)-F.BigInt(r):typeof r=="number"&&typeof n=="number"&&(o=n-r),typeof o<"u"&&o>e&&(e=o)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},Xv=({segmentDuration:t,maxDuration:e})=>t?Math.round(t)>e+hs:!1,vF=(t,e)=>{if(e!=="hls")return null;const i=CF({audioTimingInfo:t.audioTimingInfo,videoTimingInfo:t.videoTimingInfo});if(!i)return null;const s=t.playlist.targetDuration,r=Xv({segmentDuration:i,maxDuration:s*2}),n=Xv({segmentDuration:i,maxDuration:s}),o=`Segment with index ${t.mediaIndex} from playlist ${t.playlist.id} has a duration of ${i} when the reported duration is ${t.duration} and the target duration is ${s}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return r||n?{severity:r?"warn":"info",message:o}:null};class $p extends V.EventTarget{constructor(e,i={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=Ni(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(s){s!==this.state_&&(this.logger_(`${this.state_} -> ${s}`),this.state_=s,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return qc.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&F.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,F.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&qc.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return bt();if(this.loaderType_==="main"){const{hasAudio:i,hasVideo:s,isMuxed:r}=e;if(s&&i&&!this.audioDisabled_&&!r)return this.sourceUpdater_.buffered();if(s)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,i=!1){if(!e)return null;const s=_d(e);let r=this.initSegments_[s];return i&&!r&&e.bytes&&(this.initSegments_[s]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),r||e}segmentKey(e,i=!1){if(!e)return null;const s=dw(e);let r=this.keyCache_[s];this.cacheEncryptionKeys_&&i&&!r&&e.bytes&&(this.keyCache_[s]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});const n={resolvedUri:(r||e).resolvedUri};return r&&(n.bytes=r.bytes),n}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,i={}){if(!e)return;const s=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let n=null;if(s&&(s.id?n=s.id:s.uri&&(n=s.uri)),this.logger_(`playlist update [${n} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${$c(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!s||s.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const o=e.mediaSequence-s.mediaSequence;if(this.logger_(`live window shift [${o}]`),this.mediaIndex!==null)if(this.mediaIndex-=o,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const a=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!a.parts||!a.parts.length||!a.parts[this.partIndex])){const l=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=l}}r&&(r.mediaIndex-=o,r.mediaIndex<0?(r.mediaIndex=null,r.partIndex=null):(r.mediaIndex>=0&&(r.segment=e.segments[r.mediaIndex]),r.partIndex>=0&&r.segment.parts&&(r.part=r.segment.parts[r.partIndex]))),this.syncController_.saveExpiredSegmentInfo(s,e)}pause(){this.checkBufferTimeout_&&(F.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&qc.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,i,s=()=>{},r=!1){if(i===1/0&&(i=this.duration_()),i<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let n=1;const o=()=>{n--,n===0&&s()};(r||!this.audioDisabled_)&&(n++,this.sourceUpdater_.removeAudio(e,i,o)),(r||this.loaderType_==="main")&&(this.gopBuffer_=dF(this.gopBuffer_,e,i,this.timeMapping_),n++,this.sourceUpdater_.removeVideo(e,i,o));for(const a in this.inbandTextTracks_)Na(e,i,this.inbandTextTracks_[a]);Na(e,i,this.segmentMetadataTrack_),o()}monitorBuffer_(){this.checkBufferTimeout_&&F.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=F.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&F.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=F.setTimeout(this.monitorBufferTick_.bind(this),pF)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();e&&(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,i=this.playlist_,s=this.partIndex){if(!i||!this.mediaSource_)return!1;const r=typeof e=="number"&&i.segments[e],n=e+1===i.segments.length,o=!r||!r.parts||s+1===r.parts.length;return i.endList&&this.mediaSource_.readyState==="open"&&n&&o}chooseNextRequest_(){const e=this.buffered_(),i=$c(e)||0,s=Sf(e,this.currentTime_()),r=!this.hasPlayed_()&&s>=1,n=s>=this.goalBufferLength_(),o=this.playlist_.segments;if(!o.length||r||n)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(a.isSyncRequest)a.mediaIndex=cF(this.currentTimeline_,o,i),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${a.mediaIndex}`);else if(this.mediaIndex!==null){const C=o[this.mediaIndex],E=typeof this.partIndex=="number"?this.partIndex:-1;a.startOfSegment=C.end?C.end:i,C.parts&&C.parts[E+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=E+1):a.mediaIndex=this.mediaIndex+1}else{let C,E,y;const _=this.fetchAtBuffer_?i:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${_}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${i}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const b=this.getSyncInfoFromMediaSequenceSync_(_);if(!b)return this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null;this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${b.start} --> ${b.end})`),C=b.segmentIndex,E=b.partIndex,y=b.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const b=Kt.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:_,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});C=b.segmentIndex,E=b.partIndex,y=b.startTime}a.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${_}`:`currentTime ${_}`,a.mediaIndex=C,a.startOfSegment=y,a.partIndex=E,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${a.mediaIndex} `)}const l=o[a.mediaIndex];let u=l&&typeof a.partIndex=="number"&&l.parts&&l.parts[a.partIndex];if(!l||typeof a.partIndex=="number"&&!u)return null;typeof a.partIndex!="number"&&l.parts&&(a.partIndex=0,u=l.parts[0]);const d=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!s&&u&&!d&&!u.independent)if(a.partIndex===0){const C=o[a.mediaIndex-1],E=C.parts&&C.parts.length&&C.parts[C.parts.length-1];E&&E.independent&&(a.mediaIndex-=1,a.partIndex=C.parts.length-1,a.independent="previous segment")}else l.parts[a.partIndex-1].independent&&(a.partIndex-=1,a.independent="previous part");const c=this.mediaSource_&&this.mediaSource_.readyState==="ended";return a.mediaIndex>=o.length-1&&c&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,a.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(a))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const i=Math.max(e,this.mediaSequenceSync_.start);e!==i&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${i}`);const s=this.mediaSequenceSync_.getSyncInfoForTime(i);if(!s)return null;if(!s.isAppended)return s;const r=this.mediaSequenceSync_.getSyncInfoForTime(s.end);return r?(r.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),r):null}generateSegmentInfo_(e){const{independent:i,playlist:s,mediaIndex:r,startOfSegment:n,isSyncRequest:o,partIndex:a,forceTimestampOffset:l,getMediaInfoForTime:u}=e,d=s.segments[r],c=typeof a=="number"&&d.parts[a],C={requestId:"segment-loader-"+Math.random(),uri:c&&c.resolvedUri||d.resolvedUri,mediaIndex:r,partIndex:c?a:null,isSyncRequest:o,startOfSegment:n,playlist:s,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:d.timeline,duration:c&&c.duration||d.duration,segment:d,part:c,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:u,independent:i},E=typeof l<"u"?l:this.isPendingTimestampOffset_;C.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:d.timeline,currentTimeline:this.currentTimeline_,startOfSegment:n,buffered:this.buffered_(),overrideCheck:E});const y=$c(this.sourceUpdater_.audioBuffered());return typeof y=="number"&&(C.audioAppendStart=y-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(C.gopsToAlignWith=lF(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),C}timestampOffsetForSegment_(e){return mF(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const i=this.currentTime_(),s=e.bandwidth,r=this.pendingSegment_.duration,n=Kt.estimateSegmentRequestTime(r,s,this.playlist_,e.bytesReceived),o=VI(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(n<=o)return;const a=QL({main:this.vhs_.playlists.main,currentTime:i,bandwidth:s,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:o,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!a)return;const u=n-o-a.rebufferingImpact;let d=.5;o<=hs&&(d=1),!(!a.playlist||a.playlist.uri===this.playlist_.uri||u<d)&&(this.bandwidth=a.playlist.attributes.BANDWIDTH*ft.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${Hn(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&this.trigger("progress")}handleTrackInfo_(e,i){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(i)||(i=i||{},hF(this.currentMediaInfo_,i)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,i,s,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const n=this.pendingSegment_,o=Kv(i);n[o]=n[o]||{},n[o][s]=r,this.logger_(`timinginfo: ${i} - ${s} - ${r}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(i.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));return}const r=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),n={};i.forEach(o=>{n[o.stream]=n[o.stream]||{startTime:1/0,captions:[],endTime:0};const a=n[o.stream];a.startTime=Math.min(a.startTime,o.startTime+r),a.endTime=Math.max(a.endTime,o.endTime+r),a.captions.push(o)}),Object.keys(n).forEach(o=>{const{startTime:a,endTime:l,captions:u}=n[o],d=this.inbandTextTracks_;this.logger_(`adding cues from ${a} -> ${l} for ${o}`),eF(d,this.vhs_.tech_,o),Na(a,l,d[o]),tF({captionArray:u,inbandTextTracks:d,timestampOffset:r})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,i,s){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,s));return}this.addMetadataToTextTrack(s,i,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(i=>i())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(i=>i())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!Yv({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,i=this.getCurrentMediaInfo_();if(!e||!i)return!1;const{hasAudio:s,hasVideo:r,isMuxed:n}=i;return!(r&&!e.videoTimingInfo||s&&!this.audioDisabled_&&!n&&!e.audioTimingInfo||Yv({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,i));return}const s=this.pendingSegment_;if(this.setTimeMapping_(s.timeline),this.updateMediaSecondsLoaded_(s.part||s.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),s.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),s.isFmp4=e.isFmp4,s.timingInfo=s.timingInfo||{},s.isFmp4)this.trigger("fmp4"),s.timingInfo.start=s[Kv(i.type)].start;else{const r=this.getCurrentMediaInfo_(),n=this.loaderType_==="main"&&r&&r.hasVideo;let o;n&&(o=s.videoTimingInfo.start),s.timingInfo.start=this.trueSegmentStart_({currentStart:s.timingInfo.start,playlist:s.playlist,mediaIndex:s.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:n,firstVideoFrameTimeForData:o,videoTimingInfo:s.videoTimingInfo,audioTimingInfo:s.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(s,i.type),this.updateSourceBufferTimestampOffset_(s),s.isSyncRequest){this.updateTimingInfoEnd_(s),this.syncController_.saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:this.loaderType_==="main"});const r=this.chooseNextRequest_();if(r.mediaIndex!==s.mediaIndex||r.partIndex!==s.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}s.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(s,i)}}updateAppendInitSegmentStatus(e,i){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:i,map:s,playlist:r}){if(s){const n=_d(s);if(this.activeInitSegmentId_===n)return null;i=this.initSegmentForMap(s,!0).bytes,this.activeInitSegmentId_=n}return i&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=r,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:e,type:i,bytes:s},r){const n=this.sourceUpdater_.audioBuffered(),o=this.sourceUpdater_.videoBuffered();n.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Ur(n).join(", ")),o.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Ur(o).join(", "));const a=n.length?n.start(0):0,l=n.length?n.end(n.length-1):0,u=o.length?o.start(0):0,d=o.length?o.end(o.length-1):0;if(l-a<=Aa&&d-u<=Aa){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${s.byteLength}, audio buffer: ${Ur(n).join(", ")}, video buffer: ${Ur(o).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0,metadata:{errorType:V.Error.SegmentExceedsSourceBufferQuota}}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:i,bytes:s}));const C=this.currentTime_()-Aa;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${C}`),this.remove(0,C,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Aa}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=F.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Aa*1e3)},!0)}handleAppendError_({segmentInfo:e,type:i,bytes:s},r){if(r){if(r.code===Aw){this.handleQuotaExceededError_({segmentInfo:e,type:i,bytes:s});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",r),this.error({message:`${i} append of ${s.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:V.Error.SegmentAppendError}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:s,data:r,bytes:n}){if(!n){const o=[r];let a=r.byteLength;s&&(o.unshift(s),a+=s.byteLength),n=ZL({bytes:a,segments:o})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:i,bytes:n},this.handleAppendError_.bind(this,{segmentInfo:e,type:i,bytes:n}))}handleSegmentTimingInfo_(e,i,s){if(!this.pendingSegment_||i!==this.pendingSegment_.requestId)return;const r=this.pendingSegment_.segment,n=`${e}TimingInfo`;r[n]||(r[n]={}),r[n].transmuxerPrependedSeconds=s.prependedContentDuration||0,r[n].transmuxedPresentationStart=s.start.presentation,r[n].transmuxedDecodeStart=s.start.decode,r[n].transmuxedPresentationEnd=s.end.presentation,r[n].transmuxedDecodeEnd=s.end.decode,r[n].baseMediaDecodeTime=s.baseMediaDecodeTime}appendData_(e,i){const{type:s,data:r}=i;if(!r||!r.byteLength||s==="audio"&&this.audioDisabled_)return;const n=this.getInitSegmentAndUpdateState_({type:s,initSegment:i.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:s,initSegment:n,data:r})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const i=Di({},e,{forceTimestampOffset:!0});Di(e,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const i=this.createSimplifiedSegmentObj_(e),s=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),r=this.mediaIndex!==null,n=e.timeline!==this.currentTimeline_&&e.timeline>0,o=s||r&&n;this.logger_(`Requesting
${Rw(e.uri)}
${Hn(e)}`),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=$L({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:o,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:a,level:l,stream:u})=>{this.logger_(`${Hn(e)} logged from transmuxer stream ${u} as a ${l}: ${a}`)}})}trimBackBuffer_(e){const i=fF(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)}createSimplifiedSegmentObj_(e){const i=e.segment,s=e.part,r={resolvedUri:s?s.resolvedUri:i.resolvedUri,byterange:s?s.byterange:i.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},n=e.playlist.segments[e.mediaIndex-1];if(n&&n.timeline===i.timeline&&(n.videoTimingInfo?r.baseStartTime=n.videoTimingInfo.transmuxedDecodeEnd:n.audioTimingInfo&&(r.baseStartTime=n.audioTimingInfo.transmuxedDecodeEnd)),i.key){const o=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key=this.segmentKey(i.key),r.key.iv=o}return i.map&&(r.map=this.initSegmentForMap(i.map)),r}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,i){if(this.pendingSegment_.byteLength=i.bytesReceived,e<zu){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${zu}`);return}this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,i,s){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,s));return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===ps.ABORTED)return;if(this.pause(),e.code===ps.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,i.stats),r.endOfAllRequests=i.endOfAllRequests,s.gopInfo&&(this.gopBuffer_=uF(this.gopBuffer_,s.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(r)}setTimeMapping_(e){const i=this.syncController_.mappingForTimeline(e);i!==null&&(this.timeMapping_=i)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:i,mediaIndex:s,firstVideoFrameTimeForData:r,currentVideoTimestampOffset:n,useVideoTimingInfo:o,videoTimingInfo:a,audioTimingInfo:l}){if(typeof e<"u")return e;if(!o)return l.start;const u=i.segments[s-1];return s===0||!u||typeof u.start>"u"||u.end!==r+n?r:a.start}waitForAppendsToComplete_(e){const i=this.getCurrentMediaInfo_(e);if(!i){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0,metadata:{errorType:V.Error.SegmentUnsupportedMediaFormat}}),this.trigger("error");return}const{hasAudio:s,hasVideo:r,isMuxed:n}=i,o=this.loaderType_==="main"&&r,a=!this.audioDisabled_&&s&&!n;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}o&&e.waitingOnAppends++,a&&e.waitingOnAppends++,o&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),a&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const i=gF(this.loaderType_,this.getCurrentMediaInfo_(),e);return i?(this.error({message:i,playlistExclusionDuration:1/0,metadata:{errorType:V.Error.SegmentSwitchError}}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let i=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:i,timingInfo:s}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:s.start:s.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const i=this.getMediaInfo_(),r=this.loaderType_==="main"&&i&&i.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;r&&(e.timingInfo.end=typeof r.end=="number"?r.end:r.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const i=vF(e,this.sourceType_);if(i&&(i.severity==="warn"?V.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Hn(e)}`);return}this.logger_(`Appended ${Hn(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const s=e.segment,r=e.part,n=s.end&&this.currentTime_()-s.end>e.playlist.targetDuration*3,o=r&&r.end&&this.currentTime_()-r.end>e.playlist.partTargetDuration*3;if(n||o){this.logger_(`bad ${n?"segment":"part"} ${Hn(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<zu){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${zu}`);return}const i=this.throughput.rate,s=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/s*8*1e3);this.throughput.rate+=(r-i)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const i=e.segment,s=i.start,r=i.end;if(!qv(s)||!qv(r))return;Na(s,r,this.segmentMetadataTrack_);const n=F.WebKitDataCue||F.VTTCue,o={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,programDateTime:i.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:s,end:r},a=JSON.stringify(o),l=new n(s,r,a);l.value=o,this.segmentMetadataTrack_.addCue(l)}}function Ns(){}const xw=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toUpperCase())},yF=["video","audio"],jp=(t,e)=>{const i=e[`${t}Buffer`];return i&&i.updating||e.queuePending[t]},SF=(t,e)=>{for(let i=0;i<e.length;i++){const s=e[i];if(s.type==="mediaSource")return null;if(s.type===t)return i}return null},ao=(t,e)=>{if(e.queue.length===0)return;let i=0,s=e.queue[i];if(s.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),s.action(e),s.doneFn&&s.doneFn(),ao("audio",e),ao("video",e));return}if(t!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||jp(t,e))){if(s.type!==t){if(i=SF(t,e.queue),i===null)return;s=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[t]=s,s.action(t,e),!s.doneFn){e.queuePending[t]=null,ao(t,e);return}}},Pw=(t,e)=>{const i=e[`${t}Buffer`],s=xw(t);i&&(i.removeEventListener("updateend",e[`on${s}UpdateEnd_`]),i.removeEventListener("error",e[`on${s}Error_`]),e.codecs[t]=null,e[`${t}Buffer`]=null)},ls=(t,e)=>t&&e&&Array.prototype.indexOf.call(t.sourceBuffers,e)!==-1,li={appendBuffer:(t,e,i)=>(s,r)=>{const n=r[`${s}Buffer`];if(ls(r.mediaSource,n)){r.logger_(`Appending segment ${e.mediaIndex}'s ${t.length} bytes to ${s}Buffer`);try{n.appendBuffer(t)}catch(o){r.logger_(`Error with code ${o.code} `+(o.code===Aw?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${s}Buffer`),r.queuePending[s]=null,i(o)}}},remove:(t,e)=>(i,s)=>{const r=s[`${i}Buffer`];if(ls(s.mediaSource,r)){s.logger_(`Removing ${t} to ${e} from ${i}Buffer`);try{r.remove(t,e)}catch{s.logger_(`Remove ${t} to ${e} from ${i}Buffer failed`)}}},timestampOffset:t=>(e,i)=>{const s=i[`${e}Buffer`];ls(i.mediaSource,s)&&(i.logger_(`Setting ${e}timestampOffset to ${t}`),s.timestampOffset=t)},callback:t=>(e,i)=>{t()},endOfStream:t=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${t||""})`);try{e.mediaSource.endOfStream(t)}catch(i){V.log.warn("Failed to call media source endOfStream",i)}}},duration:t=>e=>{e.logger_(`Setting mediaSource duration to ${t}`);try{e.mediaSource.duration=t}catch(i){V.log.warn("Failed to set media source duration",i)}},abort:()=>(t,e)=>{if(e.mediaSource.readyState!=="open")return;const i=e[`${t}Buffer`];if(ls(e.mediaSource,i)){e.logger_(`calling abort on ${t}Buffer`);try{i.abort()}catch(s){V.log.warn(`Failed to abort on ${t}Buffer`,s)}}},addSourceBuffer:(t,e)=>i=>{const s=xw(t),r=sl(e);i.logger_(`Adding ${t}Buffer with codec ${e} to mediaSource`);const n=i.mediaSource.addSourceBuffer(r);n.addEventListener("updateend",i[`on${s}UpdateEnd_`]),n.addEventListener("error",i[`on${s}Error_`]),i.codecs[t]=e,i[`${t}Buffer`]=n},removeSourceBuffer:t=>e=>{const i=e[`${t}Buffer`];if(Pw(t,e),!!ls(e.mediaSource,i)){e.logger_(`Removing ${t}Buffer with codec ${e.codecs[t]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(i)}catch(s){V.log.warn(`Failed to removeSourceBuffer ${t}Buffer`,s)}}},changeType:t=>(e,i)=>{const s=i[`${e}Buffer`],r=sl(t);if(!ls(i.mediaSource,s))return;const n=t.substring(0,t.indexOf(".")),o=i.codecs[e];if(o.substring(0,o.indexOf("."))!==n){i.logger_(`changing ${e}Buffer codec from ${i.codecs[e]} to ${t}`);try{s.changeType(r),i.codecs[e]=t}catch(l){V.log.warn(`Failed to changeType on ${e}Buffer`,l)}}}},ui=({type:t,sourceUpdater:e,action:i,doneFn:s,name:r})=>{e.queue.push({type:t,action:i,doneFn:s,name:r}),ao(t,e)},Qv=(t,e)=>i=>{const s=e[`${t}Buffered`](),r=NI(s);if(e.logger_(`received "updateend" event for ${t} Source Buffer: `,r),e.queuePending[t]){const n=e.queuePending[t].doneFn;e.queuePending[t]=null,n&&n(e[`${t}Error_`])}ao(t,e)};class Iw extends V.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>ao("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Ni("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=Qv("video",this),this.onAudioUpdateEnd_=Qv("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,i){ui({type:"mediaSource",sourceUpdater:this,action:li.addSourceBuffer(e,i),name:"addSourceBuffer"})}abort(e){ui({type:e,sourceUpdater:this,action:li.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){V.log.error("removeSourceBuffer is not supported!");return}ui({type:"mediaSource",sourceUpdater:this,action:li.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!V.browser.IS_FIREFOX&&F.MediaSource&&F.MediaSource.prototype&&typeof F.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return F.SourceBuffer&&F.SourceBuffer.prototype&&typeof F.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,i){if(!this.canChangeType()){V.log.error("changeType is not supported!");return}ui({type:e,sourceUpdater:this,action:li.changeType(i),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(i=>{const s=e[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,s);this.canChangeType()&&this.changeType(i,s)})}appendBuffer(e,i){const{segmentInfo:s,type:r,bytes:n}=e;if(this.processedAppend_=!0,r==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,i]),this.logger_(`delayed audio append of ${n.length} until video append`);return}const o=i;if(ui({type:r,sourceUpdater:this,action:li.appendBuffer(n,s||{mediaIndex:-1},o),doneFn:i,name:"appendBuffer"}),r==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const a=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${a.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,a.forEach(l=>{this.appendBuffer.apply(this,l)})}}audioBuffered(){return ls(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:bt()}videoBuffered(){return ls(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:bt()}buffered(){const e=ls(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=ls(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():GI(this.audioBuffered(),this.videoBuffered())}setDuration(e,i=Ns){ui({type:"mediaSource",sourceUpdater:this,action:li.duration(e),name:"duration",doneFn:i})}endOfStream(e=null,i=Ns){typeof e!="string"&&(e=void 0),ui({type:"mediaSource",sourceUpdater:this,action:li.endOfStream(e),name:"endOfStream",doneFn:i})}removeAudio(e,i,s=Ns){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){s();return}ui({type:"audio",sourceUpdater:this,action:li.remove(e,i),doneFn:s,name:"remove"})}removeVideo(e,i,s=Ns){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){s();return}ui({type:"video",sourceUpdater:this,action:li.remove(e,i),doneFn:s,name:"remove"})}updating(){return!!(jp("audio",this)||jp("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(ui({type:"audio",sourceUpdater:this,action:li.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(ui({type:"video",sourceUpdater:this,action:li.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&ui({type:"audio",sourceUpdater:this,action:li.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&ui({type:"video",sourceUpdater:this,action:li.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),yF.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>Pw(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Jv=t=>decodeURIComponent(escape(String.fromCharCode.apply(null,t))),EF=t=>{const e=new Uint8Array(t);return Array.from(e).map(i=>i.toString(16).padStart(2,"0")).join("")},Zv=new Uint8Array(`

`.split("").map(t=>t.charCodeAt(0)));class wF extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class TF extends $p{constructor(e,i={}){super(e,i),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return bt();const e=this.subtitlesTrack_.cues,i=e[0].startTime,s=e[e.length-1].startTime;return bt([[i,s]])}initSegmentForMap(e,i=!1){if(!e)return null;const s=_d(e);let r=this.initSegments_[s];if(i&&!r&&e.bytes){const n=Zv.byteLength+e.bytes.byteLength,o=new Uint8Array(n);o.set(e.bytes),o.set(Zv,e.bytes.byteLength),this.initSegments_[s]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:o}}return r||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,i){Na(e,i,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const i=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",i),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,i,s){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===ps.TIMEOUT&&this.handleTimeout_(),e.code===ps.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending");const n=r.segment;if(n.map&&(n.map.bytes=i.map.bytes),r.bytes=i.bytes,typeof F.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,i,s),()=>this.stopForError({message:"Error loading vtt.js",metadata:{errorType:V.Error.VttLoadError}}));return}n.requested=!0;try{this.parseVTTCues_(r)}catch(o){this.stopForError({message:o.message,metadata:{errorType:V.Error.VttCueParsingError}});return}if(this.updateTimeMapping_(r,this.syncController_.timelines[r.timeline],this.playlist_),r.cues.length?r.timingInfo={start:r.cues[0].startTime,end:r.cues[r.cues.length-1].endTime}:r.timingInfo={start:r.startOfSegment,end:r.startOfSegment+r.duration},r.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}r.byteLength=r.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,r.cues.forEach(o=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new F.VTTCue(o.startTime,o.endTime,o.text):o)}),aF(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let i,s=!1;if(typeof F.WebVTT!="function")throw new wF;typeof F.TextDecoder=="function"?i=new F.TextDecoder("utf8"):(i=F.WebVTT.StringDecoder(),s=!0);const r=new F.WebVTT.Parser(F,F.vttjs,i);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=e.cues.push.bind(e.cues),r.ontimestampmap=o=>{e.timestampmap=o},r.onparsingerror=o=>{V.log.warn("Error encountered when parsing cues: "+o.message)},e.segment.map){let o=e.segment.map.bytes;s&&(o=Jv(o)),r.parse(o)}let n=e.bytes;s&&(n=Jv(n)),r.parse(n),r.flush()}updateTimeMapping_(e,i,s){const r=e.segment;if(!i)return;if(!e.cues.length){r.empty=!0;return}const{MPEGTS:n,LOCAL:o}=e.timestampmap,l=n/Hr.ONE_SECOND_IN_TS-o+i.mapping;if(e.cues.forEach(u=>{const d=u.endTime-u.startTime,c=n===0?u.startTime+l:this.handleRollover_(u.startTime+l,i.time);u.startTime=Math.max(c,0),u.endTime=Math.max(c+d,0)}),!s.syncInfo){const u=e.cues[0].startTime,d=e.cues[e.cues.length-1].startTime;s.syncInfo={mediaSequence:s.mediaSequence+e.mediaIndex,time:Math.min(u,d-r.duration)}}}handleRollover_(e,i){if(i===null)return e;let s=e*Hr.ONE_SECOND_IN_TS;const r=i*Hr.ONE_SECOND_IN_TS;let n;for(r<s?n=-8589934592:n=8589934592;Math.abs(s-r)>4294967296;)s+=n;return s/Hr.ONE_SECOND_IN_TS}}const bF=function(t,e){const i=t.cues;for(let s=0;s<i.length;s++){const r=i[s];if(e>=r.adStartTime&&e<=r.adEndTime)return r}return null},_F=function(t,e,i=0){if(!t.segments)return;let s=i,r;for(let n=0;n<t.segments.length;n++){const o=t.segments[n];if(r||(r=bF(e,s+o.duration/2)),r){if("cueIn"in o){r.endTime=s,r.adEndTime=s,s+=o.duration,r=null;continue}if(s<r.endTime){s+=o.duration;continue}r.endTime+=o.duration}else if("cueOut"in o&&(r=new F.VTTCue(s,s+o.duration,o.cueOut),r.adStartTime=s,r.adEndTime=s+parseFloat(o.cueOut),e.addCue(r)),"cueOutCont"in o){const[a,l]=o.cueOutCont.split("/").map(parseFloat);r=new F.VTTCue(s,s+o.duration,""),r.adStartTime=s-a,r.adEndTime=r.adStartTime+l,e.addCue(r)}s+=o.duration}};class ey{constructor({start:e,end:i,segmentIndex:s,partIndex:r=null,appended:n=!1}){this.start_=e,this.end_=i,this.segmentIndex_=s,this.partIndex_=r,this.appended_=n}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class DF{constructor(e,i=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=i}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class Kc{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,i){const{mediaSequence:s,segments:r}=e;if(this.isReliable_=this.isReliablePlaylist_(s,r),!!this.isReliable_)return this.updateStorage_(r,s,this.calculateBaseTime_(s,i))}getSyncInfoForTime(e){for(const{segmentSyncInfo:i,partsSyncInfo:s}of this.storage_.values())if(s.length){for(const r of s)if(r.isInRange(e))return r}else if(i.isInRange(e))return i;return null}updateStorage_(e,i,s){const r=new Map;let n=`
`,o=s,a=i;this.start_=o,e.forEach((l,u)=>{const d=this.storage_.get(a),c=o,C=c+l.duration,E=!!(d&&d.segmentSyncInfo&&d.segmentSyncInfo.isAppended),y=new ey({start:c,end:C,appended:E,segmentIndex:u});l.syncInfo=y;let _=o;const b=(l.parts||[]).map((R,D)=>{const O=_,L=_+R.duration,I=!!(d&&d.partsSyncInfo&&d.partsSyncInfo[D]&&d.partsSyncInfo[D].isAppended),k=new ey({start:O,end:L,appended:I,segmentIndex:u,partIndex:D});return _=L,n+=`Media Sequence: ${a}.${D} | Range: ${O} --> ${L} | Appended: ${I}
`,R.syncInfo=k,k});r.set(a,new DF(y,b)),n+=`${Rw(l.resolvedUri)} | Media Sequence: ${a} | Range: ${c} --> ${C} | Appended: ${E}
`,a++,o=C}),this.end_=o,this.storage_=r,this.diagnostics_=n}calculateBaseTime_(e,i){return this.storage_.size?this.storage_.has(e)?this.storage_.get(e).segmentSyncInfo.start:i:0}isReliablePlaylist_(e,i){return e!=null&&Array.isArray(i)&&i.length}}const RF=86400,Yc=[{name:"VOD",run:(t,e,i,s,r)=>i!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(t,e,i,s,r,n)=>{const o=t.getMediaSequenceSync(n);if(!o||!o.isReliable)return null;const a=o.getSyncInfoForTime(r);return a?{time:a.start,partIndex:a.partIndex,segmentIndex:a.segmentIndex}:null}},{name:"ProgramDateTime",run:(t,e,i,s,r)=>{if(!Object.keys(t.timelineToDatetimeMappings).length)return null;let n=null,o=null;const a=kp(e);r=r||0;for(let l=0;l<a.length;l++){const u=e.endList||r===0?l:a.length-(l+1),d=a[u],c=d.segment,C=t.timelineToDatetimeMappings[c.timeline];if(!C||!c.dateTimeObject)continue;let y=c.dateTimeObject.getTime()/1e3+C;if(c.parts&&typeof d.partIndex=="number")for(let b=0;b<d.partIndex;b++)y+=c.parts[b].duration;const _=Math.abs(r-y);if(o!==null&&(_===0||o<_))break;o=_,n={time:y,segmentIndex:d.segmentIndex,partIndex:d.partIndex}}return n}},{name:"Segment",run:(t,e,i,s,r)=>{let n=null,o=null;r=r||0;const a=kp(e);for(let l=0;l<a.length;l++){const u=e.endList||r===0?l:a.length-(l+1),d=a[u],c=d.segment,C=d.part&&d.part.start||c&&c.start;if(c.timeline===s&&typeof C<"u"){const E=Math.abs(r-C);if(o!==null&&o<E)break;(!n||o===null||o>=E)&&(o=E,n={time:C,segmentIndex:d.segmentIndex,partIndex:d.partIndex})}}return n}},{name:"Discontinuity",run:(t,e,i,s,r)=>{let n=null;if(r=r||0,e.discontinuityStarts&&e.discontinuityStarts.length){let o=null;for(let a=0;a<e.discontinuityStarts.length;a++){const l=e.discontinuityStarts[a],u=e.discontinuitySequence+a+1,d=t.discontinuities[u];if(d){const c=Math.abs(r-d.time);if(o!==null&&o<c)break;(!n||o===null||o>=c)&&(o=c,n={time:d.time,segmentIndex:l,partIndex:null})}}}return n}},{name:"Playlist",run:(t,e,i,s,r)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class AF extends V.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.mediaSequenceStorage_={main:new Kc,audio:new Kc,vtt:new Kc},this.logger_=Ni("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,i,s,r,n){if(i!==1/0)return Yc.find(({name:l})=>l==="VOD").run(this,e,i);const o=this.runStrategies_(e,i,s,r,n);if(!o.length)return null;for(const a of o){const{syncPoint:l,strategy:u}=a,{segmentIndex:d,time:c}=l;if(d<0)continue;const C=e.segments[d],E=c,y=E+C.duration;if(this.logger_(`Strategy: ${u}. Current time: ${r}. selected segment: ${d}. Time: [${E} -> ${y}]}`),r>=E&&r<y)return this.logger_("Found sync point with exact match: ",l),l}return this.selectSyncPoint_(o,{key:"time",value:r})}getExpiredTime(e,i){if(!e||!e.segments)return null;const s=this.runStrategies_(e,i,e.discontinuitySequence,0);if(!s.length)return null;const r=this.selectSyncPoint_(s,{key:"segmentIndex",value:0});return r.segmentIndex>0&&(r.time*=-1),Math.abs(r.time+Ka({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:r.segmentIndex,endIndex:0}))}runStrategies_(e,i,s,r,n){const o=[];for(let a=0;a<Yc.length;a++){const l=Yc[a],u=l.run(this,e,i,s,r,n);u&&(u.strategy=l.name,o.push({strategy:l.name,syncPoint:u}))}return o}selectSyncPoint_(e,i){let s=e[0].syncPoint,r=Math.abs(e[0].syncPoint[i.key]-i.value),n=e[0].strategy;for(let o=1;o<e.length;o++){const a=Math.abs(e[o].syncPoint[i.key]-i.value);a<r&&(r=a,s=e[o].syncPoint,n=e[o].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${n}]: [time:${s.time}, segmentIndex:${s.segmentIndex}`+(typeof s.partIndex=="number"?`,partIndex:${s.partIndex}`:"")+"]"),s}saveExpiredSegmentInfo(e,i){const s=i.mediaSequence-e.mediaSequence;if(s>RF){V.log.warn(`Not saving expired segment info. Media sequence gap ${s} is too large.`);return}for(let r=s-1;r>=0;r--){const n=e.segments[r];if(n&&typeof n.start<"u"){i.syncInfo={mediaSequence:e.mediaSequence+r,time:n.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const i=e.segments[0],s=i.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[i.timeline]=-s}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:i}){const s=this.calculateSegmentTimeMapping_(e,e.timingInfo,i),r=e.segment;s&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:r.start}));const n=r.dateTimeObject;r.discontinuity&&i&&n&&(this.timelineToDatetimeMappings[r.timeline]=-(n.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,i,s){const r=e.segment,n=e.part;let o=this.timelines[e.timeline],a,l;if(typeof e.timestampOffset=="number")o={time:e.startOfSegment,mapping:e.startOfSegment-i.start},s&&(this.timelines[e.timeline]=o,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${o.time}] [mapping: ${o.mapping}]`)),a=e.startOfSegment,l=i.end+o.mapping;else if(o)a=i.start+o.mapping,l=i.end+o.mapping;else return!1;return n&&(n.start=a,n.end=l),(!r.start||a<r.start)&&(r.start=a),r.end=l,!0}saveDiscontinuitySyncInfo_(e){const i=e.playlist,s=e.segment;if(s.discontinuity)this.discontinuities[s.timeline]={time:s.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let r=0;r<i.discontinuityStarts.length;r++){const n=i.discontinuityStarts[r],o=i.discontinuitySequence+r+1,a=n-e.mediaIndex,l=Math.abs(a);if(!this.discontinuities[o]||this.discontinuities[o].accuracy>l){let u;a<0?u=s.start-Ka({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex,endIndex:n}):u=s.end+Ka({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex+1,endIndex:n}),this.discontinuities[o]={time:u,accuracy:l}}}}dispose(){this.trigger("dispose"),this.off()}}class xF extends V.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:i,to:s}){return typeof i=="number"&&typeof s=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:i,to:s},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:i,to:s}){return typeof i=="number"&&typeof s=="number"&&(this.lastTimelineChanges_[e]={type:e,from:i,to:s},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const PF=mw(Cw(function(){var t=function(){function _(){this.listeners={}}var b=_.prototype;return b.on=function(D,O){this.listeners[D]||(this.listeners[D]=[]),this.listeners[D].push(O)},b.off=function(D,O){if(!this.listeners[D])return!1;var L=this.listeners[D].indexOf(O);return this.listeners[D]=this.listeners[D].slice(0),this.listeners[D].splice(L,1),L>-1},b.trigger=function(D){var O=this.listeners[D];if(O)if(arguments.length===2)for(var L=O.length,I=0;I<L;++I)O[I].call(this,arguments[1]);else for(var k=Array.prototype.slice.call(arguments,1),H=O.length,ee=0;ee<H;++ee)O[ee].apply(this,k)},b.dispose=function(){this.listeners={}},b.pipe=function(D){this.on("data",function(O){D.push(O)})},_}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(_){return _.subarray(0,_.byteLength-_[_.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const i=function(){const _=[[[],[],[],[],[]],[[],[],[],[],[]]],b=_[0],R=_[1],D=b[4],O=R[4];let L,I,k;const H=[],ee=[];let Q,Ce,le,be,Z,Ee;for(L=0;L<256;L++)ee[(H[L]=L<<1^(L>>7)*283)^L]=L;for(I=k=0;!D[I];I^=Q||1,k=ee[k]||1)for(be=k^k<<1^k<<2^k<<3^k<<4,be=be>>8^be&255^99,D[I]=be,O[be]=I,le=H[Ce=H[Q=H[I]]],Ee=le*16843009^Ce*65537^Q*257^I*16843008,Z=H[be]*257^be*16843008,L=0;L<4;L++)b[L][I]=Z=Z<<24^Z>>>8,R[L][be]=Ee=Ee<<24^Ee>>>8;for(L=0;L<5;L++)b[L]=b[L].slice(0),R[L]=R[L].slice(0);return _};let s=null;class r{constructor(b){s||(s=i()),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];let R,D,O;const L=this._tables[0][4],I=this._tables[1],k=b.length;let H=1;if(k!==4&&k!==6&&k!==8)throw new Error("Invalid aes key size");const ee=b.slice(0),Q=[];for(this._key=[ee,Q],R=k;R<4*k+28;R++)O=ee[R-1],(R%k===0||k===8&&R%k===4)&&(O=L[O>>>24]<<24^L[O>>16&255]<<16^L[O>>8&255]<<8^L[O&255],R%k===0&&(O=O<<8^O>>>24^H<<24,H=H<<1^(H>>7)*283)),ee[R]=ee[R-k]^O;for(D=0;R;D++,R--)O=ee[D&3?R:R-4],R<=4||D<4?Q[D]=O:Q[D]=I[0][L[O>>>24]]^I[1][L[O>>16&255]]^I[2][L[O>>8&255]]^I[3][L[O&255]]}decrypt(b,R,D,O,L,I){const k=this._key[1];let H=b^k[0],ee=O^k[1],Q=D^k[2],Ce=R^k[3],le,be,Z;const Ee=k.length/4-2;let xt,Re=4;const it=this._tables[1],Ps=it[0],_r=it[1],Dr=it[2],Rr=it[3],Ar=it[4];for(xt=0;xt<Ee;xt++)le=Ps[H>>>24]^_r[ee>>16&255]^Dr[Q>>8&255]^Rr[Ce&255]^k[Re],be=Ps[ee>>>24]^_r[Q>>16&255]^Dr[Ce>>8&255]^Rr[H&255]^k[Re+1],Z=Ps[Q>>>24]^_r[Ce>>16&255]^Dr[H>>8&255]^Rr[ee&255]^k[Re+2],Ce=Ps[Ce>>>24]^_r[H>>16&255]^Dr[ee>>8&255]^Rr[Q&255]^k[Re+3],Re+=4,H=le,ee=be,Q=Z;for(xt=0;xt<4;xt++)L[(3&-xt)+I]=Ar[H>>>24]<<24^Ar[ee>>16&255]<<16^Ar[Q>>8&255]<<8^Ar[Ce&255]^k[Re++],le=H,H=ee,ee=Q,Q=Ce,Ce=le}}class n extends t{constructor(){super(t),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(b){this.jobs.push(b),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const o=function(_){return _<<24|(_&65280)<<8|(_&16711680)>>8|_>>>24},a=function(_,b,R){const D=new Int32Array(_.buffer,_.byteOffset,_.byteLength>>2),O=new r(Array.prototype.slice.call(b)),L=new Uint8Array(_.byteLength),I=new Int32Array(L.buffer);let k,H,ee,Q,Ce,le,be,Z,Ee;for(k=R[0],H=R[1],ee=R[2],Q=R[3],Ee=0;Ee<D.length;Ee+=4)Ce=o(D[Ee]),le=o(D[Ee+1]),be=o(D[Ee+2]),Z=o(D[Ee+3]),O.decrypt(Ce,le,be,Z,I,Ee),I[Ee]=o(I[Ee]^k),I[Ee+1]=o(I[Ee+1]^H),I[Ee+2]=o(I[Ee+2]^ee),I[Ee+3]=o(I[Ee+3]^Q),k=Ce,H=le,ee=be,Q=Z;return L};class l{constructor(b,R,D,O){const L=l.STEP,I=new Int32Array(b.buffer),k=new Uint8Array(b.byteLength);let H=0;for(this.asyncStream_=new n,this.asyncStream_.push(this.decryptChunk_(I.subarray(H,H+L),R,D,k)),H=L;H<I.length;H+=L)D=new Uint32Array([o(I[H-4]),o(I[H-3]),o(I[H-2]),o(I[H-1])]),this.asyncStream_.push(this.decryptChunk_(I.subarray(H,H+L),R,D,k));this.asyncStream_.push(function(){O(null,e(k))})}static get STEP(){return 32e3}decryptChunk_(b,R,D,O){return function(){const L=a(b,R,D);O.set(L,b.byteOffset)}}}var u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d;typeof window<"u"?d=window:typeof u<"u"?d=u:typeof self<"u"?d=self:d={};var c=d,C=function(b){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(b):b&&b.buffer instanceof ArrayBuffer},E=c.BigInt||Number;E("0x1"),E("0x100"),E("0x10000"),E("0x1000000"),E("0x100000000"),E("0x10000000000"),E("0x1000000000000"),E("0x100000000000000"),E("0x10000000000000000"),function(){var _=new Uint16Array([65484]),b=new Uint8Array(_.buffer,_.byteOffset,_.byteLength);return b[0]===255?"big":b[0]===204?"little":"unknown"}();const y=function(_){const b={};return Object.keys(_).forEach(R=>{const D=_[R];C(D)?b[R]={bytes:D.buffer,byteOffset:D.byteOffset,byteLength:D.byteLength}:b[R]=D}),b};self.onmessage=function(_){const b=_.data,R=new Uint8Array(b.encrypted.bytes,b.encrypted.byteOffset,b.encrypted.byteLength),D=new Uint32Array(b.key.bytes,b.key.byteOffset,b.key.byteLength/4),O=new Uint32Array(b.iv.bytes,b.iv.byteOffset,b.iv.byteLength/4);new l(R,D,O,function(L,I){self.postMessage(y({source:b.source,decrypted:I}),[I.buffer])})}}));var IF=fw(PF);const LF=t=>{let e=t.default?"main":"alternative";return t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},Lw=(t,e)=>{t.abort(),t.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},qp=(t,e)=>{e.activePlaylistLoader=t,t.load()},FF=(t,e)=>()=>{const{segmentLoaders:{[t]:i,main:s},mediaTypes:{[t]:r}}=e,n=r.activeTrack(),o=r.getActiveGroup(),a=r.activePlaylistLoader,l=r.lastGroup_;if(!(o&&l&&o.id===l.id)&&(r.lastGroup_=o,r.lastTrack_=n,Lw(i,r),!(!o||o.isMainPlaylist))){if(!o.playlistLoader){a&&s.resetEverything();return}i.resyncLoader(),qp(o.playlistLoader,r)}},MF=(t,e)=>()=>{const{segmentLoaders:{[t]:i},mediaTypes:{[t]:s}}=e;s.lastGroup_=null,i.abort(),i.pause()},OF=(t,e)=>()=>{const{mainPlaylistLoader:i,segmentLoaders:{[t]:s,main:r},mediaTypes:{[t]:n}}=e,o=n.activeTrack(),a=n.getActiveGroup(),l=n.activePlaylistLoader,u=n.lastTrack_;if(!(u&&o&&u.id===o.id)&&(n.lastGroup_=a,n.lastTrack_=o,Lw(s,n),!!a)){if(a.isMainPlaylist){if(!o||!u||o.id===u.id)return;const d=e.vhs.playlistController_,c=d.selectPlaylist();if(d.media()===c)return;n.logger_(`track change. Switching main audio from ${u.id} to ${o.id}`),i.pause(),r.resetEverything(),d.fastQualityChange_(c);return}if(t==="AUDIO"){if(!a.playlistLoader){r.setAudio(!0),r.resetEverything();return}s.setAudio(!0),r.setAudio(!1)}if(l===a.playlistLoader){qp(a.playlistLoader,n);return}s.track&&s.track(o),s.resetEverything(),qp(a.playlistLoader,n)}},Ad={AUDIO:(t,e)=>()=>{const{mediaTypes:{[t]:i},excludePlaylist:s}=e,r=i.activeTrack(),n=i.activeGroup(),o=(n.filter(l=>l.default)[0]||n[0]).id,a=i.tracks[o];if(r===a){s({error:{message:"Problem encountered loading the default audio track."}});return}V.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const l in i.tracks)i.tracks[l].enabled=i.tracks[l]===a;i.onTrackChanged()},SUBTITLES:(t,e)=>()=>{const{mediaTypes:{[t]:i}}=e;V.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const s=i.activeTrack();s&&(s.mode="disabled"),i.onTrackChanged()}},ty={AUDIO:(t,e,i)=>{if(!e)return;const{tech:s,requestOptions:r,segmentLoaders:{[t]:n}}=i;e.on("loadedmetadata",()=>{const o=e.media();n.playlist(o,r),(!s.paused()||o.endList&&s.preload()!=="none")&&n.load()}),e.on("loadedplaylist",()=>{n.playlist(e.media(),r),s.paused()||n.load()}),e.on("error",Ad[t](t,i))},SUBTITLES:(t,e,i)=>{const{tech:s,requestOptions:r,segmentLoaders:{[t]:n},mediaTypes:{[t]:o}}=i;e.on("loadedmetadata",()=>{const a=e.media();n.playlist(a,r),n.track(o.activeTrack()),(!s.paused()||a.endList&&s.preload()!=="none")&&n.load()}),e.on("loadedplaylist",()=>{n.playlist(e.media(),r),s.paused()||n.load()}),e.on("error",Ad[t](t,i))}},NF={AUDIO:(t,e)=>{const{vhs:i,sourceType:s,segmentLoaders:{[t]:r},requestOptions:n,main:{mediaGroups:o},mediaTypes:{[t]:{groups:a,tracks:l,logger_:u}},mainPlaylistLoader:d}=e,c=Kl(d.main);(!o[t]||Object.keys(o[t]).length===0)&&(o[t]={main:{default:{default:!0}}},c&&(o[t].main.default.playlists=d.main.playlists));for(const C in o[t]){a[C]||(a[C]=[]);for(const E in o[t][C]){let y=o[t][C][E],_;if(c?(u(`AUDIO group '${C}' label '${E}' is a main playlist`),y.isMainPlaylist=!0,_=null):s==="vhs-json"&&y.playlists?_=new Xn(y.playlists[0],i,n):y.resolvedUri?_=new Xn(y.resolvedUri,i,n):y.playlists&&s==="dash"?_=new Wp(y.playlists[0],i,n,d):_=null,y=Ie({id:E,playlistLoader:_},y),ty[t](t,y.playlistLoader,e),a[C].push(y),typeof l[E]>"u"){const b=new V.AudioTrack({id:E,kind:LF(y),enabled:!1,language:y.language,default:y.default,label:E});l[E]=b}}}r.on("error",Ad[t](t,e))},SUBTITLES:(t,e)=>{const{tech:i,vhs:s,sourceType:r,segmentLoaders:{[t]:n},requestOptions:o,main:{mediaGroups:a},mediaTypes:{[t]:{groups:l,tracks:u}},mainPlaylistLoader:d}=e;for(const c in a[t]){l[c]||(l[c]=[]);for(const C in a[t][c]){if(!s.options_.useForcedSubtitles&&a[t][c][C].forced)continue;let E=a[t][c][C],y;if(r==="hls")y=new Xn(E.resolvedUri,s,o);else if(r==="dash"){if(!E.playlists.filter(b=>b.excludeUntil!==1/0).length)return;y=new Wp(E.playlists[0],s,o,d)}else r==="vhs-json"&&(y=new Xn(E.playlists?E.playlists[0]:E.resolvedUri,s,o));if(E=Ie({id:C,playlistLoader:y},E),ty[t](t,E.playlistLoader,e),l[c].push(E),typeof u[C]>"u"){const _=i.addRemoteTextTrack({id:C,kind:"subtitles",default:E.default&&E.autoselect,language:E.language,label:C},!1).track;u[C]=_}}}n.on("error",Ad[t](t,e))},"CLOSED-CAPTIONS":(t,e)=>{const{tech:i,main:{mediaGroups:s},mediaTypes:{[t]:{groups:r,tracks:n}}}=e;for(const o in s[t]){r[o]||(r[o]=[]);for(const a in s[t][o]){const l=s[t][o][a];if(!/^(?:CC|SERVICE)/.test(l.instreamId))continue;const u=i.options_.vhs&&i.options_.vhs.captionServices||{};let d={label:a,language:l.language,instreamId:l.instreamId,default:l.default&&l.autoselect};if(u[d.instreamId]&&(d=Ie(d,u[d.instreamId])),d.default===void 0&&delete d.default,r[o].push(Ie({id:a},l)),typeof n[a]>"u"){const c=i.addRemoteTextTrack({id:d.instreamId,kind:"captions",default:d.default,language:d.language,label:d.label},!1).track;n[a]=c}}}}},Fw=(t,e)=>{for(let i=0;i<t.length;i++)if(Tf(e,t[i])||t[i].playlists&&Fw(t[i].playlists,e))return!0;return!1},kF=(t,e)=>i=>{const{mainPlaylistLoader:s,mediaTypes:{[t]:{groups:r}}}=e,n=s.media();if(!n)return null;let o=null;n.attributes[t]&&(o=r[n.attributes[t]]);const a=Object.keys(r);if(!o)if(t==="AUDIO"&&a.length>1&&Kl(e.main))for(let l=0;l<a.length;l++){const u=r[a[l]];if(Fw(u,n)){o=u;break}}else r.main?o=r.main:a.length===1&&(o=r[a[0]]);return typeof i>"u"?o:i===null||!o?null:o.filter(l=>l.id===i.id)[0]||null},GF={AUDIO:(t,e)=>()=>{const{mediaTypes:{[t]:{tracks:i}}}=e;for(const s in i)if(i[s].enabled)return i[s];return null},SUBTITLES:(t,e)=>()=>{const{mediaTypes:{[t]:{tracks:i}}}=e;for(const s in i)if(i[s].mode==="showing"||i[s].mode==="hidden")return i[s];return null}},VF=(t,{mediaTypes:e})=>()=>{const i=e[t].activeTrack();return i?e[t].activeGroup(i):null},BF=t=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(u=>{NF[u](u,t)});const{mediaTypes:e,mainPlaylistLoader:i,tech:s,vhs:r,segmentLoaders:{["AUDIO"]:n,main:o}}=t;["AUDIO","SUBTITLES"].forEach(u=>{e[u].activeGroup=kF(u,t),e[u].activeTrack=GF[u](u,t),e[u].onGroupChanged=FF(u,t),e[u].onGroupChanging=MF(u,t),e[u].onTrackChanged=OF(u,t),e[u].getActiveGroup=VF(u,t)});const a=e.AUDIO.activeGroup();if(a){const u=(a.filter(c=>c.default)[0]||a[0]).id;e.AUDIO.tracks[u].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(o.setAudio(!1),n.setAudio(!0)):o.setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanging())});const l=()=>{e.AUDIO.onTrackChanged(),s.trigger({type:"usage",name:"vhs-audio-change"})};s.audioTracks().addEventListener("change",l),s.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),r.on("dispose",()=>{s.audioTracks().removeEventListener("change",l),s.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),s.clearTracks("audio");for(const u in e.AUDIO.tracks)s.audioTracks().addTrack(e.AUDIO.tracks[u])},HF=()=>{const t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Ns,activeTrack:Ns,getActiveGroup:Ns,onGroupChanged:Ns,onTrackChanged:Ns,lastTrack_:null,logger_:Ni(`MediaGroups[${e}]`)}}),t};class iy{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=qt(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(i=>[i.ID,i])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class UF extends V.EventTarget{constructor(e,i){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new iy,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=Ni("Content Steering"),this.xhr_=e,this.getBandwidth_=i}assignTagProperties(e,i){this.manifestType_=i.serverUri?"HLS":"DASH";const s=i.serverUri||i.serverURL;if(!s){this.logger_(`steering manifest URL is ${s}, cannot request steering manifest.`),this.trigger("error");return}if(s.startsWith("data:")){this.decodeDataUriManifest_(s.substring(s.indexOf(",")+1));return}this.steeringManifest.reloadUri=qt(e,s),this.defaultPathway=i.pathwayId||i.defaultServiceLocation,this.queryBeforeStart=i.queryBeforeStart,this.proxyServerUrl_=i.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const i=this.steeringManifest.reloadUri;if(!i)return;const s=e?i:this.getRequestURI(i);if(!s){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}this.request_=this.xhr_({uri:s,requestType:"content-steering-manifest"},(r,n)=>{if(r){if(n.status===410){this.logger_(`manifest request 410 ${r}.`),this.logger_(`There will be no more content steering requests to ${s} this session.`),this.excludedSteeringManifestURLs.add(s);return}if(n.status===429){const a=n.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${r}.`),this.logger_(`content steering will retry in ${a} seconds.`),this.startTTLTimeout_(parseInt(a,10));return}this.logger_(`manifest failed to load ${r}.`),this.startTTLTimeout_();return}const o=JSON.parse(this.request_.responseText);this.assignSteeringProperties_(o),this.startTTLTimeout_()})}setProxyServerUrl_(e){const i=new F.URL(e),s=new F.URL(this.proxyServerUrl_);return s.searchParams.set("url",encodeURI(i.toString())),this.setSteeringParams_(s.toString())}decodeDataUriManifest_(e){const i=JSON.parse(F.atob(e));this.assignSteeringProperties_(i)}setSteeringParams_(e){const i=new F.URL(e),s=this.getPathway(),r=this.getBandwidth_();if(s){const n=`_${this.manifestType_}_pathway`;i.searchParams.set(n,s)}if(r){const n=`_${this.manifestType_}_throughput`;i.searchParams.set(n,r)}return i.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const s=(r=>{for(const n of r)if(this.availablePathways_.has(n))return n;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==s&&(this.currentPathway=s,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const i=r=>this.excludedSteeringManifestURLs.has(r);if(this.proxyServerUrl_){const r=this.setProxyServerUrl_(e);if(!i(r))return r}const s=this.setSteeringParams_(e);return i(s)?null:s}startTTLTimeout_(e=this.steeringManifest.ttl){const i=e*1e3;this.ttlTimeout_=F.setTimeout(()=>{this.requestSteeringManifest()},i)}clearTTLTimeout_(){F.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new iy}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,i){return!i&&this.steeringManifest.reloadUri||i&&(qt(e,i.serverURL)!==this.steeringManifest.reloadUri||i.defaultServiceLocation!==this.defaultPathway||i.queryBeforeStart!==this.queryBeforeStart||i.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const WF=10;let Fs;const zF=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],$F=function(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]},jF=function({currentPlaylist:t,buffered:e,currentTime:i,nextPlaylist:s,bufferLowWaterLine:r,bufferHighWaterLine:n,duration:o,bufferBasedABR:a,log:l}){if(!s)return V.log.warn("We received no playlist to switch to. Please check your stream."),!1;const u=`allowing switch ${t&&t.id||"null"} -> ${s.id}`;if(!t)return l(`${u} as current playlist is not set`),!0;if(s.id===t.id)return!1;const d=!!Yn(e,i).length;if(!t.endList)return!d&&typeof t.partTargetDuration=="number"?(l(`not ${u} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(l(`${u} as current playlist is live`),!0);const c=Sf(e,i),C=a?ft.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:ft.MAX_BUFFER_LOW_WATER_LINE;if(o<C)return l(`${u} as duration < max low water line (${o} < ${C})`),!0;const E=s.attributes.BANDWIDTH,y=t.attributes.BANDWIDTH;if(E<y&&(!a||c<n)){let _=`${u} as next bandwidth < current bandwidth (${E} < ${y})`;return a&&(_+=` and forwardBuffer < bufferHighWaterLine (${c} < ${n})`),l(_),!0}if((!a||E>y)&&c>=r){let _=`${u} as forwardBuffer >= bufferLowWaterLine (${c} >= ${r})`;return a&&(_+=` and next bandwidth > current bandwidth (${E} > ${y})`),l(_),!0}return l(`not ${u} as no switching criteria met`),!1};class qF extends V.EventTarget{constructor(e){super();const{src:i,withCredentials:s,tech:r,bandwidth:n,externVhs:o,useCueTags:a,playlistExclusionDuration:l,enableLowInitialPlaylist:u,sourceType:d,cacheEncryptionKeys:c,bufferBasedABR:C,leastPixelDiffSelector:E,captionServices:y}=e;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:_}=e;(_===null||typeof _>"u")&&(_=1/0),Fs=o,this.bufferBasedABR=!!C,this.leastPixelDiffSelector=!!E,this.withCredentials=s,this.tech_=r,this.vhs_=r.vhs,this.sourceType_=d,this.useCueTags_=a,this.playlistExclusionDuration=l,this.maxPlaylistRetries=_,this.enableLowInitialPlaylist=u,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:s,maxPlaylistRetries:_,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=HF(),this.mediaSource=new F.MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=bt(),this.hasPlayed_=!1,this.syncController_=new AF(e),this.segmentMetadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new IF,this.sourceUpdater_=new Iw(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new xF,this.keyStatusMap_=new Map;const b={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:y,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:n,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:c,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new Wp(i,this.vhs_,Ie(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new Xn(i,this.vhs_,Ie(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new $p(Ie(b,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new $p(Ie(b,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new TF(Ie(b,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((O,L)=>{function I(){r.off("vttjserror",k),O()}function k(){r.off("vttjsloaded",I),L()}r.one("vttjsloaded",I),r.one("vttjserror",k),r.addWebVttScript_()})}),e);const R=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new UF(this.vhs_.xhr,R),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),zF.forEach(O=>{this[O+"_"]=$F.bind(this,O)}),this.logger_=Ni("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const D=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(D,()=>{const O=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-O,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return e===-1||i===-1?-1:e+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,e)}switchMedia_(e,i,s){const r=this.media(),n=r&&(r.id||r.uri),o=e&&(e.id||e.uri);n&&n!==o&&(this.logger_(`switch media ${n} -> ${o} from ${i}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${i}`})),this.mainPlaylistLoader_.media(e,s)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const i=this.mediaTypes_[e],s=i?i.activeGroup():null,r=this.contentSteeringController_.getPathway();if(s&&r){const o=(s.length?s[0].playlists:s.playlists).filter(a=>a.attributes.serviceLocation===r);o.length&&this.mediaTypes_[e].activePlaylistLoader.media(o[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=F.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(F.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),i=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return i;const s=e.mediaGroups.AUDIO,r=Object.keys(s);let n;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)n=this.mediaTypes_.AUDIO.activeTrack();else{const a=s.main||r.length&&s[r[0]];for(const l in a)if(a[l].default){n={label:l};break}}if(!n)return i;const o=[];for(const a in s)if(s[a][n.label]){const l=s[a][n.label];if(l.playlists&&l.playlists.length)o.push.apply(o,l.playlists);else if(l.uri)o.push(l);else if(e.playlists.length)for(let u=0;u<e.playlists.length;u++){const d=e.playlists[u];d.attributes&&d.attributes.AUDIO&&d.attributes.AUDIO===a&&o.push(d)}}return o.length?o:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;Gp(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),BF({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;Gp(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,i){const s=e.mediaGroups||{};let r=!0;const n=Object.keys(s.AUDIO);for(const o in s.AUDIO)for(const a in s.AUDIO[o])s.AUDIO[o][a].uri||(r=!1);r&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(s.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Fs.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),n.length&&Object.keys(s.AUDIO[n[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,s=this.tech_.currentTime(),r=this.bufferLowWaterLine(),n=this.bufferHighWaterLine(),o=this.tech_.buffered();return jF({buffered:o,currentTime:s,currentPlaylist:i,nextPlaylist:e,bufferLowWaterLine:r,bufferHighWaterLine:n,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:WF}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(()=>{this.tech_.setCurrentTime(this.tech_.currentTime())})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const i=this.seekable();if(!i.length)return!1;const s=i.end(0);let r=s;if(e.start){const n=e.start.timeOffset;n<0?r=Math.max(s+n,i.start(0)):r=Math.min(s,n)}this.trigger("firstplay"),this.tech_.setCurrentTime(r)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,i=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===1/0?Number.MAX_VALUE:i}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const i=this.mainSegmentLoader_.getCurrentMediaInfo_();!i||i.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const s=this.syncController_.getExpiredTime(e,this.duration());if(s===null)return!1;const r=Fs.Playlist.playlistEnd(e,s),n=this.tech_.currentTime(),o=this.tech_.buffered();if(!o.length)return r-n<=cs;const a=o.end(o.length-1);return a-n<=cs&&r-a<=cs}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:s}){if(e=e||this.mainPlaylistLoader_.media(),s=s||i.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const r=this.mainPlaylistLoader_.main.playlists,n=r.filter(Eh),o=n.length===1&&n[0]===e;if(r.length===1&&s!==1/0)return V.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(o);if(o){if(this.main().contentSteering){const y=this.pathwayAttribute_(e),_=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(y),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(y)},_);return}let E=!1;r.forEach(y=>{if(y===e)return;const _=y.excludeUntil;typeof _<"u"&&_!==1/0&&(E=!0,delete y.excludeUntil)}),E&&(V.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let a;e.playlistErrors_>this.maxPlaylistRetries?a=1/0:a=Date.now()+s*1e3,e.excludeUntil=a,i.reason&&(e.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const l=this.selectPlaylist();if(!l){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const u=i.internal?this.logger_:V.log.warn,d=i.message?" "+i.message:"";u(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${d} Switching to playlist ${l.id}.`),l.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const c=l.targetDuration/2*1e3||5*1e3,C=typeof l.lastRequest=="number"&&Date.now()-l.lastRequest<=c;return this.switchMedia_(l,"exclude",o||C)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,i){const s=[],r=e==="all";(r||e==="main")&&s.push(this.mainPlaylistLoader_);const n=[];(r||e==="audio")&&n.push("AUDIO"),(r||e==="subtitle")&&(n.push("CLOSED-CAPTIONS"),n.push("SUBTITLES")),n.forEach(o=>{const a=this.mediaTypes_[o]&&this.mediaTypes_[o].activePlaylistLoader;a&&s.push(a)}),["main","audio","subtitle"].forEach(o=>{const a=this[`${o}SegmentLoader_`];a&&(e===o||e==="all")&&s.push(a)}),s.forEach(o=>i.forEach(a=>{typeof o[a]=="function"&&o[a]()}))}setCurrentTime(e){const i=Yn(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(i&&i.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Fs.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let i=this.mainPlaylistLoader_.media();if(!i)return;let s=this.syncController_.getExpiredTime(i,this.duration());if(s===null)return;const r=this.mainPlaylistLoader_.main,n=Fs.Playlist.seekable(i,s,Fs.Playlist.liveEdgeDelay(r,i));if(n.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),s=this.syncController_.getExpiredTime(i,this.duration()),s===null||(e=Fs.Playlist.seekable(i,s,Fs.Playlist.liveEdgeDelay(r,i)),e.length===0)))return;let o,a;this.seekable_&&this.seekable_.length&&(o=this.seekable_.end(0),a=this.seekable_.start(0)),e?e.start(0)>n.end(0)||n.start(0)>e.end(0)?this.seekable_=n:this.seekable_=bt([[e.start(0)>n.start(0)?e.start(0):n.start(0),e.end(0)<n.end(0)?e.end(0):n.end(0)]]):this.seekable_=n,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===o&&this.seekable_.start(0)===a)&&(this.logger_(`seekable updated [${jE(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const r=this.seekable();if(!r.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<r.end(r.length-1))&&this.sourceUpdater_.setDuration(r.end(r.length-1));return}const i=this.tech_.buffered();let s=Fs.Playlist.duration(this.mainPlaylistLoader_.media());i.length>0&&(s=Math.max(s,i.end(i.length-1))),this.mediaSource.duration!==s&&this.sourceUpdater_.setDuration(s)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const i=this.mediaTypes_[e].groups;for(const s in i)i[s].forEach(r=>{r.playlistLoader&&r.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,i=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),s=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!i||!s)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},i=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const s=Xa(this.main(),i),r={},n=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(r.video=s.video||e.main.videoCodec||fA),e.main.isMuxed&&(r.video+=`,${s.audio||e.main.audioCodec||BC}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||n)&&(r.audio=s.audio||e.main.audioCodec||e.audio.audioCodec||BC,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!r.audio&&!r.video){this.excludePlaylist({playlistToExclude:i,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const o=(u,d)=>u?Xu(d):Ic(d),a={};let l;if(["video","audio"].forEach(function(u){if(r.hasOwnProperty(u)&&!o(e[u].isFmp4,r[u])){const d=e[u].isFmp4?"browser":"muxer";a[d]=a[d]||[],a[d].push(r[u]),u==="audio"&&(l=d)}}),n&&l&&i.attributes.AUDIO){const u=i.attributes.AUDIO;this.main().playlists.forEach(d=>{(d.attributes&&d.attributes.AUDIO)===u&&d!==i&&(d.excludeUntil=1/0)}),this.logger_(`excluding audio group ${u} as ${l} does not support codec(s): "${r.audio}"`)}if(Object.keys(a).length){const u=Object.keys(a).reduce((d,c)=>(d&&(d+=", "),d+=`${c} does not support codec(s): "${a[c].join(",")}"`,d),"")+".";this.excludePlaylist({playlistToExclude:i,error:{internal:!0,message:u},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const u=[];if(["video","audio"].forEach(d=>{const c=(as(this.sourceUpdater_.codecs[d]||"")[0]||{}).type,C=(as(r[d]||"")[0]||{}).type;c&&C&&c.toLowerCase()!==C.toLowerCase()&&u.push(`"${this.sourceUpdater_.codecs[d]}" -> "${r[d]}"`)}),u.length){this.excludePlaylist({playlistToExclude:i,error:{message:`Codec switching not supported: ${u.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return r}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}excludeUnsupportedVariants_(){const e=this.main().playlists,i=[];Object.keys(e).forEach(s=>{const r=e[s];if(i.indexOf(r.id)!==-1)return;i.push(r.id);const n=Xa(this.main,r),o=[];n.audio&&!Ic(n.audio)&&!Xu(n.audio)&&o.push(`audio codec ${n.audio}`),n.video&&!Ic(n.video)&&!Xu(n.video)&&o.push(`video codec ${n.video}`),n.text&&n.text==="stpp.ttml.im1t"&&o.push(`text codec ${n.text}`),o.length&&(r.excludeUntil=1/0,this.logger_(`excluding ${r.id} for unsupported: ${o.join(", ")}`))})}excludeIncompatibleVariants_(e){const i=[],s=this.main().playlists,r=Dd(as(e)),n=Wv(r),o=r.video&&as(r.video)[0]||null,a=r.audio&&as(r.audio)[0]||null;Object.keys(s).forEach(l=>{const u=s[l];if(i.indexOf(u.id)!==-1||u.excludeUntil===1/0)return;i.push(u.id);const d=[],c=Xa(this.mainPlaylistLoader_.main,u),C=Wv(c);if(!(!c.audio&&!c.video)){if(C!==n&&d.push(`codec count "${C}" !== "${n}"`),!this.sourceUpdater_.canChangeType()){const E=c.video&&as(c.video)[0]||null,y=c.audio&&as(c.audio)[0]||null;E&&o&&E.type.toLowerCase()!==o.type.toLowerCase()&&d.push(`video codec "${E.type}" !== "${o.type}"`),y&&a&&y.type.toLowerCase()!==a.type.toLowerCase()&&d.push(`audio codec "${y.type}" !== "${a.type}"`)}d.length&&(u.excludeUntil=1/0,this.logger_(`excluding ${u.id}: ${d.join(" && ")}`))}})}updateAdCues_(e){let i=0;const s=this.seekable();s.length&&(i=s.start(0)),_F(e,this.cueTagsTrack_,i)}goalBufferLength(){const e=this.tech_.currentTime(),i=ft.GOAL_BUFFER_LENGTH,s=ft.GOAL_BUFFER_LENGTH_RATE,r=Math.max(i,ft.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*s,r)}bufferLowWaterLine(){const e=this.tech_.currentTime(),i=ft.BUFFER_LOW_WATER_LINE,s=ft.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(i,ft.MAX_BUFFER_LOW_WATER_LINE),n=Math.max(i,ft.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*s,this.bufferBasedABR?n:r)}bufferHighWaterLine(){return ft.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){jv(this.inbandTextTracks_,"com.apple.streaming",this.tech_),oF({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,i,s){const r=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();jv(this.inbandTextTracks_,e,this.tech_),sF({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:r,videoDuration:s})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const i of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(i));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const e=this.main();(this.contentSteeringController_.didDASHTagChange(e.uri,e.contentSteering)||(()=>{const r=this.contentSteeringController_.getAvailablePathways(),n=[];for(const o of e.playlists){const a=o.attributes.serviceLocation;if(a&&(n.push(a),!r.has(a)))return!0}return!!(!n.length&&r.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const s=this.main().playlists,r=new Set;let n=!1;Object.keys(s).forEach(o=>{const a=s[o],l=this.pathwayAttribute_(a),u=l&&e!==l;a.excludeUntil===1/0&&a.lastExcludeReason_==="content-steering"&&!u&&(delete a.excludeUntil,delete a.lastExcludeReason_,n=!0);const c=!a.excludeUntil&&a.excludeUntil!==1/0;!r.has(a.id)&&u&&c&&(r.add(a.id),a.excludeUntil=1/0,a.lastExcludeReason_="content-steering",this.logger_(`excluding ${a.id} for ${a.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(o=>{const a=this.mediaTypes_[o];if(a.activePlaylistLoader){const l=a.activePlaylistLoader.media_;l&&l.attributes.serviceLocation!==e&&(n=!0)}}),n&&this.changeSegmentPathway_()}handlePathwayClones_(){const i=this.main().playlists,s=this.contentSteeringController_.currentPathwayClones,r=this.contentSteeringController_.nextPathwayClones;if(s&&s.size||r&&r.size){for(const[o,a]of s.entries())r.get(o)||(this.mainPlaylistLoader_.updateOrDeleteClone(a),this.contentSteeringController_.excludePathway(o));for(const[o,a]of r.entries()){const l=s.get(o);if(!l){i.filter(d=>d.attributes["PATHWAY-ID"]===a["BASE-ID"]).forEach(d=>{this.mainPlaylistLoader_.addClonePathway(a,d)}),this.contentSteeringController_.addAvailablePathway(o);continue}this.equalPathwayClones_(l,a)||(this.mainPlaylistLoader_.updateOrDeleteClone(a,!0),this.contentSteeringController_.addAvailablePathway(o))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...r])))}}equalPathwayClones_(e,i){if(e["BASE-ID"]!==i["BASE-ID"]||e.ID!==i.ID||e["URI-REPLACEMENT"].HOST!==i["URI-REPLACEMENT"].HOST)return!1;const s=e["URI-REPLACEMENT"].PARAMS,r=i["URI-REPLACEMENT"].PARAMS;for(const n in s)if(s[n]!==r[n])return!1;for(const n in r)if(s[n]!==r[n])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const i="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(s=>{const r=this.mainPlaylistLoader_.getKeyIdSet(s);!r||!r.size||r.forEach(n=>{const o="usable",a=this.keyStatusMap_.has(n)&&this.keyStatusMap_.get(n)===o,l=s.lastExcludeReason_===i&&s.excludeUntil===1/0;a?a&&l&&(delete s.excludeUntil,delete s.lastExcludeReason_,this.logger_(`enabling playlist ${s.id} because key ID ${n} is ${o}`)):(s.excludeUntil!==1/0&&s.lastExcludeReason_!==i&&(s.excludeUntil=1/0,s.lastExcludeReason_=i,this.logger_(`excluding playlist ${s.id} because the key ID ${n} doesn't exist in the keyStatusMap or is not ${o}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(s=>{const r=s&&s.attributes&&s.attributes.RESOLUTION&&s.attributes.RESOLUTION.height<720,n=s.excludeUntil===1/0&&s.lastExcludeReason_===i;r&&n&&(delete s.excludeUntil,V.log.warn(`enabling non-HD playlist ${s.id} because all playlists were excluded due to ${i} key IDs`))})}addKeyStatus_(e,i){const n=(typeof e=="string"?e:EF(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${i}' with key ID ${n} added to the keyStatusMap`),this.keyStatusMap_.set(n,i)}updatePlaylistByKeyStatus(e,i){this.addKeyStatus_(e,i),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const KF=(t,e,i)=>s=>{const r=t.main.playlists[e],n=wf(r),o=Eh(r);return typeof s>"u"?o:(s?delete r.disabled:r.disabled=!0,s!==o&&!n&&(i(r),s?t.trigger("renditionenabled"):t.trigger("renditiondisabled")),s)};class YF{constructor(e,i,s){const{playlistController_:r}=e,n=r.fastQualityChange_.bind(r);if(i.attributes){const o=i.attributes.RESOLUTION;this.width=o&&o.width,this.height=o&&o.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]}this.codecs=Xa(r.main(),i),this.playlist=i,this.id=s,this.enabled=KF(e.playlists,i.id,n)}}const XF=function(t){t.representations=()=>{const e=t.playlistController_.main(),i=Kl(e)?t.playlistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(s=>!wf(s)).map((s,r)=>new YF(t,s,s.id)):[]}},sy=["seeking","seeked","pause","playing","error"];class QF{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Ni("PlaybackWatcher"),this.logger_("initialize");const i=()=>this.monitorCurrentTime_(),s=()=>this.monitorCurrentTime_(),r=()=>this.techWaiting_(),n=()=>this.resetTimeUpdate_(),o=this.playlistController_,a=["main","subtitle","audio"],l={};a.forEach(d=>{l[d]={reset:()=>this.resetSegmentDownloads_(d),updateend:()=>this.checkSegmentDownloads_(d)},o[`${d}SegmentLoader_`].on("appendsdone",l[d].updateend),o[`${d}SegmentLoader_`].on("playlistupdate",l[d].reset),this.tech_.on(["seeked","seeking"],l[d].reset)});const u=d=>{["main","audio"].forEach(c=>{o[`${c}SegmentLoader_`][d]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),u("off"))},this.clearSeekingAppendCheck_=()=>u("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),u("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",r),this.tech_.on(sy,n),this.tech_.on("canplay",s),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",r),this.tech_.off(sy,n),this.tech_.off("canplay",s),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),a.forEach(d=>{o[`${d}SegmentLoader_`].off("appendsdone",l[d].updateend),o[`${d}SegmentLoader_`].off("playlistupdate",l[d].reset),this.tech_.off(["seeked","seeking"],l[d].reset)}),this.checkCurrentTimeTimeout_&&F.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&F.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=F.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const i=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=i.buffered_()}checkSegmentDownloads_(e){const i=this.playlistController_,s=i[`${e}SegmentLoader_`],r=s.buffered_(),n=BI(this[`${e}Buffered_`],r);if(this[`${e}Buffered_`]=r,n){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:s.playlist_&&s.playlist_.id,buffered:Ur(r)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+cs>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),s=this.tech_.currentTime(),r=this.afterSeekableWindow_(i,s,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let n;if(r&&(n=i.end(i.length-1)),this.beforeSeekableWindow_(i,s)){const y=i.start(0);n=y+(y===i.end(0)?0:cs)}if(typeof n<"u")return this.logger_(`Trying to seek outside of seekable at time ${s} with seekable range ${jE(i)}. Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0;const o=this.playlistController_.sourceUpdater_,a=this.tech_.buffered(),l=o.audioBuffer?o.audioBuffered():null,u=o.videoBuffer?o.videoBuffered():null,d=this.media(),c=d.partTargetDuration?d.partTargetDuration:(d.targetDuration-hs)*2,C=[l,u];for(let y=0;y<C.length;y++){if(!C[y])continue;if(Sf(C[y],s)<c)return!1}const E=Uu(a,s);return E.length===0?!1:(n=E.start(0)+cs,this.logger_(`Buffered region starts (${E.start(0)})  just beyond seek point (${s}). Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),i=this.tech_.buffered(),s=Yn(i,e);if(s.length&&e+3<=s.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${s.start(0)} -> ${s.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,i)){const a=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${i}. Seeking to live point (seekable end) ${a}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(a),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const s=this.tech_.vhs.playlistController_.sourceUpdater_,r=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:s.audioBuffered(),videoBuffered:s.videoBuffered(),currentTime:i}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const o=Uu(r,i);return o.length>0?(this.logger_(`Stopped at ${i} and seeking to ${o.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(i),!0):!1}afterSeekableWindow_(e,i,s,r=!1){if(!e.length)return!1;let n=e.end(e.length-1)+cs;const o=!s.endList,a=typeof s.partTargetDuration=="number";return o&&(a||r)&&(n=e.end(e.length-1)+s.targetDuration*3),i>n}beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:i,currentTime:s}){if(!e)return;let r;if(e.length&&i.length){const n=Yn(e,s-3),o=Yn(e,s),a=Yn(i,s);a.length&&!o.length&&n.length&&(r={start:n.end(0),end:a.end(0)})}else Uu(e,s).length||(r=this.gapFromVideoUnderflow_(e,s));return r?(this.logger_(`Encountered a gap in video from ${r.start} to ${r.end}. Seeking to current time ${s}`),!0):!1}skipTheGap_(e){const i=this.tech_.buffered(),s=this.tech_.currentTime(),r=Uu(i,s);this.resetTimeUpdate_(),!(r.length===0||s!==e)&&(this.logger_("skipTheGap_:","currentTime:",s,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+hs),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,i){const s=kI(e);for(let r=0;r<s.length;r++){const n=s.start(r),o=s.end(r);if(i-n<4&&i-n>2)return{start:n,end:o}}return null}}const JF={errorInterval:30,getSource(t){const i=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return t(i)}},Mw=function(t,e){let i=0,s=0;const r=Ie(JF,e);t.ready(()=>{t.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const n=function(){s&&t.currentTime(s)},o=function(d){d!=null&&(s=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",n),t.src(d),t.trigger({type:"usage",name:"vhs-error-reload"}),t.play())},a=function(){if(Date.now()-i<r.errorInterval*1e3){t.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!r.getSource||typeof r.getSource!="function"){V.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),r.getSource.call(t,o)},l=function(){t.off("loadedmetadata",n),t.off("error",a),t.off("dispose",l)},u=function(d){l(),Mw(t,d)};t.on("error",a),t.on("dispose",l),t.reloadSourceOnError=u},ZF=function(t){Mw(this,t)};var Ow="3.12.1",eM="7.0.3",tM="1.3.0",iM="7.1.0",sM="4.0.1";const Je={PlaylistLoader:Xn,Playlist:Kt,utils:dL,STANDARD_PLAYLIST_SELECTOR:$v,INITIAL_PLAYLIST_SELECTOR:JL,lastBandwidthSelector:$v,movingAverageBandwidthSelector:XL,comparePlaylistBandwidth:_f,comparePlaylistResolution:YL,xhr:lw()};Object.keys(ft).forEach(t=>{Object.defineProperty(Je,t,{get(){return V.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),ft[t]},set(e){if(V.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){V.log.warn(`value of Vhs.${t} must be greater than or equal to 0`);return}ft[t]=e}})});const Nw="videojs-vhs",kw=function(t,e){const i=e.media();let s=-1;for(let r=0;r<t.length;r++)if(t[r].id===i.id){s=r;break}t.selectedIndex_=s,t.trigger({selectedIndex:s,type:"change"})},rM=function(t,e){e.representations().forEach(i=>{t.addQualityLevel(i)}),kw(t,e.playlists)};Je.canPlaySource=function(){return V.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const nM=(t,e,i)=>{if(!t)return t;let s={};e&&e.attributes&&e.attributes.CODECS&&(s=Dd(as(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(s.audio=i.attributes.CODECS);const r=sl(s.video),n=sl(s.audio),o={};for(const a in t)o[a]={},n&&(o[a].audioContentType=n),r&&(o[a].videoContentType=r),e.contentProtection&&e.contentProtection[a]&&e.contentProtection[a].pssh&&(o[a].pssh=e.contentProtection[a].pssh),typeof t[a]=="string"&&(o[a].url=t[a]);return Ie(t,o)},oM=(t,e)=>t.reduce((i,s)=>{if(!s.contentProtection)return i;const r=e.reduce((n,o)=>{const a=s.contentProtection[o];return a&&a.pssh&&(n[o]={pssh:a.pssh}),n},{});return Object.keys(r).length&&i.push(r),i},[]),aM=({player:t,sourceKeySystems:e,audioMedia:i,mainPlaylists:s})=>{if(!t.eme.initializeMediaKeys)return Promise.resolve();const r=i?s.concat([i]):s,n=oM(r,Object.keys(e)),o=[],a=[];return n.forEach(l=>{a.push(new Promise((u,d)=>{t.tech_.one("keysessioncreated",u)})),o.push(new Promise((u,d)=>{t.eme.initializeMediaKeys({keySystems:l},c=>{if(c){d(c);return}u()})}))}),Promise.race([Promise.all(o),Promise.race(a)])},lM=({player:t,sourceKeySystems:e,media:i,audioMedia:s})=>{const r=nM(e,i,s);return r?(t.currentSource().keySystems=r,r&&!t.eme?(V.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},Gw=()=>{if(!F.localStorage)return null;const t=F.localStorage.getItem(Nw);if(!t)return null;try{return JSON.parse(t)}catch{return null}},uM=t=>{if(!F.localStorage)return!1;let e=Gw();e=e?Ie(e,t):t;try{F.localStorage.setItem(Nw,JSON.stringify(e))}catch{return!1}return e},dM=t=>t.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(t.substring(t.indexOf(",")+1)):t,Vw=(t,e)=>{t._requestCallbackSet||(t._requestCallbackSet=new Set),t._requestCallbackSet.add(e)},Bw=(t,e)=>{t._responseCallbackSet||(t._responseCallbackSet=new Set),t._responseCallbackSet.add(e)},Hw=(t,e)=>{t._requestCallbackSet&&(t._requestCallbackSet.delete(e),t._requestCallbackSet.size||delete t._requestCallbackSet)},Uw=(t,e)=>{t._responseCallbackSet&&(t._responseCallbackSet.delete(e),t._responseCallbackSet.size||delete t._responseCallbackSet)};Je.supportsNativeHls=function(){if(!K||!K.createElement)return!1;const t=K.createElement("video");return V.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(t.canPlayType(i))}):!1}();Je.supportsNativeDash=function(){return!K||!K.createElement||!V.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(K.createElement("video").canPlayType("application/dash+xml"))}();Je.supportsTypeNatively=t=>t==="hls"?Je.supportsNativeHls:t==="dash"?Je.supportsNativeDash:!1;Je.isSupported=function(){return V.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};Je.xhr.onRequest=function(t){Vw(Je.xhr,t)};Je.xhr.onResponse=function(t){Bw(Je.xhr,t)};Je.xhr.offRequest=function(t){Hw(Je.xhr,t)};Je.xhr.offResponse=function(t){Uw(Je.xhr,t)};const hM=V.getComponent("Component");class Ww extends hM{constructor(e,i,s){if(super(i,s.vhs),typeof s.initialBandwidth=="number"&&(this.options_.bandwidth=s.initialBandwidth),this.logger_=Ni("VhsHandler"),i.options_&&i.options_.playerId){const r=V.getPlayer(i.options_.playerId);this.player_=r}if(this.tech_=i,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(K,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],r=>{const n=K.fullscreenElement||K.webkitFullscreenElement||K.mozFullScreenElement||K.msFullscreenElement;n&&n.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=Ie(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const s=Gw();s&&s.bandwidth&&(this.options_.bandwidth=s.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),s&&s.throughput&&(this.options_.throughput=s.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=ft.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===ft.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(s=>{typeof this.source_[s]<"u"&&(this.options_[s]=this.source_[s])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio;const i=this.options_.customPixelRatio;typeof i=="number"&&i>=0&&(this.customPixelRatio=i)}setOptions(e={}){this.setOptions_(e)}src(e,i){if(!e)return;this.setOptions_(),this.options_.src=dM(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Je,this.options_.sourceType=By(i),this.options_.seekTo=n=>{this.tech_.setCurrentTime(n)},this.playlistController_=new qF(this.options_);const s=Ie({liveRangeSafeTimeDelta:cs},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new QF(s),this.playlistController_.on("error",()=>{const n=V.players[this.tech_.options_.playerId];let o=this.playlistController_.error;typeof o=="object"&&!o.code?o.code=3:typeof o=="string"&&(o={message:o,code:3}),n.error(o)});const r=this.options_.bufferBasedABR?Je.movingAverageBandwidthSelector(.55):Je.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):r.bind(this),this.playlistController_.selectInitialPlaylist=Je.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(n){this.playlistController_.selectPlaylist=n.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(n){this.playlistController_.mainSegmentLoader_.throughput.rate=n,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let n=this.playlistController_.mainSegmentLoader_.bandwidth;const o=F.navigator.connection||F.navigator.mozConnection||F.navigator.webkitConnection,a=1e7;if(this.options_.useNetworkInformationApi&&o){const l=o.downlink*1e3*1e3;l>=a&&n>=a?n=Math.max(n,l):n=l}return n},set(n){this.playlistController_.mainSegmentLoader_.bandwidth=n,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const n=1/(this.bandwidth||1);let o;return this.throughput>0?o=1/this.throughput:o=0,Math.floor(1/(n+o))},set(){V.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>Ur(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>Ur(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&uM({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{XF(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=F.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),aM({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3,metadata:{errorType:V.Error.EMEKeySessionCreationError}})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,i=lM({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",s=>{this.playlistController_.updatePlaylistByKeyStatus(s.keyId,s.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!i){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=V.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{rM(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{kw(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":Ow,"mux.js":eM,"mpd-parser":tM,"m3u8-parser":iM,"aes-decrypter":sM}}version(){return this.constructor.version()}canChangeType(){return Iw.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&F.URL.revokeObjectURL&&(F.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,i){return CL({playlist:this.playlistController_.media(),time:e,callback:i})}seekToProgramTime(e,i,s=!0,r=2){return pw({programTime:e,playlist:this.playlistController_.media(),retryCount:r,pauseAfterSeek:s,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}setupXhrHooks_(){this.xhr.onRequest=e=>{Vw(this.xhr,e)},this.xhr.onResponse=e=>{Bw(this.xhr,e)},this.xhr.offRequest=e=>{Hw(this.xhr,e)},this.xhr.offResponse=e=>{Uw(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}}const xd={name:"videojs-http-streaming",VERSION:Ow,canHandleSource(t,e={}){const i=Ie(V.options,e);return xd.canPlayType(t.type,i)},handleSource(t,e,i={}){const s=Ie(V.options,i);return e.vhs=new Ww(t,e,s),e.vhs.xhr=lw(),e.vhs.setupXhrHooks_(),e.vhs.src(t.src,t.type),e.vhs},canPlayType(t,e){const i=By(t);if(!i)return"";const s=xd.getOverrideNative(e);return!Je.supportsTypeNatively(i)||s?"maybe":""},getOverrideNative(t={}){const{vhs:e={}}=t,i=!(V.browser.IS_ANY_SAFARI||V.browser.IS_IOS),{overrideNative:s=i}=e;return s}},cM=()=>Xu("avc1.4d400d,mp4a.40.2");cM()&&V.getTech("Html5").registerSourceHandler(xd,0);V.VhsHandler=Ww;V.VhsSourceHandler=xd;V.Vhs=Je;V.use||V.registerComponent("Vhs",Je);V.options.vhs=V.options.vhs||{};(!V.getPlugin||!V.getPlugin("reloadSourceOnError"))&&V.registerPlugin("reloadSourceOnError",ZF);const pM=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));var gM={exports:{}};const fM=Tg(pM);(function(t,e){(function(i,s){{var r=fM;t.exports=s(r.default||r)}})(il,function(i){var s=i.browser.IS_IOS||i.browser.IS_NATIVE_ANDROID,r=i.getTech("Tech");class n extends r{constructor(d,c){super(d,c),this.setPoster(d.poster),this.setSrc(this.options_.source,!0),this.setTimeout((function(){this.el_&&(this.el_.parentNode.className+=" vjs-youtube",s&&(this.el_.parentNode.className+=" vjs-youtube-mobile"),n.isApiReady?this.initYTPlayer():n.apiReadyQueue.push(this))}).bind(this))}dispose(){if(this.ytPlayer)this.ytPlayer.stopVideo&&this.ytPlayer.stopVideo(),this.ytPlayer.destroy&&this.ytPlayer.destroy();else{var d=n.apiReadyQueue.indexOf(this);d!==-1&&n.apiReadyQueue.splice(d,1)}this.ytPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-youtube","").replace(" vjs-youtube-mobile",""),this.el_.parentNode.removeChild(this.el_),r.prototype.dispose.call(this)}createEl(){var d=document.createElement("div");d.setAttribute("id",this.options_.techId),d.setAttribute("style","width:100%;height:100%;top:0;left:0;position:absolute"),d.setAttribute("class","vjs-tech");var c=document.createElement("div");if(c.appendChild(d),!s&&!this.options_.ytControls){var C=document.createElement("div");C.setAttribute("class","vjs-iframe-blocker"),C.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),C.onclick=(function(){this.pause()}).bind(this),c.appendChild(C)}return c}initYTPlayer(){var d={controls:0,modestbranding:1,rel:0,showinfo:0,loop:this.options_.loop?1:0};if(typeof this.options_.autohide<"u"&&(d.autohide=this.options_.autohide),typeof this.options_.cc_load_policy<"u"&&(d.cc_load_policy=this.options_.cc_load_policy),typeof this.options_.ytControls<"u"&&(d.controls=this.options_.ytControls),typeof this.options_.disablekb<"u"&&(d.disablekb=this.options_.disablekb),typeof this.options_.color<"u"&&(d.color=this.options_.color),d.controls?typeof this.options_.fs<"u"&&(d.fs=this.options_.fs):d.fs=0,this.options_.source.src.indexOf("end=")!==-1){var c=this.options_.source.src.match(/end=([0-9]*)/);this.options_.end=parseInt(c[1])}if(typeof this.options_.end<"u"&&(d.end=this.options_.end),typeof this.options_.hl<"u"?d.hl=this.options_.hl:typeof this.options_.language<"u"&&(d.hl=this.options_.language.substr(0,2)),typeof this.options_.iv_load_policy<"u"&&(d.iv_load_policy=this.options_.iv_load_policy),typeof this.options_.list<"u"?d.list=this.options_.list:this.url&&typeof this.url.listId<"u"&&(d.list=this.url.listId),typeof this.options_.listType<"u"&&(d.listType=this.options_.listType),typeof this.options_.modestbranding<"u"&&(d.modestbranding=this.options_.modestbranding),typeof this.options_.playlist<"u"&&(d.playlist=this.options_.playlist),typeof this.options_.playsinline<"u"&&(d.playsinline=this.options_.playsinline),typeof this.options_.rel<"u"&&(d.rel=this.options_.rel),typeof this.options_.showinfo<"u"&&(d.showinfo=this.options_.showinfo),this.options_.source.src.indexOf("start=")!==-1){var C=this.options_.source.src.match(/start=([0-9]*)/);this.options_.start=parseInt(C[1])}if(typeof this.options_.start<"u"&&(d.start=this.options_.start),typeof this.options_.theme<"u"&&(d.theme=this.options_.theme),typeof this.options_.customVars<"u"){var E=this.options_.customVars;Object.keys(E).forEach(function(_){d[_]=E[_]})}this.activeVideoId=this.url?this.url.videoId:null,this.activeList=d.list;var y={videoId:this.activeVideoId,playerVars:d,events:{onReady:this.onPlayerReady.bind(this),onPlaybackQualityChange:this.onPlayerPlaybackQualityChange.bind(this),onPlaybackRateChange:this.onPlayerPlaybackRateChange.bind(this),onStateChange:this.onPlayerStateChange.bind(this),onVolumeChange:this.onPlayerVolumeChange.bind(this),onError:this.onPlayerError.bind(this)}};typeof this.options_.enablePrivacyEnhancedMode<"u"&&this.options_.enablePrivacyEnhancedMode&&(y.host="https://www.youtube-nocookie.com"),this.ytPlayer=new YT.Player(this.options_.techId,y)}onPlayerReady(){this.options_.muted&&this.ytPlayer.mute();var d=this.ytPlayer.getAvailablePlaybackRates();d.length>1&&(this.featuresPlaybackRate=!0),this.playerReady_=!0,this.triggerReady(),this.playOnReady?this.play():this.cueOnReady&&(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)}onPlayerPlaybackQualityChange(){}onPlayerPlaybackRateChange(){this.trigger("ratechange")}onPlayerStateChange(d){var c=d.data;if(!(c===this.lastState||this.errorNumber))switch(this.lastState=c,c){case-1:this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("durationchange"),this.trigger("ratechange");break;case YT.PlayerState.ENDED:this.trigger("ended");break;case YT.PlayerState.PLAYING:this.trigger("timeupdate"),this.trigger("durationchange"),this.trigger("playing"),this.trigger("play"),this.isSeeking&&this.onSeeked();break;case YT.PlayerState.PAUSED:this.trigger("canplay"),this.isSeeking?this.onSeeked():this.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.trigger("waiting");break}}onPlayerVolumeChange(){this.trigger("volumechange")}onPlayerError(d){this.errorNumber=d.data,this.trigger("pause"),this.trigger("error")}error(){var d=1e3+this.errorNumber;switch(this.errorNumber){case 5:return{code:d,message:"Error while trying to play the video"};case 2:case 100:return{code:d,message:"Unable to find the video"};case 101:case 150:return{code:d,message:"Playback on other Websites has been disabled by the video owner."}}return{code:d,message:"YouTube unknown error ("+this.errorNumber+")"}}loadVideoById_(d){var c={videoId:d};this.options_.start&&(c.startSeconds=this.options_.start),this.options_.end&&(c.endSeconds=this.options_.end),this.ytPlayer.loadVideoById(c)}cueVideoById_(d){var c={videoId:d};this.options_.start&&(c.startSeconds=this.options_.start),this.options_.end&&(c.endSeconds=this.options_.end),this.ytPlayer.cueVideoById(c)}src(d){return d&&this.setSrc({src:d}),this.source}poster(){return s?null:this.poster_}setPoster(d){this.poster_=d}setSrc(d){!d||!d.src||(delete this.errorNumber,this.source=d,this.url=n.parseUrl(d.src),this.options_.poster||this.url.videoId&&(this.poster_="https://img.youtube.com/vi/"+this.url.videoId+"/0.jpg",this.trigger("posterchange"),this.checkHighResPoster()),this.options_.autoplay&&!s?this.isReady_?this.play():this.playOnReady=!0:this.activeVideoId!==this.url.videoId&&(this.isReady_?(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):this.cueOnReady=!0))}autoplay(){return this.options_.autoplay}setAutoplay(d){this.options_.autoplay=d}loop(){return this.options_.loop}setLoop(d){this.options_.loop=d}play(){!this.url||!this.url.videoId||(this.wasPausedBeforeSeek=!1,this.isReady_?(this.url.listId&&(this.activeList===this.url.listId?this.ytPlayer.playVideo():(this.ytPlayer.loadPlaylist(this.url.listId),this.activeList=this.url.listId)),this.activeVideoId===this.url.videoId?this.ytPlayer.playVideo():(this.loadVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)):(this.trigger("waiting"),this.playOnReady=!0))}pause(){this.ytPlayer&&this.ytPlayer.pauseVideo()}paused(){return this.ytPlayer?this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING:!0}currentTime(){return this.ytPlayer?this.ytPlayer.getCurrentTime():0}setCurrentTime(d){this.lastState===YT.PlayerState.PAUSED&&(this.timeBeforeSeek=this.currentTime()),this.isSeeking||(this.wasPausedBeforeSeek=this.paused()),this.ytPlayer.seekTo(d,!0),this.trigger("timeupdate"),this.trigger("seeking"),this.isSeeking=!0,this.lastState===YT.PlayerState.PAUSED&&this.timeBeforeSeek!==d&&(clearInterval(this.checkSeekedInPauseInterval),this.checkSeekedInPauseInterval=setInterval((function(){this.lastState!==YT.PlayerState.PAUSED||!this.isSeeking?clearInterval(this.checkSeekedInPauseInterval):this.currentTime()!==this.timeBeforeSeek&&(this.trigger("timeupdate"),this.onSeeked())}).bind(this),250))}seeking(){return this.isSeeking}seekable(){return this.ytPlayer?i.createTimeRange(0,this.ytPlayer.getDuration()):i.createTimeRange()}onSeeked(){clearInterval(this.checkSeekedInPauseInterval),this.isSeeking=!1,this.wasPausedBeforeSeek&&this.pause(),this.trigger("seeked")}playbackRate(){return this.ytPlayer?this.ytPlayer.getPlaybackRate():1}setPlaybackRate(d){this.ytPlayer&&this.ytPlayer.setPlaybackRate(d)}duration(){return this.ytPlayer?this.ytPlayer.getDuration():0}currentSrc(){return this.source&&this.source.src}ended(){return this.ytPlayer?this.lastState===YT.PlayerState.ENDED:!1}volume(){return this.ytPlayer?this.ytPlayer.getVolume()/100:1}setVolume(d){this.ytPlayer&&this.ytPlayer.setVolume(d*100)}muted(){return this.ytPlayer?this.ytPlayer.isMuted():!1}setMuted(d){if(this.ytPlayer)this.muted(!0);else return;d?this.ytPlayer.mute():this.ytPlayer.unMute(),this.setTimeout(function(){this.trigger("volumechange")},50)}buffered(){if(!this.ytPlayer||!this.ytPlayer.getVideoLoadedFraction)return i.createTimeRange();var d=this.ytPlayer.getVideoLoadedFraction()*this.ytPlayer.getDuration();return i.createTimeRange(0,d)}preload(){}load(){}reset(){}networkState(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 3:return 2;default:return 1}}readyState(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 5:return 1;case 3:return 2;default:return 4}}supportsFullScreen(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}checkHighResPoster(){var d="https://img.youtube.com/vi/"+this.url.videoId+"/maxresdefault.jpg";try{var c=new Image;c.onload=(function(){if("naturalHeight"in c){if(c.naturalHeight<=90||c.naturalWidth<=120)return}else if(c.height<=90||c.width<=120)return;this.poster_=d,this.trigger("posterchange")}).bind(this),c.onerror=function(){},c.src=d}catch{}}}n.isSupported=function(){return!0},n.canPlaySource=function(u){return n.canPlayType(u.type)},n.canPlayType=function(u){return u==="video/youtube"},n.parseUrl=function(u){var d={videoId:null},c=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,C=u.match(c);C&&C[2].length===11&&(d.videoId=C[2]);var E=/[?&]list=([^#\&\?]+)/;return C=u.match(E),C&&C[1]&&(d.listId=C[1]),d};function o(){YT.ready(function(){n.isApiReady=!0;for(var u=0;u<n.apiReadyQueue.length;++u)n.apiReadyQueue[u].initYTPlayer()})}function a(u,d){var c=!1,C=document.createElement("script"),E=document.getElementsByTagName("script")[0];E&&(E.parentNode.insertBefore(C,E),C.onload=function(){c||(c=!0,d())},C.onreadystatechange=function(){!c&&(this.readyState==="complete"||this.readyState==="loaded")&&(c=!0,d())},C.src=u)}function l(){var u=".vjs-youtube .vjs-iframe-blocker { display: none; }.vjs-youtube.vjs-user-inactive .vjs-iframe-blocker { display: block; }.vjs-youtube .vjs-poster { background-size: cover; }.vjs-youtube-mobile .vjs-big-play-button { display: none; }",d=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=u:c.appendChild(document.createTextNode(u)),d.appendChild(c)}n.apiReadyQueue=[],typeof document<"u"&&(a("https://www.youtube.com/iframe_api",o),l()),typeof i.registerTech<"u"?i.registerTech("Youtube",n):i.registerComponent("Youtube",n)})})(gM);const Qa=-1,mM={cues:[{start:1,end:3,content:"one to three"},{start:4,end:15,content:"four to 15"},{start:24,end:25,content:"24 to 25"},{start:100,end:104,content:"100 to 104"}],currentCueIndex:Qa},dr=Gl(mM);function wh(){return $D(dr).cues}function zw(t,e,i){return t>=e||t<0||e<0?(alert("The start value must be smaller than the end value"),!0):!1}function $w(){localStorage.setItem("timeline",JSON.stringify(wh()))}function CM(t,e,i,s){if(console.log({index:t,start:e,end:i,content:s}),zw(e,i))throw new Error("Bad values");dr.update(r=>{if(t<0||t>=r.cues.length)return console.error(`Invalid index ${t} provided for updateCue`),r;const n=[...r.cues];return n[t]={start:Number(e),end:Number(i),content:String(s)},n.sort((o,a)=>o.start-a.start),{...r,cues:n}}),$w()}function vM(t,e,i){zw(t,e)||(dr.update(s=>{const r=[...s.cues,{start:Number(t),end:Number(e),content:String(i)}].sort((n,o)=>n.start-o.start);return{...s,cues:r}}),$w())}function yM(t){dr.update(()=>({cues:t,currentCueIndex:0}))}function SM(t){dr.update(e=>({...e,currentCueIndex:t}))}function EM(t){dr.update(e=>{const{cues:i,currentCueIndex:s}=e;let r=s+1;for(;r<i.length&&t>=i[r].end;)r++;if(r<i.length){if(s!==Qa&&t>=i[s].end||t>=i[r].start&&t<i[r].end)return{...e,currentCueIndex:r};if(s!==Qa&&t>i[s].end)return{...e,currentCueIndex:Qa}}return e})}const jw=Gl(0),Qn=Gl(!1),Ja=Gl(0);function wM(t){let e,i;return{c(){e=ze("div"),i=ze("video"),we(i,"class","video-js vjs-default-skin"),we(i,"width","640"),we(i,"height","256"),i.controls=!0,we(e,"data-vjs-player","")},m(s,r){pi(s,e,r),Ge(e,i),t[2](i)},p:Le,i:Le,o:Le,d(s){s&&Zt(e),t[2](null)}}}function TM(t,e,i){let s,r;Zr(t,Ja,d=>i(4,s=d)),Zr(t,Qn,d=>i(5,r=d));let{videoUrl:n}=e,o,a;function l(d){if(!d)throw new Error("No url");if(!o){console.error("No videoElement");return}a&&a.dispose(),a=V(o,{techOrder:["youtube"],sources:[{type:"video/youtube",src:d}]}),a.on("play",()=>Pa(Qn,r=!0,r)),a.on("pause",()=>Pa(Qn,r=!1,r));let c=0;a.on("timeupdate",()=>{const y=a.currentTime();y!==c&&(console.log("player time changed, call for update of currentCue",y),Pa(Ja,s=y,s),EM(y),c=y)});const C=Qn.subscribe(y=>{y?a.play():a.pause()}),E=jw.subscribe(y=>{Pa(Ja,s=y,s),a.currentTime(y)});return()=>{C(),E()}}wg(()=>{const d=n.subscribe(c=>{c&&o&&l(c)});return()=>{d(),a&&a.dispose(),d.unsubscribe()}});function u(d){od[d?"unshift":"push"](()=>{o=d,i(0,o)})}return t.$$set=d=>{"videoUrl"in d&&i(1,n=d.videoUrl)},[o,n,u]}class bM extends es{constructor(e){super(),Zi(this,e,TM,wM,Oi,{videoUrl:1})}}var Df=Object.defineProperty,_M=Object.defineProperties,DM=Object.getOwnPropertyDescriptor,RM=Object.getOwnPropertyDescriptors,Pd=Object.getOwnPropertySymbols,qw=Object.prototype.hasOwnProperty,Kw=Object.prototype.propertyIsEnumerable,ry=(t,e,i)=>e in t?Df(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,te=(t,e)=>{for(var i in e||(e={}))qw.call(e,i)&&ry(t,i,e[i]);if(Pd)for(var i of Pd(e))Kw.call(e,i)&&ry(t,i,e[i]);return t},He=(t,e)=>_M(t,RM(e)),AM=(t,e)=>{var i={};for(var s in t)qw.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&Pd)for(var s of Pd(t))e.indexOf(s)<0&&Kw.call(t,s)&&(i[s]=t[s]);return i},St=(t,e)=>{for(var i in e)Df(t,i,{get:e[i],enumerable:!0})},g=(t,e,i,s)=>{for(var r=s>1?void 0:s?DM(e,i):e,n=t.length-1,o;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&Df(e,i,r),r},zi=(t,e)=>(i,s)=>e(i,s,t),Yw={};St(Yw,{attrToBoolean:()=>Id,attrToNumber:()=>ar,attrToString:()=>xM,defaultComparator:()=>PM,exists:()=>U,jsonEquals:()=>Kp,makeNull:()=>ys,missing:()=>re,missingOrEmpty:()=>bi,toStringOrNull:()=>hl,values:()=>qr});function ys(t){return t==null||t===""?null:t}function U(t,e=!1){return t!=null&&(t!==""||e)}function re(t){return!U(t)}function bi(t){return t==null||t.length===0}function hl(t){return t!=null&&typeof t.toString=="function"?t.toString():null}function ar(t){if(t===void 0)return;if(t===null||t==="")return null;if(typeof t=="number")return isNaN(t)?void 0:t;const e=parseInt(t,10);return isNaN(e)?void 0:e}function Id(t){if(t!==void 0)return t===null||t===""?!1:typeof t=="boolean"?t:/true/i.test(t)}function xM(t){if(!(t==null||t===""))return t}function Kp(t,e){const i=t?JSON.stringify(t):null,s=e?JSON.stringify(e):null;return i===s}function PM(t,e,i=!1){const s=t==null,r=e==null;if(t&&t.toNumber&&(t=t.toNumber()),e&&e.toNumber&&(e=e.toNumber()),s&&r)return 0;if(s)return-1;if(r)return 1;function n(o,a){return o>a?1:o<a?-1:0}if(typeof t!="string"||!i)return n(t,e);try{return t.localeCompare(e)}catch{return n(t,e)}}function qr(t){if(t instanceof Set||t instanceof Map){const e=[];return t.forEach(i=>e.push(i)),e}return Object.values(t)}var IM=class{constructor(){this.existingKeys={}}addExistingKeys(t){for(let e=0;e<t.length;e++)this.existingKeys[t[e]]=!0}getUniqueKey(t,e){t=hl(t);let i=0;for(;;){let s;if(t?(s=t,i!==0&&(s+="_"+i)):e?(s=e,i!==0&&(s+="_"+i)):s=i,!this.existingKeys[s])return this.existingKeys[s]=!0,String(s);i++}}},Xw={};St(Xw,{cloneObject:()=>Rf,deepCloneDefinition:()=>Ld,getAllValuesInObject:()=>hr,getValueUsingField:()=>lo,isNonNullObject:()=>Fd,iterateObject:()=>Tt,mergeDeep:()=>Yt,removeAllReferences:()=>Qw});function Tt(t,e){if(t!=null){if(Array.isArray(t)){for(let i=0;i<t.length;i++)e(i.toString(),t[i]);return}for(const[i,s]of Object.entries(t))e(i,s)}}function Rf(t){const e={},i=Object.keys(t);for(let s=0;s<i.length;s++){const r=i[s],n=t[r];e[r]=n}return e}function Ld(t,e){if(!t)return;const i=t,s={};return Object.keys(i).forEach(r=>{if(e&&e.indexOf(r)>=0)return;const n=i[r];Fd(n)&&n.constructor===Object?s[r]=Ld(n):s[r]=n}),s}function hr(t){if(!t)return[];const e=Object;if(typeof e.values=="function")return e.values(t);const i=[];for(const s in t)t.hasOwnProperty(s)&&t.propertyIsEnumerable(s)&&i.push(t[s]);return i}function Yt(t,e,i=!0,s=!1){U(e)&&Tt(e,(r,n)=>{let o=t[r];o!==n&&(s&&o==null&&n!=null&&typeof n=="object"&&n.constructor===Object&&(o={},t[r]=o),Fd(n)&&Fd(o)&&!Array.isArray(o)?Yt(o,n,i,s):(i||n!==void 0)&&(t[r]=n))})}function lo(t,e,i){if(!e||!t)return;if(!i)return t[e];const s=e.split(".");let r=t;for(let n=0;n<s.length;n++){if(r==null)return;r=r[s[n]]}return r}function Qw(t,e=[],i){Object.keys(t).forEach(o=>{typeof t[o]=="object"&&!e.includes(o)&&(t[o]=void 0)});const s=Object.getPrototypeOf(t),r={},n=o=>`AG Grid: Grid API function ${o}() cannot be called as the grid has been destroyed.
    It is recommended to remove local references to the grid api. Alternatively, check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
    To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${i}`;Object.getOwnPropertyNames(s).forEach(o=>{if(typeof s[o]=="function"&&!e.includes(o)){const l=()=>{console.warn(n(o))};r[o]={value:l,writable:!0}}}),Object.defineProperties(t,r)}function Fd(t){return typeof t=="object"&&t!==null}var Jw={};St(Jw,{compose:()=>LM,debounce:()=>Ot,doOnce:()=>bo,errorOnce:()=>gs,executeAfter:()=>e0,executeInAWhile:()=>Zw,executeNextVMTurn:()=>Yp,getFunctionName:()=>Th,isFunction:()=>bh,noop:()=>FM,throttle:()=>Xp,waitUntil:()=>Af,warnOnce:()=>ie});var ny={};function bo(t,e){ny[e]||(t(),ny[e]=!0)}function ie(t){bo(()=>console.warn("AG Grid: "+t),t)}function gs(t){bo(()=>console.error("AG Grid: "+t),t)}function Th(t){if(t.name)return t.name;const e=/function\s+([^\(]+)/.exec(t.toString());return e&&e.length===2?e[1].trim():null}function bh(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Zw(t){e0(t,400)}var Xc=[],Qc=!1;function Yp(t){Xc.push(t),!Qc&&(Qc=!0,window.setTimeout(()=>{const e=Xc.slice();Xc.length=0,Qc=!1,e.forEach(i=>i())},0))}function e0(t,e=0){t.length>0&&window.setTimeout(()=>t.forEach(i=>i()),e)}function Ot(t,e){let i;return function(...s){const r=this;window.clearTimeout(i),i=window.setTimeout(function(){t.apply(r,s)},e)}}function Xp(t,e){let i=0;return function(...s){const r=this,n=new Date().getTime();n-i<e||(i=n,t.apply(r,s))}}function Af(t,e,i=100,s){const r=new Date().getTime();let n=null,o=!1;const a=()=>{const l=new Date().getTime()-r>i;(t()||l)&&(e(),o=!0,n!=null&&(window.clearInterval(n),n=null),l&&s&&console.warn(s))};a(),o||(n=window.setInterval(a,10))}function LM(...t){return e=>t.reduce((i,s)=>s(i),e)}var FM=()=>{},t0=(t=>(t.CommunityCoreModule="@ag-grid-community/core",t.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",t.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",t.CsvExportModule="@ag-grid-community/csv-export",t.EnterpriseCoreModule="@ag-grid-enterprise/core",t.RowGroupingModule="@ag-grid-enterprise/row-grouping",t.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",t.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",t.MenuModule="@ag-grid-enterprise/menu",t.SetFilterModule="@ag-grid-enterprise/set-filter",t.MultiFilterModule="@ag-grid-enterprise/multi-filter",t.StatusBarModule="@ag-grid-enterprise/status-bar",t.SideBarModule="@ag-grid-enterprise/side-bar",t.RangeSelectionModule="@ag-grid-enterprise/range-selection",t.MasterDetailModule="@ag-grid-enterprise/master-detail",t.RichSelectModule="@ag-grid-enterprise/rich-select",t.GridChartsModule="@ag-grid-enterprise/charts",t.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",t.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",t.ExcelExportModule="@ag-grid-enterprise/excel-export",t.ClipboardModule="@ag-grid-enterprise/clipboard",t.SparklinesModule="@ag-grid-enterprise/sparklines",t.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",t.AngularModule="@ag-grid-community/angular",t.ReactModule="@ag-grid-community/react",t.VueModule="@ag-grid-community/vue",t))(t0||{}),_h=class Ae{static register(e){Ae.__register(e,!0,void 0)}static registerModules(e){Ae.__registerModules(e,!0,void 0)}static __register(e,i,s){Ae.runVersionChecks(e),s!==void 0?(Ae.areGridScopedModules=!0,Ae.gridModulesMap[s]===void 0&&(Ae.gridModulesMap[s]={}),Ae.gridModulesMap[s][e.moduleName]=e):Ae.globalModulesMap[e.moduleName]=e,Ae.setModuleBased(i)}static __unRegisterGridModules(e){delete Ae.gridModulesMap[e]}static __registerModules(e,i,s){Ae.setModuleBased(i),e&&e.forEach(r=>Ae.__register(r,i,s))}static isValidModuleVersion(e){const[i,s]=e.version.split(".")||[],[r,n]=Ae.currentModuleVersion.split(".")||[];return i===r&&s===n}static runVersionChecks(e){if(Ae.currentModuleVersion||(Ae.currentModuleVersion=e.version),e.version?Ae.isValidModuleVersion(e)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${e.moduleName}' is version ${e.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${e.moduleName}' is incompatible. Please update all modules to the same version.`),e.validate){const i=e.validate();i.isValid||console.error(`AG Grid: ${i.message}`)}}static setModuleBased(e){Ae.moduleBased===void 0?Ae.moduleBased=e:Ae.moduleBased!==e&&bo(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){Ae.isBundled=!0}static __assertRegistered(e,i,s){var r;if(this.__isRegistered(e,s))return!0;const n=i+e;let o;if(Ae.isBundled)o=`AG Grid: unable to use ${i} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(Ae.moduleBased||Ae.moduleBased===void 0){let a=(r=Object.entries(t0).find(([l,u])=>u===e))==null?void 0:r[0];o=`AG Grid: unable to use ${i} as the ${a} is not registered${Ae.areGridScopedModules?` for gridId: ${s}`:""}. Check if you have registered the module:
           
    import { ModuleRegistry } from '@ag-grid-community/core';
    import { ${a} } from '${e}';
    
    ModuleRegistry.registerModules([ ${a} ]);

For more info see: https://www.ag-grid.com/javascript-grid/modules/`}else o=`AG Grid: unable to use ${i} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:
            
    import 'ag-grid-enterprise';`;return bo(()=>{console.warn(o)},n),!1}static __isRegistered(e,i){var s;return!!Ae.globalModulesMap[e]||!!((s=Ae.gridModulesMap[i])!=null&&s[e])}static __getRegisteredModules(e){return[...qr(Ae.globalModulesMap),...qr(Ae.gridModulesMap[e]||{})]}static __getGridRegisteredModules(e){var i;return qr((i=Ae.gridModulesMap[e])!=null?i:{})||[]}static __isPackageBased(){return!Ae.moduleBased}};_h.globalModulesMap={};_h.gridModulesMap={};_h.areGridScopedModules=!1;var _e=_h,MM=class{constructor(t,e){if(this.beanWrappers={},this.destroyed=!1,!t||!t.beanClasses)return;this.contextParams=t,this.logger=e,this.logger.log(">> creating ag-Application Context"),this.createBeans();const i=this.getBeanInstances();this.wireBeans(i),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return qr(this.beanWrappers).map(t=>t.beanInstance)}createBean(t,e){if(!t)throw Error("Can't wire to bean since it is null");return this.wireBeans([t],e),t}wireBeans(t,e){this.autoWireBeans(t),this.methodWireBeans(t),this.callLifeCycleMethods(t,"preConstructMethods"),U(e)&&t.forEach(e),this.callLifeCycleMethods(t,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),Tt(this.beanWrappers,(e,i)=>{let s;i.bean.__agBeanMetaData&&i.bean.__agBeanMetaData.autowireMethods&&i.bean.__agBeanMetaData.autowireMethods.agConstructor&&(s=i.bean.__agBeanMetaData.autowireMethods.agConstructor);const r=this.getBeansForParameters(s,i.bean.name),n=new(i.bean.bind.apply(i.bean,[null,...r]));i.beanInstance=n});const t=Object.keys(this.beanWrappers).join(", ");this.logger.log(`created beans: ${t}`)}createBeanWrapper(t){const e=t.__agBeanMetaData;if(!e){let s;t.prototype.constructor?s=Th(t.prototype.constructor):s=""+t,console.error(`Context item ${s} is not a bean`);return}const i={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=i}autoWireBeans(t){t.forEach(e=>{this.forEachMetaDataInHierarchy(e,(i,s)=>{const r=i.agClassAttributes;r&&r.forEach(n=>{const o=this.lookupBeanInstance(s,n.beanName,n.optional);e[n.attributeName]=o})})})}methodWireBeans(t){t.forEach(e=>{this.forEachMetaDataInHierarchy(e,(i,s)=>{Tt(i.autowireMethods,(r,n)=>{if(r==="agConstructor")return;const o=this.getBeansForParameters(n,s);e[r].apply(e,o)})})})}forEachMetaDataInHierarchy(t,e){let i=Object.getPrototypeOf(t);for(;i!=null;){const s=i.constructor;if(s.hasOwnProperty("__agBeanMetaData")){const r=s.__agBeanMetaData,n=this.getBeanName(s);e(r,n)}i=Object.getPrototypeOf(i)}}getBeanName(t){if(t.__agBeanMetaData&&t.__agBeanMetaData.beanName)return t.__agBeanMetaData.beanName;const e=t.toString();return e.substring(9,e.indexOf("("))}getBeansForParameters(t,e){const i=[];return t&&Tt(t,(s,r)=>{const n=this.lookupBeanInstance(e,r);i[Number(s)]=n}),i}lookupBeanInstance(t,e,i=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${e} is used after the grid is destroyed!`),null;if(e==="context")return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(e))return this.contextParams.providedBeanInstances[e];const s=this.beanWrappers[e];return s?s.beanInstance:(i||console.error(`AG Grid: unable to find bean reference ${e} while initialising ${t}`),null)}callLifeCycleMethods(t,e){t.forEach(i=>this.callLifeCycleMethodsOnBean(i,e))}callLifeCycleMethodsOnBean(t,e,i){const s={};this.forEachMetaDataInHierarchy(t,n=>{const o=n[e];o&&o.forEach(a=>{a!=i&&(s[a]=!0)})}),Object.keys(s).forEach(n=>t[n]())}getBean(t){return this.lookupBeanInstance("getBean",t,!0)}destroy(){if(this.destroyed)return;this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");const t=this.getBeanInstances();this.destroyBeans(t),this.contextParams.providedBeanInstances=null,_e.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(t){t&&this.destroyBeans([t])}destroyBeans(t){return t?(t.forEach(e=>{this.callLifeCycleMethodsOnBean(e,"preDestroyMethods","destroy");const i=e;typeof i.destroy=="function"&&i.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}};function i0(t,e,i){const s=sn(t.constructor);s.preConstructMethods||(s.preConstructMethods=[]),s.preConstructMethods.push(e)}function $(t,e,i){const s=sn(t.constructor);s.postConstructMethods||(s.postConstructMethods=[]),s.postConstructMethods.push(e)}function Vt(t,e,i){const s=sn(t.constructor);s.preDestroyMethods||(s.preDestroyMethods=[]),s.preDestroyMethods.push(e)}function Y(t){return e=>{const i=sn(e);i.beanName=t}}function T(t){return(e,i,s)=>{s0(e,t,!1,e,i)}}function De(t){return(e,i,s)=>{s0(e,t,!0,e,i)}}function s0(t,e,i,s,r,n){if(e===null){console.error("AG Grid: Autowired name should not be null");return}const o=sn(t.constructor);o.agClassAttributes||(o.agClassAttributes=[]),o.agClassAttributes.push({attributeName:r,beanName:e,optional:i})}function _i(t){return(e,i,s)=>{const r=typeof e=="function"?e:e.constructor;let n;if(typeof s=="number"){let o;i?(n=sn(r),o=i):(n=sn(r),o="agConstructor"),n.autowireMethods||(n.autowireMethods={}),n.autowireMethods[o]||(n.autowireMethods[o]={}),n.autowireMethods[o][s]=t}}}function sn(t){return t.hasOwnProperty("__agBeanMetaData")||(t.__agBeanMetaData={}),t.__agBeanMetaData}var Qi=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(t,e,i=null,s=null){if(this.frameworkOverrides=e,this.gos=t,i){const r=t.useAsyncEvents();this.addGlobalListener(i,r)}s&&this.addGlobalListener(s,!1)}setFrameworkOverrides(t){this.frameworkOverrides=t}getListeners(t,e,i){const s=e?this.allAsyncListeners:this.allSyncListeners;let r=s.get(t);return!r&&i&&(r=new Set,s.set(t,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(t,e,i=!1){this.getListeners(t,i,!0).add(e)}removeEventListener(t,e,i=!1){const s=this.getListeners(t,i,!1);s&&(s.delete(e),s.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(t))}addGlobalListener(t,e=!1){(e?this.globalAsyncListeners:this.globalSyncListeners).add(t)}removeGlobalListener(t,e=!1){(e?this.globalAsyncListeners:this.globalSyncListeners).delete(t)}dispatchEvent(t){let e=t;this.gos&&this.gos.addGridCommonParams(e),this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(t){this.firedEvents[t.type]||this.dispatchEvent(t)}dispatchToListeners(t,e){var i;const s=t.type;if(e&&"event"in t){const l=t.event;l instanceof Event&&(t.eventPath=l.composedPath())}const r=(l,u)=>l.forEach(d=>{if(!u.has(d))return;const c=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>d(t)):()=>d(t);e?this.dispatchAsync(c):c()}),n=(i=this.getListeners(s,e,!1))!=null?i:new Set,o=new Set(n);o.size>0&&r(o,n),new Set(e?this.globalAsyncListeners:this.globalSyncListeners).forEach(l=>{const u=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>l(s,t)):()=>l(s,t);e?this.dispatchAsync(u):u()})}dispatchAsync(t){this.asyncFunctionsQueue.push(t),this.scheduled||(this.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)}),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const t=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],t.forEach(e=>e())}};g([zi(0,_i("gridOptionsService")),zi(1,_i("frameworkOverrides")),zi(2,_i("globalEventListener")),zi(3,_i("globalSyncEventListener"))],Qi.prototype,"setBeans",1);Qi=g([Y("eventService")],Qi);var xf=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t){let e=t;return this.frameworkOverrides.shouldWrapOutgoing&&(e=i=>{this.frameworkOverrides.wrapOutgoing(()=>t(i))},this.wrappedListeners.set(t,e)),e}wrapGlobal(t){let e=t;return this.frameworkOverrides.shouldWrapOutgoing&&(e=(i,s)=>{this.frameworkOverrides.wrapOutgoing(()=>t(i,s))},this.wrappedGlobalListeners.set(t,e)),e}unwrap(t){var e;return(e=this.wrappedListeners.get(t))!=null?e:t}unwrapGlobal(t){var e;return(e=this.wrappedGlobalListeners.get(t))!=null?e:t}},OM={resizable:!0,sortable:!0},NM=0;function r0(){return NM++}var lt=class n0{constructor(e,i,s,r){this.instanceId=r0(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new Qi,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=i,this.colId=s,this.primary=r,this.setState(e)}getInstanceId(){return this.instanceId}setState(e){e.sort!==void 0?(e.sort==="asc"||e.sort==="desc")&&(this.sort=e.sort):(e.initialSort==="asc"||e.initialSort==="desc")&&(this.sort=e.initialSort);const i=e.sortIndex,s=e.initialSortIndex;i!==void 0?i!==null&&(this.sortIndex=i):s!==null&&(this.sortIndex=s);const r=e.hide,n=e.initialHide;r!==void 0?this.visible=!r:this.visible=!n,e.pinned!==void 0?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const o=e.flex,a=e.initialFlex;o!==void 0?this.flex=o:a!==void 0&&(this.flex=a)}setColDef(e,i,s){this.colDef=e,this.userProvidedColDef=i,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged",s))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=U(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=U(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){var e,i;const s=this.colDef;this.minWidth=(e=s.minWidth)!=null?e:this.environment.getMinColWidth(),this.maxWidth=(i=s.maxWidth)!=null?i:Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=U(this.colDef.tooltipField)||U(this.colDef.tooltipValueGetter)||U(this.colDef.tooltipComponent)}resetActualWidth(e){const i=this.calculateColInitialWidth(this.colDef);this.setActualWidth(i,e,!0)}calculateColInitialWidth(e){var i,s;const r=(i=e.minWidth)!=null?i:this.environment.getMinColWidth(),n=(s=e.maxWidth)!=null?s:Number.MAX_SAFE_INTEGER;let o;const a=ar(e.width),l=ar(e.initialWidth);return a!=null?o=a:l!=null?o=l:o=200,Math.max(Math.min(o,n),r)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(re(this.colDef)||re(this.colDef.showRowGroup))return!1;const i=this.colDef.showRowGroup===!0,s=this.colDef.showRowGroup===e;return i||s}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(e,i){var s,r;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new xf(this.frameworkOverrides));const n=(r=(s=this.frameworkEventListenerService)==null?void 0:s.wrap(i))!=null?r:i;this.eventService.addEventListener(e,n)}removeEventListener(e,i){var s,r;const n=(r=(s=this.frameworkEventListenerService)==null?void 0:s.unwrap(i))!=null?r:i;this.eventService.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if(typeof this.colDef.suppressNavigable=="boolean")return this.colDef.suppressNavigable;if(typeof this.colDef.suppressNavigable=="function"){const i=this.createColumnFunctionCallbackParams(e),s=this.colDef.suppressNavigable;return s(i)}return!1}isCellEditable(e){return e.group&&!this.gos.get("enableGroupEdit")?!1:this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){var i;return(i=this.colDef[e])!=null?i:OM[e]}isColumnFunc(e,i){if(typeof i=="boolean")return i;if(typeof i=="function"){const s=this.createColumnFunctionCallbackParams(e);return i(s)}return!1}setMoving(e,i){this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",i))}createColumnEvent(e,i){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:i})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,i){this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",i))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(e,i){this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",i)))}isMenuVisible(){return this.menuVisible}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return re(this.sort)}isSorting(){return U(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,i){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",i)))}isFilterActive(){return this.filterActive}setFilterActive(e,i,s){this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",i)));const r=this.createColumnEvent("filterChanged",i);s&&Yt(r,s),this.eventService.dispatchEvent(r)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){e===!0||e==="left"?this.pinned="left":e==="right"?this.pinned="right":this.pinned=null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,i){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",i)))}setLastLeftPinned(e,i){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",i)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,i){const s=e===!0;this.visible!==s&&(this.visible=s,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",i))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const e=this.getColDef();return!e.suppressSpanHeaderHeight&&!e.autoHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const i=e.getPaddingLevel()+1;let s=!0;for(;e;){if(!e.isPadding()){s=!1;break}e=e.getParent()}return{numberOfParents:i,isSpanningTotal:s}}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const i=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,i}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(re(this.colDef.colSpan))return 1;const i=this.createBaseColDefParams(e),s=this.colDef.colSpan(i);return Math.max(s,1)}getRowSpan(e){if(re(this.colDef.rowSpan))return 1;const i=this.createBaseColDefParams(e),s=this.colDef.rowSpan(i);return Math.max(s,1)}setActualWidth(e,i,s=!1){this.minWidth!=null&&(e=Math.max(e,this.minWidth)),this.maxWidth!=null&&(e=Math.min(e,this.maxWidth)),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&i!=="flex"&&i!=="gridInitializing"&&(this.flex=null),s||this.fireColumnWidthChangedEvent(i)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return this.maxWidth!=null?e>this.maxWidth:!1}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){U(this.minWidth)&&this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,i){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",i))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,i){this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",i))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,i){this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",i)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}getMenuTabs(e){ie("As of v31.1, 'getMenuTabs' is deprecated. Use 'getColDef().menuTabs ?? defaultValues' instead.");let i=this.getColDef().menuTabs;return i==null&&(i=e),i}dispatchStateUpdatedEvent(e){this.eventService.dispatchEvent({type:n0.EVENT_STATE_UPDATED,key:e})}};lt.EVENT_MOVING_CHANGED="movingChanged";lt.EVENT_LEFT_CHANGED="leftChanged";lt.EVENT_WIDTH_CHANGED="widthChanged";lt.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged";lt.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged";lt.EVENT_VISIBLE_CHANGED="visibleChanged";lt.EVENT_FILTER_CHANGED="filterChanged";lt.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged";lt.EVENT_SORT_CHANGED="sortChanged";lt.EVENT_COL_DEF_CHANGED="colDefChanged";lt.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged";lt.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged";lt.EVENT_PIVOT_CHANGED="columnPivotChanged";lt.EVENT_VALUE_CHANGED="columnValueChanged";lt.EVENT_STATE_UPDATED="columnStateUpdated";g([T("gridOptionsService")],lt.prototype,"gos",2);g([T("environment")],lt.prototype,"environment",2);g([T("columnHoverService")],lt.prototype,"columnHoverService",2);g([T("frameworkOverrides")],lt.prototype,"frameworkOverrides",2);g([$],lt.prototype,"initialise",1);var Pe=lt,Dh=class ka{constructor(e,i,s,r){this.localEventService=new Qi,this.expandable=!1,this.instanceId=r0(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=i,this.expanded=!!e&&!!e.openByDefault,this.padding=s,this.level=r}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(e,i){this.colGroupDef=e,this.level=i,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e;const i={type:ka.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(i)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(i=>{i instanceof Pe?e.push(i):i instanceof ka&&i.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(i=>i.addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(i=>i.removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,i=!1,s=!1;const r=this.findChildrenRemovingPadding();for(let o=0,a=r.length;o<a;o++){const l=r[o];if(!l.isVisible())continue;const u=l.getColumnGroupShow();u==="open"?(e=!0,s=!0):u==="closed"?(i=!0,s=!0):(e=!0,i=!0)}const n=e&&i&&s;if(this.expandable!==n){this.expandable=n;const o={type:ka.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(o)}}findChildrenRemovingPadding(){const e=[],i=s=>{s.forEach(r=>{r instanceof ka&&r.isPadding()?i(r.children):e.push(r)})};return i(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(e,i){this.localEventService.addEventListener(e,i)}removeEventListener(e,i){this.localEventService.removeEventListener(e,i)}};Dh.EVENT_EXPANDED_CHANGED="expandedChanged";Dh.EVENT_EXPANDABLE_CHANGED="expandableChanged";g([Vt],Dh.prototype,"destroy",1);var nt=Dh,kM={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},o0={};St(o0,{addSafePassiveEventListener:()=>m0,createEventPath:()=>g0,getCtrlForEventTarget:()=>Md,getEventPath:()=>f0,isElementInEventPath:()=>Od,isEventSupported:()=>If,isStopPropagationForAgGrid:()=>Yi,stopPropagationForAgGrid:()=>Ji});var a0={};St(a0,{areEqual:()=>fs,existsAndNotEmpty:()=>l0,flatten:()=>c0,forEachReverse:()=>HM,includes:()=>fi,insertArrayIntoArray:()=>Qp,insertIntoArray:()=>cl,last:()=>Se,moveInArray:()=>Jp,pushAll:()=>Zp,removeAllFromArray:()=>h0,removeAllFromUnorderedArray:()=>d0,removeFromArray:()=>$t,removeFromUnorderedArray:()=>Pf,removeRepeatsFromArray:()=>VM,shallowCompare:()=>GM,sortNumerically:()=>u0,toStrings:()=>BM});function l0(t){return t!=null&&t.length>0}function Se(t){if(!(!t||!t.length))return t[t.length-1]}function fs(t,e,i){return t==null&&e==null?!0:t!=null&&e!=null&&t.length===e.length&&t.every((s,r)=>i?i(s,e[r]):e[r]===s)}function GM(t,e){return fs(t,e)}function u0(t){return t.sort((e,i)=>e-i)}function VM(t,e){if(t)for(let i=t.length-2;i>=0;i--){const s=t[i]===e,r=t[i+1]===e;s&&r&&t.splice(i+1,1)}}function Pf(t,e){const i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],t.pop())}function $t(t,e){const i=t.indexOf(e);i>=0&&t.splice(i,1)}function d0(t,e){for(let i=0;i<e.length;i++)Pf(t,e[i])}function h0(t,e){for(let i=0;i<e.length;i++)$t(t,e[i])}function cl(t,e,i){t.splice(i,0,e)}function Qp(t,e,i){if(!(t==null||e==null))for(let s=e.length-1;s>=0;s--){const r=e[s];cl(t,r,i)}}function Jp(t,e,i){h0(t,e),e.slice().reverse().forEach(s=>cl(t,s,i))}function fi(t,e){return t.indexOf(e)>-1}function c0(t){return[].concat.apply([],t)}function Zp(t,e){e==null||t==null||e.forEach(i=>t.push(i))}function BM(t){return t.map(hl)}function HM(t,e){if(t!=null)for(let i=t.length-1;i>=0;i--)e(t[i],i)}var p0="__ag_Grid_Stop_Propagation",UM=["touchstart","touchend","touchmove","touchcancel","scroll"],Jc={};function Ji(t){t[p0]=!0}function Yi(t){return t[p0]===!0}var If=(()=>{const t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof Jc[i]=="boolean")return Jc[i];const s=document.createElement(t[i]||"div");return i="on"+i,Jc[i]=i in s}})();function Md(t,e,i){let s=e;for(;s;){const r=t.getDomData(s,i);if(r)return r;s=s.parentElement}return null}function Od(t,e){return!e||!t?!1:f0(e).indexOf(t)>=0}function g0(t){const e=[];let i=t.target;for(;i;)e.push(i),i=i.parentElement;return e}function f0(t){const e=t;return e.path?e.path:e.composedPath?e.composedPath():g0(e)}function m0(t,e,i,s){const n=fi(UM,i)?{passive:!0}:void 0;t&&t.addEventListener&&t.addEventListener(e,i,s,n)}var qs=class C0{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.lastChangeSetIdLookup={},this.propertyListenerId=0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:C0.EVENT_DESTROYED})}addEventListener(e,i){this.localEventService||(this.localEventService=new Qi),this.localEventService.addEventListener(e,i)}removeEventListener(e,i){this.localEventService&&this.localEventService.removeEventListener(e,i)}dispatchEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedListener(e,i,s){if(this.destroyed)return;e instanceof HTMLElement?m0(this.getFrameworkOverrides(),e,i,s):e.addEventListener(i,s);const r=()=>(e.removeEventListener(i,s),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==r),null)}setupGridOptionListener(e,i){this.gos.addEventListener(e,i);const s=()=>(this.gos.removeEventListener(e,i),null);return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==s),null)}addManagedPropertyListener(e,i){return this.destroyed?()=>null:this.setupGridOptionListener(e,i)}addManagedPropertyListeners(e,i){if(this.destroyed)return;const s=e.join("-")+this.propertyListenerId++,r=n=>{if(n.changeSet){if(n.changeSet&&n.changeSet.id===this.lastChangeSetIdLookup[s])return;this.lastChangeSetIdLookup[s]=n.changeSet.id}const o={type:"gridPropertyChanged",changeSet:n.changeSet,source:n.source};i(o)};e.forEach(n=>this.setupGridOptionListener(n,r))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,i){const s=this.createBean(e,i);return this.addDestroyFunc(this.destroyBean.bind(this,e,i)),s}createBean(e,i,s){return(i||this.getContext()).createBean(e,s)}destroyBean(e,i){return(i||this.getContext()).destroyBean(e)}destroyBeans(e,i){if(e)for(let s=0;s<e.length;s++)this.destroyBean(e[s],i);return[]}};qs.EVENT_DESTROYED="destroyed";g([T("frameworkOverrides")],qs.prototype,"frameworkOverrides",2);g([T("context")],qs.prototype,"context",2);g([T("eventService")],qs.prototype,"eventService",2);g([T("gridOptionsService")],qs.prototype,"gos",2);g([T("localeService")],qs.prototype,"localeService",2);g([T("environment")],qs.prototype,"environment",2);g([Vt],qs.prototype,"destroy",1);var z=qs,pl=class extends z{setBeans(t){this.logger=t.create("ColumnFactory")}createColumnTree(t,e,i,s){const r=new IM,{existingCols:n,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(i);r.addExistingKeys(a);const l=this.recursivelyCreateColumns(t,0,e,n,r,o,s),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);const d=this.balanceColumnTree(l,0,u,r);return Ms(null,d,(C,E)=>{C instanceof nt&&C.setupExpandable(),C.setOriginalParent(E)}),{columnTree:d,treeDept:u}}extractExistingTreeData(t){const e=[],i=[],s=[];return t&&Ms(null,t,r=>{if(r instanceof nt){const n=r;i.push(n)}else{const n=r;s.push(n.getId()),e.push(n)}}),{existingCols:e,existingGroups:i,existingColKeys:s}}createForAutoGroups(t,e){return t.map(i=>this.createAutoGroupTreeItem(e,i))}createAutoGroupTreeItem(t,e){const i=this.findDepth(t);let s=e;for(let r=i-1;r>=0;r--){const n=new nt(null,`FAKE_PATH_${e.getId()}}_${r}`,!0,r);this.createBean(n),n.setChildren([s]),s.setOriginalParent(n),s=n}return i===0&&e.setOriginalParent(null),s}findDepth(t){let e=0,i=t;for(;i&&i[0]&&i[0]instanceof nt;)e++,i=i[0].getChildren();return e}balanceColumnTree(t,e,i,s){const r=[];for(let n=0;n<t.length;n++){const o=t[n];if(o instanceof nt){const a=o,l=this.balanceColumnTree(a.getChildren(),e+1,i,s);a.setChildren(l),r.push(a)}else{let a,l;for(let u=i-1;u>=e;u--){const d=s.getUniqueKey(null,null),c=this.createMergedColGroupDef(null),C=new nt(c,d,!0,e);this.createBean(C),l&&l.setChildren([C]),l=C,a||(a=l)}if(a&&l)if(r.push(a),t.some(d=>d instanceof nt)){l.setChildren([o]);continue}else{l.setChildren(t);break}r.push(o)}}return r}findMaxDept(t,e){let i=e;for(let s=0;s<t.length;s++){const r=t[s];if(r instanceof nt){const n=r,o=this.findMaxDept(n.getChildren(),e+1);i<o&&(i=o)}}return i}recursivelyCreateColumns(t,e,i,s,r,n,o){if(!t)return[];const a=new Array(t.length);for(let l=0;l<a.length;l++){const u=t[l];this.isColumnGroup(u)?a[l]=this.createColumnGroup(i,u,e,s,r,n,o):a[l]=this.createColumn(i,u,s,r,o)}return a}createColumnGroup(t,e,i,s,r,n,o){const a=this.createMergedColGroupDef(e),l=r.getUniqueKey(a.groupId||null,null),u=new nt(a,l,!1,i);this.createBean(u);const d=this.findExistingGroup(e,n);d&&n.splice(d.idx,1);let c=d==null?void 0:d.group;c&&u.setExpanded(c.isExpanded());const C=this.recursivelyCreateColumns(a.children,i+1,t,s,r,n,o);return u.setChildren(C),u}createMergedColGroupDef(t){const e={};return Object.assign(e,this.gos.get("defaultColGroupDef")),Object.assign(e,t),e}createColumn(t,e,i,s,r){const n=this.findExistingColumn(e,i);n&&(i==null||i.splice(n.idx,1));let o=n==null?void 0:n.column;if(o){const a=this.addColumnDefaultAndTypes(e,o.getColId());o.setColDef(a,e,r),this.applyColumnState(o,a,r)}else{const a=s.getUniqueKey(e.colId,e.field),l=this.addColumnDefaultAndTypes(e,a);o=new Pe(l,e,a,t),this.context.createBean(o)}return this.dataTypeService.addColumnListeners(o),o}applyColumnState(t,e,i){const s=ar(e.flex);if(s!==void 0&&t.setFlex(s),t.getFlex()<=0){const a=ar(e.width);if(a!=null)t.setActualWidth(a,i);else{const l=t.getActualWidth();t.setActualWidth(l,i)}}e.sort!==void 0&&(e.sort=="asc"||e.sort=="desc"?t.setSort(e.sort,i):t.setSort(void 0,i));const n=ar(e.sortIndex);n!==void 0&&t.setSortIndex(n);const o=Id(e.hide);o!==void 0&&t.setVisible(!o,i),e.pinned!==void 0&&t.setPinned(e.pinned)}findExistingColumn(t,e){if(e)for(let i=0;i<e.length;i++){const s=e[i].getUserProvidedColDef();if(!s)continue;if(t.colId!=null){if(e[i].getId()===t.colId)return{idx:i,column:e[i]};continue}if(t.field!=null){if(s.field===t.field)return{idx:i,column:e[i]};continue}if(s===t)return{idx:i,column:e[i]}}}findExistingGroup(t,e){if(t.groupId!=null)for(let s=0;s<e.length;s++){const r=e[s];if(r.getColGroupDef()&&r.getId()===t.groupId)return{idx:s,group:r}}}addColumnDefaultAndTypes(t,e){const i={},s=this.gos.get("defaultColDef");Yt(i,s,!1,!0);const r=this.dataTypeService.updateColDefAndGetColumnType(i,t,e);r&&this.assignColumnTypes(r,i),Yt(i,t,!1,!0);const n=this.gos.get("autoGroupColumnDef"),o=this.gos.isColumnsSortingCoupledToGroup();return t.rowGroup&&n&&o&&Yt(i,{sort:n.sort,initialSort:n.initialSort},!1,!0),this.dataTypeService.validateColDef(i),i}assignColumnTypes(t,e){if(!t.length)return;const i=Object.assign({},kM),s=this.gos.get("columnTypes")||{};Tt(s,(r,n)=>{r in i?console.warn(`AG Grid: the column type '${r}' is a default column type and cannot be overridden.`):(n.type&&ie("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),i[r]=n)}),t.forEach(r=>{const n=i[r.trim()];n?Yt(e,n,!1,!0):console.warn("AG Grid: colDef.type '"+r+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(t){return t.children!==void 0}};g([T("dataTypeService")],pl.prototype,"dataTypeService",2);g([zi(0,_i("loggerFactory"))],pl.prototype,"setBeans",1);pl=g([Y("columnFactory")],pl);function Ms(t,e,i){if(e)for(let s=0;s<e.length;s++){const r=e[s];r instanceof nt&&Ms(r,r.getChildren(),i),i(r,t)}}var Rh=class rs{constructor(e,i,s,r){this.displayedChildren=[],this.localEventService=new Qi,this.groupId=i,this.partId=s,this.providedColumnGroup=e,this.pinned=r}static createUniqueId(e,i){return e+"_"+i}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return rs.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(i=>i.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{e instanceof rs&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const i=Se(this.displayedChildren).getLeft();this.setLeft(i)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(rs.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(e){return{type:e}}addEventListener(e,i){this.localEventService.addEventListener(e,i)}removeEventListener(e,i){this.localEventService.removeEventListener(e,i)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(e){let i=!1;return this.children.forEach(s=>{e===s&&(i=!0),s instanceof rs&&s.isChildInThisGroupDeepSearch(e)&&(i=!0)}),i}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach(i=>{e+=i.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(i=>{i.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(i=>{e+=i.getMinWidth()||0}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}addDisplayedLeafColumns(e){this.displayedChildren.forEach(i=>{i instanceof Pe?e.push(i):i instanceof rs&&i.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(i=>{i instanceof Pe?e.push(i):i instanceof rs&&i.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e||!e.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.providedColumnGroup.isExpandable():!1)){this.displayedChildren=this.children,this.localEventService.dispatchEvent(this.createAgEvent(rs.EVENT_DISPLAYED_CHILDREN_CHANGED));return}this.children.forEach(s=>{if(s instanceof rs&&(!s.displayedChildren||!s.displayedChildren.length))return;switch(s.getColumnGroupShow()){case"open":e.providedColumnGroup.isExpanded()&&this.displayedChildren.push(s);break;case"closed":e.providedColumnGroup.isExpanded()||this.displayedChildren.push(s);break;default:this.displayedChildren.push(s);break}}),this.localEventService.dispatchEvent(this.createAgEvent(rs.EVENT_DISPLAYED_CHILDREN_CHANGED))}};Rh.EVENT_LEFT_CHANGED="leftChanged";Rh.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged";g([T("gridOptionsService")],Rh.prototype,"gos",2);var gt=Rh,S=class{};S.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged";S.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded";S.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged";S.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED="pivotMaxColumnsExceeded";S.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged";S.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll";S.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged";S.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged";S.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged";S.EVENT_COLUMN_MOVED="columnMoved";S.EVENT_COLUMN_VISIBLE="columnVisible";S.EVENT_COLUMN_PINNED="columnPinned";S.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened";S.EVENT_COLUMN_RESIZED="columnResized";S.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged";S.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED="suppressMovableColumns";S.EVENT_SUPPRESS_MENU_HIDE_CHANGED="suppressMenuHide";S.EVENT_SUPPRESS_FIELD_DOT_NOTATION="suppressFieldDotNotation";S.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged";S.EVENT_COLUMN_HEADER_MOUSE_OVER="columnHeaderMouseOver";S.EVENT_COLUMN_HEADER_MOUSE_LEAVE="columnHeaderMouseLeave";S.EVENT_COLUMN_HEADER_CLICKED="columnHeaderClicked";S.EVENT_COLUMN_HEADER_CONTEXT_MENU="columnHeaderContextMenu";S.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed";S.EVENT_ROW_GROUP_OPENED="rowGroupOpened";S.EVENT_ROW_DATA_UPDATED="rowDataUpdated";S.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged";S.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged";S.EVENT_CHART_CREATED="chartCreated";S.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged";S.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged";S.EVENT_CHART_DESTROYED="chartDestroyed";S.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged";S.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged";S.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart";S.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd";S.EVENT_MODEL_UPDATED="modelUpdated";S.EVENT_CUT_START="cutStart";S.EVENT_CUT_END="cutEnd";S.EVENT_PASTE_START="pasteStart";S.EVENT_PASTE_END="pasteEnd";S.EVENT_FILL_START="fillStart";S.EVENT_FILL_END="fillEnd";S.EVENT_RANGE_DELETE_START="rangeDeleteStart";S.EVENT_RANGE_DELETE_END="rangeDeleteEnd";S.EVENT_UNDO_STARTED="undoStarted";S.EVENT_UNDO_ENDED="undoEnded";S.EVENT_REDO_STARTED="redoStarted";S.EVENT_REDO_ENDED="redoEnded";S.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart";S.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd";S.EVENT_CELL_CLICKED="cellClicked";S.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked";S.EVENT_CELL_MOUSE_DOWN="cellMouseDown";S.EVENT_CELL_CONTEXT_MENU="cellContextMenu";S.EVENT_CELL_VALUE_CHANGED="cellValueChanged";S.EVENT_CELL_EDIT_REQUEST="cellEditRequest";S.EVENT_ROW_VALUE_CHANGED="rowValueChanged";S.EVENT_CELL_FOCUSED="cellFocused";S.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared";S.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused";S.EVENT_ROW_SELECTED="rowSelected";S.EVENT_SELECTION_CHANGED="selectionChanged";S.EVENT_TOOLTIP_SHOW="tooltipShow";S.EVENT_TOOLTIP_HIDE="tooltipHide";S.EVENT_CELL_KEY_DOWN="cellKeyDown";S.EVENT_CELL_MOUSE_OVER="cellMouseOver";S.EVENT_CELL_MOUSE_OUT="cellMouseOut";S.EVENT_FILTER_CHANGED="filterChanged";S.EVENT_FILTER_MODIFIED="filterModified";S.EVENT_FILTER_OPENED="filterOpened";S.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED="advancedFilterBuilderVisibleChanged";S.EVENT_SORT_CHANGED="sortChanged";S.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved";S.EVENT_ROW_CLICKED="rowClicked";S.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked";S.EVENT_GRID_READY="gridReady";S.EVENT_GRID_PRE_DESTROYED="gridPreDestroyed";S.EVENT_GRID_SIZE_CHANGED="gridSizeChanged";S.EVENT_VIEWPORT_CHANGED="viewportChanged";S.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged";S.EVENT_FIRST_DATA_RENDERED="firstDataRendered";S.EVENT_DRAG_STARTED="dragStarted";S.EVENT_DRAG_STOPPED="dragStopped";S.EVENT_CHECKBOX_CHANGED="checkboxChanged";S.EVENT_ROW_EDITING_STARTED="rowEditingStarted";S.EVENT_ROW_EDITING_STOPPED="rowEditingStopped";S.EVENT_CELL_EDITING_STARTED="cellEditingStarted";S.EVENT_CELL_EDITING_STOPPED="cellEditingStopped";S.EVENT_BODY_SCROLL="bodyScroll";S.EVENT_BODY_SCROLL_END="bodyScrollEnd";S.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged";S.EVENT_PAGINATION_CHANGED="paginationChanged";S.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged";S.EVENT_STORE_REFRESHED="storeRefreshed";S.EVENT_STATE_UPDATED="stateUpdated";S.EVENT_COLUMN_MENU_VISIBLE_CHANGED="columnMenuVisibleChanged";S.EVENT_CONTEXT_MENU_VISIBLE_CHANGED="contextMenuVisibleChanged";S.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged";S.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED="columnContainerWidthChanged";S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged";S.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged";S.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged";S.EVENT_FLASH_CELLS="flashCells";S.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged";S.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged";S.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged";S.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged";S.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged";S.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged";S.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged";S.EVENT_ROW_DRAG_ENTER="rowDragEnter";S.EVENT_ROW_DRAG_MOVE="rowDragMove";S.EVENT_ROW_DRAG_LEAVE="rowDragLeave";S.EVENT_ROW_DRAG_END="rowDragEnd";S.EVENT_GRID_STYLES_CHANGED="gridStylesChanged";S.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest";S.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest";S.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest";S.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest";S.EVENT_STORE_UPDATED="storeUpdated";S.EVENT_FILTER_DESTROYED="filterDestroyed";S.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";S.EVENT_ROW_COUNT_READY="rowCountReady";S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged";S.EVENT_DATA_TYPES_INFERRED="dataTypesInferred";S.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged";S.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected";S.EVENT_SIDE_BAR_UPDATED="sideBarUpdated";var ed=new Set([S.EVENT_GRID_PRE_DESTROYED,S.EVENT_FILL_START]),v0=class{constructor(){this.existingIds={}}getInstanceIdForKey(t){const e=this.existingIds[t];let i;return typeof e!="number"?i=0:i=e+1,this.existingIds[t]=i,i}},_o="ag-Grid-AutoColumn",gl=class extends z{createAutoGroupColumns(t){const e=[],i=this.gos.get("treeData");let s=this.gos.isGroupMultiAutoColumn();return i&&s&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),s=!1),s?t.forEach((r,n)=>{e.push(this.createOneAutoGroupColumn(r,n))}):e.push(this.createOneAutoGroupColumn()),e}updateAutoGroupColumns(t,e){t.forEach((i,s)=>this.updateOneAutoGroupColumn(i,s,e))}createOneAutoGroupColumn(t,e){let i;t?i=`${_o}-${t.getId()}`:i=_o;const s=this.createAutoGroupColDef(i,t,e);s.colId=i;const r=new Pe(s,null,i,!0);return this.context.createBean(r),r}updateOneAutoGroupColumn(t,e,i){const s=t.getColDef(),r=typeof s.showRowGroup=="string"?s.showRowGroup:void 0,n=r!=null?this.columnModel.getPrimaryColumn(r):void 0,o=this.createAutoGroupColDef(t.getId(),n??void 0,e);t.setColDef(o,null,i),this.columnFactory.applyColumnState(t,o,i)}createAutoGroupColDef(t,e,i){let s=this.createBaseColDef(e);const r=this.gos.get("autoGroupColumnDef");Yt(s,r),s=this.columnFactory.addColumnDefaultAndTypes(s,t),this.gos.get("treeData")||re(s.field)&&re(s.valueGetter)&&re(s.filterValueGetter)&&s.filter!=="agGroupColumnFilter"&&(s.filter=!1),i&&i>0&&(s.headerCheckboxSelection=!1);const n=this.gos.isColumnsSortingCoupledToGroup(),o=s.valueGetter||s.field!=null;return n&&!o&&(s.sortIndex=void 0,s.initialSort=void 0),s}createBaseColDef(t){const e=this.gos.get("autoGroupColumnDef"),s={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(e&&(e.cellRenderer||e.cellRendererSelector)||(s.cellRenderer="agGroupCellRenderer"),t){const n=t.getColDef();Object.assign(s,{headerName:this.columnModel.getDisplayNameForColumn(t,"header"),headerValueGetter:n.headerValueGetter}),n.cellRenderer&&Object.assign(s,{cellRendererParams:{innerRenderer:n.cellRenderer,innerRendererParams:n.cellRendererParams}}),s.showRowGroup=t.getColId()}else s.showRowGroup=!0;return s}};g([T("columnModel")],gl.prototype,"columnModel",2);g([T("columnFactory")],gl.prototype,"columnFactory",2);gl=g([Y("autoGroupColService")],gl);var y0={};St(y0,{camelCaseToHumanText:()=>S0,camelCaseToHyphenated:()=>E0,capitalise:()=>jM,escapeString:()=>at,utf8_encode:()=>$M});var WM=/[&<>"']/g,zM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function $M(t){const e=String.fromCharCode;function i(c){const C=[];if(!c)return[];const E=c.length;let y=0,_,b;for(;y<E;)_=c.charCodeAt(y++),_>=55296&&_<=56319&&y<E?(b=c.charCodeAt(y++),(b&64512)==56320?C.push(((_&1023)<<10)+(b&1023)+65536):(C.push(_),y--)):C.push(_);return C}function s(c){if(c>=55296&&c<=57343)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+" is not a scalar value")}function r(c,C){return e(c>>C&63|128)}function n(c){if(c>=0&&c<=31&&c!==10)return`_x${c.toString(16).toUpperCase().padStart(4,"0")}_`;if(!(c&4294967168))return e(c);let C="";return c&4294965248?c&4294901760?c&4292870144||(C=e(c>>18&7|240),C+=r(c,12),C+=r(c,6)):(s(c),C=e(c>>12&15|224),C+=r(c,6)):C=e(c>>6&31|192),C+=e(c&63|128),C}const o=i(t),a=o.length;let l=-1,u,d="";for(;++l<a;)u=o[l],d+=n(u);return d}function jM(t){return t[0].toUpperCase()+t.substring(1).toLowerCase()}function at(t,e){if(t==null)return null;const i=t.toString().toString();return e?i:i.replace(WM,s=>zM[s])}function S0(t){if(!t||t==null)return null;const e=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return t.replace(e,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}function E0(t){return t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)}var w0={};St(w0,{convertToMap:()=>or,keys:()=>KM,mapById:()=>qM});function or(t){const e=new Map;return t.forEach(i=>e.set(i[0],i[1])),e}function qM(t,e){const i=new Map;return t.forEach(s=>i.set(e(s),s)),i}function KM(t){const e=[];return t.forEach((i,s)=>e.push(s)),e}var yt=class extends z{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.changeEventsDispatching=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation");const t=this.gos.get("pivotMode");this.isPivotSettingAllowed(t)&&(this.pivotMode=t),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],e=>this.buildAutoGroupColumns(Jn(e.source))),this.addManagedPropertyListener("autoGroupColumnDef",e=>this.onAutoGroupColumnDefChanged(Jn(e.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],e=>this.onSharedColDefChanged(Jn(e.source))),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Jn(e.source))),this.addManagedListener(this.eventService,S.EVENT_FIRST_DATA_RENDERED,()=>this.onFirstDataRendered())}buildAutoGroupColumns(t){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns(t))}onAutoGroupColumnDefChanged(t){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,t)}onSharedColDefChanged(t){this.gridColumns&&(this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,t),this.createColumnsFromColumnDefs(!0,t))}setColumnDefs(t,e){const i=!!this.columnDefs;this.columnDefs=t,this.createColumnsFromColumnDefs(i,e)}recreateColumnDefs(t){this.onSharedColDefChanged(t)}destroyOldColumns(t,e){const i={};if(!t)return;Ms(null,t,r=>{i[r.getInstanceId()]=r}),e&&Ms(null,e,r=>{i[r.getInstanceId()]=null});const s=Object.values(i).filter(r=>r!=null);this.destroyBeans(s)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(t,e){const i=t?this.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const s=this.primaryColumns,r=this.primaryColumnTree,n=this.columnFactory.createColumnTree(this.columnDefs,!0,r,e);this.destroyOldColumns(this.primaryColumnTree,n.columnTree),this.primaryColumnTree=n.columnTree,this.primaryHeaderRowCount=n.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(l=>this.primaryColumnsMap[l.getId()]=l),this.extractRowGroupColumns(e,s),this.extractPivotColumns(e,s),this.extractValueColumns(e,s),this.ready=!0;const o=this.gridColsArePrimary===void 0;(this.gridColsArePrimary||o||this.autoGroupsNeedBuilding)&&(this.updateGridColumns(),t&&this.gridColsArePrimary&&!this.gos.get("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(e),this.checkViewportColumns()),this.dispatchEverythingChanged(e),this.changeEventsDispatching=!0,i&&i(),this.changeEventsDispatching=!1,this.dispatchNewColumnsLoaded(e)}shouldRowModelIgnoreRefresh(){return this.changeEventsDispatching}dispatchNewColumnsLoaded(t){const e={type:S.EVENT_NEW_COLUMNS_LOADED,source:t};this.eventService.dispatchEvent(e),t==="gridInitializing"&&this.onColumnsReady()}dispatchEverythingChanged(t){const e={type:S.EVENT_COLUMN_EVERYTHING_CHANGED,source:t};this.eventService.dispatchEvent(e)}orderGridColumnsLikePrimary(){const t=this.primaryColumns;if(!t)return;const e=t.filter(s=>this.gridColumns.indexOf(s)>=0),i=this.gridColumns.filter(s=>e.indexOf(s)<0);this.gridColumns=[...i,...e],this.gridColumns=this.placeLockedColumns(this.gridColumns)}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gos.get("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}checkViewportColumns(t=!1){if(this.displayedColumnsCenter==null||!this.extractViewport())return;const i={type:S.EVENT_VIRTUAL_COLUMNS_CHANGED,afterScroll:t};this.eventService.dispatchEvent(i)}setViewportPosition(t,e,i=!1){(t!==this.scrollWidth||e!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=t,this.scrollPosition=e,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns(i))}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(t){return t&&this.gos.get("treeData")?(ie("Pivot mode not available with treeData."),!1):!0}setPivotMode(t,e){if(t===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=t,!this.gridColumns))return;this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(e);const i={type:S.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(i)}getSecondaryPivotColumn(t,e){if(re(this.secondaryColumns))return null;const i=this.getPrimaryColumn(e);let s=null;return this.secondaryColumns.forEach(r=>{const n=r.getColDef().pivotKeys,o=r.getColDef().pivotValueColumn;fs(n,t)&&o===i&&(s=r)}),s}setBeans(t){this.logger=t.create("columnModel")}setFirstRightAndLastLeftPinned(t){let e,i;this.gos.get("enableRtl")?(e=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,i=this.displayedColumnsRight?Se(this.displayedColumnsRight):null):(e=this.displayedColumnsLeft?Se(this.displayedColumnsLeft):null,i=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(s=>{s.setLastLeftPinned(s===e,t),s.setFirstRightPinned(s===i,t)})}autoSizeColumns(t){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeColumns(t));return}const{columns:e,skipHeader:i,skipHeaderGroups:s,stopAtGroup:r,source:n="api"}=t;this.animationFrameService.flushAllFrames();const o=[];let a=-1;const l=i??this.gos.get("skipHeaderOnAutoSize"),u=s??l;for(;a!==0;)a=0,this.actionOnGridColumns(e,d=>{if(o.indexOf(d)>=0)return!1;const c=this.autoWidthCalculator.getPreferredWidthForColumn(d,l);if(c>0){const C=this.normaliseColumnWidth(d,c);d.setActualWidth(C,n),o.push(d),a++}return!0},n);u||this.autoSizeColumnGroupsByColumns(e,n,r),this.dispatchColumnResizedEvent(o,!0,"autosizeColumns")}dispatchColumnResizedEvent(t,e,i,s=null){if(t&&t.length){const r={type:S.EVENT_COLUMN_RESIZED,columns:t,column:t.length===1?t[0]:null,flexColumns:s,finished:e,source:i};this.eventService.dispatchEvent(r)}}dispatchColumnChangedEvent(t,e,i){const s={type:t,columns:e,column:e&&e.length==1?e[0]:null,source:i};this.eventService.dispatchEvent(s)}dispatchColumnMovedEvent(t){const{movedColumns:e,source:i,toIndex:s,finished:r}=t,n={type:S.EVENT_COLUMN_MOVED,columns:e,column:e&&e.length===1?e[0]:null,toIndex:s,finished:r,source:i};this.eventService.dispatchEvent(n)}dispatchColumnPinnedEvent(t,e){if(!t.length)return;const i=t.length===1?t[0]:null,s=this.getCommonValue(t,n=>n.getPinned()),r={type:S.EVENT_COLUMN_PINNED,pinned:s??null,columns:t,column:i,source:e};this.eventService.dispatchEvent(r)}dispatchColumnVisibleEvent(t,e){if(!t.length)return;const i=t.length===1?t[0]:null,s=this.getCommonValue(t,n=>n.isVisible()),r={type:S.EVENT_COLUMN_VISIBLE,visible:s,columns:t,column:i,source:e};this.eventService.dispatchEvent(r)}autoSizeColumn(t,e,i){t&&this.autoSizeColumns({columns:[t],skipHeader:i,skipHeaderGroups:!0,source:e})}autoSizeColumnGroupsByColumns(t,e,i){const s=new Set;this.getGridColumns(t).forEach(a=>{let l=a.getParent();for(;l&&l!=i;)l.isPadding()||s.add(l),l=l.getParent()});let n;const o=[];for(const a of s){for(const l of this.ctrlsService.getHeaderRowContainerCtrls())if(n=l.getHeaderCtrlForColumn(a),n)break;n&&n.resizeLeafColumnsToFit(e)}return o}autoSizeAllColumns(t,e){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(t,e));return}const i=this.getAllDisplayedColumns();this.autoSizeColumns({columns:i,skipHeader:e,source:t})}getColumnsFromTree(t){const e=[],i=s=>{for(let r=0;r<s.length;r++){const n=s[r];n instanceof Pe?e.push(n):n instanceof nt&&i(n.getChildren())}};return i(t),e}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(t){return this.getAllDisplayedColumns().indexOf(t)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(t,e,i,s){const r=[];let n=null;for(let o=0;o<e.length;o++){const a=e[o],l=e.length-o,u=Math.min(a.getColSpan(t),l),d=[a];if(u>1){const C=u-1;for(let E=1;E<=C;E++)d.push(e[o+E]);o+=C}let c;i?(c=!1,d.forEach(C=>{i(C)&&(c=!0)})):c=!0,c&&(r.length===0&&n&&(s&&s(a))&&r.push(n),r.push(a)),n=a}return r}getViewportCenterColumnsForRow(t){if(!this.colSpanActive)return this.viewportColumnsCenter;const e=s=>{const r=s.getLeft();return U(r)&&r>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(t,this.displayedColumnsCenter,i,e)}isColumnAtEdge(t,e){const i=this.getAllDisplayedColumns();if(!i.length)return!1;const s=e==="first";let r;if(t instanceof gt){const n=t.getDisplayedLeafColumns();if(!n.length)return!1;r=s?n[0]:Se(n)}else r=t;return(s?i[0]:Se(i))===r}getAriaColumnIndex(t){let e;return t instanceof gt?e=t.getLeafColumns()[0]:e=t,this.ariaOrderColumns.indexOf(e)+1}isColumnInHeaderViewport(t){return t.isAutoHeaderHeight()?!0:this.isColumnInRowViewport(t)}isColumnInRowViewport(t){if(t.isAutoHeight())return!0;const e=t.getLeft()||0,i=e+t.getActualWidth(),s=this.viewportLeft-200,r=this.viewportRight+200,n=e<s&&i<s,o=e>r&&i>r;return!n&&!o}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(t,e,i,s,r,n){if(!t||bi(t))return;let o=!1;if(t.forEach(l=>{if(!l)return;const u=this.getPrimaryColumn(l);if(u){if(i){if(e.indexOf(u)>=0)return;e.push(u)}else{if(e.indexOf(u)<0)return;$t(e,u)}s(u),o=!0}}),!o)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n);const a={type:r,columns:e,column:e.length===1?e[0]:null,source:n};this.eventService.dispatchEvent(a)}setRowGroupColumns(t,e){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(t,this.rowGroupColumns,S.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),e)}setRowGroupActive(t,e,i){t!==e.isRowGroupActive()&&(e.setRowGroupActive(t,i),t&&!this.gos.get("suppressRowGroupHidesColumns")&&this.setColumnsVisible([e],!1,i),!t&&!this.gos.get("suppressMakeColumnVisibleAfterUnGroup")&&this.setColumnsVisible([e],!0,i))}addRowGroupColumns(t,e){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),S.EVENT_COLUMN_ROW_GROUP_CHANGED,e)}removeRowGroupColumns(t,e){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),S.EVENT_COLUMN_ROW_GROUP_CHANGED,e)}addPivotColumns(t,e){this.updatePrimaryColumnList(t,this.pivotColumns,!0,i=>i.setPivotActive(!0,e),S.EVENT_COLUMN_PIVOT_CHANGED,e)}setPivotColumns(t,e){this.setPrimaryColumnList(t,this.pivotColumns,S.EVENT_COLUMN_PIVOT_CHANGED,!0,(i,s)=>{s.setPivotActive(i,e)},e)}removePivotColumns(t,e){this.updatePrimaryColumnList(t,this.pivotColumns,!1,i=>i.setPivotActive(!1,e),S.EVENT_COLUMN_PIVOT_CHANGED,e)}setPrimaryColumnList(t,e,i,s,r,n){if(!this.gridColumns)return;const o=new Map;e.forEach((a,l)=>o.set(a,l)),e.length=0,U(t)&&t.forEach(a=>{const l=this.getPrimaryColumn(a);l&&e.push(l)}),e.forEach((a,l)=>{const u=o.get(a);if(u===void 0){o.set(a,0);return}s&&u!==l||o.delete(a)}),(this.primaryColumns||[]).forEach(a=>{const l=e.indexOf(a)>=0;r(l,a)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n),this.dispatchColumnChangedEvent(i,[...o.keys()],n)}setValueColumns(t,e){this.setPrimaryColumnList(t,this.valueColumns,S.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),e)}setValueActive(t,e,i){if(t!==e.isValueActive()&&(e.setValueActive(t,i),t&&!e.getAggFunc()&&this.aggFuncService)){const s=this.aggFuncService.getDefaultAggFunc(e);e.setAggFunc(s)}}addValueColumns(t,e){this.updatePrimaryColumnList(t,this.valueColumns,!0,this.setValueActive.bind(this,!0),S.EVENT_COLUMN_VALUE_CHANGED,e)}removeValueColumns(t,e){this.updatePrimaryColumnList(t,this.valueColumns,!1,this.setValueActive.bind(this,!1),S.EVENT_COLUMN_VALUE_CHANGED,e)}normaliseColumnWidth(t,e){const i=t.getMinWidth();U(i)&&e<i&&(e=i);const s=t.getMaxWidth();return U(s)&&t.isGreaterThanMax(e)&&(e=s),e}getPrimaryOrGridColumn(t){return this.getPrimaryColumn(t)||this.getGridColumn(t)}setColumnWidths(t,e,i,s){const r=[];t.forEach(n=>{const o=this.getPrimaryOrGridColumn(n.key);if(!o)return;if(r.push({width:n.newWidth,ratios:[1],columns:[o]}),this.gos.get("colResizeDefault")==="shift"&&(e=!e),e){const l=this.getDisplayedColAfter(o);if(!l)return;const u=o.getActualWidth()-n.newWidth,d=l.getActualWidth()+u;r.push({width:d,ratios:[1],columns:[l]})}}),r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:i,source:s})}checkMinAndMaxWidthsForSet(t){const{columns:e,width:i}=t;let s=0,r=0,n=!0;e.forEach(l=>{const u=l.getMinWidth();s+=u||0;const d=l.getMaxWidth();U(d)&&d>0?r+=d:n=!1});const o=i>=s,a=!n||i<=r;return o&&a}resizeColumnSets(t){const{resizeSets:e,finished:i,source:s}=t;if(!(!e||e.every(d=>this.checkMinAndMaxWidthsForSet(d)))){if(i){const d=e&&e.length>0?e[0].columns:null;this.dispatchColumnResizedEvent(d,i,s)}return}const n=[],o=[];e.forEach(d=>{const{width:c,columns:C,ratios:E}=d,y={},_={};C.forEach(D=>o.push(D));let b=!0,R=0;for(;b;){if(R++,R>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}b=!1;const D=[];let O=0,L=c;C.forEach((k,H)=>{if(_[k.getId()])L-=y[k.getId()];else{D.push(k);const Q=E[H];O+=Q}});const I=1/O;D.forEach((k,H)=>{const ee=H===D.length-1;let Q;ee?Q=L:(Q=Math.round(E[H]*c*I),L-=Q);const Ce=k.getMinWidth(),le=k.getMaxWidth();U(Ce)&&Q<Ce?(Q=Ce,_[k.getId()]=!0,b=!0):U(le)&&le>0&&Q>le&&(Q=le,_[k.getId()]=!0,b=!0),y[k.getId()]=Q})}C.forEach(D=>{const O=y[D.getId()];D.getActualWidth()!==O&&(D.setActualWidth(O,s),n.push(D))})});const a=n.length>0;let l=[];a&&(l=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.setLeftValues(s),this.updateBodyWidths(),this.checkViewportColumns());const u=o.concat(l);(a||i)&&this.dispatchColumnResizedEvent(u,i,s,l)}setColumnAggFunc(t,e,i){if(!t)return;const s=this.getPrimaryColumn(t);s&&(s.setAggFunc(e),this.dispatchColumnChangedEvent(S.EVENT_COLUMN_VALUE_CHANGED,[s],i))}moveRowGroupColumn(t,e,i){if(this.isRowGroupEmpty())return;const s=this.rowGroupColumns[t],r=this.rowGroupColumns.slice(t,e);this.rowGroupColumns.splice(t,1),this.rowGroupColumns.splice(e,0,s);const n={type:S.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:r,column:r.length===1?r[0]:null,source:i};this.eventService.dispatchEvent(n)}moveColumns(t,e,i,s=!0){if(!this.gridColumns)return;if(this.columnAnimationService.start(),e>this.gridColumns.length-t.length){console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+e),console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");return}const r=this.getGridColumns(t);this.doesMovePassRules(r,e)&&(Jp(this.gridColumns,r,e),this.updateDisplayedColumns(i),this.dispatchColumnMovedEvent({movedColumns:r,source:i,toIndex:e,finished:s}),this.columnAnimationService.finish())}doesMovePassRules(t,e){const i=this.getProposedColumnOrder(t,e);return this.doesOrderPassRules(i)}doesOrderPassRules(t){return!(!this.doesMovePassMarryChildren(t)||!this.doesMovePassLockedPositions(t))}getProposedColumnOrder(t,e){const i=this.gridColumns.slice();return Jp(i,t,e),i}sortColumnsLikeGridColumns(t){!t||t.length<=1||t.filter(i=>this.gridColumns.indexOf(i)<0).length>0||t.sort((i,s)=>{const r=this.gridColumns.indexOf(i),n=this.gridColumns.indexOf(s);return r-n})}doesMovePassLockedPositions(t){let e=0,i=!0;const s=r=>r?r===!0||r==="left"?0:2:1;return t.forEach(r=>{const n=s(r.getColDef().lockPosition);n<e&&(i=!1),e=n}),i}doesMovePassMarryChildren(t){let e=!0;return Ms(null,this.gridBalancedTree,i=>{if(!(i instanceof nt))return;const s=i,r=s.getColGroupDef();if(!(r&&r.marryChildren))return;const o=[];s.getLeafColumns().forEach(c=>{const C=t.indexOf(c);o.push(C)});const a=Math.max.apply(Math,o),l=Math.min.apply(Math,o),u=a-l,d=s.getLeafColumns().length-1;u>d&&(e=!1)}),e}moveColumnByIndex(t,e,i){if(!this.gridColumns)return;const s=this.gridColumns[t];this.moveColumns([s],e,i)}getColumnDefs(){if(!this.primaryColumns)return;const t=this.primaryColumns.slice();return this.gridColsArePrimary?t.sort((e,i)=>this.gridColumns.indexOf(e)-this.gridColumns.indexOf(i)):this.lastPrimaryOrder&&t.sort((e,i)=>this.lastPrimaryOrder.indexOf(e)-this.lastPrimaryOrder.indexOf(i)),this.columnDefFactory.buildColumnDefs(t,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(t){switch(t){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const t=this.getWidthOfColsInList(this.displayedColumnsCenter),e=this.getWidthOfColsInList(this.displayedColumnsLeft),i=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==t,this.bodyWidth!==t||this.leftWidth!==e||this.rightWidth!==i){this.bodyWidth=t,this.leftWidth=e,this.rightWidth=i;const r={type:S.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED};this.eventService.dispatchEvent(r);const n={type:S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(n)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns:null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns:null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){var t;return(t=this.gridColumns)!=null?t:[]}isRowGroupEmpty(){return bi(this.rowGroupColumns)}setColumnsVisible(t,e=!1,i){this.applyColumnState({state:t.map(s=>({colId:typeof s=="string"?s:s.getColId(),hide:!e}))},i)}setColumnsPinned(t,e,i){if(!this.gridColumns)return;if(this.gos.isDomLayout("print")){console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");return}this.columnAnimationService.start();let s;e===!0||e==="left"?s="left":e==="right"?s="right":s=null,this.actionOnGridColumns(t,r=>r.getPinned()!==s?(r.setPinned(s),!0):!1,i,()=>({type:S.EVENT_COLUMN_PINNED,pinned:s,column:null,columns:null,source:i})),this.columnAnimationService.finish()}actionOnGridColumns(t,e,i,s){if(bi(t))return;const r=[];if(t.forEach(n=>{if(!n)return;const o=this.getGridColumn(n);if(!o)return;e(o)!==!1&&r.push(o)}),!!r.length&&(this.updateDisplayedColumns(i),U(s)&&s)){const n=s();n.columns=r,n.column=r.length===1?r[0]:null,this.eventService.dispatchEvent(n)}}getDisplayedColBefore(t){const e=this.getAllDisplayedColumns(),i=e.indexOf(t);return i>0?e[i-1]:null}getDisplayedColAfter(t){const e=this.getAllDisplayedColumns(),i=e.indexOf(t);return i<e.length-1?e[i+1]:null}getDisplayedGroupAtDirection(t,e){const i=t.getProvidedColumnGroup().getLevel()+t.getPaddingLevel(),s=t.getDisplayedLeafColumns(),r=e==="After"?Se(s):s[0],n=`getDisplayedCol${e}`;for(;;){const o=this[n](r);if(!o)return null;const a=this.getColumnGroupAtLevel(o,i);if(a!==t)return a}}getColumnGroupAtLevel(t,e){let i=t.getParent(),s,r;for(;s=i.getProvidedColumnGroup().getLevel(),r=i.getPaddingLevel(),!(s+r<=e);)i=i.getParent();return i}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(t){const e=t.isRowGroupActive()?this.rowGroupColumns.indexOf(t):null,i=t.isPivotActive()?this.pivotColumns.indexOf(t):null,s=t.isValueActive()?t.getAggFunc():null,r=t.getSort()!=null?t.getSort():null,n=t.getSortIndex()!=null?t.getSortIndex():null,o=t.getFlex()!=null&&t.getFlex()>0?t.getFlex():null;return{colId:t.getColId(),width:t.getActualWidth(),hide:!t.isVisible(),pinned:t.getPinned(),sort:r,sortIndex:n,aggFunc:s,rowGroup:t.isRowGroupActive(),rowGroupIndex:e,pivot:t.isPivotActive(),pivotIndex:i,flex:o}}getColumnState(){if(re(this.primaryColumns)||!this.isAlive())return[];const e=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(e),e}orderColumnStateList(t){const e=or(this.gridColumns.map((i,s)=>[i.getColId(),s]));t.sort((i,s)=>{const r=e.has(i.colId)?e.get(i.colId):-1,n=e.has(s.colId)?e.get(s.colId):-1;return r-n})}resetColumnState(t){if(bi(this.primaryColumns))return;const e=this.getColumnsFromTree(this.primaryColumnTree),i=[];let s=1e3,r=1e3,n=[];this.groupAutoColumns&&(n=n.concat(this.groupAutoColumns)),e&&(n=n.concat(e)),n.forEach(o=>{const a=this.getColumnStateFromColDef(o);re(a.rowGroupIndex)&&a.rowGroup&&(a.rowGroupIndex=s++),re(a.pivotIndex)&&a.pivot&&(a.pivotIndex=r++),i.push(a)}),this.applyColumnState({state:i,applyOrder:!0},t)}getColumnStateFromColDef(t){const e=(y,_)=>y??_??null,i=t.getColDef(),s=e(i.sort,i.initialSort),r=e(i.sortIndex,i.initialSortIndex),n=e(i.hide,i.initialHide),o=e(i.pinned,i.initialPinned),a=e(i.width,i.initialWidth),l=e(i.flex,i.initialFlex);let u=e(i.rowGroupIndex,i.initialRowGroupIndex),d=e(i.rowGroup,i.initialRowGroup);u==null&&(d==null||d==!1)&&(u=null,d=null);let c=e(i.pivotIndex,i.initialPivotIndex),C=e(i.pivot,i.initialPivot);c==null&&(C==null||C==!1)&&(c=null,C=null);const E=e(i.aggFunc,i.initialAggFunc);return{colId:t.getColId(),sort:s,sortIndex:r,hide:n,pinned:o,width:a,flex:l,rowGroup:d,rowGroupIndex:u,pivot:C,pivotIndex:c,aggFunc:E}}applyColumnState(t,e){if(bi(this.primaryColumns))return!1;if(t&&t.state&&!t.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const i=(n,o,a)=>{const l=this.compareColumnStatesAndDispatchEvents(e);this.autoGroupsNeedBuilding=!0;const u=o.slice(),d={},c={},C=[],E=[];let y=0;const _=this.rowGroupColumns.slice(),b=this.pivotColumns.slice();n.forEach(L=>{const I=L.colId||"";if(I.startsWith(_o)){C.push(L),E.push(L);return}const H=a(I);H?(this.syncColumnWithStateItem(H,L,t.defaultState,d,c,!1,e),$t(u,H)):(E.push(L),y+=1)});const R=L=>this.syncColumnWithStateItem(L,null,t.defaultState,d,c,!1,e);u.forEach(R);const D=(L,I,k,H)=>{const ee=L[k.getId()],Q=L[H.getId()],Ce=ee!=null,le=Q!=null;if(Ce&&le)return ee-Q;if(Ce)return-1;if(le)return 1;const be=I.indexOf(k),Z=I.indexOf(H),Ee=be>=0,xt=Z>=0;return Ee&&xt?be-Z:Ee?-1:1};this.rowGroupColumns.sort(D.bind(this,d,_)),this.pivotColumns.sort(D.bind(this,c,b)),this.updateGridColumns();const O=this.groupAutoColumns?this.groupAutoColumns.slice():[];return C.forEach(L=>{const I=this.getAutoColumn(L.colId);$t(O,I),this.syncColumnWithStateItem(I,L,t.defaultState,null,null,!0,e)}),O.forEach(R),this.applyOrderAfterApplyState(t),this.updateDisplayedColumns(e),this.dispatchEverythingChanged(e),l(),{unmatchedAndAutoStates:E,unmatchedCount:y}};this.columnAnimationService.start();let{unmatchedAndAutoStates:s,unmatchedCount:r}=i(t.state||[],this.primaryColumns||[],n=>this.getPrimaryColumn(n));return(s.length>0||U(t.defaultState))&&(r=i(s,this.secondaryColumns||[],n=>this.getSecondaryColumn(n)).unmatchedCount),this.columnAnimationService.finish(),r===0}applyOrderAfterApplyState(t){if(!t.applyOrder||!t.state)return;let e=[];const i={};t.state.forEach(r=>{if(!r.colId||i[r.colId])return;const n=this.gridColumnsMap[r.colId];n&&(e.push(n),i[r.colId]=!0)});let s=0;if(this.gridColumns.forEach(r=>{const n=r.getColId();if(i[n]!=null)return;n.startsWith(_o)?cl(e,r,s++):e.push(r)}),e=this.placeLockedColumns(e),!this.doesMovePassMarryChildren(e)){console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");return}this.gridColumns=e}compareColumnStatesAndDispatchEvents(t){const e={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},i=this.getColumnState(),s={};return i.forEach(r=>{s[r.colId]=r}),()=>{const r=this.getPrimaryAndSecondaryAndAutoColumns(),n=(_,b,R,D)=>{const O=b.map(D),L=R.map(D);if(fs(O,L))return;const k=new Set(b);R.forEach(Q=>{k.delete(Q)||k.add(Q)});const H=[...k],ee={type:_,columns:H,column:H.length===1?H[0]:null,source:t};this.eventService.dispatchEvent(ee)},o=_=>{const b=[];return r.forEach(R=>{const D=s[R.getColId()];D&&_(D,R)&&b.push(R)}),b},a=_=>_.getColId();n(S.EVENT_COLUMN_ROW_GROUP_CHANGED,e.rowGroupColumns,this.rowGroupColumns,a),n(S.EVENT_COLUMN_PIVOT_CHANGED,e.pivotColumns,this.pivotColumns,a);const u=o((_,b)=>{const R=_.aggFunc!=null,D=R!=b.isValueActive(),O=R&&_.aggFunc!=b.getAggFunc();return D||O});u.length>0&&this.dispatchColumnChangedEvent(S.EVENT_COLUMN_VALUE_CHANGED,u,t);const d=(_,b)=>_.width!=b.getActualWidth();this.dispatchColumnResizedEvent(o(d),!0,t);const c=(_,b)=>_.pinned!=b.getPinned();this.dispatchColumnPinnedEvent(o(c),t);const C=(_,b)=>_.hide==b.isVisible();this.dispatchColumnVisibleEvent(o(C),t);const y=o((_,b)=>_.sort!=b.getSort()||_.sortIndex!=b.getSortIndex());y.length>0&&this.sortController.dispatchSortChangedEvents(t,y),this.normaliseColumnMovedEventForColumnState(i,t)}}getCommonValue(t,e){if(!t||t.length==0)return;const i=e(t[0]);for(let s=1;s<t.length;s++)if(i!==e(t[s]))return;return i}normaliseColumnMovedEventForColumnState(t,e){const i=this.getColumnState(),s={};i.forEach(l=>s[l.colId]=l);const r={};t.forEach(l=>{s[l.colId]&&(r[l.colId]=!0)});const n=t.filter(l=>r[l.colId]),o=i.filter(l=>r[l.colId]),a=[];o.forEach((l,u)=>{const d=n&&n[u];if(d&&d.colId!==l.colId){const c=this.getGridColumn(d.colId);c&&a.push(c)}}),a.length&&this.dispatchColumnMovedEvent({movedColumns:a,source:e,finished:!0})}syncColumnWithStateItem(t,e,i,s,r,n,o){var a;if(!t)return;const l=(L,I)=>{const k={value1:void 0,value2:void 0};let H=!1;return e&&(e[L]!==void 0&&(k.value1=e[L],H=!0),U(I)&&e[I]!==void 0&&(k.value2=e[I],H=!0)),!H&&i&&(i[L]!==void 0&&(k.value1=i[L]),U(I)&&i[I]!==void 0&&(k.value2=i[I])),k},u=l("hide").value1;u!==void 0&&t.setVisible(!u,o);const d=l("pinned").value1;d!==void 0&&t.setPinned(d);const c=(a=t.getColDef().minWidth)!=null?a:this.environment.getMinColWidth(),C=l("flex").value1;if(C!==void 0&&t.setFlex(C),C==null){const L=l("width").value1;L!=null&&c!=null&&L>=c&&t.setActualWidth(L,o)}const E=l("sort").value1;E!==void 0&&(E==="desc"||E==="asc"?t.setSort(E,o):t.setSort(void 0,o));const y=l("sortIndex").value1;if(y!==void 0&&t.setSortIndex(y),n||!t.isPrimary())return;const _=l("aggFunc").value1;_!==void 0&&(typeof _=="string"?(t.setAggFunc(_),t.isValueActive()||(t.setValueActive(!0,o),this.valueColumns.push(t))):(U(_)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),t.isValueActive()&&(t.setValueActive(!1,o),$t(this.valueColumns,t))));const{value1:b,value2:R}=l("rowGroup","rowGroupIndex");(b!==void 0||R!==void 0)&&(typeof R=="number"||b?(t.isRowGroupActive()||(t.setRowGroupActive(!0,o),this.rowGroupColumns.push(t)),s&&typeof R=="number"&&(s[t.getId()]=R)):t.isRowGroupActive()&&(t.setRowGroupActive(!1,o),$t(this.rowGroupColumns,t)));const{value1:D,value2:O}=l("pivot","pivotIndex");(D!==void 0||O!==void 0)&&(typeof O=="number"||D?(t.isPivotActive()||(t.setPivotActive(!0,o),this.pivotColumns.push(t)),r&&typeof O=="number"&&(r[t.getId()]=O)):t.isPivotActive()&&(t.setPivotActive(!1,o),$t(this.pivotColumns,t)))}getGridColumns(t){return this.getColumns(t,this.getGridColumn.bind(this))}getColumns(t,e){const i=[];return t&&t.forEach(s=>{const r=e(s);r&&i.push(r)}),i}getColumnWithValidation(t){if(t==null)return null;const e=this.getGridColumn(t);return e||console.warn("AG Grid: could not find column "+t),e}getPrimaryColumn(t){return this.primaryColumns?this.getColumn(t,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(t){return this.getColumn(t,this.gridColumns,this.gridColumnsMap)}lookupGridColumn(t){return this.gridColumnsMap[t]}getSecondaryColumn(t){return this.secondaryColumns?this.getColumn(t,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(t,e,i){if(!t||!i)return null;if(typeof t=="string"&&i[t])return i[t];for(let s=0;s<e.length;s++)if(this.columnsMatch(e[s],t))return e[s];return this.getAutoColumn(t)}getSourceColumnsForGroupColumn(t){const e=t.getColDef().showRowGroup;if(!e)return null;if(e===!0)return this.rowGroupColumns.slice(0);const i=this.getPrimaryColumn(e);return i?[i]:null}getAutoColumn(t){return!this.groupAutoColumns||!U(this.groupAutoColumns)||re(this.groupAutoColumns)?null:this.groupAutoColumns.find(e=>this.columnsMatch(e,t))||null}columnsMatch(t,e){const i=t===e,s=t.getColDef()===e,r=t.getColId()==e;return i||s||r}getDisplayNameForColumn(t,e,i=!1){if(!t)return null;const s=this.getHeaderName(t.getColDef(),t,null,null,e);return i?this.wrapHeaderNameWithAggFunc(t,s):s}getDisplayNameForProvidedColumnGroup(t,e,i){const s=e?e.getColGroupDef():null;return s?this.getHeaderName(s,null,t,e,i):null}getDisplayNameForColumnGroup(t,e){return this.getDisplayNameForProvidedColumnGroup(t,t.getProvidedColumnGroup(),e)}getHeaderName(t,e,i,s,r){const n=t.headerValueGetter;if(n){const o=this.gos.addGridCommonParams({colDef:t,column:e,columnGroup:i,providedColumnGroup:s,location:r});return typeof n=="function"?n(o):typeof n=="string"?this.expressionService.evaluate(n,o):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}else{if(t.headerName!=null)return t.headerName;if(t.field)return S0(t.field)}return""}wrapHeaderNameWithAggFunc(t,e){if(this.gos.get("suppressAggFuncInHeader"))return e;const i=t.getColDef().pivotValueColumn,s=U(i);let r=null,n;if(s){const o=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&this.valueColumns.length===1,a=t.getColDef().pivotTotalColumnIds!==void 0;if(o&&!a)return e;r=i?i.getAggFunc():null,n=!0}else{const o=t.isValueActive(),a=this.pivotMode||!this.isRowGroupEmpty();o&&a?(r=t.getAggFunc(),n=!0):n=!1}if(n){const o=typeof r=="string"?r:"func";return`${this.localeService.getLocaleTextFunc()(o,o)}(${e})`}return e}getColumnGroup(t,e){if(!t)return null;if(t instanceof gt)return t;const i=this.getAllDisplayedTrees(),s=typeof e=="number";let r=null;return Nr(i,!1,n=>{if(n instanceof gt){const o=n;let a;s?a=t===o.getGroupId()&&e===o.getPartId():a=t===o.getGroupId(),a&&(r=o)}}),r}isReady(){return this.ready}extractValueColumns(t,e){this.valueColumns=this.extractColumns(e,this.valueColumns,(i,s)=>i.setValueActive(s,t),()=>{},()=>{},i=>{const s=i.aggFunc;if(s===null||s==="")return null;if(s!==void 0)return!!s},i=>i.initialAggFunc!=null&&i.initialAggFunc!=""),this.valueColumns.forEach(i=>{const s=i.getColDef();s.aggFunc!=null&&s.aggFunc!=""?i.setAggFunc(s.aggFunc):i.getAggFunc()||i.setAggFunc(s.initialAggFunc)})}extractRowGroupColumns(t,e){this.rowGroupColumns=this.extractColumns(e,this.rowGroupColumns,(i,s)=>i.setRowGroupActive(s,t),i=>i.rowGroupIndex,i=>i.initialRowGroupIndex,i=>i.rowGroup,i=>i.initialRowGroup)}extractColumns(t=[],e=[],i,s,r,n,o){const a=[],l=[];(this.primaryColumns||[]).forEach(c=>{const C=t.indexOf(c)<0,E=c.getColDef(),y=Id(n(E)),_=Id(o(E)),b=ar(s(E)),R=ar(r(E));let D;y!==void 0?D=y:b!==void 0?b===null?D=!1:D=b>=0:C?_!==void 0?D=_:R!==void 0?D=R!=null&&R>=0:D=!1:D=e.indexOf(c)>=0,D&&((C?b!=null||R!=null:b!=null)?a.push(c):l.push(c))});const u=c=>{const C=s(c.getColDef()),E=r(c.getColDef());return C??E};a.sort((c,C)=>{const E=u(c),y=u(C);return E===y?0:E<y?-1:1});const d=[].concat(a);return e.forEach(c=>{l.indexOf(c)>=0&&d.push(c)}),l.forEach(c=>{d.indexOf(c)<0&&d.push(c)}),e.forEach(c=>{d.indexOf(c)<0&&i(c,!1)}),d.forEach(c=>{e.indexOf(c)<0&&i(c,!0)}),d}extractPivotColumns(t,e){this.pivotColumns=this.extractColumns(e,this.pivotColumns,(i,s)=>i.setPivotActive(s,t),i=>i.pivotIndex,i=>i.initialPivotIndex,i=>i.pivot,i=>i.initialPivot)}resetColumnGroupState(t){if(!this.primaryColumnTree)return;const e=[];Ms(null,this.primaryColumnTree,i=>{if(i instanceof nt){const s=i.getColGroupDef(),r={groupId:i.getGroupId(),open:s?s.openByDefault:void 0};e.push(r)}}),this.setColumnGroupState(e,t)}getColumnGroupState(){const t=[];return Ms(null,this.gridBalancedTree,e=>{e instanceof nt&&t.push({groupId:e.getGroupId(),open:e.isExpanded()})}),t}setColumnGroupState(t,e){if(!this.gridBalancedTree)return;this.columnAnimationService.start();const i=[];if(t.forEach(s=>{const r=s.groupId,n=s.open,o=this.getProvidedColumnGroup(r);o&&o.isExpanded()!==n&&(this.logger.log("columnGroupOpened("+o.getGroupId()+","+n+")"),o.setExpanded(n),i.push(o))}),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e),i.length){const s={type:S.EVENT_COLUMN_GROUP_OPENED,columnGroup:nt.length===1?i[0]:void 0,columnGroups:i};this.eventService.dispatchEvent(s)}this.columnAnimationService.finish()}setColumnGroupOpened(t,e,i){let s;t instanceof nt?s=t.getId():s=t||"",this.setColumnGroupState([{groupId:s,open:e}],i)}getProvidedColumnGroup(t){typeof t!="string"&&console.error("AG Grid: group key must be a string");let e=null;return Ms(null,this.gridBalancedTree,i=>{i instanceof nt&&i.getId()===t&&(e=i)}),e}calculateColumnsForDisplay(){let t;return this.pivotMode&&re(this.secondaryColumns)?t=this.gridColumns.filter(e=>{const i=this.groupAutoColumns&&fi(this.groupAutoColumns,e),s=this.valueColumns&&fi(this.valueColumns,e);return i||s}):t=this.gridColumns.filter(e=>this.groupAutoColumns&&fi(this.groupAutoColumns,e)||e.isVisible()),t}checkColSpanActiveInCols(t){let e=!1;return t.forEach(i=>{U(i.getColDef().colSpan)&&(e=!0)}),e}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};const t=e=>{const i=e.getColDef(),s=i.showRowGroup;i&&U(s)&&(this.groupDisplayColumns.push(e),typeof s=="string"?this.groupDisplayColumnsMap[s]=e:s===!0&&this.getRowGroupColumns().forEach(r=>{this.groupDisplayColumnsMap[r.getId()]=e}))};this.gridColumns.forEach(t)}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(t){return this.groupDisplayColumnsMap[t]}updateDisplayedColumns(t){const e=this.calculateColumnsForDisplay();this.buildDisplayedTrees(e),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t)}isSecondaryColumnsPresent(){return U(this.secondaryColumns)}setSecondaryColumns(t,e){if(!this.gridColumns)return;const i=t;if(!(!i&&re(this.secondaryColumns))){if(i){this.processSecondaryColumnDefinitions(t);const s=this.columnFactory.createColumnTree(t,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0,e);this.destroyOldColumns(this.secondaryBalancedTree,s.columnTree),this.secondaryBalancedTree=s.columnTree,this.secondaryHeaderRowCount=s.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(r=>this.secondaryColumnsMap[r.getId()]=r),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(e)}}processSecondaryColumnDefinitions(t){const e=this.gos.get("processPivotResultColDef"),i=this.gos.get("processPivotResultColGroupDef");if(!e&&!i)return;const s=r=>{r.forEach(n=>{if(U(n.children)){const a=n;i&&i(a),s(a.children)}else e&&e(n)})};t&&s(t)}updateGridColumns(){const t=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.createGroupAutoColumnsIfNeeded()){const s=or(this.groupAutoColumns.map(r=>[r,!0]));this.lastPrimaryOrder&&(this.lastPrimaryOrder=this.lastPrimaryOrder.filter(r=>!s.has(r)),this.lastPrimaryOrder=[...this.groupAutoColumns,...this.lastPrimaryOrder]),this.lastSecondaryOrder&&(this.lastSecondaryOrder=this.lastSecondaryOrder.filter(r=>!s.has(r)),this.lastSecondaryOrder=[...this.groupAutoColumns,...this.lastSecondaryOrder])}let i;if(this.secondaryColumns&&this.secondaryBalancedTree){const s=this.secondaryColumns.some(r=>this.gridColumnsMap[r.getColId()]!==void 0);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,s&&(i=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,i=this.lastPrimaryOrder);if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(i),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(s=>this.gridColumnsMap[s.getId()]=s),this.setAutoHeightActive(),!fs(t,this.gridBalancedTree)){const s={type:S.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(s)}}setAutoHeightActive(){this.autoHeightActive=this.gridColumns.filter(t=>t.isAutoHeight()).length>0,this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,this.gos.isRowModelType("clientSide")||this.gos.isRowModelType("serverSide")||ie("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}orderGridColsLike(t){if(re(t))return;const e=or(t.map((l,u)=>[l,u]));let i=!0;if(this.gridColumns.forEach(l=>{e.has(l)&&(i=!1)}),i)return;const s=or(this.gridColumns.map(l=>[l,!0])),r=t.filter(l=>s.has(l)),n=or(r.map(l=>[l,!0])),o=this.gridColumns.filter(l=>!n.has(l)),a=r.slice();o.forEach(l=>{let u=l.getOriginalParent();if(!u){a.push(l);return}const d=[];for(;!d.length&&u;)u.getLeafColumns().forEach(y=>{const _=a.indexOf(y)>=0,b=d.indexOf(y)<0;_&&b&&d.push(y)}),u=u.getOriginalParent();if(!d.length){a.push(l);return}const c=d.map(E=>a.indexOf(E)),C=Math.max(...c);cl(a,l,C+1)}),this.gridColumns=a}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var t;let e=(t=this.isPivotMode()&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.secondaryColumns:this.primaryColumns)!=null?t:[];this.groupAutoColumns&&(e=e.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?e:e.filter(i=>i.isVisible()||i.isRowGroupActive())}placeLockedColumns(t){const e=[],i=[],s=[];return t.forEach(r=>{const n=r.getColDef().lockPosition;n==="right"?s.push(r):n==="left"||n===!0?e.push(r):i.push(r)}),[...e,...i,...s]}addAutoGroupToGridColumns(){if(re(this.groupAutoColumns)){this.destroyOldColumns(this.groupAutoColsBalancedTree),this.groupAutoColsBalancedTree=null;return}this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const t=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,t),this.groupAutoColsBalancedTree=t,this.gridBalancedTree=t.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.ariaOrderColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(t){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(t),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const e={type:S.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)}deriveDisplayedColumns(t){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinColumnsAriaOrder(),this.joinDisplayedColumns(),this.setLeftValues(t),this.displayedAutoHeightCols=this.displayedColumns.filter(e=>e.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinColumnsAriaOrder(){const t=this.getAllGridColumns(),e=[],i=[],s=[];for(const r of t){const n=r.getPinned();n?n===!0||n==="left"?e.push(r):s.push(r):i.push(r)}this.ariaOrderColumns=e.concat(i).concat(s)}joinDisplayedColumns(){this.gos.get("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(t){this.setLeftValuesOfColumns(t),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(t){if(!this.primaryColumns)return;const e=this.getPrimaryAndSecondaryAndAutoColumns().slice(0),i=this.gos.get("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(s=>{if(i){let r=this.getWidthOfColsInList(s);s.forEach(n=>{r-=n.getActualWidth(),n.setLeft(r,t)})}else{let r=0;s.forEach(n=>{n.setLeft(r,t),r+=n.getActualWidth()})}d0(e,s)}),e.forEach(s=>{s.setLeft(null,t)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(t=>{t.forEach(e=>{e instanceof gt&&e.checkLeft()})})}derivedDisplayedColumnsFromDisplayedTree(t,e){e.length=0,Nr(t,!0,i=>{i instanceof Pe&&e.push(i)})}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}extractViewportColumns(){this.isColumnVirtualisationSuppressed()?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(t,e){let i;switch(t){case"left":i=this.viewportRowLeft[e];break;case"right":i=this.viewportRowRight[e];break;default:i=this.viewportRowCenter[e];break}return re(i)&&(i=[]),i}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const t={};this.headerViewportColumns.forEach(i=>t[i.getId()]=!0);const e=(i,s,r)=>{let n=!1;for(let o=0;o<i.length;o++){const a=i[o];let l=!1;if(a instanceof Pe)l=t[a.getId()]===!0;else{const d=a.getDisplayedChildren();d&&(l=e(d,s,r+1))}l&&(n=!0,s[r]||(s[r]=[]),s[r].push(a))}return n};e(this.displayedTreeLeft,this.viewportRowLeft,0),e(this.displayedTreeRight,this.viewportRowRight,0),e(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){const t=s=>`${s.getId()}-${s.getPinned()||"normal"}`;this.extractViewportColumns();const e=this.viewportColumns.map(t).join("#"),i=this.viewportColumnsHash!==e;return i&&(this.viewportColumnsHash=e,this.calculateHeaderRows()),i}refreshFlexedColumns(t={}){var e;const i=t.source?t.source:"flex";if(t.viewportWidth!=null&&(this.flexViewportWidth=t.viewportWidth),!this.flexViewportWidth)return[];let s=-1;if(t.resizingCols){const C=new Set(t.resizingCols);let E=this.displayedColumnsCenter;for(let y=E.length-1;y>=0;y--)if(C.has(E[y])){s=y;break}}let r=0,n=[],o=0,a=0;for(let C=0;C<this.displayedColumnsCenter.length;C++)this.displayedColumnsCenter[C].getFlex()&&C>s?(n.push(this.displayedColumnsCenter[C]),a+=this.displayedColumnsCenter[C].getFlex(),o+=(e=this.displayedColumnsCenter[C].getMinWidth())!=null?e:0):r+=this.displayedColumnsCenter[C].getActualWidth();if(!n.length)return[];let l=[];r+o>this.flexViewportWidth&&(n.forEach(C=>{var E;return C.setActualWidth((E=C.getMinWidth())!=null?E:0,i)}),l=n,n=[]);const u=[];let d;e:for(;;){d=this.flexViewportWidth-r;const C=d/a;for(let E=0;E<n.length;E++){const y=n[E],_=C*y.getFlex();let b=0;const R=y.getMinWidth(),D=y.getMaxWidth();if(U(R)&&_<R?b=R:U(D)&&_>D&&(b=D),b){y.setActualWidth(b,i),Pf(n,y),a-=y.getFlex(),l.push(y),r+=y.getActualWidth();continue e}u[E]=Math.round(_)}break}let c=d;return n.forEach((C,E)=>{C.setActualWidth(Math.min(u[E],c),i),l.push(C),c-=u[E]}),t.skipSetLeft||this.setLeftValues(i),t.updateBodyWidths&&this.updateBodyWidths(),t.fireResizedEvent&&this.dispatchColumnResizedEvent(l,!0,i,n),n}sizeColumnsToFit(t,e="sizeColumnsToFit",i,s){var r,n,o,a,l;if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(t,e,i,s));return}const u={};s&&((r=s==null?void 0:s.columnLimits)==null||r.forEach(R=>{var D=R,{key:O}=D,L=AM(D,["key"]);u[typeof O=="string"?O:O.getColId()]=L}));const d=this.getAllDisplayedColumns(),c=t===this.getWidthOfColsInList(d);if(t<=0||!d.length||c)return;const C=[],E=[];d.forEach(R=>{R.getColDef().suppressSizeToFit===!0?E.push(R):C.push(R)});const y=C.slice(0);let _=!1;const b=R=>{$t(C,R),E.push(R)};for(C.forEach(R=>{var D,O;R.resetActualWidth(e);const L=u==null?void 0:u[R.getId()],I=(D=L==null?void 0:L.minWidth)!=null?D:s==null?void 0:s.defaultMinWidth,k=(O=L==null?void 0:L.maxWidth)!=null?O:s==null?void 0:s.defaultMaxWidth,H=R.getActualWidth();typeof I=="number"&&H<I?R.setActualWidth(I,e,!0):typeof k=="number"&&H>k&&R.setActualWidth(k,e,!0)});!_;){_=!0;const R=t-this.getWidthOfColsInList(E);if(R<=0)C.forEach(D=>{var O,L;const I=(L=(O=u==null?void 0:u[D.getId()])==null?void 0:O.minWidth)!=null?L:s==null?void 0:s.defaultMinWidth;if(typeof I=="number"){D.setActualWidth(I,e,!0);return}D.setMinimum(e)});else{const D=R/this.getWidthOfColsInList(C);let O=R;for(let L=C.length-1;L>=0;L--){const I=C[L],k=u==null?void 0:u[I.getId()],H=(n=k==null?void 0:k.minWidth)!=null?n:s==null?void 0:s.defaultMinWidth,ee=(o=k==null?void 0:k.maxWidth)!=null?o:s==null?void 0:s.defaultMaxWidth,Q=(a=I.getMinWidth())!=null?a:0,Ce=(l=I.getMaxWidth())!=null?l:Number.MAX_VALUE,le=typeof H=="number"&&H>Q?H:I.getMinWidth(),be=typeof ee=="number"&&ee<Ce?ee:I.getMaxWidth();let Z=Math.round(I.getActualWidth()*D);U(le)&&Z<le?(Z=le,b(I),_=!1):U(be)&&Z>be?(Z=be,b(I),_=!1):L===0&&(Z=O),I.setActualWidth(Z,e,!0),O-=Z}}}y.forEach(R=>{R.fireColumnWidthChangedEvent(e)}),this.setLeftValues(e),this.updateBodyWidths(),!i&&this.dispatchColumnResizedEvent(y,!0,e)}buildDisplayedTrees(t){const e=[],i=[],s=[];t.forEach(n=>{switch(n.getPinned()){case"left":e.push(n);break;case"right":i.push(n);break;default:s.push(n);break}});const r=new v0;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(e,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(i,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(s,r,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const t=e=>{this.displayedColumnsAndGroupsMap[e.getUniqueId()]=e};Nr(this.displayedTreeCentre,!1,t),Nr(this.displayedTreeLeft,!1,t),Nr(this.displayedTreeRight,!1,t)}isDisplayed(t){return this.displayedColumnsAndGroupsMap[t.getUniqueId()]===t}updateOpenClosedVisibilityInColumnGroups(){const t=this.getAllDisplayedTrees();Nr(t,!1,e=>{e instanceof gt&&e.calculateDisplayedColumns()})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const t=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const e=this.gos.isGroupUseEntireRow(this.pivotMode),i=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.gos.get("treeData"))&&!i&&!e){const n=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(n,this.groupAutoColumns)||t)return this.groupAutoColumns=n,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){return this.gos.get("groupDisplayType")==="custom"?!0:this.gos.get("treeDataDisplayType")==="custom"}autoColsEqual(t,e){return fs(t,e,(i,s)=>i.getColId()===s.getColId())}getWidthOfColsInList(t){return t.reduce((e,i)=>e+i.getActualWidth(),0)}getFirstDisplayedColumn(){const t=this.gos.get("enableRtl"),e=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];t&&e.reverse();for(let i=0;i<e.length;i++){const s=this[e[i]]();if(s.length)return t?Se(s):s[0]}return null}setColumnHeaderHeight(t,e){if(t.setAutoHeaderHeight(e)){const s={type:S.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:t,columns:[t],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(s)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const t=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),e=this.getAllDisplayedColumns().filter(i=>i.isAutoHeaderHeight()).map(i=>i.getAutoHeaderHeight()||0);return Math.max(t,...e)}getHeaderHeight(){var t;return(t=this.gos.get("headerHeight"))!=null?t:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var t;return(t=this.gos.get("floatingFiltersHeight"))!=null?t:this.getHeaderHeight()}getGroupHeaderHeight(){var t;return(t=this.gos.get("groupHeaderHeight"))!=null?t:this.getHeaderHeight()}getPivotHeaderHeight(){var t;return(t=this.gos.get("pivotHeaderHeight"))!=null?t:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var t;return(t=this.gos.get("pivotGroupHeaderHeight"))!=null?t:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(t=>t()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(t,e){const i=t.getUserProvidedColDef();if(!i)return!1;const s=this.columnFactory.addColumnDefaultAndTypes(i,t.getColId());return t.setColDef(s,i,e),!0}isColumnGroupingLocked(t){const e=this.gos.get("groupLockGroupColumns");if(!t.isRowGroupActive()||e===0)return!1;if(e===-1)return!0;const i=this.rowGroupColumns.findIndex(s=>s.getColId()===t.getColId());return e>i}generateColumnStateForRowGroupAndPivotIndexes(t,e){let i={};const s=(r,n,o,a,l,u)=>{if(!n.length||!this.primaryColumns)return[];const d=Object.keys(r),c=new Set(d),C=new Set(d),E=new Set(n.map(I=>{const k=I.getColId();return C.delete(k),k}).concat(d)),y=[],_={};let b=0;for(let I=0;I<this.primaryColumns.length;I++){const k=this.primaryColumns[I].getColId();E.has(k)&&(y.push(k),_[k]=b++)}let R=1e3,D=!1,O=0;const L=I=>{const k=_[I];for(let H=O;H<k;H++){const ee=y[H];C.has(ee)&&(r[ee][l]=R++,C.delete(ee))}O=k};n.forEach(I=>{const k=I.getColId();if(c.has(k))L(k),r[k][l]=R++;else{const H=I.getColDef();(H[l]===null||H[l]===void 0&&H[u]==null)&&(D||(H[o]||H[o]===void 0&&H[a]?L(k):(C.forEach(Ce=>{r[Ce][l]=R+_[Ce]}),R+=y.length,D=!0)),i[k]||(i[k]={colId:k}),i[k][l]=R++)}})};return s(t,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),s(e,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(i)}onColumnsReady(){const t=this.gos.get("autoSizeStrategy");if(!t)return;const{type:e}=t;setTimeout(()=>{if(e==="fitGridWidth"){const{columnLimits:i,defaultMinWidth:s,defaultMaxWidth:r}=t,n=i==null?void 0:i.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:s,defaultMaxWidth:r,columnLimits:n})}else e==="fitProvidedWidth"&&this.sizeColumnsToFit(t.width,"sizeColumnsToFit")})}onFirstDataRendered(){const t=this.gos.get("autoSizeStrategy");if((t==null?void 0:t.type)!=="fitCellContents")return;const{colIds:e,skipHeader:i}=t;setTimeout(()=>{e?this.autoSizeColumns({columns:e,skipHeader:i,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",i)})}};g([T("expressionService")],yt.prototype,"expressionService",2);g([T("columnFactory")],yt.prototype,"columnFactory",2);g([T("displayedGroupCreator")],yt.prototype,"displayedGroupCreator",2);g([T("ctrlsService")],yt.prototype,"ctrlsService",2);g([T("autoWidthCalculator")],yt.prototype,"autoWidthCalculator",2);g([T("columnAnimationService")],yt.prototype,"columnAnimationService",2);g([T("autoGroupColService")],yt.prototype,"autoGroupColService",2);g([T("valueCache")],yt.prototype,"valueCache",2);g([T("animationFrameService")],yt.prototype,"animationFrameService",2);g([T("sortController")],yt.prototype,"sortController",2);g([T("columnDefFactory")],yt.prototype,"columnDefFactory",2);g([De("aggFuncService")],yt.prototype,"aggFuncService",2);g([$],yt.prototype,"init",1);g([Vt],yt.prototype,"destroyColumns",1);g([zi(0,_i("loggerFactory"))],yt.prototype,"setBeans",1);yt=g([Y("columnModel")],yt);function Jn(t){return t==="gridOptionsUpdated"?"gridOptionsChanged":t}function Nr(t,e,i){if(t)for(let s=0;s<t.length;s++){const r=t[s];if(r instanceof gt){const n=e?r.getDisplayedChildren():r.getChildren();Nr(n,e,i)}i(r)}}var eg=class extends z{createDisplayedGroups(t,e,i,s){const r=this.mapOldGroupsById(s),n=[];let o=t;for(;o.length;){const a=o;o=[];let l=0;const u=d=>{const c=l;l=d;const C=a[c],y=(C instanceof gt?C.getProvidedColumnGroup():C).getOriginalParent();if(y==null){for(let b=c;b<d;b++)n.push(a[b]);return}const _=this.createColumnGroup(y,e,r,i);for(let b=c;b<d;b++)_.addChild(a[b]);o.push(_)};for(let d=1;d<a.length;d++){const c=a[d],E=(c instanceof gt?c.getProvidedColumnGroup():c).getOriginalParent(),y=a[l],b=(y instanceof gt?y.getProvidedColumnGroup():y).getOriginalParent();E!==b&&u(d)}l<a.length&&u(a.length)}return this.setupParentsIntoColumns(n,null),n}createColumnGroup(t,e,i,s){const r=t.getGroupId(),n=e.getInstanceIdForKey(r),o=gt.createUniqueId(r,n);let a=i[o];return a&&a.getProvidedColumnGroup()!==t&&(a=null),U(a)?a.reset():(a=new gt(t,r,n,s),this.context.createBean(a)),a}mapOldGroupsById(t){const e={},i=s=>{s.forEach(r=>{if(r instanceof gt){const n=r;e[r.getUniqueId()]=n,i(n.getChildren())}})};return t&&i(t),e}setupParentsIntoColumns(t,e){t.forEach(i=>{if(i.setParent(e),i instanceof gt){const s=i;this.setupParentsIntoColumns(s.getChildren(),s)}})}};eg=g([Y("displayedGroupCreator")],eg);var YM={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,excludeHiddenColumnsFromQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,enableChartToolPanelsButton:!0,suppressChartToolPanelsButton:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressParentsInRowNodes:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,suppressAggAtRootLevel:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,functionsPassive:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},ht=class{};ht.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"];ht.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"];ht.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"];ht.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"];ht.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilterAllLevels","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval"];ht.OTHER_PROPERTIES=["suppressStickyTotalRow"];ht.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher"];ht.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"];ht.FUNCTION_PROPERTIES=[...ht.FUNCTIONAL_PROPERTIES,...ht.CALLBACK_PROPERTIES];ht.ALL_PROPERTIES=[...ht.ARRAY_PROPERTIES,...ht.OBJECT_PROPERTIES,...ht.STRING_PROPERTIES,...ht.NUMBER_PROPERTIES,...ht.FUNCTION_PROPERTIES,...ht.BOOLEAN_PROPERTIES,...ht.OTHER_PROPERTIES];var fl=ht,wt=class td{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}static getGridOptionKeys(){return this.ALL_PROPERTIES_AND_CALLBACKS}static combineAttributesAndGridOptions(e,i){typeof e!="object"&&(e={});const s=te({},e);return td.getGridOptionKeys().forEach(n=>{const o=i[n];typeof o<"u"&&o!==td.VUE_OMITTED_PROPERTY&&(s[n]=o)}),s}static processOnChange(e,i,s){if(!e)return;const r={};let n=!1;if(Object.keys(e).filter(a=>td.ALL_PROPERTIES_AND_CALLBACKS_SET.has(a)).forEach(a=>{r[a]=e[a],n=!0}),!n)return;i.__internalUpdateGridOptions(r,!0);const o={type:S.EVENT_COMPONENT_STATE_CHANGED};Tt(r,(a,l)=>{o[a]=l}),i.dispatchEvent(o)}};wt.EVENTS=qr(S);wt.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY";wt.EXCLUDED_INTERNAL_EVENTS=[S.EVENT_SCROLLBAR_WIDTH_CHANGED,S.EVENT_CHECKBOX_CHANGED,S.EVENT_HEIGHT_SCALE_CHANGED,S.EVENT_BODY_HEIGHT_CHANGED,S.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,S.EVENT_SCROLL_VISIBILITY_CHANGED,S.EVENT_COLUMN_HOVER_CHANGED,S.EVENT_FLASH_CELLS,S.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,S.EVENT_DISPLAYED_ROWS_CHANGED,S.EVENT_LEFT_PINNED_WIDTH_CHANGED,S.EVENT_RIGHT_PINNED_WIDTH_CHANGED,S.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,S.EVENT_STORE_UPDATED,S.EVENT_COLUMN_PANEL_ITEM_DRAG_START,S.EVENT_COLUMN_PANEL_ITEM_DRAG_END,S.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,S.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,S.EVENT_FULL_WIDTH_ROW_FOCUSED,S.EVENT_HEADER_HEIGHT_CHANGED,S.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,S.EVENT_CELL_FOCUS_CLEARED,S.EVENT_GRID_STYLES_CHANGED,S.EVENT_FILTER_DESTROYED,S.EVENT_ROW_DATA_UPDATE_STARTED,S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,S.EVENT_DATA_TYPES_INFERRED,S.EVENT_FIELD_VALUE_CHANGED,S.EVENT_FIELD_PICKER_VALUE_SELECTED,S.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,S.EVENT_SUPPRESS_MENU_HIDE_CHANGED,S.EVENT_SUPPRESS_FIELD_DOT_NOTATION,S.EVENT_ROW_COUNT_READY,S.EVENT_SIDE_BAR_UPDATED];wt.PUBLIC_EVENTS=wt.EVENTS.filter(t=>!fi(wt.EXCLUDED_INTERNAL_EVENTS,t));wt.EVENT_CALLBACKS=wt.EVENTS.map(t=>wt.getCallbackForEvent(t));wt.BOOLEAN_PROPERTIES=fl.BOOLEAN_PROPERTIES;wt.ALL_PROPERTIES=fl.ALL_PROPERTIES;wt.ALL_PROPERTIES_AND_CALLBACKS=[...wt.ALL_PROPERTIES,...wt.EVENT_CALLBACKS];wt.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(wt.ALL_PROPERTIES_AND_CALLBACKS);var T0=wt,tg=class extends z{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(t){t&&t.forEach(e=>this.addComponent(e))}addComponent(t){const i=t.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[i]=t.componentClass}getComponentClass(t){return this.componentsMappedByName[t]}};tg=g([Y("agStackComponentsRegistry")],tg);var b0={};St(b0,{getAriaCheckboxStateName:()=>Ph,getAriaLabel:()=>A0,getAriaLevel:()=>XM,getAriaPosInSet:()=>R0,getAriaSortState:()=>D0,removeAriaExpanded:()=>L0,removeAriaSort:()=>G0,setAriaActiveDescendant:()=>Of,setAriaAtomic:()=>x0,setAriaChecked:()=>JM,setAriaColCount:()=>O0,setAriaColIndex:()=>kf,setAriaColSpan:()=>N0,setAriaControls:()=>Gf,setAriaDescribedBy:()=>QM,setAriaDisabled:()=>Mf,setAriaExpanded:()=>zs,setAriaHidden:()=>Yl,setAriaLabel:()=>Ci,setAriaLabelledBy:()=>Do,setAriaLevel:()=>I0,setAriaLive:()=>Ff,setAriaMultiSelectable:()=>F0,setAriaPosInSet:()=>xh,setAriaRelevant:()=>P0,setAriaRole:()=>Qe,setAriaRowCount:()=>M0,setAriaRowIndex:()=>Nf,setAriaSelected:()=>Ro,setAriaSetSize:()=>Ah,setAriaSort:()=>k0});function ki(t,e,i){i==null||typeof i=="string"&&i==""?Lf(t,e):Gi(t,e,i)}function Gi(t,e,i){t.setAttribute(_0(e),i.toString())}function Lf(t,e){t.removeAttribute(_0(e))}function _0(t){return`aria-${t}`}function Qe(t,e){e?t.setAttribute("role",e):t.removeAttribute("role")}function D0(t){let e;return t==="asc"?e="ascending":t==="desc"?e="descending":t==="mixed"?e="other":e="none",e}function XM(t){return parseInt(t.getAttribute("aria-level"),10)}function R0(t){return parseInt(t.getAttribute("aria-posinset"),10)}function A0(t){return t.getAttribute("aria-label")}function Ci(t,e){ki(t,"label",e)}function Do(t,e){ki(t,"labelledby",e)}function QM(t,e){ki(t,"describedby",e)}function Ff(t,e){ki(t,"live",e)}function x0(t,e){ki(t,"atomic",e)}function P0(t,e){ki(t,"relevant",e)}function I0(t,e){ki(t,"level",e)}function Mf(t,e){ki(t,"disabled",e)}function Yl(t,e){ki(t,"hidden",e)}function Of(t,e){ki(t,"activedescendant",e)}function zs(t,e){Gi(t,"expanded",e)}function L0(t){Lf(t,"expanded")}function Ah(t,e){Gi(t,"setsize",e)}function xh(t,e){Gi(t,"posinset",e)}function F0(t,e){Gi(t,"multiselectable",e)}function M0(t,e){Gi(t,"rowcount",e)}function Nf(t,e){Gi(t,"rowindex",e)}function O0(t,e){Gi(t,"colcount",e)}function kf(t,e){Gi(t,"colindex",e)}function N0(t,e){Gi(t,"colspan",e)}function k0(t,e){Gi(t,"sort",e)}function G0(t){Lf(t,"sort")}function Ro(t,e){ki(t,"selected",e)}function JM(t,e){Gi(t,"checked",e===void 0?"mixed":e)}function Gf(t,e){ki(t,"controls",e.id),Do(e,t.id)}function Ph(t,e){return e===void 0?t("ariaIndeterminate","indeterminate"):e===!0?t("ariaChecked","checked"):t("ariaUnchecked","unchecked")}var V0={};St(V0,{browserSupportsPreventScroll:()=>Uf,getBodyHeight:()=>U0,getBodyWidth:()=>H0,getMaxDivHeight:()=>B0,getSafariVersion:()=>Vf,getScrollbarWidth:()=>W0,getTabIndex:()=>Nd,isBrowserChrome:()=>Ih,isBrowserFirefox:()=>Bf,isBrowserSafari:()=>_s,isIOSUserAgent:()=>Ks,isInvisibleScrollbar:()=>Wf,isMacOsUserAgent:()=>Hf});var Zc,$u,ep,tp,ip,sp,ig,sg;function _s(){return Zc===void 0&&(Zc=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Zc}function Vf(){if($u===void 0)if(_s()){const t=navigator.userAgent.match(/version\/(\d+)/i);t&&($u=t[1]!=null?parseFloat(t[1]):0)}else $u=0;return $u}function Ih(){if(ep===void 0){const t=window;ep=!!t.chrome&&(!!t.chrome.webstore||!!t.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return ep}function Bf(){return tp===void 0&&(tp=/(firefox)/i.test(navigator.userAgent)),tp}function Hf(){return ip===void 0&&(ip=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),ip}function Ks(){return sp===void 0&&(sp=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),sp}function Uf(){return!_s()||Vf()>=15}function Nd(t){if(!t)return null;const e=t.tabIndex,i=t.getAttribute("tabIndex");return e===-1&&(i===null||i===""&&!Bf())?null:e.toString()}function B0(){if(!document.body)return-1;let t=1e6;const e=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){const s=t*2;if(i.style.height=s+"px",s>e||i.clientHeight!==s)break;t=s}return document.body.removeChild(i),t}function H0(){var t,e,i;return(i=(t=document.body)==null?void 0:t.clientWidth)!=null?i:window.innerHeight||((e=document.documentElement)==null?void 0:e.clientWidth)||-1}function U0(){var t,e,i;return(i=(t=document.body)==null?void 0:t.clientHeight)!=null?i:window.innerHeight||((e=document.documentElement)==null?void 0:e.clientHeight)||-1}function W0(){return sg==null&&z0(),sg}function z0(){const t=document.body,e=document.createElement("div");e.style.width=e.style.height="100px",e.style.opacity="0",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",e.style.position="absolute",t.appendChild(e);let i=e.offsetWidth-e.clientWidth;i===0&&e.clientWidth===0&&(i=null),e.parentNode&&e.parentNode.removeChild(e),i!=null&&(sg=i,ig=i===0)}function Wf(){return ig==null&&z0(),ig}var $0={};St($0,{dateToFormattedString:()=>ho,parseDateTimeFromString:()=>Xt,serialiseDate:()=>Ai});var j0={};St(j0,{cleanNumber:()=>ZM,createArrayOfNumbers:()=>q0,decToHex:()=>e2,formatNumberCommas:()=>zf,formatNumberTwoDecimalPlacesAndCommas:()=>t2,padStartWidthZeros:()=>uo,sum:()=>i2});function uo(t,e){return t.toString().padStart(e,"0")}function q0(t,e){const i=[];for(let s=t;s<=e;s++)i.push(s);return i}function ZM(t){return typeof t=="string"&&(t=parseInt(t,10)),typeof t=="number"?Math.floor(t):null}function e2(t,e){let i="";for(let s=0;s<e;s++)i+=String.fromCharCode(t&255),t>>>=8;return i}function t2(t,e,i){return typeof t!="number"?"":zf(Math.round(t*100)/100,e,i)}function zf(t,e,i){return typeof t!="number"?"":t.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${e}`)}function i2(t){return t==null?null:t.reduce((e,i)=>e+i,0)}function Ai(t,e=!0,i="-"){if(!t)return null;let s=[t.getFullYear(),t.getMonth()+1,t.getDate()].map(r=>uo(r,2)).join(i);return e&&(s+=" "+[t.getHours(),t.getMinutes(),t.getSeconds()].map(r=>uo(r,2)).join(":")),s}var rp=t=>{if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function ho(t,e="YYYY-MM-DD"){const i=uo(t.getFullYear(),4),s=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${t.getFullYear()}`,MMMM:()=>s[t.getMonth()],MMM:()=>s[t.getMonth()].slice(0,3),MM:()=>uo(t.getMonth()+1,2),Mo:()=>`${t.getMonth()+1}${rp(t.getMonth()+1)}`,M:()=>`${t.getMonth()+1}`,Do:()=>`${t.getDate()}${rp(t.getDate())}`,DD:()=>uo(t.getDate(),2),D:()=>`${t.getDate()}`,dddd:()=>r[t.getDay()],ddd:()=>r[t.getDay()].slice(0,3),dd:()=>r[t.getDay()].slice(0,2),do:()=>`${t.getDay()}${rp(t.getDay())}`,d:()=>`${t.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return e.replace(o,a=>a in n?n[a]():a)}function Xt(t){if(!t)return null;const[e,i]=t.split(" ");if(!e)return null;const s=e.split("-").map(c=>parseInt(c,10));if(s.filter(c=>!isNaN(c)).length!==3)return null;const[r,n,o]=s,a=new Date(r,n-1,o);if(a.getFullYear()!==r||a.getMonth()!==n-1||a.getDate()!==o)return null;if(!i||i==="00:00:00")return a;const[l,u,d]=i.split(":").map(c=>parseInt(c,10));return l>=0&&l<24&&a.setHours(l),u>=0&&u<60&&a.setMinutes(u),d>=0&&d<60&&a.setSeconds(d),a}var K0={};St(K0,{FOCUSABLE_EXCLUDE:()=>$f,FOCUSABLE_SELECTOR:()=>Y0,addOrRemoveAttribute:()=>Ss,addStylesToElement:()=>Jf,bindCellRendererToHtmlElement:()=>em,clearElement:()=>tt,copyNodeList:()=>eT,ensureDomOrder:()=>Xf,formatSize:()=>Lh,getAbsoluteHeight:()=>qf,getAbsoluteWidth:()=>ml,getElementRectWithOffset:()=>Kf,getElementSize:()=>Sr,getInnerHeight:()=>Xl,getInnerWidth:()=>mn,getScrollLeft:()=>vl,insertWithDomOrder:()=>Q0,isElementChildOfClass:()=>Kr,isFocusableFormField:()=>jf,isHorizontalScrollShowing:()=>J0,isInDOM:()=>Yf,isNodeOrElement:()=>Ql,isRtlNegativeScroll:()=>Cl,isVerticalScrollShowing:()=>Z0,isVisible:()=>ti,iterateNamedNodeMap:()=>tT,loadTemplate:()=>Qt,nodeListForEach:()=>Zf,radioCssClass:()=>rg,removeFromParent:()=>$i,setDisabled:()=>Ao,setDisplayed:()=>ve,setDomChildOrder:()=>Qf,setElementHeight:()=>s2,setElementWidth:()=>Sl,setFixedHeight:()=>Yr,setFixedWidth:()=>xi,setScrollLeft:()=>yl,setVisible:()=>X0});var ju;function rg(t,e,i){const s=t.parentElement;let r=s&&s.firstChild;for(;r;)e&&r.classList.toggle(e,r===t),i&&r.classList.toggle(i,r!==t),r=r.nextSibling}var Y0="[tabindex], input, select, button, textarea, [href]",$f="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function jf(t){const e=Element.prototype.matches||Element.prototype.msMatchesSelector,s=e.call(t,"input, select, button, textarea"),r=e.call(t,$f),n=ti(t);return s&&!r&&n}function ve(t,e,i={}){const{skipAriaHidden:s}=i;t.classList.toggle("ag-hidden",!e),s||Yl(t,!e)}function X0(t,e,i={}){const{skipAriaHidden:s}=i;t.classList.toggle("ag-invisible",!e),s||Yl(t,!e)}function Ao(t,e){const i="disabled",s=e?r=>r.setAttribute(i,""):r=>r.removeAttribute(i);s(t),Zf(t.querySelectorAll("input"),r=>s(r))}function Kr(t,e,i){let s=0;for(;t;){if(t.classList.contains(e))return!0;if(t=t.parentElement,typeof i=="number"){if(++s>i)break}else if(t===i)break}return!1}function Sr(t){const{height:e,width:i,borderTopWidth:s,borderRightWidth:r,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:u,paddingLeft:d,marginTop:c,marginRight:C,marginBottom:E,marginLeft:y,boxSizing:_}=window.getComputedStyle(t);return{height:parseFloat(e||"0"),width:parseFloat(i||"0"),borderTopWidth:parseFloat(s||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(n||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(u||"0"),paddingLeft:parseFloat(d||"0"),marginTop:parseFloat(c||"0"),marginRight:parseFloat(C||"0"),marginBottom:parseFloat(E||"0"),marginLeft:parseFloat(y||"0"),boxSizing:_}}function Xl(t){const e=Sr(t);return e.boxSizing==="border-box"?e.height-e.paddingTop-e.paddingBottom:e.height}function mn(t){const e=Sr(t);return e.boxSizing==="border-box"?e.width-e.paddingLeft-e.paddingRight:e.width}function qf(t){const e=Sr(t),i=e.marginBottom+e.marginTop;return Math.ceil(t.offsetHeight+i)}function ml(t){const e=Sr(t),i=e.marginLeft+e.marginRight;return Math.ceil(t.offsetWidth+i)}function Kf(t){const e=t.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:s,borderRightWidth:r,borderBottomWidth:n}=Sr(t);return{top:e.top+(i||0),left:e.left+(s||0),right:e.right+(r||0),bottom:e.bottom+(n||0)}}function Cl(){if(typeof ju=="boolean")return ju;const t=document.createElement("div");return t.style.direction="rtl",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="0px",t.style.overflow="hidden",t.dir="rtl",t.innerHTML=`<div style="width: 2px">
            <span style="display: inline-block; width: 1px"></span>
            <span style="display: inline-block; width: 1px"></span>
        </div>`,document.body.appendChild(t),t.scrollLeft=1,ju=Math.floor(t.scrollLeft)===0,document.body.removeChild(t),ju}function vl(t,e){let i=t.scrollLeft;return e&&(i=Math.abs(i),Ih()&&!Cl()&&(i=t.scrollWidth-t.clientWidth-i)),i}function yl(t,e,i){i&&(Cl()?e*=-1:(_s()||Ih())&&(e=t.scrollWidth-t.clientWidth-e)),t.scrollLeft=e}function tt(t){for(;t&&t.firstChild;)t.removeChild(t.firstChild)}function $i(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Yf(t){return!!t.offsetParent}function ti(t){const e=t;return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!Yf(t)||window.getComputedStyle(t).visibility!=="visible")}function Qt(t){const e=document.createElement("div");return e.innerHTML=(t||"").trim(),e.firstChild}function Xf(t,e,i){i&&i.nextSibling===e||(i?i.nextSibling?t.insertBefore(e,i.nextSibling):t.appendChild(e):t.firstChild&&t.firstChild!==e&&t.insertAdjacentElement("afterbegin",e))}function Qf(t,e){for(let i=0;i<e.length;i++){const s=e[i],r=t.children[i];r!==s&&t.insertBefore(s,r)}}function Q0(t,e,i){i?i.insertAdjacentElement("afterend",e):t.firstChild?t.insertAdjacentElement("afterbegin",e):t.appendChild(e)}function Jf(t,e){if(e)for(const[i,s]of Object.entries(e)){if(!i||!i.length||s==null)continue;const r=E0(i),n=s.toString(),o=n.replace(/\s*!important/g,""),a=o.length!=n.length?"important":void 0;t.style.setProperty(r,o,a)}}function J0(t){return t.clientWidth<t.scrollWidth}function Z0(t){return t.clientHeight<t.scrollHeight}function Sl(t,e){e==="flex"?(t.style.removeProperty("width"),t.style.removeProperty("minWidth"),t.style.removeProperty("maxWidth"),t.style.flex="1 1 auto"):xi(t,e)}function xi(t,e){e=Lh(e),t.style.width=e.toString(),t.style.maxWidth=e.toString(),t.style.minWidth=e.toString()}function s2(t,e){e==="flex"?(t.style.removeProperty("height"),t.style.removeProperty("minHeight"),t.style.removeProperty("maxHeight"),t.style.flex="1 1 auto"):Yr(t,e)}function Yr(t,e){e=Lh(e),t.style.height=e.toString(),t.style.maxHeight=e.toString(),t.style.minHeight=e.toString()}function Lh(t){return typeof t=="number"?`${t}px`:t}function Ql(t){return t instanceof Node||t instanceof HTMLElement}function eT(t){if(t==null)return[];const e=[];return Zf(t,i=>e.push(i)),e}function tT(t,e){if(t)for(let i=0;i<t.length;i++){const s=t[i];e(s.name,s.value)}}function Ss(t,e,i){i==null?t.removeAttribute(e):t.setAttribute(e,i.toString())}function Zf(t,e){if(t!=null)for(let i=0;i<t.length;i++)e(t[i])}function em(t,e){t.then(i=>{const s=i.getGui();s!=null&&(typeof s=="object"?e.appendChild(s):e.innerHTML=s)})}var iT={};St(iT,{fuzzyCheckStrings:()=>sT,fuzzySuggestions:()=>Jl});function sT(t,e,i){const s={},r=t.filter(n=>!e.some(o=>o===n));return r.length>0&&r.forEach(n=>s[n]=Jl(n,i).values),s}function Jl(t,e,i,s){let r=e.map((a,l)=>({value:a,relevance:r2(t.toLowerCase(),a.toLocaleLowerCase()),idx:l}));if(r.sort((a,l)=>l.relevance-a.relevance),i&&(r=r.filter(a=>a.relevance!==0)),r.length>0&&s&&s>0){const l=r[0].relevance*s;r=r.filter(u=>l-u.relevance<0)}const n=[],o=[];for(const a of r)n.push(a.value),o.push(a.idx);return{values:n,indices:o}}function r2(t,e){const i=t.replace(/\s/g,""),s=e.replace(/\s/g,"");let r=0,n=-1;for(let o=0;o<i.length;o++){const a=s.indexOf(i[o],n+1);a!==-1&&(n=a,r+=100-n*100/1e4*100)}return r}var rT={};St(rT,{createIcon:()=>wi,createIconNoSpan:()=>je,iconNameClassMap:()=>nT});var nT={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus"};function wi(t,e,i){const s=je(t,e,i);if(s){const{className:n}=s;if(typeof n=="string"&&n.indexOf("ag-icon")>-1||typeof n=="object"&&n["ag-icon"])return s}const r=document.createElement("span");return r.appendChild(s),r}function je(t,e,i,s){let r=null;const n=i&&i.getColDef().icons;if(n&&(r=n[t]),e&&!r){const o=e.get("icons");o&&(r=o[t])}if(r){let o;if(typeof r=="function")o=r();else if(typeof r=="string")o=r;else throw new Error("icon from grid options needs to be a string or a function");if(typeof o=="string")return Qt(o);if(Ql(o))return o;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}else{const o=document.createElement("span");let a=nT[t];return a||(s?a=t:(console.warn(`AG Grid: Did not find icon ${t}`),a="")),o.setAttribute("class",`ag-icon ag-icon-${a}`),o.setAttribute("unselectable","on"),Qe(o,"presentation"),o}}var oT={};St(oT,{isDeleteKey:()=>uT,isEventFromPrintableCharacter:()=>Fh,isUserSuppressingHeaderKeyboardEvent:()=>aT,isUserSuppressingKeyboardEvent:()=>kd,normaliseQwertyAzerty:()=>lT});var N=class{};N.BACKSPACE="Backspace";N.TAB="Tab";N.ENTER="Enter";N.ESCAPE="Escape";N.SPACE=" ";N.LEFT="ArrowLeft";N.UP="ArrowUp";N.RIGHT="ArrowRight";N.DOWN="ArrowDown";N.DELETE="Delete";N.F2="F2";N.PAGE_UP="PageUp";N.PAGE_DOWN="PageDown";N.PAGE_HOME="Home";N.PAGE_END="End";N.A="KeyA";N.C="KeyC";N.D="KeyD";N.V="KeyV";N.X="KeyX";N.Y="KeyY";N.Z="KeyZ";var n2=65,o2=67,a2=86,l2=68,u2=90,d2=89;function Fh(t){return t.altKey||t.ctrlKey||t.metaKey?!1:t.key.length===1}function kd(t,e,i,s,r){const n=s?s.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=t.addGridCommonParams({event:e,editing:r,column:s,node:i,data:i.data,colDef:s.getColDef()});return!!(n&&n(o))}function aT(t,e,i,s){const r=s.getDefinition(),n=r&&r.suppressHeaderKeyboardEvent;if(!U(n))return!1;const o=t.addGridCommonParams({colDef:r,column:s,headerRowIndex:i,event:e});return!!n(o)}function lT(t){const{keyCode:e}=t;let i;switch(e){case n2:i=N.A;break;case o2:i=N.C;break;case a2:i=N.V;break;case l2:i=N.D;break;case u2:i=N.Z;break;case d2:i=N.Y;break;default:i=t.code}return i}function uT(t,e=!1){return t===N.DELETE?!0:!e&&t===N.BACKSPACE?Hf():!1}var dT={};St(dT,{areEventsNear:()=>tm});function tm(t,e,i){if(i===0)return!1;const s=Math.abs(t.clientX-e.clientX),r=Math.abs(t.clientY-e.clientY);return Math.max(s,r)<=i}var hT={};St(hT,{sortRowNodesByOrder:()=>h2});function h2(t,e){if(!t)return!1;const i=(o,a)=>{const l=e[o.id],u=e[a.id],d=l!==void 0,c=u!==void 0,C=d&&c,E=!d&&!c;return C?l-u:E?o.__objectId-a.__objectId:d?1:-1};let s,r,n=!1;for(let o=0;o<t.length-1;o++)if(s=t[o],r=t[o+1],i(s,r)>0){n=!0;break}return n?(t.sort(i),!0):!1}var cT={};St(cT,{convertToSet:()=>im});function im(t){const e=new Set;return t.forEach(i=>e.add(i)),e}var c2=te(te(te(te(te(te(te(te(te(te(te(te(te(te(te(te(te(te({},b0),a0),V0),$0),K0),o0),Jw),iT),Yw),rT),oT),w0),dT),j0),Xw),hT),cT),y0),ge=c2,xo=class{constructor(t=0,e=1){this.nextValue=t,this.step=e}next(){const t=this.nextValue;return this.nextValue+=this.step,t}peek(){return this.nextValue}skip(t){this.nextValue+=t}},Pi=class id{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e(i=>this.onDone(i),i=>this.onReject(i))}static all(e){return new id(i=>{let s=e.length;const r=new Array(s);e.forEach((n,o)=>{n.then(a=>{r[o]=a,s--,s===0&&i(r)})})})}static resolve(e=null){return new id(i=>i(e))}then(e){return new id(i=>{this.status===1?i(e(this.resolution)):this.waiters.push(s=>i(e(s)))})}resolveNow(e,i){return this.status===1?i(this.resolution):e}onDone(e){this.status=1,this.resolution=e,this.waiters.forEach(i=>i(e))}onReject(e){console.warn("TBI")}},p2=class{constructor(t){this.cssClassStates={},this.getGui=t}addCssClass(t){const e=(t||"").split(" ");if(e.length>1){e.forEach(s=>this.addCssClass(s));return}if(this.cssClassStates[t]!==!0&&t.length){const s=this.getGui();s&&s.classList.add(t),this.cssClassStates[t]=!0}}removeCssClass(t){const e=(t||"").split(" ");if(e.length>1){e.forEach(s=>this.removeCssClass(s));return}if(this.cssClassStates[t]!==!1&&t.length){const s=this.getGui();s&&s.classList.remove(t),this.cssClassStates[t]=!1}}containsCssClass(t){const e=this.getGui();return e?e.classList.contains(t):!1}addOrRemoveCssClass(t,e){if(!t)return;if(t.indexOf(" ")>=0){const s=(t||"").split(" ");if(s.length>1){s.forEach(r=>this.addOrRemoveCssClass(r,e));return}}if(this.cssClassStates[t]!==e&&t.length){const s=this.getGui();s&&s.classList.toggle(t,e),this.cssClassStates[t]=e}}},Zl=class kr extends z{constructor(e,i,s,r){super(),this.parentComp=e,this.tooltipShowDelayOverride=i,this.tooltipHideDelayOverride=s,this.shouldDisplayTooltip=r,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.INTERACTIVE_HIDE_DELAY=100,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.parentComp.getGui();this.tooltipTrigger===0&&(this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===1&&(this.addManagedListener(e,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(e,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this)))}getGridOptionsTooltipDelay(e){const i=this.gos.get(e);return i<0&&ie(`${e} should not be lower than 0`),Math.max(200,i)}getTooltipDelay(e){var i,s;return e==="show"?(i=this.tooltipShowDelayOverride)!=null?i:this.getGridOptionsTooltipDelay("tooltipShowDelay"):(s=this.tooltipHideDelayOverride)!=null?s:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!Ks()&&(kr.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var i;const s=e.relatedTarget,r=this.parentComp.getGui(),n=(i=this.tooltipComp)==null?void 0:i.getGui();this.isInteractingWithTooltip||r.contains(s)||this.interactionEnabled&&(n!=null&&n.contains(s))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||kr.isLocked)return;let i=0;e&&(i=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),i),this.state=1}isLastTooltipHiddenRecently(){const e=new Date().getTime(),i=kr.lastTooltipHideTime;return e-i<this.SHOW_QUICK_TOOLTIP_DIFF}setToDoNothing(){this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=te({},this.parentComp.getTooltipParams());if(!U(e.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip()){this.setToDoNothing();return}this.state=2,this.tooltipInstanceCount++;const i=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(i)}hideTooltip(e){if(!e&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),kr.lastTooltipHideTime=new Date().getTime());const i={type:S.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(i),this.state=0}newTooltipComponentCallback(e,i){if(this.state!==2||this.tooltipInstanceCount!==e){this.getContext().destroyBean(i);return}const r=i.getGui();this.tooltipComp=i,r.classList.contains("ag-tooltip")||r.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&r.classList.add("ag-tooltip-animate"),this.interactionEnabled&&r.classList.add("ag-tooltip-interactive");const n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:r,ariaLabel:n("ariaLabelTooltip","Tooltip")});o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,S.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===0?(this.tooltipMouseEnterListener=this.addManagedListener(r,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(r,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(r,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(r,"focusout",this.onTooltipFocusOut.bind(this))||null));const a={type:S.EVENT_TOOLTIP_SHOW,tooltipGui:r,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(a),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(e){var i;const s=this.parentComp.getGui(),r=(i=this.tooltipComp)==null?void 0:i.getGui(),n=e.relatedTarget;r!=null&&r.contains(n)||(this.isInteractingWithTooltip=!1,s.contains(n)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(He(te({},e),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(He(te({},e),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,i=this.tooltipComp,s=this.tooltipTrigger===0?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout(()=>{e(),this.getContext().destroyBean(i)},s),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(e=>{e&&e()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){kr.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},this.INTERACTIVE_HIDE_DELAY)}unlockService(){kr.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};Zl.isLocked=!1;g([T("popupService")],Zl.prototype,"popupService",2);g([T("userComponentFactory")],Zl.prototype,"userComponentFactory",2);g([$],Zl.prototype,"postConstruct",1);var g2=Zl,Ys=class extends z{constructor(t,e){super(),this.ctrl=t,e&&(this.beans=e)}postConstruct(){this.refreshToolTip()}setBrowserTooltip(t){const e="title",i=this.ctrl.getGui();i&&(t!=null&&t!=""?i.setAttribute(e,t):i.removeAttribute(e))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var t,e,i,s;if(this.tooltipManager!=null)return;const r={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new g2(r,(e=(t=this.ctrl).getTooltipShowDelayOverride)==null?void 0:e.call(t),(s=(i=this.ctrl).getTooltipHideDelayOverride)==null?void 0:s.call(i),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const t=this.ctrl,e=t.getColumn?t.getColumn():void 0,i=t.getColDef?t.getColDef():void 0,s=t.getRowNode?t.getRowNode():void 0;return{location:t.getLocation(),colDef:i,column:e,rowIndex:t.getRowIndex?t.getRowIndex():void 0,node:s,data:s?s.data:void 0,value:this.getTooltipText(),valueFormatted:t.getValueFormatted?t.getValueFormatted():void 0,hideTooltipCallback:()=>{var r;return(r=this.tooltipManager)==null?void 0:r.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}};g([T("beans")],Ys.prototype,"beans",2);g([$],Ys.prototype,"postConstruct",1);var f2=new xo,eu=class ng extends z{constructor(e){super(),this.displayed=!0,this.visible=!0,this.compId=f2.next(),this.cssClassManager=new p2(()=>this.eGui),e&&this.setTemplate(e)}preConstructOnComponent(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const{newTooltipText:i,showDelayOverride:s,hideDelayOverride:r,location:n,shouldDisplayTooltip:o}=e||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==i&&(this.tooltipText=i);const a=()=>this.tooltipText;i!=null&&(this.tooltipFeature=this.createBean(new Ys({getTooltipValue:a,getGui:()=>this.getGui(),getLocation:()=>n??"UNKNOWN",getColDef:e==null?void 0:e.getColDef,getColumn:e==null?void 0:e.getColumn,getTooltipShowDelayOverride:s!=null?()=>s:void 0,getTooltipHideDelayOverride:r!=null?()=>r:void 0,shouldDisplayTooltip:o})))}createChildComponentsFromTags(e,i){eT(e.childNodes).forEach(r=>{if(!(r instanceof HTMLElement))return;const n=this.createComponentFromElement(r,o=>{o.getGui()&&this.copyAttributesFromNode(r,o.getGui())},i);if(n){if(n.addItems&&r.children.length){this.createChildComponentsFromTags(r,i);const o=Array.prototype.slice.call(r.children);n.addItems(o)}this.swapComponentForNode(n,e,r)}else r.childNodes&&this.createChildComponentsFromTags(r,i)})}createComponentFromElement(e,i,s){const r=e.nodeName,n=s?s[e.getAttribute("ref")]:void 0,o=this.agStackComponentsRegistry.getComponentClass(r);if(o){ng.elementGettingCreated=e;const a=new o(n);return a.setParentComponent(this),this.createBean(a,null,i),a}return null}copyAttributesFromNode(e,i){tT(e.attributes,(s,r)=>i.setAttribute(s,r))}swapComponentForNode(e,i,s){const r=e.getGui();i.replaceChild(r,s),i.insertBefore(document.createComment(s.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,s)}swapInComponentForQuerySelectors(e,i){const s=this;this.iterateOverQuerySelectors(r=>{s[r.attributeName]===i&&(s[r.attributeName]=e)})}iterateOverQuerySelectors(e){let i=Object.getPrototypeOf(this);for(;i!=null;){const s=i.__agComponentMetaData,r=Th(i.constructor);s&&s[r]&&s[r].querySelectors&&s[r].querySelectors.forEach(n=>e(n)),i=Object.getPrototypeOf(i)}}activateTabIndex(e){const i=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach(s=>s.setAttribute("tabindex",i.toString()))}setTemplate(e,i){const s=Qt(e);this.setTemplateFromElement(s,i)}setTemplateFromElement(e,i){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),i)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const e=this;this.iterateOverQuerySelectors(i=>{const s=n=>e[i.attributeName]=n;if(i.refSelector&&this.getAttribute("ref")===i.refSelector)s(this.eGui);else{const n=this.eGui.querySelector(i.querySelector);n&&s(n.__agComponent||n)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}queryForHtmlInputElement(e){return this.eGui.querySelector(e)}appendChild(e,i){if(e!=null)if(i||(i=this.eGui),Ql(e))i.appendChild(e);else{const s=e;i.appendChild(s.getGui())}}isDisplayed(){return this.displayed}setVisible(e,i={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:s}=i;X0(this.eGui,e,{skipAriaHidden:s})}}setDisplayed(e,i={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:s}=i;ve(this.eGui,e,{skipAriaHidden:s});const r={type:ng.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(r)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),super.destroy()}addGuiEventListener(e,i,s){this.eGui.addEventListener(e,i,s),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,i))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,i){this.cssClassManager.addOrRemoveCssClass(e,i)}getAttribute(e){const{eGui:i}=this;return i?i.getAttribute(e):null}getRefElement(e){return this.queryForHtmlElement(`[ref="${e}"]`)}};eu.EVENT_DISPLAYED_CHANGED="displayedChanged";g([T("agStackComponentsRegistry")],eu.prototype,"agStackComponentsRegistry",2);g([i0],eu.prototype,"preConstructOnComponent",1);g([i0],eu.prototype,"createChildComponentsPreConstruct",1);var oe=eu;function q(t){return m2.bind(this,`[ref=${t}]`,t)}function m2(t,e,i,s,r){if(t===null){console.error("AG Grid: QuerySelector selector should not be null");return}if(typeof r=="number"){console.error("AG Grid: QuerySelector should be on an attribute");return}C2(i,"querySelectors",{attributeName:s,querySelector:t,refSelector:e})}function C2(t,e,i){const s=v2(t,Th(t.constructor));s[e]||(s[e]=[]),s[e].push(i)}function v2(t,e){return t.__agComponentMetaData||(t.__agComponentMetaData={}),t.__agComponentMetaData[e]||(t.__agComponentMetaData[e]={}),t.__agComponentMetaData[e]}var sm=class extends oe{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(t){this.params=t;const e=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${e} ${i("ariaFilterInput","Filter Input")}`)}onParentModelChanged(t){if(t==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(e=>{if(e.getModelAsString){const i=e.getModelAsString(t);this.eFloatingFilterText.setValue(i)}})}onParamsUpdated(t){this.refresh(t)}refresh(t){this.init(t)}};g([q("eFloatingFilterText")],sm.prototype,"eFloatingFilterText",2);g([T("columnModel")],sm.prototype,"columnModel",2);var pT=class{constructor(t,e,i,s,r){this.alive=!0,this.context=t,this.eParent=s,e.getDateCompDetails(i).newAgStackInstance().then(a=>{if(!this.alive){t.destroyBean(a);return}this.dateComp=a,a&&(s.appendChild(a.getGui()),a.afterGuiAttached&&a.afterGuiAttached(),this.tempValue&&a.setDate(this.tempValue),this.disabled!=null&&this.setDateCompDisabled(this.disabled),r==null||r(this))})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(t){this.dateComp?this.dateComp.setDate(t):this.tempValue=t}setDisabled(t){this.dateComp?this.setDateCompDisabled(t):this.disabled=t}setDisplayed(t){ve(this.eParent,t)}setInputPlaceholder(t){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(t)}setInputAriaLabel(t){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(t)}afterGuiAttached(t){this.dateComp&&typeof this.dateComp.afterGuiAttached=="function"&&this.dateComp.afterGuiAttached(t)}updateParams(t){var e,i;let s=!1;(e=this.dateComp)!=null&&e.refresh&&typeof this.dateComp.refresh=="function"&&this.dateComp.refresh(t)!==null&&(s=!0),!s&&((i=this.dateComp)!=null&&i.onParamsUpdated)&&typeof this.dateComp.onParamsUpdated=="function"&&this.dateComp.onParamsUpdated(t)!==null&&ie("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(t){this.dateComp!=null&&this.dateComp.setDisabled!=null&&this.dateComp.setDisabled(t)}},gT=class{constructor(){this.customFilterOptions={}}init(t,e){this.filterOptions=t.filterOptions||e,this.mapCustomOptions(),this.selectDefaultItem(t)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(t=>{if(typeof t=="string")return;const e=[["displayKey"],["displayName"],["predicate","test"]],i=s=>s.some(r=>t[r]!=null)?!0:(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${s}'`),!1);if(!e.every(i)){this.filterOptions=this.filterOptions.filter(s=>s===t)||[];return}this.customFilterOptions[t.displayKey]=t})}selectDefaultItem(t){if(t.defaultOption)this.defaultOption=t.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];typeof e=="string"?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(t){return this.customFilterOptions[t]}},fT={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Mh=class mT extends z{constructor(e,i={}){super(),this.eFocusableElement=e,this.callbacks=i,this.callbacks=te({shouldStopEventPropagation:()=>!1,onTabKeyDown:s=>{if(s.defaultPrevented)return;const r=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,s.shiftKey);r&&(r.focus(),s.preventDefault())}},i)}postConstruct(){this.eFocusableElement.classList.add(mT.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(e){this.addManagedListener(e,"keydown",i=>{if(!(i.defaultPrevented||Yi(i))){if(this.callbacks.shouldStopEventPropagation(i)){Ji(i);return}i.key===N.TAB?this.callbacks.onTabKeyDown(i):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(i)}})}};Mh.FOCUS_MANAGED_CLASS="ag-focus-managed";g([T("focusService")],Mh.prototype,"focusService",2);g([$],Mh.prototype,"postConstruct",1);var Er=Mh,CT="ag-resizer-wrapper",y2=`<div class="${CT}">
        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>
        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>
        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>
        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>
        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>
        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>
        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>
        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>
    </div>`,qo=class extends z{constructor(t,e){super(),this.element=t,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},e)}center(){const{clientHeight:t,clientWidth:e}=this.offsetParent,i=e/2-this.getWidth()/2,s=t/2-this.getHeight()/2;this.offsetElement(i,s)}initialisePosition(){if(this.positioned)return;const{centered:t,forcePopupParentAsOffsetParent:e,minWidth:i,width:s,minHeight:r,height:n,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,u=0;const d=ti(this.element);if(d){const c=this.findBoundaryElement(),C=window.getComputedStyle(c);if(C.minWidth!=null){const E=c.offsetWidth-this.element.offsetWidth;u=parseInt(C.minWidth,10)-E}if(C.minHeight!=null){const E=c.offsetHeight-this.element.offsetHeight;l=parseInt(C.minHeight,10)-E}}if(this.minHeight=r||l,this.minWidth=i||u,s&&this.setWidth(s),n&&this.setHeight(n),(!s||!n)&&this.refreshSize(),t)this.center();else if(o||a)this.offsetElement(o,a);else if(d&&e){let c=this.boundaryEl,C=!0;if(c||(c=this.findBoundaryElement(),C=!1),c){const E=parseFloat(c.style.top),y=parseFloat(c.style.left);C?this.offsetElement(isNaN(y)?0:y,isNaN(E)?0:E):this.setPosition(y,E)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(t,e){if(!this.config.popup||t===this.movable)return;this.movable=t;const i=this.moveElementDragListener||{eElement:e,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};t?(this.dragService.addDragSource(i),this.moveElementDragListener=i):(this.dragService.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(t){if(this.clearResizeListeners(),t?this.addResizers():this.removeResizers(),typeof t=="boolean"){if(t===!1)return;t={topLeft:t,top:t,topRight:t,right:t,bottomRight:t,bottom:t,bottomLeft:t,left:t}}Object.keys(t).forEach(e=>{const s=!!t[e],r=this.getResizerElement(e),n={dragStartPixels:0,eElement:r,onDragStart:o=>this.onResizeStart(o,e),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,e)};(s||!this.isAlive()&&!s)&&(s?(this.dragService.addDragSource(n),this.resizeListeners.push(n),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[e]=s)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:t,width:e}=this.lastSize;e!==-1&&(this.element.style.width=`${e}px`),t!==-1&&(this.element.style.height=`${t}px`)}getHeight(){return this.element.offsetHeight}setHeight(t){const{popup:e}=this.config,i=this.element;let s=!1;if(typeof t=="string"&&t.indexOf("%")!==-1)Yr(i,t),t=qf(i),s=!0;else if(t=Math.max(this.minHeight,t),this.positioned){const r=this.getAvailableHeight();r&&t>r&&(t=r)}this.getHeight()!==t&&(s?(i.style.maxHeight="unset",i.style.minHeight="unset"):e?Yr(i,t):(i.style.height=`${t}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof t=="number"?t:parseFloat(t)))}getAvailableHeight(){const{popup:t,forcePopupParentAsOffsetParent:e}=this.config;this.positioned||this.initialisePosition();const{clientHeight:i}=this.offsetParent;if(!i)return null;const s=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),n=t?this.position.y:s.top,o=t?0:r.top;let a=0;if(e){const u=this.element.parentElement;if(u){const{bottom:d}=u.getBoundingClientRect();a=d-s.bottom}}return i+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(t){const e=this.element,{popup:i}=this.config;let s=!1;if(typeof t=="string"&&t.indexOf("%")!==-1)xi(e,t),t=ml(e),s=!0;else if(this.positioned){t=Math.max(this.minWidth,t);const{clientWidth:r}=this.offsetParent,n=i?this.position.x:this.element.getBoundingClientRect().left;r&&t+n>r&&(t=r-n)}this.getWidth()!==t&&(s?(e.style.maxWidth="unset",e.style.minWidth="unset"):this.config.popup?xi(e,t):(e.style.width=`${t}px`,e.style.flex=" unset",this.lastSize.width=typeof t=="number"?t:parseFloat(t)))}offsetElement(t=0,e=0){const{forcePopupParentAsOffsetParent:i}=this.config,s=i?this.boundaryEl:this.element;s&&(this.popupService.positionPopup({ePopup:s,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:t,y:e})}),this.setPosition(parseFloat(s.style.left),parseFloat(s.style.top)))}constrainSizeToAvailableHeight(t){if(!this.config.forcePopupParentAsOffsetParent)return;const e=()=>{const i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};t?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),e):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(t,e){this.position.x=t,this.position.y=e}updateDragStartPosition(t,e){this.dragStartPosition={x:t,y:e}}calculateMouseMovement(t){const{e,isLeft:i,isTop:s,anywhereWithin:r,topBuffer:n}=t,o=e.clientX-this.dragStartPosition.x,a=e.clientY-this.dragStartPosition.y,l=this.shouldSkipX(e,!!i,!!r,o)?0:o,u=this.shouldSkipY(e,!!s,n,a)?0:a;return{movementX:l,movementY:u}}shouldSkipX(t,e,i,s){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&n.left>=t.clientX||n.right<=t.clientX&&n.right<=o.right;return l?!0:(e?l=s<0&&t.clientX>a+n.left||s>0&&t.clientX<a+n.left:i?l=s<0&&t.clientX>o.right||s>0&&t.clientX<a+n.left:l=s<0&&t.clientX>o.right||s>0&&t.clientX<o.right,l)}shouldSkipY(t,e,i=0,s){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&n.top>=t.clientY||n.bottom<=t.clientY&&n.bottom<=o.bottom;return l?!0:(e?l=s<0&&t.clientY>a+n.top+i||s>0&&t.clientY<a+n.top:l=s<0&&t.clientY>o.bottom||s>0&&t.clientY<o.bottom,l)}createResizeMap(){const t=this.element;this.resizerMap={topLeft:{element:t.querySelector("[ref=eTopLeftResizer]")},top:{element:t.querySelector("[ref=eTopResizer]")},topRight:{element:t.querySelector("[ref=eTopRightResizer]")},right:{element:t.querySelector("[ref=eRightResizer]")},bottomRight:{element:t.querySelector("[ref=eBottomRightResizer]")},bottom:{element:t.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:t.querySelector("[ref=eBottomLeftResizer]")},left:{element:t.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const t=this.element;if(!t)return;const i=new DOMParser().parseFromString(y2,"text/html").body;t.appendChild(i.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const t=this.element.querySelector(`.${CT}`);t&&this.element.removeChild(t),this.resizersAdded=!1}getResizerElement(t){return this.resizerMap[t].element}onResizeStart(t,e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!e.match(/top/i),isRight:!!e.match(/right/i),isBottom:!!e.match(/bottom/i),isLeft:!!e.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[e].element.classList.add("ag-active");const{popup:i,forcePopupParentAsOffsetParent:s}=this.config;!i&&!s&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(t.clientX,t.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const t=this.getSiblings()||[];let e=0,i=0;for(let s=0;s<t.length;s++){const r=t[s],n=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(n){const l=window.getComputedStyle(r);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;e+=o,i+=a}return{height:e,width:i}}applySizeToSiblings(t){let e=null;const i=this.getSiblings();if(i){for(let s=0;s<i.length;s++){const r=i[s];r!==e&&(t?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(e=i[s+1]))}e&&(e.style.removeProperty("height"),e.style.removeProperty("min-height"),e.style.removeProperty("max-height"),e.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(t=>t)}onResize(t){if(!this.isResizing||!this.currentResizer)return;const{popup:e,forcePopupParentAsOffsetParent:i}=this.config,{isTop:s,isRight:r,isBottom:n,isLeft:o}=this.currentResizer,a=r||o,l=n||s,{movementX:u,movementY:d}=this.calculateMouseMovement({e:t,isLeft:o,isTop:s}),c=this.position.x,C=this.position.y;let E=0,y=0;if(a&&u){const _=o?-1:1,b=this.getWidth(),R=b+u*_;let D=!1;o&&(E=b-R,(c+E<=0||R<=this.minWidth)&&(D=!0,E=0)),D||this.setWidth(R)}if(l&&d){const _=s?-1:1,b=this.getHeight(),R=b+d*_;let D=!1;s?(y=b-R,(C+y<=0||R<=this.minHeight)&&(D=!0,y=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&b<R&&this.getMinSizeOfSiblings().height+R>this.element.parentElement.offsetHeight&&(D=!0),D||this.setHeight(R)}this.updateDragStartPosition(t.clientX,t.clientY),((e||i)&&E||y)&&this.offsetElement(c+E,C+y)}onResizeEnd(t,e){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const i={type:"resize"};this.element.classList.remove("ag-resizing"),this.resizerMap[e].element.classList.remove("ag-active"),this.dispatchEvent(i)}refreshSize(){const t=this.element;this.config.popup&&(this.config.width||this.setWidth(t.offsetWidth),this.config.height||this.setHeight(t.offsetHeight))}onMoveStart(t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(t.clientX,t.clientY)}onMove(t){if(!this.isMoving)return;const{x:e,y:i}=this.position;let s;this.config.calculateTopBuffer&&(s=this.config.calculateTopBuffer());const{movementX:r,movementY:n}=this.calculateMouseMovement({e:t,isTop:!0,anywhereWithin:!0,topBuffer:s});this.offsetElement(e+r,i+n),this.updateDragStartPosition(t.clientX,t.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let t=this.element;for(;t;){if(window.getComputedStyle(t).position!=="static")return t;t=t.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const t=this.resizeListeners.pop();this.dragService.removeDragSource(t)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}};g([T("popupService")],qo.prototype,"popupService",2);g([T("resizeObserverService")],qo.prototype,"resizeObserverService",2);g([T("dragService")],qo.prototype,"dragService",2);var Oh=class Ga extends oe{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.buttonListeners=[]}postConstruct(){this.resetTemplate(),this.createManagedBean(new Er(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new qo(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let i=this.getGui();i&&i.removeEventListener("submit",this.onFormSubmit);const s=`
            <form class="ag-filter-wrapper">
                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">
                    ${this.createBodyTemplate()}
                </div>
            </form>`;this.setTemplate(s,e),i=this.getGui(),i&&i.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Ga.isUseApplyButton(e),this.resetButtonsPanel()}updateParams(e){this.providedFilterParams=e,this.applyActive=Ga.isUseApplyButton(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons:e}=this.providedFilterParams,i=e&&e.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(tt(this.eButtonsPanel),this.buttonListeners.forEach(n=>n==null?void 0:n()),this.buttonListeners=[]):i&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!i){this.eButtonsPanel&&$i(this.eButtonsPanel);return}const s=document.createDocumentFragment(),r=n=>{let o,a;switch(n){case"apply":o=this.translate("applyFilter"),a=d=>this.onBtApply(!1,!1,d);break;case"clear":o=this.translate("clearFilter"),a=()=>this.onBtClear();break;case"reset":o=this.translate("resetFilter"),a=()=>this.onBtReset();break;case"cancel":o=this.translate("cancelFilter"),a=d=>{this.onBtCancel(d)};break;default:console.warn("AG Grid: Unknown button type specified");return}const u=Qt(`<button
                    type="${n==="apply"?"submit":"button"}"
                    ref="${n}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${o}
                </button>`);this.buttonListeners.push(this.addManagedListener(u,"click",a)),s.append(u)};im(e).forEach(n=>r(n)),this.eButtonsPanel.append(s),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Ga.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),i=Ot(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,i()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(e!=null?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,i){const s=()=>{this.onUiChanged(!1,"prevent"),i==null||i()};e!=null?this.setModelIntoUi(e).then(s):this.resetUiToDefaults().then(s)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(e="api"){const i=this.getModelFromUi();if(!this.isModelValid(i))return!1;const s=this.appliedModel;return this.appliedModel=i,!this.areModelsEqual(s,i)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(e=!1,i=!1,s){s&&s.preventDefault(),this.applyModel(i?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:i,source:"columnFilter"});const{closeOnApply:r}=this.providedFilterParams;r&&this.applyActive&&!e&&!i&&this.close(s)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const i=e,s=i&&i.key;let r;(s==="Enter"||s==="Space")&&(r={keyboardEvent:i}),this.hidePopup(r),this.hidePopup=null}onUiChanged(e=!1,i){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const s=this.isModelValid(this.getModelFromUi()),r=this.getRefElement("applyFilterButton");r&&Ao(r,!s)}e&&!i||i==="immediately"?this.onBtApply(e):(!this.applyActive&&!i||i==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e==null?void 0:e.container)}refreshFilterResizer(e){if(!this.positionableFeature||e==="toolPanel")return;const i=e==="floatingFilter"||e==="columnFilter",{positionableFeature:s,gos:r}=this;i?(s.restoreLastSize(),s.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(e,i){return Ga.isUseApplyButton(e)?(e.debounceMs!=null&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):e.debounceMs!=null?e.debounceMs:i}static isUseApplyButton(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}refresh(e){return this.providedFilterParams=e,!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,fT[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}};g([T("rowModel")],Oh.prototype,"rowModel",2);g([q("eFilterBody")],Oh.prototype,"eFilterBody",2);g([$],Oh.prototype,"postConstruct",1);var Gd=Oh,rm=class extends oe{constructor(t,e){super(e),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=t||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:t,label:e,labelWidth:i,labelAlignment:s,disabled:r}=this.config;r!=null&&this.setDisabled(r),t!=null&&this.setLabelSeparator(t),e!=null&&this.setLabel(e),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(s||this.labelAlignment),this.refreshLabel()}refreshLabel(){tt(this.eLabel),typeof this.label=="string"?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),this.label===""?(ve(this.eLabel,!1),Qe(this.eLabel,"presentation")):(ve(this.eLabel,!0),Qe(this.eLabel,null))}setLabelSeparator(t){return this.labelSeparator===t?this:(this.labelSeparator=t,this.label!=null&&this.refreshLabel(),this)}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(t){return this.label===t?this:(this.label=t,this.refreshLabel(),this)}setLabelAlignment(t){const i=this.getGui().classList;return i.toggle("ag-label-align-left",t==="left"),i.toggle("ag-label-align-right",t==="right"),i.toggle("ag-label-align-top",t==="top"),this}setLabelEllipsis(t){return this.eLabel.classList.toggle("ag-label-ellipsis",t),this}setLabelWidth(t){return this.label==null?this:(Sl(this.eLabel,t),this)}setDisabled(t){t=!!t;const e=this.getGui();return Ao(e,t),e.classList.toggle("ag-disabled",t),this.disabled=t,this}isDisabled(){return!!this.disabled}};g([$],rm.prototype,"postConstruct",1);var vT=class extends rm{constructor(t,e,i){super(t,e),this.className=i}postConstruct(){super.postConstruct();const{width:t,value:e,onValueChange:i}=this.config;t!=null&&this.setWidth(t),e!=null&&this.setValue(e),i!=null&&this.onValueChange(i),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}refreshAriaLabelledBy(){const t=this.getAriaElement(),e=this.getLabelId();A0(t)!==null?Do(t,""):Do(t,e??"")}setAriaLabel(t){return Ci(this.getAriaElement(),t),this.refreshAriaLabelledBy(),this}onValueChange(t){return this.addManagedListener(this,S.EVENT_FIELD_VALUE_CHANGED,()=>t(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(t){return xi(this.getGui(),t),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(t,e){return this.value===t?this:(this.previousValue=this.value,this.value=t,e||this.dispatchEvent({type:S.EVENT_FIELD_VALUE_CHANGED}),this)}},S2=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,Cn=class extends vT{constructor(t){if(super(t,(t==null?void 0:t.template)||S2,t==null?void 0:t.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.ariaRole=t==null?void 0:t.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!t)return;const{pickerGap:e,maxPickerHeight:i,variableWidth:s,minPickerWidth:r,maxPickerWidth:n}=t;e!=null&&(this.pickerGap=e),this.variableWidth=!!s,i!=null&&this.setPickerMaxHeight(i),r!=null&&this.setPickerMinWidth(r),n!=null&&this.setPickerMaxWidth(n)}postConstruct(){super.postConstruct(),this.setupAria();const t=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",t);const e=this.getAriaElement();this.addManagedListener(e,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"mousedown",this.onLabelOrWrapperMouseDown.bind(this)),this.addManagedListener(this.eWrapper,"mousedown",this.onLabelOrWrapperMouseDown.bind(this));const{pickerIcon:i,inputWidth:s}=this.config;if(i){const r=je(i,this.gos);r&&this.eIcon.appendChild(r)}s!=null&&this.setInputWidth(s)}setupAria(){const t=this.getAriaElement();t.setAttribute("tabindex",this.gos.get("tabIndex").toString()),zs(t,!1),this.ariaRole&&Qe(t,this.ariaRole)}onLabelOrWrapperMouseDown(t){if(t){const e=this.getFocusableElement();if(e!==this.eWrapper&&(t==null?void 0:t.target)===e)return;t.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(t){switch(t.key){case N.UP:case N.DOWN:case N.ENTER:case N.SPACE:t.preventDefault(),this.onLabelOrWrapperMouseDown();break;case N.ESCAPE:this.isPickerDisplayed&&(t.preventDefault(),t.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const t=this.pickerComponent.getGui();t.addEventListener("focusin",this.onPickerFocusIn),t.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const t=this.gos.getDocument(),e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL,()=>{this.hidePicker()}));const i=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:s,pickerAriaLabelValue:r,modalPicker:n=!0}=this.config,o={modal:n,eChild:e,closeOnEsc:!0,closedCallback:()=>{const E=this.gos.getActiveDomElement(),y=!E||E===t.body;this.beforeHidePicker(),y&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:i(s,r)},a=this.popupService.addPopup(o),{maxPickerHeight:l,minPickerWidth:u,maxPickerWidth:d,variableWidth:c}=this;c?(u&&(e.style.minWidth=u),e.style.width=Lh(ml(this.eWrapper)),d&&(e.style.maxWidth=d)):Sl(e,d??ml(this.eWrapper));const C=l??`${Xl(this.popupService.getPopupParent())}px`;return e.style.setProperty("max-height",C),e.style.position="absolute",this.alignPickerToComponent(),a.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:t}=this.config,{pickerGap:e}=this,i=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:t,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:i,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const t=this.pickerComponent.getGui();t.removeEventListener("focusin",this.onPickerFocusIn),t.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(t){if(!this.isAlive())return;const e=this.getAriaElement();zs(e,t),this.eWrapper.classList.toggle("ag-picker-expanded",t),this.eWrapper.classList.toggle("ag-picker-collapsed",!t)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(t){var e;(e=this.pickerComponent)!=null&&e.getGui().contains(t.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(t){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",t)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(t){return Sl(this.eWrapper,t),this}getFocusableElement(){return this.eWrapper}setPickerGap(t){return this.pickerGap=t,this}setPickerMinWidth(t){return typeof t=="number"&&(t=`${t}px`),this.minPickerWidth=t??void 0,this}setPickerMaxWidth(t){return typeof t=="number"&&(t=`${t}px`),this.maxPickerWidth=t??void 0,this}setPickerMaxHeight(t){return typeof t=="number"&&(t=`${t}px`),this.maxPickerHeight=t??void 0,this}destroy(){this.hidePicker(),super.destroy()}};g([T("popupService")],Cn.prototype,"popupService",2);g([q("eLabel")],Cn.prototype,"eLabel",2);g([q("eWrapper")],Cn.prototype,"eWrapper",2);g([q("eDisplayField")],Cn.prototype,"eDisplayField",2);g([q("eIcon")],Cn.prototype,"eIcon",2);var Nh=class sd extends oe{constructor(e="default",i=!1){super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.unFocusable=i,this.options=[],this.itemEls=[]}init(){const e=this.getGui();this.addManagedListener(e,"mouseleave",()=>this.clearHighlighted()),!this.unFocusable&&this.addManagedListener(e,"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){const i=e.key;switch(i){case N.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const s=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(s)}break;case N.DOWN:case N.UP:e.preventDefault(),this.navigate(i);break;case N.PAGE_DOWN:case N.PAGE_UP:case N.PAGE_HOME:case N.PAGE_END:e.preventDefault(),this.navigateToPage(i);break}}navigate(e){const i=e===N.DOWN;let s;if(!this.highlightedEl)s=this.itemEls[i?0:this.itemEls.length-1];else{let n=this.itemEls.indexOf(this.highlightedEl)+(i?1:-1);n=Math.min(Math.max(n,0),this.itemEls.length-1),s=this.itemEls[n]}this.highlightItem(s)}navigateToPage(e){if(!this.highlightedEl||this.itemEls.length===0)return;const i=this.itemEls.indexOf(this.highlightedEl),s=this.options.length-1,r=this.itemEls[0].clientHeight,n=Math.floor(this.getGui().clientHeight/r);let o=-1;e===N.PAGE_HOME?o=0:e===N.PAGE_END?o=s:e===N.PAGE_DOWN?o=Math.min(i+n,s):e===N.PAGE_UP&&(o=Math.max(i-n,0)),o!==-1&&this.highlightItem(this.itemEls[o])}addOptions(e){return e.forEach(i=>this.addOption(i)),this}addOption(e){const{value:i,text:s}=e,r=s||i;return this.options.push({value:i,text:r}),this.renderOption(i,r),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{$i(e)}),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((i,s)=>{xh(i,s+1),Ah(i,e.length)})}renderOption(e,i){const s=this.gos.getDocument(),r=s.createElement("div");Qe(r,"option"),r.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const n=s.createElement("span");r.appendChild(n),n.textContent=i,this.unFocusable||(r.tabIndex=-1),this.itemEls.push(r),this.addManagedListener(r,"mousemove",()=>this.highlightItem(r)),this.addManagedListener(r,"mousedown",o=>{o.preventDefault(),this.setValue(e)}),this.createManagedBean(new Ys({getTooltipValue:()=>i,getGui:()=>r,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>n.scrollWidth>n.clientWidth})),this.getGui().appendChild(r)}setValue(e,i){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(i),this;const s=this.options.findIndex(r=>r.value===e);if(s!==-1){const r=this.options[s];this.value=r.value,this.displayValue=r.text,this.highlightItem(this.itemEls[s]),i||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(i=>i.value===this.value);e!==-1&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!ti(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(sd.ACTIVE_CLASS),Ro(this.highlightedEl,!0);const i=this.getGui(),{scrollTop:s,clientHeight:r}=i,{offsetTop:n,offsetHeight:o}=e;(n+o>s+r||n<s)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!ti(this.highlightedEl)||(this.highlightedEl.classList.remove(sd.ACTIVE_CLASS),Ro(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:S.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:sd.EVENT_ITEM_SELECTED})}};Nh.EVENT_ITEM_SELECTED="selectedItem";Nh.ACTIVE_CLASS="ag-active-item";g([$],Nh.prototype,"init",1);var oy=Nh,yT=class ST extends Cn{constructor(e){super(te({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},e))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:i,placeholder:s}=this.config;e!=null&&this.addOptions(e),i!=null&&this.setValue(i,!0),s&&i==null&&(this.eDisplayField.textContent=s),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new oy("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),i=`ag-select-list-${this.listComponent.getCompId()}`;e.setAttribute("id",i),Gf(this.getAriaElement(),e),this.listComponent.addManagedListener(this.listComponent,oy.EVENT_ITEM_SELECTED,()=>{this.hidePicker(),this.dispatchEvent({type:ST.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,S.EVENT_FIELD_VALUE_CHANGED,()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())})}createPickerComponent(){return this.listComponent}onKeyDown(e){var i;const{key:s}=e;switch(s===N.TAB&&this.hidePicker(),s){case N.ENTER:case N.UP:case N.DOWN:case N.PAGE_UP:case N.PAGE_DOWN:case N.PAGE_HOME:case N.PAGE_END:e.preventDefault(),this.isPickerDisplayed?(i=this.listComponent)==null||i.handleKeyDown(e):super.onKeyDown(e);break;case N.ESCAPE:super.onKeyDown(e);break}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach(i=>this.addOption(i)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){var e;return(e=this.listComponent)==null||e.clearOptions(),this}setValue(e,i,s){if(this.value===e||!this.listComponent)return this;if(s||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue())return this;let n=this.listComponent.getDisplayValue();return n==null&&this.config.placeholder&&(n=this.config.placeholder),this.eDisplayField.textContent=n,this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,i)}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),super.destroy()}};yT.EVENT_ITEM_SELECTED="selectedItem";var kh=yT,ji=class extends vT{constructor(t,e,i="text",s="input"){super(t,`
            <div role="presentation">
                <div ref="eLabel" class="ag-input-field-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">
                    <${s} ref="eInput" class="ag-input-field-input"></${s}>
                </div>
            </div>`,e),this.inputType=i,this.displayFieldTag=s}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:t,inputWidth:e}=this.config;t!=null&&this.setInputName(t),e!=null&&this.setInputWidth(e),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedListener(this.eInput,"input",t=>this.setValue(t.target.value))}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(t){return Sl(this.eWrapper,t),this}setInputName(t){return this.getInputElement().setAttribute("name",t),this}getFocusableElement(){return this.eInput}setMaxLength(t){const e=this.eInput;return e.maxLength=t,this}setInputPlaceholder(t){return Ss(this.eInput,"placeholder",t),this}setInputAriaLabel(t){return Ci(this.eInput,t),this.refreshAriaLabelledBy(),this}setDisabled(t){return Ao(this.eInput,t),super.setDisabled(t)}setAutoComplete(t){if(t===!0)Ss(this.eInput,"autocomplete",null);else{const e=typeof t=="string"?t:"off";Ss(this.eInput,"autocomplete",e)}return this}};g([q("eLabel")],ji.prototype,"eLabel",2);g([q("eWrapper")],ji.prototype,"eWrapper",2);g([q("eInput")],ji.prototype,"eInput",2);var Gh=class extends ji{constructor(t,e="ag-checkbox",i="checkbox"){super(t,e,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:t,passive:e}=this.config;typeof t=="boolean"&&this.setReadOnly(t),typeof e=="boolean"&&this.setPassive(e)}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(t){this.passive=t}isReadOnly(){return this.readOnly}setReadOnly(t){this.eWrapper.classList.toggle("ag-disabled",t),this.eInput.disabled=t,this.readOnly=t}setDisabled(t){return this.eWrapper.classList.toggle("ag-disabled",t),super.setDisabled(t)}toggle(){if(this.eInput.disabled)return;const t=this.isSelected(),e=this.getNextValue();this.passive?this.dispatchChange(e,t):this.setValue(e)}getValue(){return this.isSelected()}setValue(t,e){return this.refreshSelectedClass(t),this.setSelected(t,e),this}setName(t){const e=this.getInputElement();return e.name=t,this}isSelected(){return this.selected}setSelected(t,e){this.isSelected()!==t&&(this.previousValue=this.isSelected(),t=this.selected=typeof t=="boolean"?t:void 0,this.eInput.checked=t,this.eInput.indeterminate=t===void 0,e||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(t,e,i){this.dispatchEvent({type:S.EVENT_FIELD_VALUE_CHANGED,selected:t,previousValue:e,event:i});const s=this.getInputElement(),r={type:S.EVENT_CHECKBOX_CHANGED,id:s.id,name:s.name,selected:t,previousValue:e};this.eventService.dispatchEvent(r)}onCheckboxClick(t){if(this.passive||this.eInput.disabled)return;const e=this.isSelected(),i=this.selected=t.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,e,t)}refreshSelectedClass(t){this.eWrapper.classList.toggle("ag-checked",t===!0),this.eWrapper.classList.toggle("ag-indeterminate",t==null)}},ET=class extends Gh{constructor(t){super(t,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,S.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(t){t.selected&&t.name&&this.eInput.name&&this.eInput.name===t.name&&t.id&&this.eInput.id!==t.id&&this.setValue(!1,!0)}},nm=class{constructor(t,e,i){this.localeService=t,this.optionsFactory=e,this.valueFormatter=i}getModelAsString(t){if(!t)return null;const e=t.operator!=null,i=this.localeService.getLocaleTextFunc();if(e){const s=t;let{conditions:r}=s;if(!r){const{condition1:a,condition2:l}=s;r=[a,l]}const n=r.map(a=>this.getModelAsString(a)),o=s.operator==="AND"?"andCondition":"orCondition";return n.join(` ${i(o,fT[o])} `)}else{if(t.type===Ye.BLANK||t.type===Ye.NOT_BLANK)return i(t.type,t.type);{const s=t,r=this.optionsFactory.getCustomOption(s.type),{displayKey:n,displayName:o,numberOfInputs:a}=r||{};return n&&o&&a===0?(i(n,o),o):this.conditionToString(s,r)}}}updateParams(t){this.optionsFactory=t.optionsFactory}formatValue(t){var e;return this.valueFormatter?(e=this.valueFormatter(t??null))!=null?e:"":String(t)}},Bt=class Wn extends Gd{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const i=this.optionsFactory.getCustomOption(e);if(i){const{numberOfInputs:r}=i;return r??1}const s=[Wn.EMPTY,Wn.NOT_BLANK,Wn.BLANK];return e&&s.indexOf(e)>=0?0:e===Wn.IN_RANGE?2:1}onFloatingFilterChanged(e,i){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(i),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((i,s)=>{s===0?i.setValue(e,!0):i.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return this.eJoinOperatorsOr.length===0?this.defaultJoinOperator:this.eJoinOperatorsOr[0].getValue()===!0?"OR":"AND"}areModelsEqual(e,i){if(!e&&!i)return!0;if(!e&&i||e&&!i)return!1;const s=!e.operator,r=!i.operator;if(!s&&r||s&&!r)return!1;let o;if(s){const a=e,l=i;o=this.areSimpleModelsEqual(a,l)}else{const a=e,l=i;o=a.operator===l.operator&&fs(a.conditions,l.conditions,(u,d)=>this.areSimpleModelsEqual(u,d))}return o}shouldRefresh(e){var i,s,r;const n=this.getModel(),o=n?(i=n.conditions)!=null?i:[n]:null,a=(r=(s=e.filterOptions)==null?void 0:s.map(u=>typeof u=="string"?u:u.displayKey))!=null?r:this.getDefaultFilterOptions();return!(!(!o||o.every(u=>a.find(d=>d===u.type)!==void 0))||typeof e.maxNumConditions=="number"&&o&&o.length>e.maxNumConditions)}refresh(e){return!this.shouldRefresh(e)||!super.refresh(e)?!1:(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){let s=e;s.conditions||(s.conditions=[s.condition1,s.condition2]);const r=this.validateAndUpdateConditions(s.conditions),n=this.getNumConditions();if(r<n)this.removeConditionsAndOperators(r);else if(r>n)for(let a=n;a<r;a++)this.createJoinOperatorPanel(),this.createOption();const o=s.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),s.conditions.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Pi.resolve()}validateAndUpdateConditions(e){let i=e.length;return i>this.maxNumConditions&&(e.splice(this.maxNumConditions),ie('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),i=this.maxNumConditions),i}doesFilterPass(e){var i;const s=this.getModel();if(s==null)return!0;const{operator:r}=s,n=[];if(r){const a=s;n.push(...(i=a.conditions)!=null?i:[])}else n.push(s);return n[r&&r==="OR"?"some":"every"](a=>this.individualConditionPasses(e,a))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new gT,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){var i,s;e.suppressAndOrCondition!=null&&ie('Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),e.alwaysShowBothConditions!=null&&ie('Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),this.maxNumConditions=(i=e.maxNumConditions)!=null?i:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(ie('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=(s=e.numAlwaysVisibleConditions)!=null?s:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(ie('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(ie('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new kh);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const i=this.createValueElement();this.eConditionBodies.push(i),this.eFilterBody.appendChild(i),this.putOptionsIntoDropdown(e),this.resetType(e);const s=this.getNumConditions()-1;this.forEachPositionInput(s,r=>this.resetInput(r)),this.addChangedListeners(e,s)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const i=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),s=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const r=this.eJoinOperatorPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(i,r,n),this.resetJoinOperatorOr(s,r,n),this.isReadOnly()||(i.onValueChange(this.listener),s.onValueChange(this.listener))}createJoinOperator(e,i,s){const r=this.createManagedBean(new ET);return e.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass(`ag-filter-condition-operator-${s}`),i.appendChild(r.getGui()),r}getDefaultJoinOperator(e){return e==="AND"||e==="OR"?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(i=>typeof i=="string"?this.createBoilerplateListOption(i):this.createCustomListOption(i))}putOptionsIntoDropdown(e){this.filterListOptions.forEach(i=>{e.addOption(i)}),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:i}=e,s=this.optionsFactory.getCustomOption(e.displayKey);return{value:i,text:s?this.localeService.getLocaleTextFunc()(s.displayKey,s.displayName):this.translate(i)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){var e;let i=-1,s=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?i=r:s=!1;if(this.shouldAddNewConditionAtEnd(s))this.createJoinOperatorPanel(),this.createOption();else{const r=(e=this.lastUiCompletePosition)!=null?e:this.getNumConditions()-2;if(i<r){this.removeConditionsAndOperators(r+1);const n=i+1,o=r-n;o>0&&this.removeConditionsAndOperators(n,o),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=i}updateConditionStatusesAndValues(e,i){this.eTypes.forEach((r,n)=>{const o=this.isConditionDisabled(n,e);r.setDisabled(o||this.filterListOptions.length<=1),n===1&&(Ao(this.eJoinOperatorPanels[0],o),this.eJoinOperatorsAnd[0].setDisabled(o),this.eJoinOperatorsOr[0].setDisabled(o))}),this.eConditionBodies.forEach((r,n)=>{ve(r,this.isConditionBodyVisible(n))});const s=(i??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach((r,n)=>{r.setValue(!s,!0)}),this.eJoinOperatorsOr.forEach((r,n)=>{r.setValue(s,!0)}),this.forEachInput((r,n,o,a)=>{this.setElementDisplayed(r,n<a),this.setElementDisabled(r,this.isConditionDisabled(o,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,i){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,i),this.removeElements(this.eConditionBodies,e,i),this.removeValueElements(e,i);const s=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,s,i),this.removeComponents(this.eJoinOperatorsAnd,s,i),this.removeComponents(this.eJoinOperatorsOr,s,i)}removeElements(e,i,s){this.removeItems(e,i,s).forEach(n=>$i(n))}removeComponents(e,i,s){this.removeItems(e,i,s).forEach(n=>{$i(n.getGui()),this.destroyBean(n)})}removeItems(e,i,s){return s==null?e.splice(i):e.splice(i,s)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!(e!=null&&e.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const i=this.getInputs(0)[0];if(!i)return;i instanceof ji&&i.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let i=-1,s=-1,r=!1;const n=this.getJoinOperator();for(let a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))i===-1&&(i=a,s=a);else{const l=a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1),u=a<i;(l||u)&&(this.removeConditionsAndOperators(a,1),r=!0,u&&s--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(s===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(s,n),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=s}getPlaceholderText(e,i){let s=this.translate(e);if(bh(this.filterPlaceholder)){const r=this.filterPlaceholder,n=this.eTypes[i].getValue(),o=this.translate(n);s=r({filterOptionKey:n,filterOption:o,placeholder:s})}else typeof this.filterPlaceholder=="string"&&(s=this.filterPlaceholder);return s}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput((i,s,r,n)=>{if(!(i instanceof ji))return;const o=s===0&&n>1?"inRangeStart":s===0?"filterOoo":"inRangeEnd",a=s===0&&n>1?e("ariaFilterFromValue","Filter from value"):s===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");i.setInputPlaceholder(this.getPlaceholderText(o,r)),i.setInputAriaLabel(a)})}setElementValue(e,i,s){e instanceof ji&&e.setValue(i!=null?String(i):null,!0)}setElementDisplayed(e,i){e instanceof oe&&ve(e.getGui(),i)}setElementDisabled(e,i){e instanceof oe&&Ao(e.getGui(),i)}attachElementOnChange(e,i){e instanceof ji&&e.onValueChange(i)}forEachInput(e){this.getConditionTypes().forEach((i,s)=>{this.forEachPositionTypeInput(s,i,e)})}forEachPositionInput(e,i){const s=this.getConditionType(e);this.forEachPositionTypeInput(e,s,i)}forEachPositionTypeInput(e,i,s){const r=this.getNumberOfInputs(i),n=this.getInputs(e);for(let o=0;o<n.length;o++){const a=n[o];a!=null&&s(a,o,e,r)}}isConditionDisabled(e,i){return this.isReadOnly()?!0:e===0?!1:e>i+1}isConditionBodyVisible(e){const i=this.getConditionType(e);return this.getNumberOfInputs(i)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)===Wn.EMPTY||this.getValues(e).some(s=>s==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)&&e.push(this.createCondition(i));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(i=>this.resetType(i)),this.eJoinOperatorsAnd.forEach((i,s)=>this.resetJoinOperatorAnd(i,s,this.joinOperatorId+s)),this.eJoinOperatorsOr.forEach((i,s)=>this.resetJoinOperatorOr(i,s,this.joinOperatorId+s)),this.joinOperatorId++,this.forEachInput(i=>this.resetInput(i)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Pi.resolve()}resetType(e){const s=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(s).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,i,s){this.resetJoinOperator(e,i,this.isDefaultOperator("AND"),this.translate("andCondition"),s)}resetJoinOperatorOr(e,i,s){this.resetJoinOperator(e,i,this.isDefaultOperator("OR"),this.translate("orCondition"),s)}resetJoinOperator(e,i,s,r,n){this.updateJoinOperatorDisabled(e.setValue(s,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${n}`).setLabel(r),i)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,i)=>this.updateJoinOperatorDisabled(e,i)),this.eJoinOperatorsOr.forEach((e,i)=>this.updateJoinOperatorDisabled(e,i))}updateJoinOperatorDisabled(e,i){e.setDisabled(this.isReadOnly()||i>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,i){const s=this.mapValuesFromModel(e);this.forEachInput((r,n,o,a)=>{o===i&&this.setElementValue(r,s[n]!=null?s[n]:null)})}setValueFromFloatingFilter(e){this.forEachInput((i,s,r,n)=>{this.setElementValue(i,s===0&&r===0?e:null,!0)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,i){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(i,s=>{this.attachElementOnChange(s,this.listener)}))}individualConditionPasses(e,i){const s=this.getCellValue(e.node),r=this.mapValuesFromModel(i),n=this.optionsFactory.getCustomOption(i.type),o=this.evaluateCustomFilter(n,r,s);return o??(s==null?this.evaluateNullValue(i.type):this.evaluateNonNullValue(r,s,i,e))}evaluateCustomFilter(e,i,s){if(e==null)return;const{predicate:r}=e;if(r!=null&&!i.some(n=>n==null))return r(i,s)}isBlank(e){return e==null||typeof e=="string"&&e.trim().length===0}hasInvalidInputs(){return!1}};Bt.EMPTY="empty";Bt.BLANK="blank";Bt.NOT_BLANK="notBlank";Bt.EQUALS="equals";Bt.NOT_EQUAL="notEqual";Bt.LESS_THAN="lessThan";Bt.LESS_THAN_OR_EQUAL="lessThanOrEqual";Bt.GREATER_THAN="greaterThan";Bt.GREATER_THAN_OR_EQUAL="greaterThanOrEqual";Bt.IN_RANGE="inRange";Bt.CONTAINS="contains";Bt.NOT_CONTAINS="notContains";Bt.STARTS_WITH="startsWith";Bt.ENDS_WITH="endsWith";var Ye=Bt,ut=class pt extends Ye{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case pt.EQUALS:case pt.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case pt.GREATER_THAN:case pt.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case pt.LESS_THAN:case pt.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case pt.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case pt.BLANK:return!0;case pt.NOT_BLANK:return!1}return!1}evaluateNonNullValue(e,i,s){const r=this.comparator(),n=e[0]!=null?r(e[0],i):0;switch(s.type){case pt.EQUALS:return n===0;case pt.NOT_EQUAL:return n!==0;case pt.GREATER_THAN:return n>0;case pt.GREATER_THAN_OR_EQUAL:return n>=0;case pt.LESS_THAN:return n<0;case pt.LESS_THAN_OR_EQUAL:return n<=0;case pt.IN_RANGE:{const o=r(e[1],i);return this.scalarFilterParams.inRangeInclusive?n>=0&&o<=0:n>0&&o<0}case pt.BLANK:return this.isBlank(i);case pt.NOT_BLANK:return!this.isBlank(i);default:return console.warn('AG Grid: Unexpected type of filter "'+s.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},ay=1e3,ly=1/0,wT=class extends nm{constructor(t,e,i){super(e,i),this.dateFilterParams=t}conditionToString(t,e){const{type:i}=t,{numberOfInputs:s}=e||{},r=i==Ye.IN_RANGE||s===2,n=Xt(t.dateFrom),o=Xt(t.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){const l=n!==null?ho(n,a):"null",u=o!==null?ho(o,a):"null";return`${l}-${u}`}return n!=null?ho(n,a):`${i}`}updateParams(t){super.updateParams(t),this.dateFilterParams=t.dateFilterParams}},om=class TT extends ut{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=ay,this.maxValidYear=ly,this.minValidDate=null,this.maxValidDate=null}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:i,dateTo:s,type:r}=e||{};return[i&&Xt(i)||null,s&&Xt(s)||null].slice(0,this.getNumberOfInputs(r))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,i){const s=i;return i==null||s<e?-1:s>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const i=(s,r)=>{if(e[s]!=null)if(isNaN(e[s]))console.warn(`AG Grid: DateFilter ${s} is not a number`);else return e[s]==null?r:Number(e[s]);return r};this.minValidYear=i("minValidYear",ay),this.maxValidYear=i("maxValidYear",ly),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),e.minValidDate?this.minValidDate=e.minValidDate instanceof Date?e.minValidDate:Xt(e.minValidDate):this.minValidDate=null,e.maxValidDate?this.maxValidDate=e.maxValidDate instanceof Date?e.maxValidDate:Xt(e.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&console.warn("AG Grid: DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new wT(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const i=new pT(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>i.destroy()),i}setElementValue(e,i){e.setDate(i)}setElementDisplayed(e,i){e.setDisplayed(i)}setElementDisabled(e,i){e.setDisabled(i)}getDefaultFilterOptions(){return TT.DEFAULT_FILTER_OPTIONS}createValueElement(){const i=this.gos.getDocument().createElement("div");return i.classList.add("ag-filter-body"),this.createFromToElement(i,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(i,this.eConditionPanelsTo,this.dateConditionToComps,"to"),i}createFromToElement(e,i,s,r){const o=this.gos.getDocument().createElement("div");o.classList.add(`ag-filter-${r}`),o.classList.add(`ag-filter-date-${r}`),i.push(o),e.appendChild(o),s.push(this.createDateCompWrapper(o))}removeValueElements(e,i){this.removeDateComps(this.dateConditionFromComps,e,i),this.removeDateComps(this.dateConditionToComps,e,i),this.removeItems(this.eConditionPanelsFrom,e,i),this.removeItems(this.eConditionPanelsTo,e,i)}removeDateComps(e,i,s){this.removeItems(e,i,s).forEach(n=>n.destroy())}isValidDateValue(e){if(e===null)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let i=!0;return this.forEachInput((s,r,n,o)=>{n!==e||!i||r>=o||(i=i&&this.isValidDateValue(s.getDate()))}),i}areSimpleModelsEqual(e,i){return e.dateFrom===i.dateFrom&&e.dateTo===i.dateTo&&e.type===i.type}getFilterType(){return"date"}createCondition(e){const i=this.getConditionType(e),s={},r=this.getValues(e);return r.length>0&&(s.dateFrom=Ai(r[0])),r.length>1&&(s.dateTo=Ai(r[1])),te({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:i},s)}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),i=this.translate("dateFormatOoo"),s=e("ariaFilterValue","Filter Value");this.forEachInput(r=>{r.setInputPlaceholder(i),r.setInputAriaLabel(s)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const i=[];return this.forEachPositionInput(e,(s,r,n,o)=>{r<o&&i.push(s.getDate())}),i}translate(e){return e===ut.LESS_THAN?super.translate("before"):e===ut.GREATER_THAN?super.translate("after"):super.translate(e)}getModelAsString(e){var i;return(i=this.filterModelFormatter.getModelAsString(e))!=null?i:""}};om.DEFAULT_FILTER_OPTIONS=[ut.EQUALS,ut.NOT_EQUAL,ut.LESS_THAN,ut.GREATER_THAN,ut.IN_RANGE,ut.BLANK,ut.NOT_BLANK];g([T("userComponentFactory")],om.prototype,"userComponentFactory",2);var bT=om,am=class extends oe{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(t){return t&&t.afterFloatingFilter}isEventFromDataChange(t){return t==null?void 0:t.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(t){if(!t){this.lastType=this.optionsFactory.getDefaultOption();return}const e=t.operator;let i;e?i=t.conditions[0]:i=t,this.lastType=i.type}canWeEditAfterModelFromParentFilter(t){if(!t)return this.isTypeEditable(this.lastType);if(t.operator)return!1;const i=t;return this.isTypeEditable(i.type)}init(t){this.setSimpleParams(t,!1)}setSimpleParams(t,e=!0){this.optionsFactory=new gT,this.optionsFactory.init(t.filterParams,this.getDefaultFilterOptions()),e||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!t.filterParams.readOnly;const i=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(i)}onParamsUpdated(t){this.refresh(t)}refresh(t){this.setSimpleParams(t)}doesFilterHaveSingleInput(t){const e=this.optionsFactory.getCustomOption(t),{numberOfInputs:i}=e||{};return i==null||i==1}isTypeEditable(t){const e=[Ye.IN_RANGE,Ye.EMPTY,Ye.BLANK,Ye.NOT_BLANK];return!!t&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(t)&&e.indexOf(t)<0}getAriaLabel(t){const e=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),i=this.localeService.getLocaleTextFunc();return`${e} ${i("ariaFilterInput","Filter Input")}`}};g([T("columnModel")],am.prototype,"columnModel",2);var Vh=class extends am{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>
                <div ref="eDateWrapper" style="display: flex;"></div>
            </div>`)}getDefaultFilterOptions(){return bT.DEFAULT_FILTER_OPTIONS}init(t){super.init(t),this.params=t,this.filterParams=t.filterParams,this.createDateComponent(),this.filterModelFormatter=new wT(this.filterParams,this.localeService,this.optionsFactory);const e=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(e("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(t){this.refresh(t)}refresh(t){super.refresh(t),this.params=t,this.filterParams=t.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(t.currentParentModel())}updateCompOnModelChange(t){const e=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(t);if(this.setEditable(e),e){if(t){const i=t;this.dateComp.setDate(Xt(i.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(t)),this.dateComp.setDate(null)}setEditable(t){ve(this.eDateWrapper,t),ve(this.eReadOnlyText.getGui(),!t)}onParentModelChanged(t,e){this.isEventFromFloatingFilter(e)||this.isEventFromDataChange(e)||(super.setLastTypeFromModel(t),this.updateCompOnModelChange(t))}onDateChanged(){const t=this.dateComp.getDate(),e=Ai(t);this.params.parentFilterInstance(i=>{if(i){const s=Xt(e);i.onFloatingFilterChanged(this.getLastType()||null,s)}})}getDateComponentParams(){const t=Gd.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:Ot(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new pT(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,t=>{t.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const t=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(t)}getFilterModelFormatter(){return this.filterModelFormatter}};g([T("userComponentFactory")],Vh.prototype,"userComponentFactory",2);g([q("eReadOnlyText")],Vh.prototype,"eReadOnlyText",2);g([q("eDateWrapper")],Vh.prototype,"eDateWrapper",2);var _T=class extends oe{constructor(){super(`
            <div class="ag-filter-filter">
                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(t){this.params=t,this.setParams(t);const e=this.eDateInput.getInputElement();this.addManagedListener(e,"mousedown",()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||e.focus()}),this.addManagedListener(e,"input",i=>{i.target===this.gos.getActiveDomElement()&&(this.eDateInput.isDisabled()||this.params.onDateChanged())})}setParams(t){const e=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(t);this.usingSafariDatePicker=i&&_s(),e.type=i?"date":"text";const{minValidYear:s,maxValidYear:r,minValidDate:n,maxValidDate:o}=t.filterParams||{};if(n&&s&&ie("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&r&&ie("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),n&&o){const[a,l]=[n,o].map(u=>u instanceof Date?u:Xt(u));a&&l&&a.getTime()>l.getTime()&&ie("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}n?n instanceof Date?e.min=ho(n):e.min=n:s&&(e.min=`${s}-01-01`),o?o instanceof Date?e.max=ho(o):e.max=o:r&&(e.max=`${r}-12-31`)}onParamsUpdated(t){this.refresh(t)}refresh(t){this.params=t,this.setParams(t)}getDate(){return Xt(this.eDateInput.getValue())}setDate(t){this.eDateInput.setValue(Ai(t,!1))}setInputPlaceholder(t){this.eDateInput.setInputPlaceholder(t)}setInputAriaLabel(t){this.eDateInput.setAriaLabel(t)}setDisabled(t){this.eDateInput.setDisabled(t)}afterGuiAttached(t){(!t||!t.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(t){return t.filterParams&&t.filterParams.browserDatePicker!=null?t.filterParams.browserDatePicker:Ih()||Bf()||_s()&&Vf()>=14.1}};g([q("eDateInput")],_T.prototype,"eDateInput",2);var vn=class extends ji{constructor(t,e="ag-text-field",i="text"){super(t,e,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(t,e){return this.eInput.value!==t&&(this.eInput.value=U(t)?t:""),super.setValue(t,e)}setStartValue(t){this.setValue(t,!0)}preventDisallowedCharacters(){const t=new RegExp(`[${this.config.allowedCharPattern}]`),e=i=>{Fh(i)&&i.key&&!t.test(i.key)&&i.preventDefault()};this.addManagedListener(this.eInput,"keydown",e),this.addManagedListener(this.eInput,"paste",i=>{var s;const r=(s=i.clipboardData)==null?void 0:s.getData("text");r&&r.split("").some(n=>!t.test(n))&&i.preventDefault()})}},lm=class extends vn{constructor(t){super(t,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const r=parseFloat(this.eInput.value),n=isNaN(r)?"":this.normalizeValue(r.toString());this.value!==n&&this.setValue(n)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any";const{precision:t,min:e,max:i,step:s}=this.config;typeof t=="number"&&this.setPrecision(t),typeof e=="number"&&this.setMin(e),typeof i=="number"&&this.setMax(i),typeof s=="number"&&this.setStep(s)}onWheel(t){this.gos.getActiveDomElement()===this.eInput&&t.preventDefault()}normalizeValue(t){if(t==="")return"";this.precision!=null&&(t=this.adjustPrecision(t));const e=parseFloat(t);return this.min!=null&&e<this.min?t=this.min.toString():this.max!=null&&e>this.max&&(t=this.max.toString()),t}adjustPrecision(t,e){if(this.precision==null)return t;if(e){const s=parseFloat(t).toFixed(this.precision);return parseFloat(s).toString()}const i=String(t).split(".");if(i.length>1){if(i[1].length<=this.precision)return t;if(this.precision>0)return`${i[0]}.${i[1].slice(0,this.precision)}`}return i[0]}setMin(t){return this.min===t?this:(this.min=t,Ss(this.eInput,"min",t),this)}setMax(t){return this.max===t?this:(this.max=t,Ss(this.eInput,"max",t),this)}setPrecision(t){return this.precision=t,this}setStep(t){return this.step===t?this:(this.step=t,Ss(this.eInput,"step",t),this)}setValue(t,e){return this.setValueOrInputValue(i=>super.setValue(i,e),()=>this,t)}setStartValue(t){return this.setValueOrInputValue(e=>super.setValue(e,!0),e=>{this.eInput.value=e},t)}setValueOrInputValue(t,e,i){if(U(i)){let s=this.isScientificNotation(i);if(s&&this.eInput.validity.valid)return t(i);if(!s){i=this.adjustPrecision(i);const r=this.normalizeValue(i);s=i!=r}if(s)return e(i)}return t(i)}getValue(){if(!this.eInput.validity.valid)return;const t=this.eInput.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(t){return typeof t=="string"&&t.includes("e")}},DT=class extends nm{conditionToString(t,e){const{numberOfInputs:i}=e||{};return t.type==Ye.IN_RANGE||i===2?`${this.formatValue(t.filter)}-${this.formatValue(t.filterTo)}`:t.filter!=null?this.formatValue(t.filter):`${t.type}`}};function og(t){const{allowedCharPattern:e}=t??{};return e??null}var RT=class AT extends ut{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern!==e.allowedCharPattern?!1:super.refresh(e)}mapValuesFromModel(e){const{filter:i,filterTo:s,type:r}=e||{};return[this.processValue(i),this.processValue(s)].slice(0,this.getNumberOfInputs(r))}getDefaultDebounceMs(){return 500}comparator(){return(e,i)=>e===i?0:e<i?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new DT(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return AT.DEFAULT_FILTER_OPTIONS}setElementValue(e,i,s){const r=!s&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(i??null):i;super.setElementValue(e,r)}createValueElement(){const e=og(this.numberFilterParams),i=document.createElement("div");return i.classList.add("ag-filter-body"),Qe(i,"presentation"),this.createFromToElement(i,this.eValuesFrom,"from",e),this.createFromToElement(i,this.eValuesTo,"to",e),i}createFromToElement(e,i,s,r){const n=this.createManagedBean(r?new vn({allowedCharPattern:r}):new lm);n.addCssClass(`ag-filter-${s}`),n.addCssClass("ag-filter-filter"),i.push(n),e.appendChild(n.getGui())}removeValueElements(e,i){this.removeComponents(this.eValuesFrom,e,i),this.removeComponents(this.eValuesTo,e,i)}getValues(e){const i=[];return this.forEachPositionInput(e,(s,r,n,o)=>{r<o&&i.push(this.processValue(this.stringToFloat(s.getValue())))}),i}areSimpleModelsEqual(e,i){return e.filter===i.filter&&e.filterTo===i.filterTo&&e.type===i.type}getFilterType(){return"number"}processValue(e){return e==null||isNaN(e)?null:e}stringToFloat(e){if(typeof e=="number")return e;let i=ys(e);return i!=null&&i.trim()===""&&(i=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(i):i==null||i.trim()==="-"?null:parseFloat(i)}createCondition(e){const i=this.getConditionType(e),s={filterType:this.getFilterType(),type:i},r=this.getValues(e);return r.length>0&&(s.filter=r[0]),r.length>1&&(s.filterTo=r[1]),s}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){var i;return(i=this.filterModelFormatter.getModelAsString(e))!=null?i:""}hasInvalidInputs(){let e=!1;return this.forEachInput(i=>{if(!i.getInputElement().validity.valid){e=!0;return}}),e}};RT.DEFAULT_FILTER_OPTIONS=[ut.EQUALS,ut.NOT_EQUAL,ut.GREATER_THAN,ut.GREATER_THAN_OR_EQUAL,ut.LESS_THAN,ut.LESS_THAN_OR_EQUAL,ut.IN_RANGE,ut.BLANK,ut.NOT_BLANK];var xT=RT,PT=class extends nm{conditionToString(t,e){const{numberOfInputs:i}=e||{};return t.type==Ye.IN_RANGE||i===2?`${t.filter}-${t.filterTo}`:t.filter!=null?`${t.filter}`:`${t.type}`}},Wi=class zn extends Ye{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(e){const i=e&&e.trim();return i===""?e:i}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?zn.DEFAULT_FORMATTER:zn.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new PT(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(ge.warnOnce("textCustomComparator is deprecated, use textMatcher instead."),({filterOption:i,value:s,filterText:r})=>e(i,s,r)):this.textFilterParams.textMatcher||zn.DEFAULT_MATCHER}createCondition(e){const i=this.getConditionType(e),s={filterType:this.getFilterType(),type:i},r=this.getValuesWithSideEffects(e,!0);return r.length>0&&(s.filter=r[0]),r.length>1&&(s.filterTo=r[1]),s}getFilterType(){return"text"}areSimpleModelsEqual(e,i){return e.filter===i.filter&&e.filterTo===i.filterTo&&e.type===i.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,i){const s=[];return this.forEachPositionInput(e,(r,n,o,a)=>{var l;if(n<a){let u=ys(r.getValue());i&&this.textFilterParams.trimInput&&(u=(l=zn.trimInput(u))!=null?l:null,r.setValue(u,!0)),s.push(u)}}),s}getDefaultFilterOptions(){return zn.DEFAULT_FILTER_OPTIONS}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),Qe(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,i,s){const r=this.createManagedBean(new vn);r.addCssClass(`ag-filter-${s}`),r.addCssClass("ag-filter-filter"),i.push(r),e.appendChild(r.getGui())}removeValueElements(e,i){this.removeComponents(this.eValuesFrom,e,i),this.removeComponents(this.eValuesTo,e,i)}mapValuesFromModel(e){const{filter:i,filterTo:s,type:r}=e||{};return[i||null,s||null].slice(0,this.getNumberOfInputs(r))}evaluateNullValue(e){const i=[Ye.NOT_EQUAL,Ye.NOT_CONTAINS,Ye.BLANK];return e?i.indexOf(e)>=0:!1}evaluateNonNullValue(e,i,s,r){const n=e.map(y=>this.formatter(y))||[],o=this.formatter(i),{api:a,colDef:l,column:u,columnApi:d,context:c,textFormatter:C}=this.textFilterParams;if(s.type===Ye.BLANK)return this.isBlank(i);if(s.type===Ye.NOT_BLANK)return!this.isBlank(i);const E={api:a,colDef:l,column:u,columnApi:d,context:c,node:r.node,data:r.data,filterOption:s.type,value:o,textFormatter:C};return n.some(y=>this.matcher(He(te({},E),{filterText:y})))}getModelAsString(e){var i;return(i=this.filterModelFormatter.getModelAsString(e))!=null?i:""}};Wi.DEFAULT_FILTER_OPTIONS=[Ye.CONTAINS,Ye.NOT_CONTAINS,Ye.EQUALS,Ye.NOT_EQUAL,Ye.STARTS_WITH,Ye.ENDS_WITH,Ye.BLANK,Ye.NOT_BLANK];Wi.DEFAULT_FORMATTER=t=>t;Wi.DEFAULT_LOWERCASE_FORMATTER=t=>t==null?null:t.toString().toLowerCase();Wi.DEFAULT_MATCHER=({filterOption:t,value:e,filterText:i})=>{if(i==null)return!1;switch(t){case Wi.CONTAINS:return e.indexOf(i)>=0;case Wi.NOT_CONTAINS:return e.indexOf(i)<0;case Wi.EQUALS:return e===i;case Wi.NOT_EQUAL:return e!=i;case Wi.STARTS_WITH:return e.indexOf(i)===0;case Wi.ENDS_WITH:const s=e.lastIndexOf(i);return s>=0&&s===e.length-i.length;default:return!1}};var um=Wi,IT=class extends z{constructor(t){super(),this.params=t,this.valueChangedListener=()=>{}}setupGui(t){var e;this.eFloatingFilterTextInput=this.createManagedBean(new vn((e=this.params)==null?void 0:e.config));const i=this.eFloatingFilterTextInput.getGui();t.appendChild(i),this.addManagedListener(i,"input",s=>this.valueChangedListener(s)),this.addManagedListener(i,"keydown",s=>this.valueChangedListener(s))}setEditable(t){this.eFloatingFilterTextInput.setDisabled(!t)}setAutoComplete(t){this.eFloatingFilterTextInput.setAutoComplete(t)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(t,e){this.eFloatingFilterTextInput.setValue(t,e)}setValueChangedListener(t){this.valueChangedListener=t}setParams(t){this.setAriaLabel(t.ariaLabel),t.autoComplete!==void 0&&this.setAutoComplete(t.autoComplete)}setAriaLabel(t){this.eFloatingFilterTextInput.setInputAriaLabel(t)}},Bh=class extends am{postConstruct(){this.setTemplate(`
            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>
        `)}getDefaultDebounceMs(){return 500}onParentModelChanged(t,e){this.isEventFromFloatingFilter(e)||this.isEventFromDataChange(e)||(this.setLastTypeFromModel(t),this.setEditable(this.canWeEditAfterModelFromParentFilter(t)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(t)))}init(t){this.setupFloatingFilterInputService(t),super.init(t),this.setTextInputParams(t)}setupFloatingFilterInputService(t){this.floatingFilterInputService=this.createFloatingFilterInputService(t),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(t){var e;this.params=t;const i=(e=t.browserAutoComplete)!=null?e:!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(t),autoComplete:i}),this.applyActive=Gd.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const s=Gd.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),r=Ot(this.syncUpWithParentFilter.bind(this),s);this.floatingFilterInputService.setValueChangedListener(r)}}onParamsUpdated(t){this.refresh(t)}refresh(t){super.refresh(t),this.setTextInputParams(t)}recreateFloatingFilterInputService(t){const e=this.floatingFilterInputService.getValue();tt(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(t),this.floatingFilterInputService.setValue(e,!0)}syncUpWithParentFilter(t){const e=t.key===N.ENTER;if(this.applyActive&&!e)return;let i=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(i=um.trimInput(i),this.floatingFilterInputService.setValue(i,!0)),this.params.parentFilterInstance(s=>{s&&s.onFloatingFilterChanged(this.getLastType()||null,i||null)})}setEditable(t){this.floatingFilterInputService.setEditable(t)}};g([q("eFloatingFilterInputContainer")],Bh.prototype,"eFloatingFilterInputContainer",2);g([$],Bh.prototype,"postConstruct",1);var E2=class extends z{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(t){this.eFloatingFilterNumberInput=this.createManagedBean(new lm),this.eFloatingFilterTextInput=this.createManagedBean(new vn),this.eFloatingFilterTextInput.setDisabled(!0);const e=this.eFloatingFilterNumberInput.getGui(),i=this.eFloatingFilterTextInput.getGui();t.appendChild(e),t.appendChild(i),this.setupListeners(e,s=>this.valueChangedListener(s)),this.setupListeners(i,s=>this.valueChangedListener(s))}setEditable(t){this.numberInputActive=t,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(t){this.eFloatingFilterNumberInput.setAutoComplete(t),this.eFloatingFilterTextInput.setAutoComplete(t)}getValue(){return this.getActiveInputElement().getValue()}setValue(t,e){this.getActiveInputElement().setValue(t,e)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(t){this.valueChangedListener=t}setupListeners(t,e){this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)}setParams(t){this.setAriaLabel(t.ariaLabel),t.autoComplete!==void 0&&this.setAutoComplete(t.autoComplete)}setAriaLabel(t){this.eFloatingFilterNumberInput.setInputAriaLabel(t),this.eFloatingFilterTextInput.setInputAriaLabel(t)}},w2=class extends Bh{init(t){var e;super.init(t),this.filterModelFormatter=new DT(this.localeService,this.optionsFactory,(e=t.filterParams)==null?void 0:e.numberFormatter)}onParamsUpdated(t){this.refresh(t)}refresh(t){og(t.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(t),super.refresh(t),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return xT.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(t){return this.allowedCharPattern=og(t.filterParams),this.allowedCharPattern?this.createManagedBean(new IT({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new E2)}},T2=class extends Bh{init(t){super.init(t),this.filterModelFormatter=new PT(this.localeService,this.optionsFactory)}onParamsUpdated(t){this.refresh(t)}refresh(t){super.refresh(t),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return um.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new IT)}},tu=class Va{constructor(e,i=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new Qi,this.eElement=e,this.preventMouseClick=i;const s=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),n=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",s,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",n,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",s,{passive:!0}),this.eElement.removeEventListener("touchmove",r,{passive:!0}),this.eElement.removeEventListener("touchend",n,{passive:!1})})}getActiveTouch(e){for(let i=0;i<e.length;i++)if(e[i].identifier===this.touchStart.identifier)return e[i];return null}addEventListener(e,i){this.eventService.addEventListener(e,i)}removeEventListener(e,i){this.eventService.removeEventListener(e,i)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const i=this.touchStart;window.setTimeout(()=>{const s=this.touchStart===i;if(this.touching&&s&&!this.moved){this.moved=!0;const r={type:Va.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent:e};this.eventService.dispatchEvent(r)}},500)}onTouchMove(e){if(!this.touching)return;const i=this.getActiveTouch(e.touches);if(!i)return;!tm(i,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const i={type:Va.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(i),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=new Date().getTime();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>Va.DOUBLE_TAP_MILLIS){const s={type:Va.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(s),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}};tu.EVENT_TAP="tap";tu.EVENT_DOUBLE_TAP="doubleTap";tu.EVENT_LONG_TAP="longTap";tu.DOUBLE_TAP_MILLIS=500;var Ct=tu,Xs=class LT extends oe{constructor(e){super(),e||this.setTemplate(LT.TEMPLATE)}attachCustomElements(e,i,s,r,n){this.eSortOrder=e,this.eSortAsc=i,this.eSortDesc=s,this.eSortMixed=r,this.eSortNone=n}setupSort(e,i=!1){this.column=e,this.suppressOrder=i,this.setupMultiSortIndicator(),!(!this.column.isSortable()&&!this.column.getColDef().showRowGroup)&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.updateIcons()),this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(e,i,s){if(i==null)return;const r=je(e,this.gos,s);r&&i.appendChild(r)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const i=e==="asc";ve(this.eSortAsc,i,{skipAriaHidden:!0})}if(this.eSortDesc){const i=e==="desc";ve(this.eSortDesc,i,{skipAriaHidden:!0})}if(this.eSortNone){const i=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),s=e==null;ve(this.eSortNone,!i&&s,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;this.gos.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e=this.sortController.getDisplaySortForColumn(this.column)==="mixed";ve(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){var e;if(!this.eSortOrder)return;const i=this.sortController.getColumnsWithSortingOrdered(),s=(e=this.sortController.getDisplaySortIndexForColumn(this.column))!=null?e:-1,r=i.some(o=>{var a;return(a=this.sortController.getDisplaySortIndexForColumn(o))!=null?a:!1}),n=s>=0&&r;ve(this.eSortOrder,n,{skipAriaHidden:!0}),s>=0?this.eSortOrder.textContent=(s+1).toString():tt(this.eSortOrder)}};Xs.TEMPLATE=`<span class="ag-sort-indicator-container">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>
        </span>`;g([q("eSortOrder")],Xs.prototype,"eSortOrder",2);g([q("eSortAsc")],Xs.prototype,"eSortAsc",2);g([q("eSortDesc")],Xs.prototype,"eSortDesc",2);g([q("eSortMixed")],Xs.prototype,"eSortMixed",2);g([q("eSortNone")],Xs.prototype,"eSortNone",2);g([T("columnModel")],Xs.prototype,"columnModel",2);g([T("sortController")],Xs.prototype,"sortController",2);var dm=Xs,At=class FT extends oe{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(e){const i=this.params;return this.params=e,this.workOutTemplate()!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||this.workOutSort()!=this.currentSort||this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||i.enableFilterButton!=e.enableFilterButton||i.enableFilterIcon!=e.enableFilterIcon?!1:(this.setDisplayName(e),!0)}workOutTemplate(){var e;let i=(e=this.params.template)!=null?e:FT.TEMPLATE;return i=i&&i.trim?i.trim():i,i}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const i=at(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=i)}}addInIcon(e,i,s){if(i==null)return;const r=je(e,this.gos,s);r&&i.appendChild(r)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const i=new Ct(this.getGui(),!0),s=this.shouldSuppressMenuHide(),r=s&&U(this.eMenu),n=r?new Ct(this.eMenu,!0):i;if(this.params.enableMenu){const o=r?"EVENT_TAP":"EVENT_LONG_TAP",a=l=>this.params.showColumnMenuAfterMouseClick(l.touchStart);this.addManagedListener(n,Ct[o],a)}if(this.params.enableSorting){const o=a=>{var l,u;const d=a.touchStart.target;s&&((l=this.eMenu)!=null&&l.contains(d)||(u=this.eFilterButton)!=null&&u.contains(d))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(i,Ct.EVENT_TAP,o)}if(this.params.enableFilterButton){const o=new Ct(this.eFilterButton,!0);this.addManagedListener(o,"tap",()=>this.params.showFilter(this.eFilterButton)),this.addDestroyFunc(()=>o.destroy())}this.addDestroyFunc(()=>i.destroy()),r&&this.addDestroyFunc(()=>n.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){$i(this.eMenu),this.eMenu=void 0;return}const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedListener(this.eMenu,"click",()=>this.params.showColumnMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){var i,s,r,n;const{column:o}=this.params,a=this.menuService.isLegacyMenuEnabled();if(e&&!a){if(this.menuService.isFilterMenuInHeaderEnabled(o))return this.params.showFilter((s=(i=this.eFilterButton)!=null?i:this.eMenu)!=null?s:this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu((n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new dm(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListener(this.params.column,Pe.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=new Date().getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",i=>{const s=this.params.column.isMoving(),n=new Date().getTime()-this.lastMovingChanged<50;if(!(s||n)){const l=this.gos.get("multiSortKey")==="ctrl"?i.ctrlKey||i.metaKey:i.shiftKey;this.params.progressSort(l)}});const e=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const i=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),r=!(i==null?void 0:i.every(n=>this.params.column.getSort()==n.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",r)}};this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,e),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,e)}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedListener(this.eFilterButton,"click",()=>this.params.showFilter(this.eFilterButton)):this.eFilterButton=void 0}configureFilter(e,i,s){if(!e)return $i(i),!1;const{column:r}=this.params;return this.addInIcon("filter",i,r),this.addManagedListener(r,Pe.EVENT_FILTER_CHANGED,s),s(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();ve(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){var i,s,r,n;return e?(s=(i=this.eFilterButton)!=null?i:this.eMenu)!=null?s:this.getGui():(n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()}};At.TEMPLATE=`<div class="ag-cell-label-container" role="presentation">
            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>
            <span ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text"></span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>
                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>
            </div>
        </div>`;g([T("sortController")],At.prototype,"sortController",2);g([T("menuService")],At.prototype,"menuService",2);g([T("columnModel")],At.prototype,"columnModel",2);g([q("eFilter")],At.prototype,"eFilter",2);g([q("eFilterButton")],At.prototype,"eFilterButton",2);g([q("eSortIndicator")],At.prototype,"eSortIndicator",2);g([q("eMenu")],At.prototype,"eMenu",2);g([q("eLabel")],At.prototype,"eLabel",2);g([q("eText")],At.prototype,"eText",2);g([q("eSortOrder")],At.prototype,"eSortOrder",2);g([q("eSortAsc")],At.prototype,"eSortAsc",2);g([q("eSortDesc")],At.prototype,"eSortDesc",2);g([q("eSortMixed")],At.prototype,"eSortMixed",2);g([q("eSortNone")],At.prototype,"eSortNone",2);var ag=At,iu=class MT extends oe{constructor(){super(MT.TEMPLATE)}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&ie("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const e=r=>{if(Yi(r))return;const n=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e);const i=r=>{Ji(r)};this.addManagedListener(this.eCloseIcon,"dblclick",i),this.addManagedListener(this.eOpenIcon,"dblclick",i),this.addManagedListener(this.getGui(),"dblclick",e),this.updateIconVisibility();const s=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(s,nt.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(s,nt.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(e,i){const s=new Ct(e,!0);this.addManagedListener(s,Ct.EVENT_TAP,i),this.addDestroyFunc(()=>s.destroy()),this.addManagedListener(e,"click",i)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const i=this.params.columnGroup.isExpanded();ve(this.eOpenIcon,i),ve(this.eCloseIcon,!i)}else ve(this.eOpenIcon,!1),ve(this.eCloseIcon,!1)}addInIcon(e,i){const s=je(e,this.gos,null);s&&this.getRefElement(i).appendChild(s)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable()){ve(this.eOpenIcon,!1),ve(this.eCloseIcon,!1);return}}setupLabel(){var e;const{displayName:i,columnGroup:s}=this.params;if(U(i)){const r=at(i,!0);this.getRefElement("agLabel").textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!((e=s.getColGroupDef())!=null&&e.suppressStickyLabel))}};iu.TEMPLATE=`<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">
            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>
            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>
            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>
        </div>`;g([T("columnModel")],iu.prototype,"columnModel",2);g([q("agOpened")],iu.prototype,"eOpenIcon",2);g([q("agClosed")],iu.prototype,"eCloseIcon",2);var b2=iu,yn=class extends oe{isPopup(){return!0}setParentComponent(t){t.addCssClass("ag-has-popup"),super.setParentComponent(t)}destroy(){const t=this.parentComponent;t&&t.isAlive()&&t.getGui().classList.remove("ag-has-popup"),super.destroy()}},hm=class OT extends yn{constructor(){super(OT.TEMPLATE)}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),U(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const i=e.key;(i===N.LEFT||i===N.UP||i===N.RIGHT||i===N.DOWN||e.shiftKey&&i===N.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return!U(e)&&!U(this.params.value)?this.params.value:this.params.parseValue(e)}};hm.TEMPLATE=`<div class="ag-large-text">
            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>
        </div>`;g([q("eTextArea")],hm.prototype,"eTextArea",2);var _2=hm,cm=class extends yn{constructor(){super(`<div class="ag-cell-edit-wrapper">
                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>
            </div>`),this.startedByEnter=!1}init(t){this.focusAfterAttached=t.cellStartedEdit;const{eSelect:e,valueService:i,gos:s}=this,{values:r,value:n,eventKey:o}=t;if(re(r)){console.warn("AG Grid: no values found for select cellEditor");return}this.startedByEnter=o!=null?o===N.ENTER:!1;let a=!1;r.forEach(c=>{const C={value:c},E=i.formatValue(t.column,null,c),y=E!=null;C.text=y?E:c,e.addOption(C),a=a||n===c}),a?e.setValue(t.value,!0):t.values.length&&e.setValue(t.values[0],!0);const{valueListGap:l,valueListMaxWidth:u,valueListMaxHeight:d}=t;l!=null&&e.setPickerGap(l),d!=null&&e.setPickerMaxHeight(d),u!=null&&e.setPickerMaxWidth(u),s.get("editType")!=="fullRow"&&this.addManagedListener(this.eSelect,kh.EVENT_ITEM_SELECTED,()=>t.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}};g([T("valueService")],cm.prototype,"valueService",2);g([q("eSelect")],cm.prototype,"eSelect",2);var su=class extends yn{constructor(t){super(`
            <div class="ag-cell-edit-wrapper">
                ${t.getTemplate()}
            </div>`),this.cellEditorInput=t}init(t){this.params=t;const e=this.eInput;this.cellEditorInput.init(e,t);let i;if(t.cellStartedEdit){this.focusAfterAttached=!0;const s=t.eventKey;s===N.BACKSPACE||t.eventKey===N.DELETE?i="":s&&s.length===1?i=s:(i=this.cellEditorInput.getStartValue(),s!==N.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,i=this.cellEditorInput.getStartValue();i!=null&&e.setStartValue(i),this.addManagedListener(e.getGui(),"keydown",s=>{const{key:r}=s;(r===N.PAGE_UP||r===N.PAGE_DOWN)&&s.preventDefault()})}afterGuiAttached(){var t,e;const i=this.localeService.getLocaleTextFunc(),s=this.eInput;if(s.setInputAriaLabel(i("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;_s()||s.getFocusableElement().focus();const r=s.getInputElement();this.highlightAllOnFocus?r.select():(e=(t=this.cellEditorInput).setCaret)==null||e.call(t)}focusIn(){const t=this.eInput,e=t.getFocusableElement(),i=t.getInputElement();e.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}};g([q("eInput")],su.prototype,"eInput",2);var D2=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(t,e){this.eInput=t,this.params=e,e.maxLength!=null&&t.setMaxLength(e.maxLength)}getValue(){const t=this.eInput.getValue();return!U(t)&&!U(this.params.value)?this.params.value:this.params.parseValue(t)}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const t=this.eInput.getValue(),e=U(t)&&t.length||0;e&&this.eInput.getInputElement().setSelectionRange(e,e)}},uy=class extends su{constructor(){super(new D2)}},R2="↑",A2="↓",NT=class extends oe{constructor(){super(),this.refreshCount=0;const t=document.createElement("span"),e=document.createElement("span");e.setAttribute("class","ag-value-change-delta");const i=document.createElement("span");i.setAttribute("class","ag-value-change-value"),t.appendChild(e),t.appendChild(i),this.setTemplateFromElement(t)}init(t){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(t,!0)}showDelta(t,e){const i=Math.abs(e),s=t.formatValue(i),r=U(s)?s:i,n=e>=0;n?this.eDelta.textContent=R2+r:this.eDelta.textContent=A2+r,this.eDelta.classList.toggle("ag-value-change-delta-up",n),this.eDelta.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const t=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{t===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),tt(this.eDelta)}refresh(t,e=!1){const i=t.value;if(i===this.lastValue||(U(t.valueFormatted)?this.eValue.textContent=t.valueFormatted:U(t.value)?this.eValue.textContent=i:tt(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof i=="number"&&typeof this.lastValue=="number"){const s=i-this.lastValue;this.showDelta(t,s)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),e||this.setTimerToRemoveDelta(),this.lastValue=i,!0}};g([T("filterManager")],NT.prototype,"filterManager",2);var kT=class extends oe{constructor(){super(),this.refreshCount=0;const t=document.createElement("span"),e=document.createElement("span");e.setAttribute("class","ag-value-slide-current"),t.appendChild(e),this.setTemplateFromElement(t),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(t){this.refresh(t,!0)}addSlideAnimation(){this.refreshCount++;const t=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const e=document.createElement("span");e.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=e,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{t===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{t===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(t,e=!1){let i=t.value;return re(i)&&(i=""),i===this.lastValue||this.filterManager.isSuppressFlashingCellsBecauseFiltering()?!1:(e||this.addSlideAnimation(),this.lastValue=i,U(t.valueFormatted)?this.eCurrent.textContent=t.valueFormatted:U(t.value)?this.eCurrent.textContent=i:tt(this.eCurrent),!0)}};g([T("filterManager")],kT.prototype,"filterManager",2);var Ue=class Ne{constructor(e){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=Ne.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,i){const s=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const r=this.createDataChangedEvent(e,s,i);this.dispatchLocalEvent(r)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,i,s){return{type:Ne.EVENT_DATA_CHANGED,node:this,oldData:i,newData:e,update:s}}createLocalRowEvent(e){return{type:e,node:this}}getRowIndexString(){return this.rowPinned==="top"?"t-"+this.rowIndex:this.rowPinned==="bottom"?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const e=new Ne(this.beans);return e.id=this.id,e.data=this.data,e.__daemon=!0,e.selected=this.selected,e.level=this.level,e}setDataAndId(e,i){const s=U(this.id)?this.createDaemonNode():null,r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(i),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,s);const n=this.createDataChangedEvent(e,r,!1);this.dispatchLocalEvent(n)}checkRowSelectable(){const e=this.beans.gos.get("isRowSelectable");this.setRowSelectable(e?e(this):!0)}setRowSelectable(e,i){if(this.selectable!==e){if(this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_SELECTABLE_CHANGED)),i)return;if(this.beans.gos.get("groupSelectsChildren")){const r=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:r??!1,source:"selectableChanged"});return}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(e){const i=this.beans.gos.getCallback("getRowId");if(i)if(this.data){const s=this.getGroupKeys(!0);this.id=i({data:this.data,parentKeys:s.length>0?s:void 0,level:this.level}),this.id!==null&&typeof this.id=="string"&&this.id.startsWith(Ne.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${Ne.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),this.id!==null&&typeof this.id!="string"&&(this.id=""+this.id)}else this.id=void 0;else this.id=e}getGroupKeys(e=!1){const i=[];let s=this;for(e&&(s=s.parent);s&&s.level>=0;)i.push(s.key),s=s.parent;return i.reverse(),i}isPixelInRange(e){return!U(this.rowTop)||!U(this.rowHeight)?!1:e>=this.rowTop&&e<this.rowTop+this.rowHeight}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_TOP_CHANGED)),this.setDisplayed(e!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_DISPLAYED_CHANGED)))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_DRAGGING_CHANGED)))}setHighlighted(e){e!==this.highlighted&&(this.highlighted=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_HIGHLIGHT_CHANGED)))}setHovered(e){this.hovered!==e&&(this.hovered=e)}isHovered(){return this.hovered}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_MASTER_CHANGED)))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_GROUP_CHANGED)))}setRowHeight(e,i=!1){this.rowHeight=e,this.rowHeightEstimated=i,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(e,i){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[i.getId()]=e,e!=null&&(this.checkAutoHeightsDebounced==null&&(this.checkAutoHeightsDebounced=Ot(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let e=!1,i=!0,s=0;const r=this.__autoHeights;if(r==null||(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(a=>{let l=r[a.getId()];if(l==null)if(this.beans.columnModel.isColSpanActive()){let u=[];switch(a.getPinned()){case"left":u=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":u=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:u=this.beans.columnModel.getViewportCenterColumnsForRow(this);break}if(u.includes(a)){e=!0;return}l=-1}else{e=!0;return}else i=!1;l>s&&(s=l)}),e)||((i||s<10)&&(s=this.beans.gos.getRowHeightForNode(this).height),s==this.rowHeight))return;this.setRowHeight(s);const o=this.beans.rowModel;o.onRowHeightChangedDebounced&&o.onRowHeightChangedDebounced()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_UI_LEVEL_CHANGED)))}setExpanded(e,i,s){if(this.expanded===e)return;this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_EXPANDED_CHANGED));const r=Object.assign({},this.createGlobalRowEvent(S.EVENT_ROW_GROUP_OPENED),{expanded:e,event:i||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r,s),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return this.beans.gos.addGridCommonParams({type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}dispatchLocalEvent(e){this.eventService&&this.eventService.dispatchEvent(e)}setDataValue(e,i,s){const n=(()=>{var l;return typeof e!="string"?e:(l=this.beans.columnModel.getGridColumn(e))!=null?l:this.beans.columnModel.getPrimaryColumn(e)})(),o=this.getValueFromValueService(n);if(this.beans.gos.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,o,i,s),!1;const a=this.beans.valueService.setValue(this,n,i,s);return this.dispatchCellChangedEvent(n,i,o),this.checkRowSelectable(),a}getValueFromValueService(e){var i,s;const r=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!r;let o=!1;const a=(i=this.beans.gos.get("groupTotalRow"))!=null?i:this.beans.gos.get("groupIncludeFooter");typeof a!="function"?o=!!a:o=!!((s=this.beans.gos.getCallback("groupTotalRow"))!=null?s:this.beans.gos.getCallback("groupIncludeFooter"))({node:this});const l=this.beans.gos.get("groupSuppressBlankHeader"),u=n&&o&&!l;return this.beans.valueService.getValue(e,this,!1,u)}dispatchEventForSaveValueReadOnly(e,i,s,r){const n=this.beans.gos.addGridCommonParams({type:S.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:e,colDef:e.getColDef(),data:this.data,node:this,oldValue:i,newValue:s,value:s,source:r});this.beans.eventService.dispatchEvent(n)}setGroupValue(e,i){const s=this.beans.columnModel.getGridColumn(e);re(this.groupData)&&(this.groupData={});const r=s.getColId(),n=this.groupData[r];n!==i&&(this.groupData[r]=i,this.dispatchCellChangedEvent(s,i,n))}setAggData(e){const i=this.aggData;if(this.aggData=e,this.eventService){const s=r=>{const n=this.aggData?this.aggData[r]:void 0,o=i?i[r]:void 0;if(n===o)return;const a=this.beans.columnModel.lookupGridColumn(r);a&&this.dispatchCellChangedEvent(a,n,o)};for(const r in this.aggData)s(r);for(const r in e)r in this.aggData||s(r)}}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gos.isRowModelType("serverSide")){const s=this.beans.gos.get("treeData"),r=this.beans.gos.get("isServerSideGroup");e=!this.stub&&!this.footer&&(s?!!r&&r(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Ne.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&bi(this.childrenAfterGroup)}dispatchCellChangedEvent(e,i,s){const r={type:Ne.EVENT_CELL_CHANGED,node:this,column:e,newValue:i,oldValue:s};this.dispatchLocalEvent(r)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.footer?!1:this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(i=>i.depthFirstSearch(e)),e(this)}calculateSelectedFromChildren(){var e;let i=!1,s=!1,r=!1;if(!((e=this.childrenAfterGroup)!=null&&e.length))return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const o=this.childrenAfterGroup[n];let a=o.isSelected();if(!o.selectable){const l=o.calculateSelectedFromChildren();if(l===null)continue;a=l}switch(a){case!0:i=!0;break;case!1:s=!0;break;default:r=!0;break}}if(!(r||i&&s))return i?!0:s?!1:this.selectable?this.selected:null}setSelectedInitialValue(e){this.selected=e}selectThisNode(e,i,s="api"){const r=!this.selectable&&e,n=this.selected===e;if(r||n)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(Ne.EVENT_ROW_SELECTED));const o=this.sibling;o&&o.footer&&o.eventService&&o.dispatchLocalEvent(o.createLocalRowEvent(Ne.EVENT_ROW_SELECTED));const a=He(te({},this.createGlobalRowEvent(S.EVENT_ROW_SELECTED)),{event:i||null,source:s});return this.beans.eventService.dispatchEvent(a),!0}setSelected(e,i=!1,s="api"){if(typeof s=="boolean"){console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");return}this.setSelectedParams({newValue:e,clearSelection:i,rangeSelect:!1,source:s})}setSelectedParams(e){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):this.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(He(te({},e),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return this.rowPinned==="top"||this.rowPinned==="bottom"}isParentOfNode(e){let i=this.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}addEventListener(e,i){var s,r;this.eventService||(this.eventService=new Qi),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new xf(this.beans.frameworkOverrides));const n=(r=(s=this.frameworkEventListenerService)==null?void 0:s.wrap(i))!=null?r:i;this.eventService.addEventListener(e,n)}removeEventListener(e,i){var s,r;if(!this.eventService)return;const n=(r=(s=this.frameworkEventListenerService)==null?void 0:s.unwrap(i))!=null?r:i;this.eventService.removeEventListener(e,n),this.eventService.noRegisteredListenersExist()&&(this.eventService=null)}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(Ne.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(Ne.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(e){let i=this,s=!0,r=!1,n=null;for(;s&&!r;){const o=i.parent;U(o)&&i.firstChild?o.rowGroupColumn===e&&(r=!0,n=o):s=!1,i=o}return r?n:null}isFullWidthCell(){if(this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.key==null)return;const e=[];let i=this;for(;i.key!=null;)e.push(i.key),i=i.parent;return e.reverse()}createFooter(){if(this.sibling)return;const e=new Set(["eventService","__objectId","sticky"]),i=new Ne(this.beans);Object.keys(this).forEach(s=>{e.has(s)||(i[s]=this[s])}),i.footer=!0,i.setRowTop(null),i.setRowIndex(null),i.oldRowTop=null,i.id="rowGroupFooter_"+this.id,i.sibling=this,this.sibling=i}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}};Ue.ID_PREFIX_ROW_GROUP="row-group-";Ue.ID_PREFIX_TOP_PINNED="t-";Ue.ID_PREFIX_BOTTOM_PINNED="b-";Ue.OBJECT_ID_SEQUENCE=0;Ue.EVENT_ROW_SELECTED="rowSelected";Ue.EVENT_DATA_CHANGED="dataChanged";Ue.EVENT_CELL_CHANGED="cellChanged";Ue.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged";Ue.EVENT_MASTER_CHANGED="masterChanged";Ue.EVENT_GROUP_CHANGED="groupChanged";Ue.EVENT_MOUSE_ENTER="mouseEnter";Ue.EVENT_MOUSE_LEAVE="mouseLeave";Ue.EVENT_HEIGHT_CHANGED="heightChanged";Ue.EVENT_TOP_CHANGED="topChanged";Ue.EVENT_DISPLAYED_CHANGED="displayedChanged";Ue.EVENT_FIRST_CHILD_CHANGED="firstChildChanged";Ue.EVENT_LAST_CHILD_CHANGED="lastChildChanged";Ue.EVENT_CHILD_INDEX_CHANGED="childIndexChanged";Ue.EVENT_ROW_INDEX_CHANGED="rowIndexChanged";Ue.EVENT_EXPANDED_CHANGED="expandedChanged";Ue.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged";Ue.EVENT_SELECTABLE_CHANGED="selectableChanged";Ue.EVENT_UI_LEVEL_CHANGED="uiLevelChanged";Ue.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged";Ue.EVENT_DRAGGING_CHANGED="draggingChanged";var ce=Ue,Hh=class extends oe{constructor(){super(`
            <div class="ag-selection-checkbox" role="presentation">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const t=this.localeService.getLocaleTextFunc(),e=this.rowNode.isSelected(),i=Ph(t,e),[s,r]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],n=t(s,r);this.eCheckbox.setValue(e,!0),this.eCheckbox.setInputAriaLabel(`${n} (${i})`)}onClicked(t,e,i){return this.rowNode.setSelectedParams({newValue:t,rangeSelect:i.shiftKey,groupSelectsFiltered:e,event:i,source:"checkboxSelected"})}init(t){if(this.rowNode=t.rowNode,this.column=t.column,this.overrides=t.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",s=>{Ji(s)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",s=>{Ji(s);const r=this.gos.get("groupSelectsFiltered"),n=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(n,r)?this.onClicked(!0,r,s||{})===0&&this.onClicked(!1,r,s):n?this.onClicked(!1,r,s):this.onClicked(!0,r,s||{})}),this.addManagedListener(this.rowNode,ce.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gos.get("isRowSelectable")||typeof this.getIsVisible()=="function"){const s=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,s),this.addManagedListener(this.rowNode,ce.EVENT_DATA_CHANGED,s),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,s),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(t,e){return e&&(this.eCheckbox.getPreviousValue()===void 0||t===void 0)&&this.gos.isRowModelType("clientSide")}showOrHideSelect(){var t,e,i;let s=this.rowNode.selectable;const r=this.getIsVisible();if(s)if(typeof r=="function"){const o=(t=this.overrides)==null?void 0:t.callbackParams;if(!this.column)s=r(He(te({},o),{node:this.rowNode,data:this.rowNode.data}));else{const a=this.column.createColumnFunctionCallbackParams(this.rowNode);s=r(te(te({},o),a))}}else s=r??!1;if((e=this.column)==null?void 0:e.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!s),this.setVisible(!0),this.setDisplayed(!0);return}if((i=this.overrides)!=null&&i.removeHidden){this.setDisplayed(s);return}this.setVisible(s)}getIsVisible(){var t,e;return this.overrides?this.overrides.isVisible:(e=(t=this.column)==null?void 0:t.getColDef())==null?void 0:e.checkboxSelection}};g([q("eCheckbox")],Hh.prototype,"eCheckbox",2);g([$],Hh.prototype,"postConstruct",1);var GT=(t=>(t[t.Left=0]="Left",t[t.Right=1]="Right",t))(GT||{}),ae=class extends z{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=wi("columnMovePin",this.gos,null),this.eHideIcon=wi("columnMoveHide",this.gos,null),this.eMoveIcon=wi("columnMoveMove",this.gos,null),this.eLeftIcon=wi("columnMoveLeft",this.gos,null),this.eRightIcon=wi("columnMoveRight",this.gos,null),this.eGroupIcon=wi("columnMoveGroup",this.gos,null),this.eAggregateIcon=wi("columnMoveValue",this.gos,null),this.ePivotIcon=wi("columnMovePivot",this.gos,null),this.eDropNotAllowedIcon=wi("dropNotAllowed",this.gos,null)}addDragSource(t,e=!1){const i={eElement:t.eElement,dragStartPixels:t.dragStartPixels,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:e};this.dragSourceAndParamsList.push({params:i,dragSource:t}),this.dragService.addDragSource(i)}removeDragSource(t){const e=this.dragSourceAndParamsList.find(i=>i.dragSource===t);e&&(this.dragService.removeDragSource(e.params),$t(this.dragSourceAndParamsList,e))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(t=>this.dragService.removeDragSource(t.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(t,e){this.dragging=!0,this.dragSource=t,this.eventLastTime=e,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=void 0,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(t){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const e=this.createDropTargetEvent(this.lastDropTarget,t,null,null,!1);this.lastDropTarget.onDragStop(e)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(t,e){var i,s,r,n;const o=this.getHorizontalDirection(t),a=this.getVerticalDirection(t);this.eventLastTime=t,this.positionGhost(t);const l=this.dropTargets.filter(d=>this.isMouseOnDropTarget(t,d)),u=this.findCurrentDropTarget(t,l);if(u!==this.lastDropTarget)this.leaveLastTargetIfExists(t,o,a,e),this.lastDropTarget!==null&&u===null&&((s=(i=this.dragSource).onGridExit)==null||s.call(i,this.dragItem)),this.lastDropTarget===null&&u!==null&&((n=(r=this.dragSource).onGridEnter)==null||n.call(r,this.dragItem)),this.enterDragTargetIfExists(u,t,o,a,e),this.lastDropTarget=u;else if(u&&u.onDragging){const d=this.createDropTargetEvent(u,t,o,a,e);u.onDragging(d)}}getAllContainersFromDropTarget(t){const e=t.getSecondaryContainers?t.getSecondaryContainers():null,i=[[t.getContainer()]];return e?i.concat(e):i}allContainersIntersect(t,e){for(const i of e){const s=i.getBoundingClientRect();if(s.width===0||s.height===0)return!1;const r=t.clientX>=s.left&&t.clientX<s.right,n=t.clientY>=s.top&&t.clientY<s.bottom;if(!r||!n)return!1}return!0}isMouseOnDropTarget(t,e){const i=this.getAllContainersFromDropTarget(e);let s=!1;for(const r of i)if(this.allContainersIntersect(t,r)){s=!0;break}return e.targetContainsSource&&!e.getContainer().contains(this.dragSource.eElement)?!1:s&&e.isInterestedIn(this.dragSource.type,this.dragSource.eElement)}findCurrentDropTarget(t,e){const i=e.length;if(i===0)return null;if(i===1)return e[0];const r=this.gos.getRootNode().elementsFromPoint(t.clientX,t.clientY);for(const n of r)for(const o of e)if(c0(this.getAllContainersFromDropTarget(o)).indexOf(n)!==-1)return o;return null}enterDragTargetIfExists(t,e,i,s,r){if(t){if(t.onDragEnter){const n=this.createDropTargetEvent(t,e,i,s,r);t.onDragEnter(n)}this.setGhostIcon(t.getIconName?t.getIconName():null)}}leaveLastTargetIfExists(t,e,i,s){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const r=this.createDropTargetEvent(this.lastDropTarget,t,e,i,s);this.lastDropTarget.onDragLeave(r)}this.setGhostIcon(null)}}addDropTarget(t){this.dropTargets.push(t)}removeDropTarget(t){this.dropTargets=this.dropTargets.filter(e=>e.getContainer()!==t.getContainer())}hasExternalDropZones(){return this.dropTargets.some(t=>t.external)}findExternalZone(t){return this.dropTargets.filter(i=>i.external).find(i=>i.getContainer()===t.getContainer())||null}getHorizontalDirection(t){const e=this.eventLastTime&&this.eventLastTime.clientX,i=t.clientX;return e===i?null:e>i?0:1}getVerticalDirection(t){const e=this.eventLastTime&&this.eventLastTime.clientY,i=t.clientY;return e===i?null:e>i?0:1}createDropTargetEvent(t,e,i,s,r){const n=t.getContainer(),o=n.getBoundingClientRect(),{gridApi:a,columnApi:l,dragItem:u,dragSource:d}=this,c=e.clientX-o.left,C=e.clientY-o.top;return{event:e,x:c,y:C,vDirection:s,hDirection:i,dragSource:d,fromNudge:r,dragItem:u,api:a,columnApi:l,dropZoneTarget:n}}positionGhost(t){const e=this.eGhost;if(!e)return;const s=e.getBoundingClientRect().height,r=H0()-2,n=U0()-2,o=Kf(e.offsetParent),{clientY:a,clientX:l}=t;let u=a-o.top-s/2,d=l-o.left-10;const c=this.gos.getDocument(),C=c.defaultView||window,E=C.pageYOffset||c.documentElement.scrollTop,y=C.pageXOffset||c.documentElement.scrollLeft;r>0&&d+e.clientWidth>r+y&&(d=r+y-e.clientWidth),d<0&&(d=0),n>0&&u+e.clientHeight>n+E&&(u=n+E-e.clientHeight),u<0&&(u=0),e.style.left=`${d}px`,e.style.top=`${u}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=Qt(ae.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme:t}=this.environment.getTheme();t&&this.eGhost.classList.add(t),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const e=this.eGhost.querySelector(".ag-dnd-ghost-label");let i=this.dragSource.dragItemName;bh(i)&&(i=i()),e.innerHTML=at(i)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const s=this.gos.getDocument();let r=null,n=null;try{r=s.fullscreenElement}catch{}finally{r||(r=this.gos.getRootNode());const o=r.querySelector("body");o?n=o:r instanceof ShadowRoot?n=r:r instanceof Document?n=r==null?void 0:r.documentElement:n=r}this.eGhostParent=n,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(t,e=!1){tt(this.eGhostIcon);let i=null;switch(t||(t=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():ae.ICON_NOT_ALLOWED),t){case ae.ICON_PINNED:i=this.ePinnedIcon;break;case ae.ICON_MOVE:i=this.eMoveIcon;break;case ae.ICON_LEFT:i=this.eLeftIcon;break;case ae.ICON_RIGHT:i=this.eRightIcon;break;case ae.ICON_GROUP:i=this.eGroupIcon;break;case ae.ICON_AGGREGATE:i=this.eAggregateIcon;break;case ae.ICON_PIVOT:i=this.ePivotIcon;break;case ae.ICON_NOT_ALLOWED:i=this.eDropNotAllowedIcon;break;case ae.ICON_HIDE:i=this.eHideIcon;break}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",e),!(i===this.eHideIcon&&this.gos.get("suppressDragLeaveHidesColumns"))&&i&&this.eGhostIcon.appendChild(i)}};ae.ICON_PINNED="pinned";ae.ICON_MOVE="move";ae.ICON_LEFT="left";ae.ICON_RIGHT="right";ae.ICON_GROUP="group";ae.ICON_AGGREGATE="aggregate";ae.ICON_PIVOT="pivot";ae.ICON_NOT_ALLOWED="notAllowed";ae.ICON_HIDE="hide";ae.GHOST_TEMPLATE=`<div class="ag-dnd-ghost ag-unselectable">
            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>
            <div class="ag-dnd-ghost-label"></div>
        </div>`;g([T("dragService")],ae.prototype,"dragService",2);g([T("mouseEventService")],ae.prototype,"mouseEventService",2);g([T("columnApi")],ae.prototype,"columnApi",2);g([T("gridApi")],ae.prototype,"gridApi",2);g([$],ae.prototype,"init",1);g([Vt],ae.prototype,"clearDragSourceParamsList",1);ae=g([Y("dragAndDropService")],ae);var rn=class extends oe{constructor(t,e,i,s,r,n){super(),this.cellValueFn=t,this.rowNode=e,this.column=i,this.customGui=s,this.dragStartPixels=r,this.suppressVisibilityChange=n,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(je("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const t=this.gos.get("rowDragManaged")?new HT(this,this.beans,this.rowNode,this.column):new BT(this,this.beans,this.rowNode,this.column);this.createManagedBean(t,this.beans.context)}}setDragElement(t,e){this.setTemplateFromElement(t),this.addDragSource(e)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return e.indexOf(this.rowNode)!==-1?e:[this.rowNode]}checkCompatibility(){const t=this.gos.get("rowDragManaged");this.gos.get("treeData")&&t&&ie("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(t){if(t){const e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gos.get("rowDragText")}addDragSource(t=4){this.dragSource&&this.removeDragSource();const e=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:this.getGui(),dragItemName:()=>{var i;const s=this.getDragItem(),r=((i=s.rowNodes)==null?void 0:i.length)||1,n=this.getRowDragText(this.column);return n?n(s,r):r===1?this.cellValueFn():`${r} ${e("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:t,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}};g([T("beans")],rn.prototype,"beans",2);g([$],rn.prototype,"postConstruct",1);g([Vt],rn.prototype,"removeDragSource",1);var VT=class extends z{constructor(t,e,i){super(),this.parent=t,this.rowNode=e,this.column=i}setDisplayedOrVisible(t){const e={skipAriaHidden:!0};if(t)this.parent.setDisplayed(!1,e);else{let i=!0,s=!1;this.column&&(i=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),s=bh(this.column.getColDef().rowDrag)),s?(this.parent.setDisplayed(!0,e),this.parent.setVisible(i,e)):(this.parent.setDisplayed(i,e),this.parent.setVisible(!0,e))}}},BT=class extends VT{constructor(t,e,i,s){super(t,i,s),this.beans=e}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const t=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(t)}};g([$],BT.prototype,"postConstruct",1);var HT=class extends VT{constructor(t,e,i,s){super(t,i,s),this.beans=e}postConstruct(){this.addManagedListener(this.beans.eventService,S.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,S.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),i=e&&e.shouldPreventRowMove(),s=this.gos.get("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),n=i&&!r||s;this.setDisplayedOrVisible(n)}};g([$],HT.prototype,"postConstruct",1);var Ko=class extends z{init(t,e,i,s,r,n,o){var a,l,u,d;this.params=o,this.eGui=e,this.eCheckbox=i,this.eExpanded=s,this.eContracted=r,this.comp=t,this.compClass=n;const{node:c,value:C,colDef:E}=o,y=this.isTopLevelFooter();if(!y){if(this.isEmbeddedRowMismatch())return;if(c.footer&&this.gos.get("groupHideOpenParents")){const b=E&&E.showRowGroup,R=c.rowGroupColumn&&c.rowGroupColumn.getColId();if(b!==R)return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!y){const _=o.node.footer&&o.node.rowGroupIndex===this.columnModel.getRowGroupColumns().findIndex(k=>{var H;return k.getColId()===((H=o.colDef)==null?void 0:H.showRowGroup)}),R=this.gos.get("groupDisplayType")!="multipleColumns"||this.gos.get("treeData")||this.gos.get("showOpenedGroup")&&!o.node.footer&&(!o.node.group||o.node.rowGroupIndex!=null&&o.node.rowGroupIndex>this.columnModel.getRowGroupColumns().findIndex(k=>{var H;return k.getColId()===((H=o.colDef)==null?void 0:H.showRowGroup)})),D=!c.group&&(((a=this.params.colDef)==null?void 0:a.field)||((l=this.params.colDef)==null?void 0:l.valueGetter)),O=this.isExpandable(),L=this.columnModel.isPivotMode()&&c.leafGroup&&((u=c.rowGroupColumn)==null?void 0:u.getColId())===((d=o.column)==null?void 0:d.getColDef().showRowGroup);if(!this.showingValueForOpenedParent&&!O&&!D&&!R&&!_&&!L)return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){var t,e;const i=(t=this.params.colDef)==null?void 0:t.cellAriaRole,s=(e=this.params.column)==null?void 0:e.getColDef().cellAriaRole;return i||s||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:t,eGridCell:e}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable()){L0(e);return}const i=()=>{zs(e,!!t.expanded)};this.expandListener=this.addManagedListener(t,ce.EVENT_EXPANDED_CHANGED,i)||null,i()}isTopLevelFooter(){if(!this.gos.getGrandTotalRow()||this.params.value!=null||this.params.node.level!=-1)return!1;const e=this.params.colDef;if(e==null||e.showRowGroup===!0)return!0;const s=this.columnModel.getRowGroupColumns();return!s||s.length===0?!0:s[0].getId()===e.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const t=this.params.pinned==="left",e=this.params.pinned==="right",i=!t&&!e;return this.gos.get("enableRtl")?this.columnModel.isPinningLeft()?!e:!i:this.columnModel.isPinningLeft()?!t:!i}findDisplayedGroupNode(){const t=this.params.column,e=this.params.node;if(this.showingValueForOpenedParent){let i=e.parent;for(;i!=null;){if(i.rowGroupColumn&&t.isRowGroupDisplayed(i.rowGroupColumn.getId())){this.displayedGroupNode=i;break}i=i.parent}}re(this.displayedGroupNode)&&(this.displayedGroupNode=e)}setupShowingValueForOpenedParent(){const t=this.params.node,e=this.params.column;if(!this.gos.get("groupHideOpenParents")){this.showingValueForOpenedParent=!1;return}if(!t.groupData){this.showingValueForOpenedParent=!1;return}if(t.rowGroupColumn!=null){const r=t.rowGroupColumn.getId();if(e.isRowGroupDisplayed(r)){this.showingValueForOpenedParent=!1;return}}const s=t.groupData[e.getId()]!=null;this.showingValueForOpenedParent=s}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){var t;const e=this.adjustParamsWithDetailsFromRelatedColumn(),i=this.getInnerCompDetails(e),{valueFormatted:s,value:r}=e;let n=s;if(n==null){const o=this.displayedGroupNode.rowGroupColumn&&((t=this.params.column)==null?void 0:t.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId()));this.displayedGroupNode.key===""&&this.displayedGroupNode.group&&o?n=this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):n=r??null}this.comp.setInnerRenderer(i,n)}adjustParamsWithDetailsFromRelatedColumn(){const t=this.displayedGroupNode.rowGroupColumn,e=this.params.column;if(!t)return this.params;if(e!=null&&!e.isRowGroupDisplayed(t.getId()))return this.params;const s=this.params,{value:r,node:n}=this.params,o=this.valueService.formatValue(t,n,r);return He(te({},s),{valueFormatted:o})}addFooterValue(){let t=this.params.totalValueGetter;if(!t){const s=this.params.footerValueGetter;s&&(t=s,ie("As of v31.3, footerValueGetter is deprecated. Use `totalValueGetter` instead."))}let e="";if(t){const s=Rf(this.params);s.value=this.params.value,typeof t=="function"?e=t(s):typeof t=="string"?e=this.expressionService.evaluate(t,s):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else e=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(this.params.value!=null?this.params.value:"");const i=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(i,e)}getInnerCompDetails(t){if(t.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gos.get("groupRowRendererParams"),t);const e=this.userComponentFactory.getInnerRendererDetails(t,t),i=o=>o&&o.componentClass==this.compClass;if(e&&!i(e))return e;const s=this.displayedGroupNode.rowGroupColumn,r=s?s.getColDef():void 0;if(!r)return;const n=this.userComponentFactory.getCellRendererDetails(r,t);if(n&&!i(n))return n;if(i(n)&&r.cellRendererParams&&r.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(r.cellRendererParams,t)}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,ce.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const t=this.displayedGroupNode.allChildrenCount,s=this.isShowRowGroupForThisRow()&&t!=null&&t>=0?`(${t})`:"";this.comp.setChildCount(s)}isShowRowGroupForThisRow(){if(this.gos.get("treeData"))return!0;const t=this.displayedGroupNode.rowGroupColumn;if(!t)return!1;const e=this.params.column;return e==null||e.isRowGroupDisplayed(t.getId())}addExpandAndContract(){var t;const e=this.params,i=je("groupExpanded",this.gos,null),s=je("groupContracted",this.gos,null);i&&this.eExpanded.appendChild(i),s&&this.eContracted.appendChild(s);const r=e.eGridCell;!(((t=this.params.column)==null?void 0:t.isCellEditable(e.node))&&this.gos.get("enableGroupEdit"))&&this.isExpandable()&&!e.suppressDoubleClickExpand&&this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(e.node,ce.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const o=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,ce.EVENT_ALL_CHILDREN_COUNT_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ce.EVENT_MASTER_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ce.EVENT_GROUP_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ce.EVENT_HAS_CHILDREN_CHANGED,o)}onExpandClicked(t){Yi(t)||(Ji(t),this.onExpandOrContract(t))}onExpandOrContract(t){const e=this.displayedGroupNode,i=!e.expanded;!i&&e.sticky&&this.scrollToStickyNode(e),e.setExpanded(i,t)}scrollToStickyNode(t){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(t.rowTop-t.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const t=this.displayedGroupNode,e=this.columnModel.isPivotMode()&&t.leafGroup;if(!(t.isExpandable()&&!t.footer&&!e))return!1;const s=this.params.column;return s!=null&&typeof s.getColDef().showRowGroup=="string"?this.isShowRowGroupForThisRow():!0}showExpandAndContractIcons(){const{params:t,displayedGroupNode:e,columnModel:i}=this,{node:s}=t,r=this.isExpandable();if(r){const u=this.showingValueForOpenedParent?!0:s.expanded;this.comp.setExpandedDisplayed(u),this.comp.setContractedDisplayed(!u)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const n=i.isPivotMode(),o=n&&e.leafGroup,a=r&&!o,l=s.footer&&s.level===-1;this.comp.addOrRemoveCssClass("ag-cell-expandable",a),this.comp.addOrRemoveCssClass("ag-row-group",a),n?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",o):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!a)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const t=this.params.node;this.params.suppressPadding||(this.addManagedListener(t,ce.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gos.get("groupHideOpenParents"))return;const t=this.params,e=t.node,i=!!t.colDef,s=this.gos.get("treeData"),n=!i||s||t.colDef.showRowGroup===!0?e.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+n,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const t=new rn(()=>this.params.value,this.params.node);this.createManagedBean(t,this.context),this.eGui.insertAdjacentElement("afterbegin",t.getGui())}isUserWantsSelected(){const t=this.params.checkbox;return typeof t=="function"||t===!0}addCheckboxIfNeeded(){const t=this.displayedGroupNode,e=this.isUserWantsSelected()&&!t.footer&&!t.rowPinned&&!t.detail;if(e){const i=new Hh;this.getContext().createBean(i),i.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(i.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(i))}this.comp.setCheckboxVisible(e)}onKeyDown(t){!(t.key===N.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(t)}onCellDblClicked(t){if(Yi(t))return;Od(this.eExpanded,t)||Od(this.eContracted,t)||this.onExpandOrContract(t)}};g([T("expressionService")],Ko.prototype,"expressionService",2);g([T("valueService")],Ko.prototype,"valueService",2);g([T("columnModel")],Ko.prototype,"columnModel",2);g([T("userComponentFactory")],Ko.prototype,"userComponentFactory",2);g([T("ctrlsService")],Ko.prototype,"ctrlsService",2);var Sn=class UT extends oe{constructor(){super(UT.TEMPLATE)}init(e){const i={setInnerRenderer:(o,a)=>this.setRenderDetails(o,a),setChildCount:o=>this.eChildCount.textContent=o,addOrRemoveCssClass:(o,a)=>this.addOrRemoveCssClass(o,a),setContractedDisplayed:o=>ve(this.eContracted,o),setExpandedDisplayed:o=>ve(this.eExpanded,o),setCheckboxVisible:o=>this.eCheckbox.classList.toggle("ag-invisible",!o)},s=this.createManagedBean(new Ko),r=!e.colDef,n=this.getGui();s.init(i,n,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),r&&Qe(n,s.getCellAriaRole())}setRenderDetails(e,i){if(e){const s=e.newAgStackInstance();if(!s)return;s.then(r=>{if(!r)return;const n=()=>this.context.destroyBean(r);this.isAlive()?(this.eValue.appendChild(r.getGui()),this.addDestroyFunc(n)):n()})}else this.eValue.innerText=i}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}};Sn.TEMPLATE=`<span class="ag-cell-wrapper">
            <span class="ag-group-expanded" ref="eExpanded"></span>
            <span class="ag-group-contracted" ref="eContracted"></span>
            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>
            <span class="ag-group-value" ref="eValue"></span>
            <span class="ag-group-child-count" ref="eChildCount"></span>
        </span>`;g([q("eExpanded")],Sn.prototype,"eExpanded",2);g([q("eContracted")],Sn.prototype,"eContracted",2);g([q("eCheckbox")],Sn.prototype,"eCheckbox",2);g([q("eValue")],Sn.prototype,"eValue",2);g([q("eChildCount")],Sn.prototype,"eChildCount",2);var dy=Sn,Uh=class WT extends oe{constructor(){super(WT.TEMPLATE)}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=je("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const i=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=i("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}};Uh.TEMPLATE=`<div class="ag-loading">
            <span class="ag-loading-icon" ref="eLoadingIcon"></span>
            <span class="ag-loading-text" ref="eLoadingText"></span>
        </div>`;g([q("eLoadingIcon")],Uh.prototype,"eLoadingIcon",2);g([q("eLoadingText")],Uh.prototype,"eLoadingText",2);var x2=Uh,zT=class $T extends oe{constructor(){super($T.TEMPLATE)}init(e){const i=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",i),this.addDestroyFunc(()=>Do(e.eParentOfValue)),Do(e.eParentOfValue,i),e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const i=e("ariaSkeletonCellLoadingFailed","Row failed to load");Ci(this.getGui(),i)}setupLoading(){const i=this.gos.getDocument().createElement("div");i.classList.add("ag-skeleton-effect"),this.getGui().appendChild(i);const r=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");Ci(this.getGui(),r)}refresh(e){return!1}destroy(){super.destroy()}};zT.TEMPLATE='<div class="ag-skeleton-container"></div>';var P2=zT,jT=class qT extends oe{constructor(){super()}destroy(){super.destroy()}init(e){const i=this.gos.get("overlayLoadingTemplate");if(this.setTemplate(i??qT.DEFAULT_LOADING_OVERLAY_TEMPLATE),!i){const s=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=s("loadingOoo","Loading...")})}}};jT.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>';var I2=jT,KT=class XT extends oe{constructor(){super()}destroy(){super.destroy()}init(e){const i=this.gos.get("overlayNoRowsTemplate");if(this.setTemplate(i??XT.DEFAULT_NO_ROWS_TEMPLATE),!i){const s=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=s("noRowsToShow","No Rows To Show")})}}};KT.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center"></span>';var L2=KT,F2=class extends yn{constructor(){super('<div class="ag-tooltip"></div>')}init(t){const{value:e}=t;this.getGui().textContent=at(e,!0)}},M2=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(t,e){this.eInput=t,this.params=e,e.max!=null&&t.setMax(e.max),e.min!=null&&t.setMin(e.min),e.precision!=null&&t.setPrecision(e.precision),e.step!=null&&t.setStep(e.step);const i=t.getInputElement();e.preventStepping?t.addManagedListener(i,"keydown",this.preventStepping):e.showStepperButtons&&i.classList.add("ag-number-field-input-stepper")}preventStepping(t){(t.key===N.UP||t.key===N.DOWN)&&t.preventDefault()}getValue(){const t=this.eInput.getValue();if(!U(t)&&!U(this.params.value))return this.params.value;let e=this.params.parseValue(t);if(e==null)return e;if(typeof e=="string"){if(e==="")return null;e=Number(e)}return isNaN(e)?null:e}getStartValue(){return this.params.value}},O2=class extends su{constructor(){super(new M2)}},N2=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(t,e){this.eInput=t,this.params=e,e.min!=null&&t.setMin(e.min),e.max!=null&&t.setMax(e.max),e.step!=null&&t.setStep(e.step)}getValue(){const t=this.eInput.getDate();return!U(t)&&!U(this.params.value)?this.params.value:t??null}getStartValue(){const{value:t}=this.params;if(t instanceof Date)return Ai(t,!1)}},k2=class extends su{constructor(){super(new N2)}},G2=class{constructor(t){this.getDataTypeService=t}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(t,e){this.eInput=t,this.params=e,e.min!=null&&t.setMin(e.min),e.max!=null&&t.setMax(e.max),e.step!=null&&t.setStep(e.step)}getValue(){const t=this.formatDate(this.eInput.getDate());return!U(t)&&!U(this.params.value)?this.params.value:this.params.parseValue(t??"")}getStartValue(){var t,e;return Ai((e=this.parseDate((t=this.params.value)!=null?t:void 0))!=null?e:null,!1)}parseDate(t){return this.getDataTypeService().getDateParserFunction(this.params.column)(t)}formatDate(t){return this.getDataTypeService().getDateFormatterFunction(this.params.column)(t)}},QT=class extends su{constructor(){super(new G2(()=>this.dataTypeService))}};g([T("dataTypeService")],QT.prototype,"dataTypeService",2);var pm=class JT extends oe{constructor(){super(JT.TEMPLATE)}init(e){this.params=e,this.updateCheckbox(e);const i=this.eCheckbox.getInputElement();i.setAttribute("tabindex","-1"),Ff(i,"polite"),this.addManagedListener(i,"click",s=>{if(Ji(s),this.eCheckbox.isDisabled())return;const r=this.eCheckbox.getValue();this.onCheckboxChanged(r)}),this.addManagedListener(i,"dblclick",s=>{Ji(s)}),this.addManagedListener(this.params.eGridCell,"keydown",s=>{if(s.key===N.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===this.gos.getActiveDomElement()&&this.eCheckbox.toggle();const r=this.eCheckbox.getValue();this.onCheckboxChanged(r),s.preventDefault()}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var i,s,r;let n,o=!0;if(e.node.group&&e.column){const c=e.column.getColId();c.startsWith(_o)?n=e.value==null||e.value===""?void 0:e.value==="true":e.node.aggData&&e.node.aggData[c]!==void 0?n=(i=e.value)!=null?i:void 0:o=!1}else n=(s=e.value)!=null?s:void 0;if(!o){this.eCheckbox.setDisplayed(!1);return}this.eCheckbox.setValue(n);const a=e.disabled!=null?e.disabled:!((r=e.column)!=null&&r.isCellEditable(e.node));this.eCheckbox.setDisabled(a);const l=this.localeService.getLocaleTextFunc(),u=Ph(l,n),d=a?u:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${u})`;this.eCheckbox.setInputAriaLabel(d)}onCheckboxChanged(e){const{column:i,node:s,rowIndex:r,value:n}=this.params,o={type:S.EVENT_CELL_EDITING_STARTED,column:i,colDef:i==null?void 0:i.getColDef(),data:s.data,node:s,rowIndex:r,rowPinned:s.rowPinned,value:n};this.eventService.dispatchEvent(o);const a=this.params.node.setDataValue(this.params.column,e,"edit"),l={type:S.EVENT_CELL_EDITING_STOPPED,column:i,colDef:i==null?void 0:i.getColDef(),data:s.data,node:s,rowIndex:r,rowPinned:s.rowPinned,value:n,oldValue:n,newValue:e,valueChanged:a};this.eventService.dispatchEvent(l)}};pm.TEMPLATE=`
        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">
            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
        </div>`;g([q("eCheckbox")],pm.prototype,"eCheckbox",2);var V2=pm,ZT=class extends yn{constructor(){super(`
            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}init(t){var e;this.params=t;const i=(e=t.value)!=null?e:void 0;this.eCheckbox.setValue(i),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(i),this.addManagedListener(this.eCheckbox,S.EVENT_FIELD_VALUE_CHANGED,r=>this.setAriaLabel(r.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(t){const e=this.localeService.getLocaleTextFunc(),i=Ph(e,t),s=e("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${s} (${i})`)}};g([q("eCheckbox")],ZT.prototype,"eCheckbox",2);var B2=class extends oe{constructor(){super(),this.setTemplate("<div></div>")}init(t){var e;this.params=t,this.cssClassPrefix=(e=this.params.cssClassPrefix)!=null?e:"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const t=Qt(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?t.appendChild(je("check",this.gos)):this.params.icon&&(Ql(this.params.icon)?t.appendChild(this.params.icon):typeof this.params.icon=="string"?t.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(t)}addName(){const t=Qt(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(t)}addShortcut(){if(this.params.isCompact)return;const t=Qt(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(t)}addSubMenu(){const t=Qt(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),e=this.getGui();if(this.params.subMenu){const i=this.gos.get("enableRtl")?"smallLeft":"smallRight";zs(e,!1),t.appendChild(je(i,this.gos))}e.appendChild(t)}getClassName(t){return`${this.cssClassPrefix}-${t}`}destroy(){super.destroy()}},Vd=class extends z{constructor(){super(...arguments),this.agGridDefaults={agDateInput:_T,agColumnHeader:ag,agColumnGroupHeader:b2,agSortIndicator:dm,agTextColumnFloatingFilter:T2,agNumberColumnFloatingFilter:w2,agDateColumnFloatingFilter:Vh,agReadOnlyFloatingFilter:sm,agAnimateShowChangeCellRenderer:NT,agAnimateSlideCellRenderer:kT,agGroupCellRenderer:dy,agGroupRowRenderer:dy,agLoadingCellRenderer:x2,agSkeletonCellRenderer:P2,agCheckboxCellRenderer:V2,agCellEditor:uy,agTextCellEditor:uy,agNumberCellEditor:O2,agDateCellEditor:k2,agDateStringCellEditor:QT,agSelectCellEditor:cm,agLargeTextCellEditor:_2,agCheckboxCellEditor:ZT,agTextColumnFilter:um,agNumberColumnFilter:xT,agDateColumnFilter:bT,agLoadingOverlay:I2,agNoRowsOverlay:L2,agTooltipComponent:F2,agMenuItem:B2},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}init(){const t=this.gos.get("components");t!=null&&Tt(t,(e,i)=>this.registerJsComponent(e,i))}registerDefaultComponent(t,e){if(this.agGridDefaults[t]){console.error("Trying to overwrite a default component. You should call registerComponent");return}this.agGridDefaults[t]=e}registerJsComponent(t,e){this.jsComps[t]=e}retrieve(t,e){const i=(a,l)=>({componentFromFramework:l,component:a}),s=this.getFrameworkOverrides().frameworkComponent(e,this.gos.get("components"));if(s!=null)return i(s,!0);const r=this.jsComps[e];if(r){const a=this.getFrameworkOverrides().isFrameworkComponent(r);return i(r,a)}const n=this.agGridDefaults[e];if(n)return i(n,!1);const o=this.enterpriseAgDefaultCompsModule[e];return o?_e.__assertRegistered(o,`AG Grid '${t}' component: ${e}`,this.context.getGridId()):bo(()=>{this.warnAboutMissingComponent(t,e)},"MissingComp"+e),null}warnAboutMissingComponent(t,e){const i=[...Object.keys(this.agGridDefaults).filter(r=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(r)),...Object.keys(this.jsComps)],s=Jl(e,i,!0,.8).values;console.warn(`AG Grid: Could not find '${e}' component. It was configured as "${t}: '${e}'" but it wasn't found in the list of registered components.`),s.length>0&&console.warn(`         Did you mean: [${s.slice(0,3)}]?`),console.warn(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}};g([$],Vd.prototype,"init",1);Vd=g([Y("userComponentRegistry")],Vd);var H2={propertyName:"dateComponent",cellRenderer:!1},U2={propertyName:"headerComponent",cellRenderer:!1},W2={propertyName:"headerGroupComponent",cellRenderer:!1},hy={propertyName:"cellRenderer",cellRenderer:!0},z2={propertyName:"loadingCellRenderer",cellRenderer:!0},$2={propertyName:"cellEditor",cellRenderer:!1},cy={propertyName:"innerRenderer",cellRenderer:!0},j2={propertyName:"loadingOverlayComponent",cellRenderer:!1},q2={propertyName:"noRowsOverlayComponent",cellRenderer:!1},K2={propertyName:"tooltipComponent",cellRenderer:!1},lg={propertyName:"filter",cellRenderer:!1},Y2={propertyName:"floatingFilterComponent",cellRenderer:!1},X2={propertyName:"toolPanel",cellRenderer:!1},Q2={propertyName:"statusPanel",cellRenderer:!1},J2={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Z2={propertyName:"loadingCellRenderer",cellRenderer:!0},eO={propertyName:"groupRowRenderer",cellRenderer:!0},tO={propertyName:"detailCellRenderer",cellRenderer:!0},iO={propertyName:"menuItem",cellRenderer:!1},eb=class{static getFloatingFilterType(t){return this.filterToFloatingFilterMapping[t]}};eb.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var cr=class extends z{getHeaderCompDetails(t,e){return this.getCompDetails(t,U2,"agColumnHeader",e)}getHeaderGroupCompDetails(t){const e=t.columnGroup.getColGroupDef();return this.getCompDetails(e,W2,"agColumnGroupHeader",t)}getFullWidthCellRendererDetails(t){return this.getCompDetails(this.gridOptions,J2,null,t,!0)}getFullWidthLoadingCellRendererDetails(t){return this.getCompDetails(this.gridOptions,Z2,"agLoadingCellRenderer",t,!0)}getFullWidthGroupCellRendererDetails(t){return this.getCompDetails(this.gridOptions,eO,"agGroupRowRenderer",t,!0)}getFullWidthDetailCellRendererDetails(t){return this.getCompDetails(this.gridOptions,tO,"agDetailCellRenderer",t,!0)}getInnerRendererDetails(t,e){return this.getCompDetails(t,cy,null,e)}getFullWidthGroupRowInnerCellRenderer(t,e){return this.getCompDetails(t,cy,null,e)}getCellRendererDetails(t,e){return this.getCompDetails(t,hy,null,e)}getLoadingCellRendererDetails(t,e){return this.getCompDetails(t,z2,"agSkeletonCellRenderer",e,!0)}getCellEditorDetails(t,e){return this.getCompDetails(t,$2,"agCellEditor",e,!0)}getFilterDetails(t,e,i){return this.getCompDetails(t,lg,i,e,!0)}getDateCompDetails(t){return this.getCompDetails(this.gridOptions,H2,"agDateInput",t,!0)}getLoadingOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,j2,"agLoadingOverlay",t,!0)}getNoRowsOverlayCompDetails(t){return this.getCompDetails(this.gridOptions,q2,"agNoRowsOverlay",t,!0)}getTooltipCompDetails(t){return this.getCompDetails(t.colDef,K2,"agTooltipComponent",t,!0)}getSetFilterCellRendererDetails(t,e){return this.getCompDetails(t,hy,null,e)}getFloatingFilterCompDetails(t,e,i){return this.getCompDetails(t,Y2,i,e)}getToolPanelCompDetails(t,e){return this.getCompDetails(t,X2,null,e,!0)}getStatusPanelCompDetails(t,e){return this.getCompDetails(t,Q2,null,e,!0)}getMenuItemCompDetails(t,e){return this.getCompDetails(t,iO,"agMenuItem",e,!0)}getCompDetails(t,e,i,s,r=!1){const{propertyName:n,cellRenderer:o}=e;let{compName:a,jsComp:l,fwComp:u,paramsFromSelector:d,popupFromSelector:c,popupPositionFromSelector:C}=this.getCompKeys(t,e,s);const E=R=>{const D=this.userComponentRegistry.retrieve(n,R);D&&(l=D.componentFromFramework?void 0:D.component,u=D.componentFromFramework?D.component:void 0)};if(a!=null&&E(a),l==null&&u==null&&i!=null&&E(i),l&&o&&!this.agComponentUtils.doesImplementIComponent(l)&&(l=this.agComponentUtils.adaptFunction(n,l)),!l&&!u){r&&console.error(`AG Grid: Could not find component ${a}, did you forget to configure this component?`);return}const y=this.mergeParamsWithApplicationProvidedParams(t,e,s,d),_=l==null,b=l||u;return{componentFromFramework:_,componentClass:b,params:y,type:e,popupFromSelector:c,popupPositionFromSelector:C,newAgStackInstance:()=>this.newAgStackInstance(b,_,y,e)}}getCompKeys(t,e,i){const{propertyName:s}=e;let r,n,o,a,l,u;if(t){const d=t,c=d[s+"Selector"],C=c?c(i):null,E=y=>{typeof y=="string"?r=y:y!=null&&y!==!0&&(this.getFrameworkOverrides().isFrameworkComponent(y)?o=y:n=y)};C?(E(C.component),a=C.params,l=C.popup,u=C.popupPosition):E(d[s])}return{compName:r,jsComp:n,fwComp:o,paramsFromSelector:a,popupFromSelector:l,popupPositionFromSelector:u}}newAgStackInstance(t,e,i,s){const r=s.propertyName,n=!e;let o;if(n)o=new t;else{const l=this.componentMetadataProvider.retrieve(r);o=this.frameworkComponentWrapper.wrap(t,l.mandatoryMethodList,l.optionalMethodList,s)}const a=this.initComponent(o,i);return a==null?Pi.resolve(o):a.then(()=>o)}mergeParamsWithApplicationProvidedParams(t,e,i,s=null){const r=this.gos.getGridCommonParams();Yt(r,i);const n=t,o=n&&n[e.propertyName+"Params"];if(typeof o=="function"){const a=o(i);Yt(r,a)}else typeof o=="object"&&Yt(r,o);return Yt(r,s),r}initComponent(t,e){if(this.context.createBean(t),t.init!=null)return t.init(e)}getDefaultFloatingFilterType(t,e){if(t==null)return null;let i=null,{compName:s,jsComp:r,fwComp:n}=this.getCompKeys(t,lg);return s?i=eb.getFloatingFilterType(s):r==null&&n==null&&t.filter===!0&&(i=e()),i}};g([T("gridOptions")],cr.prototype,"gridOptions",2);g([T("agComponentUtils")],cr.prototype,"agComponentUtils",2);g([T("componentMetadataProvider")],cr.prototype,"componentMetadataProvider",2);g([T("userComponentRegistry")],cr.prototype,"userComponentRegistry",2);g([De("frameworkComponentWrapper")],cr.prototype,"frameworkComponentWrapper",2);cr=g([Y("userComponentFactory")],cr);var tb=class{constructor(t){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=t.scrollAxis.indexOf("x")!==-1,this.scrollVertically=t.scrollAxis.indexOf("y")!==-1,this.scrollByTick=t.scrollByTick!=null?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||(()=>!1)}check(t,e=!1){const i=e||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;const s=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=t.clientX<s.left+r,this.tickRight=t.clientX>s.right-r,this.tickUp=t.clientY<s.top+r&&!i,this.tickDown=t.clientY>s.bottom-r&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let t;if(t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){const e=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(e-t),this.tickRight&&this.setHorizontalPosition(e+t)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},yi=class extends z{constructor(t){super(),this.eContainer=t}postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(t=>{const e=t.gridBodyCtrl;this.autoScrollService=new tb({scrollContainer:e.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>e.getScrollFeature().getVScrollPosition().top,setVerticalPosition:i=>e.getScrollFeature().setVerticalScrollPosition(i),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(t){return t===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?ae.ICON_NOT_ALLOWED:ae.ICON_MOVE}shouldPreventRowMove(){return!!(this.columnModel.getRowGroupColumns().length||this.filterManager.isAnyFilterPresent()||this.sortController.isSortActive())}getRowNodes(t){if(!this.isFromThisGrid(t))return t.dragItem.rowNodes||[];const e=t.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const s=[...this.selectionService.getSelectedNodes()].sort((r,n)=>r.rowIndex==null||n.rowIndex==null?0:this.getRowIndexNumber(r)-this.getRowIndexNumber(n));if(s.indexOf(e)!==-1)return s}return[e]}onDragEnter(t){t.dragItem.rowNodes=this.getRowNodes(t),this.dispatchGridEvent(S.EVENT_ROW_DRAG_ENTER,t),this.getRowNodes(t).forEach(e=>{e.setDragging(!0)}),this.onEnterOrDragging(t)}onDragging(t){this.onEnterOrDragging(t)}isFromThisGrid(t){const{dragSourceDomDataKey:e}=t.dragSource;return e===this.gos.getDomDataKey()}isDropZoneWithinThisGrid(t){const i=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:s}=t;return!i.contains(s)}onEnterOrDragging(t){this.dispatchGridEvent(S.EVENT_ROW_DRAG_MOVE,t),this.lastDraggingEvent=t;const e=this.mouseEventService.getNormalisedPosition(t).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(t,e),this.autoScrollService.check(t.event)}doManagedDrag(t,e){const i=this.isFromThisGrid(t),s=this.gos.get("rowDragManaged"),r=t.dragItem.rowNodes;s&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!i?this.isDropZoneWithinThisGrid(t)||this.clientSideRowModel.highlightRowAtPixel(r[0],e):this.moveRows(r,e))}getRowIndexNumber(t){return parseInt(Se(t.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(t){const e=this.clientSideRowModel.getLastHighlightedRowNode(),i=e&&e.highlighted===1,s=this.mouseEventService.getNormalisedPosition(t).y,r=t.dragItem.rowNodes;let n=i?1:0;if(this.isFromThisGrid(t))r.forEach(o=>{o.rowTop<s&&(n-=1)}),this.moveRows(r,s,n);else{const o=this.gos.getCallback("getRowId");let a=this.clientSideRowModel.getRowIndexAtPixel(s)+1;this.clientSideRowModel.getHighlightPosition(s)===0&&a--,this.clientSideRowModel.updateRowData({add:r.map(l=>l.data).filter(l=>!this.clientSideRowModel.getRowNode(o?o({data:l,level:0}):l.id)),addIndex:a})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(t,e,i=0){var s;this.clientSideRowModel.ensureRowsAtPixel(t,e,i)&&(this.focusService.clearFocusedCell(),(s=this.rangeService)==null||s.removeAllCellRanges())}addRowDropZone(t){if(!t.getContainer()){ie("addRowDropZone - A container target needs to be provided");return}if(this.dragAndDropService.findExternalZone(t)){console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");return}let e={getContainer:t.getContainer};t.fromGrid?e=t:(t.onDragEnter&&(e.onDragEnter=i=>{t.onDragEnter(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_ENTER,i))}),t.onDragLeave&&(e.onDragLeave=i=>{t.onDragLeave(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_LEAVE,i))}),t.onDragging&&(e.onDragging=i=>{t.onDragging(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_MOVE,i))}),t.onDragStop&&(e.onDragStop=i=>{t.onDragStop(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_END,i))})),this.dragAndDropService.addDropTarget(te({isInterestedIn:i=>i===2,getIconName:()=>ae.ICON_MOVE,external:!0},e))}getRowDropZone(t){const e=this.getContainer.bind(this),i=this.onDragEnter.bind(this),s=this.onDragLeave.bind(this),r=this.onDragging.bind(this),n=this.onDragStop.bind(this);return t?{getContainer:e,onDragEnter:t.onDragEnter?o=>{i(o),t.onDragEnter(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_ENTER,o))}:i,onDragLeave:t.onDragLeave?o=>{s(o),t.onDragLeave(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_LEAVE,o))}:s,onDragging:t.onDragging?o=>{r(o),t.onDragging(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_MOVE,o))}:r,onDragStop:t.onDragStop?o=>{n(o),t.onDragStop(this.draggingToRowDragEvent(S.EVENT_ROW_DRAG_END,o))}:n,fromGrid:!0}:{getContainer:e,onDragEnter:i,onDragLeave:s,onDragging:r,onDragStop:n,fromGrid:!0}}draggingToRowDragEvent(t,e){const i=this.mouseEventService.getNormalisedPosition(e).y,s=i>this.paginationProxy.getCurrentPageHeight();let r=-1,n;s||(r=this.rowModel.getRowIndexAtPixel(i),n=this.rowModel.getRow(r));let o;switch(e.vDirection){case 1:o="down";break;case 0:o="up";break;default:o=null;break}return this.gos.addGridCommonParams({type:t,event:e.event,node:e.dragItem.rowNode,nodes:e.dragItem.rowNodes,overIndex:r,overNode:n,y:i,vDirection:o})}dispatchGridEvent(t,e){const i=this.draggingToRowDragEvent(t,e);this.eventService.dispatchEvent(i)}onDragLeave(t){this.dispatchGridEvent(S.EVENT_ROW_DRAG_LEAVE,t),this.stopDragging(t),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(t){this.dispatchGridEvent(S.EVENT_ROW_DRAG_END,t),this.stopDragging(t),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(t))&&!this.isDropZoneWithinThisGrid(t)&&this.moveRowAndClearHighlight(t)}stopDragging(t){this.autoScrollService.ensureCleared(),this.getRowNodes(t).forEach(e=>{e.setDragging(!1)})}};g([T("dragAndDropService")],yi.prototype,"dragAndDropService",2);g([T("rowModel")],yi.prototype,"rowModel",2);g([T("paginationProxy")],yi.prototype,"paginationProxy",2);g([T("columnModel")],yi.prototype,"columnModel",2);g([T("focusService")],yi.prototype,"focusService",2);g([T("sortController")],yi.prototype,"sortController",2);g([T("filterManager")],yi.prototype,"filterManager",2);g([T("selectionService")],yi.prototype,"selectionService",2);g([T("mouseEventService")],yi.prototype,"mouseEventService",2);g([T("ctrlsService")],yi.prototype,"ctrlsService",2);g([De("rangeService")],yi.prototype,"rangeService",2);g([$],yi.prototype,"postConstruct",1);var El=class extends z{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(t){const e=t.dragSource.eElement,i=t.mouseDownListener;if(e.removeEventListener("mousedown",i),t.touchEnabled){const s=t.touchStartListener;e.removeEventListener("touchstart",s,{passive:!0})}}removeDragSource(t){const e=this.dragSources.find(i=>i.dragSource===t);e&&(this.removeListener(e),$t(this.dragSources,e))}isDragging(){return this.dragging}addDragSource(t){const e=this.onMouseDown.bind(this,t),{eElement:i,includeTouch:s,stopPropagationForTouch:r}=t;i.addEventListener("mousedown",e);let n=null;const o=this.gos.get("suppressTouch");s&&!o&&(n=a=>{jf(a.target)||(a.cancelable&&(a.preventDefault(),r&&a.stopPropagation()),this.onTouchStart(t,a))},i.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:t,mouseDownListener:e,touchStartListener:n,touchEnabled:!!s})}getStartTarget(){return this.startTarget}onTouchStart(t,e){this.currentDragParams=t,this.dragging=!1;const i=e.touches[0];this.touchLastTime=i,this.touchStart=i;const s=l=>this.onTouchMove(l,t.eElement),r=l=>this.onTouchUp(l,t.eElement),n=l=>{l.cancelable&&l.preventDefault()},o=e.target,a=[{target:this.gos.getRootNode(),type:"touchmove",listener:n,options:{passive:!1}},{target:o,type:"touchmove",listener:s,options:{passive:!0}},{target:o,type:"touchend",listener:r,options:{passive:!0}},{target:o,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),t.dragStartPixels===0&&this.onCommonMove(i,this.touchStart,t.eElement)}onMouseDown(t,e){const i=e;if(t.skipMouseEvent&&t.skipMouseEvent(e)||i._alreadyProcessedByDragService||(i._alreadyProcessedByDragService=!0,e.button!==0))return;this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=e,this.startTarget=e.target;const s=l=>this.onMouseMove(l,t.eElement),r=l=>this.onMouseUp(l,t.eElement),n=l=>l.preventDefault(),o=this.gos.getRootNode(),a=[{target:o,type:"mousemove",listener:s},{target:o,type:"mouseup",listener:r},{target:o,type:"contextmenu",listener:n}];this.addTemporaryEvents(a),t.dragStartPixels===0&&this.onMouseMove(e,t.eElement)}addTemporaryEvents(t){t.forEach(e=>{const{target:i,type:s,listener:r,options:n}=e;i.addEventListener(s,r,n)}),this.dragEndFunctions.push(()=>{t.forEach(e=>{const{target:i,type:s,listener:r,options:n}=e;i.removeEventListener(s,r,n)})})}isEventNearStartEvent(t,e){const{dragStartPixels:i}=this.currentDragParams,s=U(i)?i:4;return tm(t,e,s)}getFirstActiveTouch(t){for(let e=0;e<t.length;e++)if(t[e].identifier===this.touchStart.identifier)return t[e];return null}onCommonMove(t,e,i){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,e))return;this.dragging=!0;const s={type:S.EVENT_DRAG_STARTED,target:i};this.eventService.dispatchEvent(s),this.currentDragParams.onDragStart(e),this.currentDragParams.onDragging(e)}this.currentDragParams.onDragging(t)}onTouchMove(t,e){const i=this.getFirstActiveTouch(t.touches);i&&this.onCommonMove(i,this.touchStart,e)}onMouseMove(t,e){var i;_s()&&((i=this.gos.getDocument().getSelection())==null||i.removeAllRanges()),this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.onCommonMove(t,this.mouseStartEvent,e)}shouldPreventMouseEvent(t){const e=this.gos.get("enableCellTextSelection"),i=t.type==="mousemove";return e&&i&&t.cancelable&&this.mouseEventService.isEventFromThisGrid(t)&&!this.isOverFormFieldElement(t)}isOverFormFieldElement(t){const e=t.target,i=e==null?void 0:e.tagName.toLocaleLowerCase();return!!(i!=null&&i.match("^a$|textarea|input|select|button"))}onTouchUp(t,e){let i=this.getFirstActiveTouch(t.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,e)}onMouseUp(t,e){this.onUpCommon(t,e)}onUpCommon(t,e){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(t);const i={type:S.EVENT_DRAG_STOPPED,target:e};this.eventService.dispatchEvent(i)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(i=>i()),this.dragEndFunctions.length=0}};g([T("mouseEventService")],El.prototype,"mouseEventService",2);g([Vt],El.prototype,"removeAllListeners",1);El=g([Y("dragService")],El);var np="ag-list-item-hovered",ib=class extends z{constructor(t,e,i){super(),this.comp=t,this.virtualList=e,this.params=i,this.currentDragValue=null,this.lastHoveredListItem=null}postConstruct(){this.addManagedListener(this.params.eventSource,this.params.listItemDragStartEvent,this.listItemDragStart.bind(this)),this.addManagedListener(this.params.eventSource,this.params.listItemDragEndEvent,this.listItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(t){this.currentDragValue=this.params.getCurrentDragValue(t),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const t={isInterestedIn:e=>e===this.params.dragSourceType,getIconName:()=>this.moveBlocked?ae.ICON_PINNED:ae.ICON_MOVE,getContainer:()=>this.comp.getGui(),onDragging:e=>this.onDragging(e),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(t)}createAutoScrollService(){const t=this.virtualList.getGui();this.autoScrollService=new tb({scrollContainer:t,scrollAxis:"y",getVerticalPosition:()=>t.scrollTop,setVerticalPosition:e=>t.scrollTop=e})}onDragging(t){if(!this.currentDragValue||this.moveBlocked)return;const e=this.getListDragItem(t),i=this.virtualList.getComponentAt(e.rowIndex);if(!i)return;const s=i.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===e.rowIndex&&this.lastHoveredListItem.position===e.position||(this.autoScrollService.check(t.event),this.clearHoveredItems(),this.lastHoveredListItem=e,rg(s,np),rg(s,`ag-item-highlight-${e.position}`))}getListDragItem(t){const e=this.virtualList.getGui(),i=parseFloat(window.getComputedStyle(e).paddingTop),s=this.virtualList.getRowHeight(),r=this.virtualList.getScrollTop(),n=Math.max(0,(t.y-i+r)/s),o=this.params.getNumRows(this.comp)-1,a=Math.min(o,n)|0;return{rowIndex:a,position:Math.round(n)>n||n>o?"bottom":"top",component:this.virtualList.getComponentAt(a)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${np}`).forEach(e=>{[np,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(i=>{e.classList.remove(i)})}),this.lastHoveredListItem=null}};g([T("dragAndDropService")],ib.prototype,"dragAndDropService",2);g([$],ib.prototype,"postConstruct",1);function Wr(t){const e=t;return e!=null&&e.getFrameworkComponentInstance!=null?e.getFrameworkComponentInstance():t}var me=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel;break}this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl})}__getAlignedGridService(){return this.alignedGridsService}getGridId(){return this.context.getGridId()}addDetailGridInfo(t,e){this.detailGridInfoMap[t]=e}removeDetailGridInfo(t){delete this.detailGridInfoMap[t]}getDetailGridInfo(t){return this.detailGridInfoMap[t]}forEachDetailGridInfo(t){let e=0;Tt(this.detailGridInfoMap,(i,s)=>{U(s)&&(t(s,e),e++)})}getDataAsCsv(t){if(_e.__assertRegistered("@ag-grid-community/csv-export","api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(t)}exportDataAsCsv(t){_e.__assertRegistered("@ag-grid-community/csv-export","api.exportDataAsCsv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(t)}assertNotExcelMultiSheet(t,e){return _e.__assertRegistered("@ag-grid-enterprise/excel-export","api."+t,this.context.getGridId())?this.excelCreator.getFactoryMode()===1?(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1):!0:!1}getDataAsExcel(t){if(this.assertNotExcelMultiSheet("getDataAsExcel",t))return this.excelCreator.getDataAsExcel(t)}exportDataAsExcel(t){this.assertNotExcelMultiSheet("exportDataAsExcel",t)&&this.excelCreator.exportDataAsExcel(t)}getSheetDataForExcel(t){if(_e.__assertRegistered("@ag-grid-enterprise/excel-export","api.getSheetDataForExcel",this.context.getGridId()))return this.excelCreator.setFactoryMode(1),this.excelCreator.getSheetDataForExcel(t)}getMultipleSheetsAsExcel(t){if(_e.__assertRegistered("@ag-grid-enterprise/excel-export","api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(t)}exportMultipleSheetsAsExcel(t){_e.__assertRegistered("@ag-grid-enterprise/excel-export","api.exportMultipleSheetsAsExcel",this.context.getGridId())&&this.excelCreator.exportMultipleSheetsAsExcel(t)}setGridAriaProperty(t,e){if(!t)return;const i=this.ctrlsService.getGridBodyCtrl().getGui(),s=`aria-${t}`;e===null?i.removeAttribute(s):i.setAttribute(s,e)}logMissingRowModel(t,...e){console.error(`AG Grid: api.${t} can only be called when gridOptions.rowModelType is ${e.join(" or ")}`)}logDeprecation(t,e,i,s){ie(`Since ${t} api.${e} is deprecated. Please use ${i} instead. ${s??""}`)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(t){return this.pinnedRowModel.getPinnedTopRow(t)}getPinnedBottomRow(t){return this.pinnedRowModel.getPinnedBottomRow(t)}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}refreshCells(t={}){this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.refreshCells(t))}flashCells(t={}){const e=i=>ie(`Since v31.1 api.flashCells parameter '${i}Delay' is deprecated. Please use '${i}Duration' instead.`);U(t.fadeDelay)&&e("fade"),U(t.flashDelay)&&e("flash"),this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.flashCells(t))}redrawRows(t={}){const e=t?t.rowNodes:void 0;this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.redrawRows(e))}refreshHeader(){this.frameworkOverrides.wrapIncoming(()=>this.ctrlsService.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return ie("Since v31.1 getModel() is deprecated. Please use the appropriate grid API methods instead."),this.rowModel}setRowNodeExpanded(t,e,i,s){this.expansionService.setRowNodeExpanded(t,e,i,s)}onGroupExpandedOrCollapsed(){if(re(this.clientSideRowModel)){this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide");return}this.expansionService.onGroupExpandedOrCollapsed()}refreshClientSideRowModel(t){if(re(this.clientSideRowModel)){this.logMissingRowModel("refreshClientSideRowModel","clientSide");return}this.clientSideRowModel.refreshModel(t)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(t){return this.rowModel.getRowNode(t)}getSizesForCurrentTheme(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!1):this.logMissingRowModel("collapseAll","clientSide","serverSide")}addRenderedRowListener(t,e,i){this.rowRenderer.addRenderedRowListener(t,e,i)}getQuickFilter(){return this.gos.get("quickFilterText")}getAdvancedFilterModel(){return _e.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null}setAdvancedFilterModel(t){this.filterManager.setAdvancedFilterModel(t)}showAdvancedFilterBuilder(){_e.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.showAdvancedFilterBuilder("api")}setNodesSelected(t){if(!t.nodes.every(o=>o.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):o.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),!1):!0))return;const{nodes:i,source:s,newValue:r}=t,n=i;this.selectionService.setNodesSelected({nodes:n,source:s??"api",newValue:r})}selectAll(t="apiSelectAll"){this.selectionService.selectAllRowNodes({source:t})}deselectAll(t="apiSelectAll"){this.selectionService.deselectAllRowNodes({source:t})}selectAllFiltered(t="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source:t,justFiltered:!0})}deselectAllFiltered(t="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})}getServerSideSelectionState(){return re(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getSelectionState()}setServerSideSelectionState(t){if(re(this.serverSideRowModel)){this.logMissingRowModel("setServerSideSelectionState","serverSide");return}this.selectionService.setSelectionState(t,"api")}selectAllOnCurrentPage(t="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})}deselectAllOnCurrentPage(t="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})}showLoadingOverlay(){this.overlayService.showLoadingOverlay()}showNoRowsOverlay(){this.overlayService.showNoRowsOverlay()}hideOverlay(){this.overlayService.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(re(this.clientSideRowModel)){this.logMissingRowModel("getBestCostNodeSelection","clientSide");return}return this.selectionService.getBestCostNodeSelection()}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(t,e="auto"){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(t,e),"ensureVisible")}ensureIndexVisible(t,e){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t,e),"ensureVisible")}ensureNodeVisible(t,e=null){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(t,e),"ensureVisible")}forEachLeafNode(t){if(re(this.clientSideRowModel)){this.logMissingRowModel("forEachLeafNode","clientSide");return}this.clientSideRowModel.forEachLeafNode(t)}forEachNode(t,e){this.rowModel.forEachNode(t,e)}forEachNodeAfterFilter(t){if(re(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilter","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilter(t)}forEachNodeAfterFilterAndSort(t){if(re(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilterAndSort(t)}getFilterInstance(t,e){return ie("'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."),this.filterManager.getFilterInstance(t,e)}getColumnFilterInstance(t){return this.filterManager.getColumnFilterInstance(t)}destroyFilter(t){const e=this.columnModel.getPrimaryColumn(t);if(e)return this.filterManager.destroyFilter(e,"api")}getStatusPanel(t){if(!_e.__assertRegistered("@ag-grid-enterprise/status-bar","api.getStatusPanel",this.context.getGridId()))return;const e=this.statusBarService.getStatusPanel(t);return Wr(e)}getColumnDef(t){const e=this.columnModel.getPrimaryColumn(t);return e?e.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(t="api"){this.filterManager.onFilterChanged({source:t})}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(t){this.frameworkOverrides.wrapIncoming(()=>this.filterManager.setFilterModel(t))}getFilterModel(){return this.filterManager.getFilterModel()}getColumnFilterModel(t){return this.filterManager.getColumnFilterModel(t)}setColumnFilterModel(t,e){return this.filterManager.setColumnFilterModel(t,e)}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(t,e,i){this.focusService.setFocusedCell({rowIndex:t,column:e,rowPinned:i,forceBrowserFocus:!0})}addRowDropZone(t){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(t)}removeRowDropZone(t){const e=this.dragAndDropService.findExternalZone(t);e&&this.dragAndDropService.removeDropTarget(e)}getRowDropZoneParams(t){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(t)}assertSideBarLoaded(t){return _e.__assertRegistered("@ag-grid-enterprise/side-bar","api."+t,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarService.getSideBarComp().isDisplayed()}setSideBarVisible(t){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarService.getSideBarComp().setDisplayed(t)}setSideBarPosition(t){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarService.getSideBarComp().setSideBarPosition(t)}openToolPanel(t){this.assertSideBarLoaded("openToolPanel")&&this.sideBarService.getSideBarComp().openToolPanel(t,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarService.getSideBarComp().close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarService.getSideBarComp().openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarService.getSideBarComp().refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarService.getSideBarComp().isToolPanelShowing()}getToolPanelInstance(t){if(this.assertSideBarLoaded("getToolPanelInstance")){const e=this.sideBarService.getSideBarComp().getToolPanelInstance(t);return Wr(e)}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarService.getSideBarComp().getDef()}resetRowHeights(){if(U(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive()){console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");return}this.clientSideRowModel.resetRowHeights()}}setRowCount(t,e){if(this.serverSideRowModel){if(this.columnModel.isRowGroupEmpty()){this.serverSideRowModel.setRowCount(t,e);return}console.error("AG Grid: setRowCount cannot be used while using row grouping.");return}if(this.infiniteRowModel){this.infiniteRowModel.setRowCount(t,e);return}this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(t,e){return this.logDeprecation("31.3","getValue","getCellValue"),this.getCellValue({colKey:t,rowNode:e})}getCellValue(t){var e;const{colKey:i,rowNode:s,useFormatter:r}=t;let n=(e=this.columnModel.getPrimaryColumn(i))!=null?e:this.columnModel.getGridColumn(i);if(re(n))return null;const o=this.valueService.getValue(n,s);if(r){const a=this.valueService.formatValue(n,s,o);return a??at(o,!0)}return o}addEventListener(t,e){this.apiEventService.addEventListener(t,e)}addGlobalListener(t){this.apiEventService.addGlobalListener(t)}removeEventListener(t,e){this.apiEventService.removeEventListener(t,e)}removeGlobalListener(t){this.apiEventService.removeGlobalListener(t)}dispatchEvent(t){this.eventService.dispatchEvent(t)}destroy(){var t;const e=`See ${this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}`;if(this.destroyCalled)return;const i={type:S.EVENT_GRID_PRE_DESTROYED,state:this.getState()};this.dispatchEvent(i),this.destroyCalled=!0,(t=this.ctrlsService.get("gridCtrl"))==null||t.destroyGridUi(),this.context.destroy(),this.detailGridInfoMap={},Qw(this,["isDestroyed"],e)}isDestroyed(){return this.destroyCalled}resetQuickFilter(){this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(_e.__assertRegistered("@ag-grid-enterprise/range-selection","api.getCellRanges",this.context.getGridId()),null)}addCellRange(t){if(this.rangeService){this.rangeService.addCellRange(t);return}_e.__assertRegistered("@ag-grid-enterprise/range-selection","api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),_e.__assertRegistered("@ag-grid-enterprise/range-selection","gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}assertChart(t,e){if(_e.__assertRegistered("@ag-grid-enterprise/charts","api."+t,this.context.getGridId()))return this.frameworkOverrides.wrapIncoming(()=>e())}getChartModels(){return this.assertChart("getChartModels",()=>this.chartService.getChartModels())}getChartRef(t){return this.assertChart("getChartRef",()=>this.chartService.getChartRef(t))}getChartImageDataURL(t){return this.assertChart("getChartImageDataURL",()=>this.chartService.getChartImageDataURL(t))}downloadChart(t){return this.assertChart("downloadChart",()=>this.chartService.downloadChart(t))}openChartToolPanel(t){return this.assertChart("openChartToolPanel",()=>this.chartService.openChartToolPanel(t))}closeChartToolPanel(t){return this.assertChart("closeChartToolPanel",()=>this.chartService.closeChartToolPanel(t.chartId))}createRangeChart(t){return this.assertChart("createRangeChart",()=>this.chartService.createRangeChart(t))}createPivotChart(t){return this.assertChart("createPivotChart",()=>this.chartService.createPivotChart(t))}createCrossFilterChart(t){return this.assertChart("createCrossFilterChart",()=>this.chartService.createCrossFilterChart(t))}updateChart(t){return this.assertChart("updateChart",()=>this.chartService.updateChart(t))}restoreChart(t,e){return this.assertChart("restoreChart",()=>this.chartService.restoreChart(t,e))}assertClipboard(t,e){_e.__assertRegistered("@ag-grid-enterprise/clipboard","api"+t,this.context.getGridId())&&e()}copyToClipboard(t){this.assertClipboard("copyToClipboard",()=>this.clipboardService.copyToClipboard(t))}cutToClipboard(t){this.assertClipboard("cutToClipboard",()=>this.clipboardService.cutToClipboard(t))}copySelectedRowsToClipboard(t){this.assertClipboard("copySelectedRowsToClipboard",()=>this.clipboardService.copySelectedRowsToClipboard(t))}copySelectedRangeToClipboard(t){this.assertClipboard("copySelectedRangeToClipboard",()=>this.clipboardService.copySelectedRangeToClipboard(t))}copySelectedRangeDown(){this.assertClipboard("copySelectedRangeDown",()=>this.clipboardService.copyRangeDown())}pasteFromClipboard(){this.assertClipboard("pasteFromClipboard",()=>this.clipboardService.pasteFromClipboard())}showColumnMenuAfterButtonClick(t,e){ie("'showColumnMenuAfterButtonClick' is deprecated. Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere.");const i=this.columnModel.getGridColumn(t);this.menuService.showColumnMenu({column:i,buttonElement:e,positionBy:"button"})}showColumnMenuAfterMouseClick(t,e){ie("'showColumnMenuAfterMouseClick' is deprecated. Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere.");let i=this.columnModel.getGridColumn(t);if(i||(i=this.columnModel.getPrimaryColumn(t)),!i){console.error(`AG Grid: column '${t}' not found`);return}this.menuService.showColumnMenu({column:i,mouseEvent:e,positionBy:"mouse"})}showContextMenu(t){const{rowNode:e,column:i,value:s,x:r,y:n}=t||{};let{x:o,y:a}=this.menuService.getContextMenuPosition(e,i);r!=null&&(o=r),n!=null&&(a=n),this.menuService.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX:o,clientY:a}),rowNode:e,column:i,value:s})}showColumnChooser(t){this.menuService.showColumnChooser({chooserParams:t})}showColumnFilter(t){const e=this.columnModel.getGridColumn(t);if(!e){console.error(`AG Grid: column '${t}' not found`);return}this.menuService.showFilterMenu({column:e,containerType:"columnFilter",positionBy:"auto"})}showColumnMenu(t){const e=this.columnModel.getGridColumn(t);if(!e){console.error(`AG Grid: column '${t}' not found`);return}this.menuService.showColumnMenu({column:e,positionBy:"auto"})}hidePopupMenu(){this.menuService.hidePopupMenu()}hideColumnChooser(){this.menuService.hideColumnChooser()}tabToNextCell(t){return this.navigationService.tabToNextCell(!1,t)}tabToPreviousCell(t){return this.navigationService.tabToNextCell(!0,t)}getCellRendererInstances(t={}){return this.rowRenderer.getCellRendererInstances(t).map(Wr)}getCellEditorInstances(t={}){return this.rowRenderer.getCellEditorInstances(t).map(Wr)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(t=!1){this.rowRenderer.stopEditing(t)}startEditingCell(t){const e=this.columnModel.getGridColumn(t.colKey);if(!e){console.warn(`AG Grid: no column found for ${t.colKey}`);return}const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:e};t.rowPinned==null&&this.ensureIndexVisible(t.rowIndex),this.ensureColumnVisible(t.colKey);const r=this.navigationService.getCellByPosition(i);r&&(this.focusService.isCellFocused(i)||this.focusService.setFocusedCell(i),r.startRowOrCellEdit(t.key))}addAggFunc(t,e){this.logDeprecation("v31.1","addAggFunc(key, func)","addAggFuncs({ key: func })"),this.aggFuncService&&this.aggFuncService.addAggFuncs({key:e})}addAggFuncs(t){this.aggFuncService&&this.aggFuncService.addAggFuncs(t)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(t){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransaction","serverSide");return}return this.serverSideTransactionManager.applyTransaction(t)}applyServerSideTransactionAsync(t,e){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransactionAsync","serverSide");return}return this.serverSideTransactionManager.applyTransactionAsync(t,e)}applyServerSideRowData(t){var e,i;const s=(e=t.startRow)!=null?e:0,r=(i=t.route)!=null?i:[];if(s<0){console.warn(`AG Grid: invalid value ${t.startRow} for startRow, the value should be >= 0`);return}this.serverSideRowModel?this.serverSideRowModel.applyRowData(t.successParams,s,r):this.logMissingRowModel("setServerSideDatasource","serverSide")}retryServerSideLoads(){if(!this.serverSideRowModel){this.logMissingRowModel("retryServerSideLoads","serverSide");return}this.serverSideRowModel.retryLoads()}flushServerSideAsyncTransactions(){if(!this.serverSideTransactionManager){this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide");return}return this.serverSideTransactionManager.flushAsyncTransactions()}applyTransaction(t){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransaction","clientSide");return}return this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.updateRowData(t))}applyTransactionAsync(t,e){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransactionAsync","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.batchUpdateRowData(t,e))}flushAsyncTransactions(){if(!this.clientSideRowModel){this.logMissingRowModel("flushAsyncTransactions","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.flushAsyncTransactions())}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(t){if(!this.serverSideRowModel){this.logMissingRowModel("refreshServerSide","serverSide");return}this.serverSideRowModel.refreshStore(t)}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.logDeprecation("v31.1","getFirstDisplayedRow","getFirstDisplayedRowIndex"),this.getFirstDisplayedRowIndex()}getFirstDisplayedRowIndex(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.logDeprecation("v31.1","getLastDisplayedRow","getLastDisplayedRowIndex"),this.getLastDisplayedRowIndex()}getLastDisplayedRowIndex(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(t){return this.rowModel.getRow(t)}getDisplayedRowCount(){return this.rowModel.getRowCount()}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(t){this.paginationProxy.goToPage(t)}sizeColumnsToFit(t){typeof t=="number"?this.columnModel.sizeColumnsToFit(t,"api"):this.gridBodyCtrl.sizeColumnsToFit(t)}setColumnGroupOpened(t,e){this.columnModel.setColumnGroupOpened(t,e,"api")}getColumnGroup(t,e){return this.columnModel.getColumnGroup(t,e)}getProvidedColumnGroup(t){return this.columnModel.getProvidedColumnGroup(t)}getDisplayNameForColumn(t,e){return this.columnModel.getDisplayNameForColumn(t,e)||""}getDisplayNameForColumnGroup(t,e){return this.columnModel.getDisplayNameForColumnGroup(t,e)||""}getColumn(t){return this.columnModel.getPrimaryColumn(t)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(t){return this.columnModel.applyColumnState(t,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(t){this.columnModel.setColumnGroupState(t,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(t){return this.columnModel.getDisplayedColAfter(t)}getDisplayedColBefore(t){return this.columnModel.getDisplayedColBefore(t)}setColumnVisible(t,e){this.logDeprecation("v31.1","setColumnVisible(key,visible)","setColumnsVisible([key],visible)"),this.columnModel.setColumnsVisible([t],e,"api")}setColumnsVisible(t,e){this.columnModel.setColumnsVisible(t,e,"api")}setColumnPinned(t,e){this.logDeprecation("v31.1","setColumnPinned(key,pinned)","setColumnsPinned([key],pinned)"),this.columnModel.setColumnsPinned([t],e,"api")}setColumnsPinned(t,e){this.columnModel.setColumnsPinned(t,e,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(t,e){this.logDeprecation("v31.1","moveColumn(key, toIndex)","moveColumns([key], toIndex)"),this.columnModel.moveColumns([t],e,"api")}moveColumnByIndex(t,e){this.columnModel.moveColumnByIndex(t,e,"api")}moveColumns(t,e){this.columnModel.moveColumns(t,e,"api")}moveRowGroupColumn(t,e){this.columnModel.moveRowGroupColumn(t,e,"api")}setColumnAggFunc(t,e){this.columnModel.setColumnAggFunc(t,e,"api")}setColumnWidth(t,e,i=!0,s="api"){this.logDeprecation("v31.1","setColumnWidth(col, width)","setColumnWidths([{key: col, newWidth: width}])"),this.columnModel.setColumnWidths([{key:t,newWidth:e}],!1,i,s)}setColumnWidths(t,e=!0,i="api"){this.columnModel.setColumnWidths(t,!1,e,i)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(t,e){return this.columnModel.getSecondaryPivotColumn(t,e)}setValueColumns(t){this.columnModel.setValueColumns(t,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(t){this.logDeprecation("v31.1","removeValueColumn(colKey)","removeValueColumns([colKey])"),this.columnModel.removeValueColumns([t],"api")}removeValueColumns(t){this.columnModel.removeValueColumns(t,"api")}addValueColumn(t){this.logDeprecation("v31.1","addValueColumn(colKey)","addValueColumns([colKey])"),this.columnModel.addValueColumns([t],"api")}addValueColumns(t){this.columnModel.addValueColumns(t,"api")}setRowGroupColumns(t){this.columnModel.setRowGroupColumns(t,"api")}removeRowGroupColumn(t){this.logDeprecation("v31.1","removeRowGroupColumn(colKey)","removeRowGroupColumns([colKey])"),this.columnModel.removeRowGroupColumns([t],"api")}removeRowGroupColumns(t){this.columnModel.removeRowGroupColumns(t,"api")}addRowGroupColumn(t){this.logDeprecation("v31.1","addRowGroupColumn(colKey)","addRowGroupColumns([colKey])"),this.columnModel.addRowGroupColumns([t],"api")}addRowGroupColumns(t){this.columnModel.addRowGroupColumns(t,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(t){this.columnModel.setPivotColumns(t,"api")}removePivotColumn(t){this.logDeprecation("v31.1","removePivotColumn(colKey)","removePivotColumns([colKey])"),this.columnModel.removePivotColumns([t],"api")}removePivotColumns(t){this.columnModel.removePivotColumns(t,"api")}addPivotColumn(t){this.logDeprecation("v31.1","addPivotColumn(colKey)","addPivotColumns([colKey])"),this.columnModel.addPivotColumns([t],"api")}addPivotColumns(t){this.columnModel.addPivotColumns(t,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(t,e){return this.logDeprecation("v31.1","autoSizeColumn(key, skipHeader)","autoSizeColumns([key], skipHeader)"),this.columnModel.autoSizeColumns({columns:[t],skipHeader:e,source:"api"})}autoSizeColumns(t,e){this.columnModel.autoSizeColumns({columns:t,skipHeader:e,source:"api"})}autoSizeAllColumns(t){this.columnModel.autoSizeAllColumns("api",t)}setPivotResultColumns(t){this.columnModel.setSecondaryColumns(t,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}getState(){return this.stateService.getState()}getGridOption(t){return this.gos.get(t)}setGridOption(t,e){this.updateGridOptions({[t]:e})}updateGridOptions(t){this.gos.updateGridOptions({options:t})}__internalUpdateGridOptions(t,e){this.gos.updateGridOptions({options:t,force:e,source:"gridOptionsUpdated"})}deprecatedUpdateGridOption(t,e){ie(`set${t.charAt(0).toUpperCase()}${t.slice(1,t.length)} is deprecated. Please use 'api.setGridOption('${t}', newValue)' or 'api.updateGridOptions({ ${t}: newValue })' instead.`),this.setGridOption(t,e)}setPivotMode(t){this.deprecatedUpdateGridOption("pivotMode",t)}setPinnedTopRowData(t){this.deprecatedUpdateGridOption("pinnedTopRowData",t)}setPinnedBottomRowData(t){this.deprecatedUpdateGridOption("pinnedBottomRowData",t)}setPopupParent(t){this.deprecatedUpdateGridOption("popupParent",t)}setSuppressModelUpdateAfterUpdateTransaction(t){this.deprecatedUpdateGridOption("suppressModelUpdateAfterUpdateTransaction",t)}setDataTypeDefinitions(t){this.deprecatedUpdateGridOption("dataTypeDefinitions",t)}setPagination(t){this.deprecatedUpdateGridOption("pagination",t)}paginationSetPageSize(t){this.deprecatedUpdateGridOption("paginationPageSize",t)}setSideBar(t){this.deprecatedUpdateGridOption("sideBar",t)}setSuppressClipboardPaste(t){this.deprecatedUpdateGridOption("suppressClipboardPaste",t)}setGroupRemoveSingleChildren(t){this.deprecatedUpdateGridOption("groupRemoveSingleChildren",t)}setGroupRemoveLowestSingleChildren(t){this.deprecatedUpdateGridOption("groupRemoveLowestSingleChildren",t)}setGroupDisplayType(t){this.deprecatedUpdateGridOption("groupDisplayType",t)}setGroupIncludeFooter(t){this.deprecatedUpdateGridOption("groupIncludeFooter",t)}setGroupIncludeTotalFooter(t){this.deprecatedUpdateGridOption("groupIncludeTotalFooter",t)}setRowClass(t){this.deprecatedUpdateGridOption("rowClass",t)}setDeltaSort(t){this.deprecatedUpdateGridOption("deltaSort",t)}setSuppressRowDrag(t){this.deprecatedUpdateGridOption("suppressRowDrag",t)}setSuppressMoveWhenRowDragging(t){this.deprecatedUpdateGridOption("suppressMoveWhenRowDragging",t)}setSuppressRowClickSelection(t){this.deprecatedUpdateGridOption("suppressRowClickSelection",t)}setEnableAdvancedFilter(t){this.deprecatedUpdateGridOption("enableAdvancedFilter",t)}setIncludeHiddenColumnsInAdvancedFilter(t){this.deprecatedUpdateGridOption("includeHiddenColumnsInAdvancedFilter",t)}setAdvancedFilterParent(t){this.deprecatedUpdateGridOption("advancedFilterParent",t)}setAdvancedFilterBuilderParams(t){this.deprecatedUpdateGridOption("advancedFilterBuilderParams",t)}setQuickFilter(t){ie("setQuickFilter is deprecated. Please use 'api.setGridOption('quickFilterText', newValue)' or 'api.updateGridOptions({ quickFilterText: newValue })' instead."),this.gos.updateGridOptions({options:{quickFilterText:t}})}setExcludeHiddenColumnsFromQuickFilter(t){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",!t)}setIncludeHiddenColumnsInQuickFilter(t){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",t)}setQuickFilterParser(t){this.deprecatedUpdateGridOption("quickFilterParser",t)}setQuickFilterMatcher(t){this.deprecatedUpdateGridOption("quickFilterMatcher",t)}setAlwaysShowHorizontalScroll(t){this.deprecatedUpdateGridOption("alwaysShowHorizontalScroll",t)}setAlwaysShowVerticalScroll(t){this.deprecatedUpdateGridOption("alwaysShowVerticalScroll",t)}setFunctionsReadOnly(t){this.deprecatedUpdateGridOption("functionsReadOnly",t)}setColumnDefs(t,e="api"){ie("setColumnDefs is deprecated. Please use 'api.setGridOption('columnDefs', newValue)' or 'api.updateGridOptions({ columnDefs: newValue })' instead."),this.gos.updateGridOptions({options:{columnDefs:t},source:e})}setAutoGroupColumnDef(t,e="api"){ie("setAutoGroupColumnDef is deprecated. Please use 'api.setGridOption('autoGroupColumnDef', newValue)' or 'api.updateGridOptions({ autoGroupColumnDef: newValue })' instead."),this.gos.updateGridOptions({options:{autoGroupColumnDef:t},source:e})}setDefaultColDef(t,e="api"){ie("setDefaultColDef is deprecated. Please use 'api.setGridOption('defaultColDef', newValue)' or 'api.updateGridOptions({ defaultColDef: newValue })' instead."),this.gos.updateGridOptions({options:{defaultColDef:t},source:e})}setColumnTypes(t,e="api"){ie("setColumnTypes is deprecated. Please use 'api.setGridOption('columnTypes', newValue)' or 'api.updateGridOptions({ columnTypes: newValue })' instead."),this.gos.updateGridOptions({options:{columnTypes:t},source:e})}setTreeData(t){this.deprecatedUpdateGridOption("treeData",t)}setServerSideDatasource(t){this.deprecatedUpdateGridOption("serverSideDatasource",t)}setCacheBlockSize(t){this.deprecatedUpdateGridOption("cacheBlockSize",t)}setDatasource(t){this.deprecatedUpdateGridOption("datasource",t)}setViewportDatasource(t){this.deprecatedUpdateGridOption("viewportDatasource",t)}setRowData(t){this.deprecatedUpdateGridOption("rowData",t)}setEnableCellTextSelection(t){this.deprecatedUpdateGridOption("enableCellTextSelection",t)}setHeaderHeight(t){this.deprecatedUpdateGridOption("headerHeight",t)}setDomLayout(t){this.deprecatedUpdateGridOption("domLayout",t)}setFillHandleDirection(t){this.deprecatedUpdateGridOption("fillHandleDirection",t)}setGroupHeaderHeight(t){this.deprecatedUpdateGridOption("groupHeaderHeight",t)}setFloatingFiltersHeight(t){this.deprecatedUpdateGridOption("floatingFiltersHeight",t)}setPivotHeaderHeight(t){this.deprecatedUpdateGridOption("pivotHeaderHeight",t)}setPivotGroupHeaderHeight(t){this.deprecatedUpdateGridOption("pivotGroupHeaderHeight",t)}setAnimateRows(t){this.deprecatedUpdateGridOption("animateRows",t)}setIsExternalFilterPresent(t){this.deprecatedUpdateGridOption("isExternalFilterPresent",t)}setDoesExternalFilterPass(t){this.deprecatedUpdateGridOption("doesExternalFilterPass",t)}setNavigateToNextCell(t){this.deprecatedUpdateGridOption("navigateToNextCell",t)}setTabToNextCell(t){this.deprecatedUpdateGridOption("tabToNextCell",t)}setTabToNextHeader(t){this.deprecatedUpdateGridOption("tabToNextHeader",t)}setNavigateToNextHeader(t){this.deprecatedUpdateGridOption("navigateToNextHeader",t)}setRowGroupPanelShow(t){this.deprecatedUpdateGridOption("rowGroupPanelShow",t)}setGetGroupRowAgg(t){this.deprecatedUpdateGridOption("getGroupRowAgg",t)}setGetBusinessKeyForNode(t){this.deprecatedUpdateGridOption("getBusinessKeyForNode",t)}setGetChildCount(t){this.deprecatedUpdateGridOption("getChildCount",t)}setProcessRowPostCreate(t){this.deprecatedUpdateGridOption("processRowPostCreate",t)}setGetRowId(t){ie("getRowId is a static property and can no longer be updated.")}setGetRowClass(t){this.deprecatedUpdateGridOption("getRowClass",t)}setIsFullWidthRow(t){this.deprecatedUpdateGridOption("isFullWidthRow",t)}setIsRowSelectable(t){this.deprecatedUpdateGridOption("isRowSelectable",t)}setIsRowMaster(t){this.deprecatedUpdateGridOption("isRowMaster",t)}setPostSortRows(t){this.deprecatedUpdateGridOption("postSortRows",t)}setGetDocument(t){this.deprecatedUpdateGridOption("getDocument",t)}setGetContextMenuItems(t){this.deprecatedUpdateGridOption("getContextMenuItems",t)}setGetMainMenuItems(t){this.deprecatedUpdateGridOption("getMainMenuItems",t)}setProcessCellForClipboard(t){this.deprecatedUpdateGridOption("processCellForClipboard",t)}setSendToClipboard(t){this.deprecatedUpdateGridOption("sendToClipboard",t)}setProcessCellFromClipboard(t){this.deprecatedUpdateGridOption("processCellFromClipboard",t)}setProcessPivotResultColDef(t){this.deprecatedUpdateGridOption("processPivotResultColDef",t)}setProcessPivotResultColGroupDef(t){this.deprecatedUpdateGridOption("processPivotResultColGroupDef",t)}setPostProcessPopup(t){this.deprecatedUpdateGridOption("postProcessPopup",t)}setInitialGroupOrderComparator(t){this.deprecatedUpdateGridOption("initialGroupOrderComparator",t)}setGetChartToolbarItems(t){this.deprecatedUpdateGridOption("getChartToolbarItems",t)}setPaginationNumberFormatter(t){this.deprecatedUpdateGridOption("paginationNumberFormatter",t)}setGetServerSideGroupLevelParams(t){this.deprecatedUpdateGridOption("getServerSideGroupLevelParams",t)}setIsServerSideGroupOpenByDefault(t){this.deprecatedUpdateGridOption("isServerSideGroupOpenByDefault",t)}setIsApplyServerSideTransaction(t){this.deprecatedUpdateGridOption("isApplyServerSideTransaction",t)}setIsServerSideGroup(t){this.deprecatedUpdateGridOption("isServerSideGroup",t)}setGetServerSideGroupKey(t){this.deprecatedUpdateGridOption("getServerSideGroupKey",t)}setGetRowStyle(t){this.deprecatedUpdateGridOption("getRowStyle",t)}setGetRowHeight(t){this.deprecatedUpdateGridOption("getRowHeight",t)}};g([T("rowRenderer")],me.prototype,"rowRenderer",2);g([T("navigationService")],me.prototype,"navigationService",2);g([T("filterManager")],me.prototype,"filterManager",2);g([T("columnModel")],me.prototype,"columnModel",2);g([T("selectionService")],me.prototype,"selectionService",2);g([T("gridOptionsService")],me.prototype,"gos",2);g([T("valueService")],me.prototype,"valueService",2);g([T("alignedGridsService")],me.prototype,"alignedGridsService",2);g([T("eventService")],me.prototype,"eventService",2);g([T("pinnedRowModel")],me.prototype,"pinnedRowModel",2);g([T("context")],me.prototype,"context",2);g([T("rowModel")],me.prototype,"rowModel",2);g([T("sortController")],me.prototype,"sortController",2);g([T("paginationProxy")],me.prototype,"paginationProxy",2);g([T("focusService")],me.prototype,"focusService",2);g([T("dragAndDropService")],me.prototype,"dragAndDropService",2);g([T("menuService")],me.prototype,"menuService",2);g([T("valueCache")],me.prototype,"valueCache",2);g([T("animationFrameService")],me.prototype,"animationFrameService",2);g([T("ctrlsService")],me.prototype,"ctrlsService",2);g([T("overlayService")],me.prototype,"overlayService",2);g([T("stateService")],me.prototype,"stateService",2);g([T("expansionService")],me.prototype,"expansionService",2);g([T("apiEventService")],me.prototype,"apiEventService",2);g([T("frameworkOverrides")],me.prototype,"frameworkOverrides",2);g([T("undoRedoService")],me.prototype,"undoRedoService",2);g([T("rowNodeBlockLoader")],me.prototype,"rowNodeBlockLoader",2);g([De("csvCreator")],me.prototype,"csvCreator",2);g([De("excelCreator")],me.prototype,"excelCreator",2);g([De("rangeService")],me.prototype,"rangeService",2);g([De("clipboardService")],me.prototype,"clipboardService",2);g([De("aggFuncService")],me.prototype,"aggFuncService",2);g([De("statusBarService")],me.prototype,"statusBarService",2);g([De("chartService")],me.prototype,"chartService",2);g([De("ssrmTransactionManager")],me.prototype,"serverSideTransactionManager",2);g([De("sideBarService")],me.prototype,"sideBarService",2);g([$],me.prototype,"init",1);me=g([Y("gridApi")],me);var Jt=class extends z{constructor(){super(...arguments),this.quickFilter=null,this.quickFilterParts=null}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VISIBLE,()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",t=>this.setQuickFilter(t.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}isQuickFilterPresent(){return this.quickFilter!==null}doesRowPassQuickFilter(t){const e=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(e,t):this.quickFilterParts.every(i=>e?this.doesRowPassQuickFilterCache(t,i):this.doesRowPassQuickFilterNoCache(t,i))}resetQuickFilterCache(){this.rowModel.forEachNode(t=>t.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:t,parser:e}=this;t?this.quickFilterParts=e?e(t):t.split(" "):this.quickFilterParts=null}parseQuickFilter(t){return U(t)?this.gos.isRowModelType("clientSide")?t.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(t){if(t!=null&&typeof t!="string"){console.warn(`AG Grid - Grid option quickFilterText only supports string inputs, received: ${typeof t}`);return}const e=this.parseQuickFilter(t);this.quickFilter!==e&&(this.quickFilter=e,this.setQuickFilterParts(),this.dispatchEvent({type:Jt.EVENT_QUICK_FILTER_CHANGED}))}setQuickFilterParserAndMatcher(){const t=this.gos.get("quickFilterParser"),e=this.gos.get("quickFilterMatcher"),i=t!==this.parser||e!==this.matcher;this.parser=t,this.matcher=e,i&&(this.setQuickFilterParts(),this.dispatchEvent({type:Jt.EVENT_QUICK_FILTER_CHANGED}))}onQuickFilterColumnConfigChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchEvent({type:Jt.EVENT_QUICK_FILTER_CHANGED})}doesRowPassQuickFilterNoCache(t,e){return this.columnModel.getAllColumnsForQuickFilter().some(s=>{const r=this.getQuickFilterTextForColumn(s,t);return U(r)&&r.indexOf(e)>=0})}doesRowPassQuickFilterCache(t,e){return this.checkGenerateQuickFilterAggregateText(t),t.quickFilterAggregateText.indexOf(e)>=0}doesRowPassQuickFilterMatcher(t,e){let i;t?(this.checkGenerateQuickFilterAggregateText(e),i=e.quickFilterAggregateText):i=this.getQuickFilterAggregateText(e);const{quickFilterParts:s,matcher:r}=this;return r(s,i)}checkGenerateQuickFilterAggregateText(t){t.quickFilterAggregateText||(t.quickFilterAggregateText=this.getQuickFilterAggregateText(t))}getQuickFilterTextForColumn(t,e){let i=this.valueService.getValue(t,e,!0);const s=t.getColDef();if(s.getQuickFilterText){const r=this.gos.addGridCommonParams({value:i,node:e,data:e.data,column:t,colDef:s});i=s.getQuickFilterText(r)}return U(i)?i.toString().toUpperCase():null}getQuickFilterAggregateText(t){const e=[];return this.columnModel.getAllColumnsForQuickFilter().forEach(s=>{const r=this.getQuickFilterTextForColumn(s,t);U(r)&&e.push(r)}),e.join(Jt.QUICK_FILTER_SEPARATOR)}};Jt.EVENT_QUICK_FILTER_CHANGED="quickFilterChanged";Jt.QUICK_FILTER_SEPARATOR=`
`;g([T("valueService")],Jt.prototype,"valueService",2);g([T("columnModel")],Jt.prototype,"columnModel",2);g([T("rowModel")],Jt.prototype,"rowModel",2);g([$],Jt.prototype,"postConstruct",1);Jt=g([Y("quickFilterService")],Jt);var Fi=class extends z{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue=[]}init(){var t,e,i;this.addManagedListener(this.eventService,S.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VISIBLE,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,S.EVENT_ROW_DATA_UPDATED,()=>this.onNewRowsLoaded("rowDataUpdated")),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",s=>this.setAdvancedFilterModel(s.currentValue)),this.addManagedListener(this.eventService,S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,({enabled:s})=>this.onAdvancedFilterEnabledChanged(s)),this.addManagedListener(this.eventService,S.EVENT_DATA_TYPES_INFERRED,()=>this.processFilterModelUpdateQueue()),this.addManagedListener(this.quickFilterService,Jt.EVENT_QUICK_FILTER_CHANGED,()=>this.onFilterChanged({source:"quickFilter"})),this.initialFilterModel=te({},(i=(e=(t=this.gos.get("initialState"))==null?void 0:t.filter)==null?void 0:e.filterModel)!=null?i:{})}isExternalFilterPresentCallback(){const t=this.gos.getCallback("isExternalFilterPresent");return typeof t=="function"?t({}):!1}doesExternalFilterPass(t){const e=this.gos.get("doesExternalFilterPass");return typeof e=="function"?e(t):!1}setFilterModel(t,e="api"){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}if(this.dataTypeService.isPendingInference()){this.filterModelUpdateQueue.push({model:t,source:e});return}const i=[],s=this.getFilterModel();if(t){const r=im(Object.keys(t));this.allColumnFilters.forEach((n,o)=>{const a=t[o];i.push(this.setModelOnFilterWrapper(n.filterPromise,a)),r.delete(o)}),r.forEach(n=>{const o=this.columnModel.getPrimaryColumn(n)||this.columnModel.getGridColumn(n);if(!o){console.warn("AG Grid: setFilterModel() - no column found for colId: "+n);return}if(!o.isFilterAllowed()){console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+n);return}const a=this.getOrCreateFilterWrapper(o,"NO_UI");if(!a){console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+n);return}i.push(this.setModelOnFilterWrapper(a.filterPromise,t[n]))})}else this.allColumnFilters.forEach(r=>{i.push(this.setModelOnFilterWrapper(r.filterPromise,null))});Pi.all(i).then(()=>{const r=this.getFilterModel(),n=[];this.allColumnFilters.forEach((o,a)=>{const l=s?s[a]:null,u=r?r[a]:null;ge.jsonEquals(l,u)||n.push(o.column)}),n.length>0&&this.onFilterChanged({columns:n,source:e})})}setModelOnFilterWrapper(t,e){return new Pi(i=>{t.then(s=>{typeof s.setModel!="function"&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),i()),(s.setModel(e)||Pi.resolve()).then(()=>i())})})}getFilterModel(){const t={};return this.allColumnFilters.forEach((e,i)=>{const s=this.getModelFromFilterWrapper(e);U(s)&&(t[i]=s)}),t}getModelFromFilterWrapper(t){var e;const s=t.filterPromise.resolveNow(null,r=>r);return s==null?(e=this.initialFilterModel[t.column.getColId()])!=null?e:null:typeof s.getModel!="function"?(console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel"),null):s.getModel()}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(t){var e;t?this.allColumnFilters.size&&(this.allColumnFilters.forEach(i=>this.disposeFilterWrapper(i,"advancedFilterEnabled")),this.onFilterChanged({source:"advancedFilter"})):(e=this.advancedFilterService)!=null&&e.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var t;return!!((t=this.advancedFilterService)!=null&&t.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}doAggregateFiltersPass(t,e){return this.doColumnFiltersPass(t,e,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const t=s=>s?s.isFilterActive?s.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1):!1,e=!!this.gos.getGroupAggFiltering(),i=s=>{if(!s.isPrimary())return!0;const n=!this.columnModel.isPivotActive();return!s.isValueActive()||!n?!1:this.columnModel.isPivotMode()?!0:e};this.allColumnFilters.forEach(s=>{if(s.filterPromise.resolveNow(!1,t)){const r=s.filterPromise.resolveNow(null,n=>n);i(s.column)?this.activeAggregateFilters.push(r):this.activeColumnFilters.push(r)}})}updateFilterFlagInColumns(t,e){this.allColumnFilters.forEach(i=>{const s=i.filterPromise.resolveNow(!1,r=>r.isFilterActive());i.column.setFilterActive(s,t,e)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}doColumnFiltersPass(t,e,i){const{data:s,aggData:r}=t,n=i?this.activeAggregateFilters:this.activeColumnFilters,o=i?r:s;for(let a=0;a<n.length;a++){const l=n[a];if(!(l==null||l===e)){if(typeof l.doesFilterPass!="function")throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:t,data:o}))return!1}}return!0}resetQuickFilterCache(){this.quickFilterService.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gos.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(t){const e=()=>this.onFilterChanged(t);this.rowRenderer.isRefreshInProgress()?setTimeout(e,0):e()}onFilterChanged(t={}){const{source:e,filterInstance:i,additionalEventAttributes:s,columns:r}=t;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",s),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(o=>{o.filterPromise&&o.filterPromise.then(a=>{a&&a!==i&&a.onAnyFilterChanged&&a.onAnyFilterChanged()})});const n={source:e,type:S.EVENT_FILTER_CHANGED,columns:r||[]};s&&Yt(n,s),this.processingFilterChange=!0,this.eventService.dispatchEvent(n),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var t;return!((t=this.gos.get("allowShowChangeAfterFilter"))!=null?t:!1)&&this.processingFilterChange}isQuickFilterPresent(){return this.quickFilterService.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!this.gos.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(t,e){return this.doesRowPassFilter({rowNode:e,filterInstanceToSkip:t})}doesRowPassAggregateFilters(t){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(t.rowNode)||this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(t.rowNode,t.filterInstanceToSkip))}doesRowPassFilter(t){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(t.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(t.rowNode)||this.isColumnFilterPresent()&&!this.doColumnFiltersPass(t.rowNode,t.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(t.rowNode))}onNewRowsLoaded(t){this.allColumnFilters.forEach(e=>{e.filterPromise.then(i=>{i.onNewRowsLoaded&&i.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(t,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(t){return({node:e})=>this.valueService.getValue(t,e,!0)}createGetValue(t){return(e,i)=>{const s=i?this.columnModel.getGridColumn(i):t;return s?this.valueService.getValue(s,e,!0):void 0}}getFilterComponent(t,e,i=!0){var s;if(i)return((s=this.getOrCreateFilterWrapper(t,e))==null?void 0:s.filterPromise)||null;const r=this.cachedFilter(t);return r?r.filterPromise:null}isFilterActive(t){const e=this.cachedFilter(t);return!!e&&e.filterPromise.resolveNow(!1,i=>i.isFilterActive())}getOrCreateFilterWrapper(t,e){if(!t.isFilterAllowed())return null;let i=this.cachedFilter(t);return i||(i=this.createFilterWrapper(t,e),this.setColumnFilterWrapper(t,i)),i}cachedFilter(t){return this.allColumnFilters.get(t.getColId())}getDefaultFilter(t){let e;if(_e.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))e="agSetColumnFilter";else{const i=this.dataTypeService.getBaseDataType(t);i==="number"?e="agNumberColumnFilter":i==="date"||i==="dateString"?e="agDateColumnFilter":e="agTextColumnFilter"}return e}getDefaultFloatingFilter(t){let e;if(_e.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))e="agSetColumnFloatingFilter";else{const i=this.dataTypeService.getBaseDataType(t);i==="number"?e="agNumberColumnFloatingFilter":i==="date"||i==="dateString"?e="agDateColumnFloatingFilter":e="agTextColumnFloatingFilter"}return e}createFilterInstance(t){const e=this.getDefaultFilter(t),i=t.getColDef();let s;const r=He(te({},this.createFilterParams(t,i)),{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(s,t)(),filterChangedCallback:o=>this.filterChangedCallbackFactory(s,t)(o),doesRowPassOtherFilter:o=>this.doesRowPassOtherFilters(s,o)}),n=this.userComponentFactory.getFilterDetails(i,r,e);return n?{filterPromise:()=>{const o=n.newAgStackInstance();return o&&o.then(a=>s=a),o},compDetails:n}:{filterPromise:null,compDetails:null}}createFilterParams(t,e){return this.gos.addGridCommonParams({column:t,colDef:Rf(e),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(t),getValue:this.createGetValue(t),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(t,e){var i;const s={column:t,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:n}=this.createFilterInstance(t);return s.filterPromise=(i=r==null?void 0:r())!=null?i:null,s.compDetails=n,s}onColumnsChanged(){const t=[];this.allColumnFilters.forEach((e,i)=>{let s;e.column.isPrimary()?s=this.columnModel.getPrimaryColumn(i):s=this.columnModel.getGridColumn(i),!(s&&s===e.column)&&(t.push(e.column),this.disposeFilterWrapper(e,"columnChanged"),this.disposeColumnListener(i))}),t.length>0?this.onFilterChanged({columns:t,source:"api"}):this.updateDependantFilters()}updateDependantFilters(){const t=this.columnModel.getGroupAutoColumns();t==null||t.forEach(e=>{e.getColDef().filter==="agGroupColumnFilter"&&this.getOrCreateFilterWrapper(e,"NO_UI")})}isFilterAllowed(t){var e,i;if(this.isAdvancedFilterEnabled()||!t.isFilterAllowed())return!1;const r=this.allColumnFilters.get(t.getColId());return(i=(e=r==null?void 0:r.filterPromise)==null?void 0:e.resolveNow(!0,n=>typeof(n==null?void 0:n.isFilterAllowed)=="function"?n==null?void 0:n.isFilterAllowed():!0))!=null?i:!0}getFloatingFilterCompDetails(t,e){const i=l=>{const u=this.getFilterComponent(t,"NO_UI");u!=null&&u.then(d=>{l(Wr(d))})},s=t.getColDef(),r=He(te({},this.createFilterParams(t,s)),{filterChangedCallback:()=>i(l=>this.filterChangedCallbackFactory(l,t)())}),n=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(s,lg,r);let o=this.userComponentFactory.getDefaultFloatingFilterType(s,()=>this.getDefaultFloatingFilter(t));o==null&&(o="agReadOnlyFloatingFilter");const a={column:t,filterParams:n,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(t),parentFilterInstance:i,showParentFilter:e,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(s,a,o)}getCurrentFloatingFilterParentModel(t){const e=this.getFilterComponent(t,"NO_UI",!1);return e?e.resolveNow(null,i=>i&&i.getModel()):null}destroyFilter(t,e="api"){const i=t.getColId(),s=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialFilterModel[i],s&&(this.disposeFilterWrapper(s,e),this.onFilterChanged({columns:[t],source:"api"}))}disposeColumnListener(t){const e=this.allColumnListeners.get(t);e&&(this.allColumnListeners.delete(t),e())}disposeFilterWrapper(t,e){t.filterPromise.then(i=>{this.getContext().destroyBean(i),t.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(t.column.getColId());const s={type:S.EVENT_FILTER_DESTROYED,source:e,column:t.column};this.eventService.dispatchEvent(s)})}filterModifiedCallbackFactory(t,e){return()=>{const i={type:S.EVENT_FILTER_MODIFIED,column:e,filterInstance:t};this.eventService.dispatchEvent(i)}}filterChangedCallbackFactory(t,e){return i=>{var s;const r=(s=i==null?void 0:i.source)!=null?s:"api",n={filter:t,additionalEventAttributes:i,columns:[e],source:r};this.callOnFilterChangedOutsideRenderCycle(n)}}checkDestroyFilter(t){const e=this.allColumnFilters.get(t);if(!e)return;const i=e.column,{compDetails:s}=i.isFilterAllowed()?this.createFilterInstance(i):{compDetails:null};if(this.areFilterCompsDifferent(e.compDetails,s)){this.destroyFilter(i,"paramsUpdated");return}const r=i.getColDef().filterParams;if(!e.filterPromise){this.destroyFilter(i,"paramsUpdated");return}e.filterPromise.then(n=>{(n!=null&&n.refresh?n.refresh(te(He(te({},this.createFilterParams(i,i.getColDef())),{filterModifiedCallback:this.filterModifiedCallbackFactory(n,i),filterChangedCallback:this.filterChangedCallbackFactory(n,i),doesRowPassOtherFilter:a=>this.doesRowPassOtherFilters(n,a)}),r)):!0)===!1&&this.destroyFilter(i,"paramsUpdated")})}setColumnFilterWrapper(t,e){const i=t.getColId();this.allColumnFilters.set(i,e),this.allColumnListeners.set(i,this.addManagedListener(t,Pe.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(i)))}areFilterCompsDifferent(t,e){if(!e||!t)return!0;const{componentClass:i}=t,{componentClass:s}=e;return!(i===s||(i==null?void 0:i.render)&&(s==null?void 0:s.render)&&i.render===s.render)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(t){if(this.isAdvancedFilterEnabled()){if(this.dataTypeService.isPendingInference()){this.advancedFilterModelUpdateQueue.push(t);return}this.advancedFilterService.setModel(t??null),this.onFilterChanged({source:"advancedFilter"})}}showAdvancedFilterBuilder(t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(t,!0)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvancedFilterEnabled()?!1:this.columnModel.getAllGridColumns().some(e=>e.getColDef().floatingFilter)}getFilterInstance(t,e){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}const i=this.getFilterInstanceImpl(t,r=>{if(!e)return;const n=Wr(r);e(n)});return Wr(i)}getColumnFilterInstance(t){return new Promise(e=>{this.getFilterInstance(t,i=>{e(i)})})}getFilterInstanceImpl(t,e){const i=this.columnModel.getPrimaryColumn(t);if(!i)return;const s=this.getFilterComponent(i,"NO_UI"),r=s&&s.resolveNow(null,n=>n);return r?setTimeout(e,0,r):s&&s.then(n=>{e(n)}),r}warnAdvancedFilters(){ie("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(t){var e;(e=this.advancedFilterService)==null||e.getCtrl().setupHeaderComp(t)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:t,source:e})=>this.setFilterModel(t,e)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:t,model:e,resolve:i})=>{this.setColumnFilterModel(t,e).then(()=>i())}),this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue.forEach(t=>this.setAdvancedFilterModel(t)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(t){const e=this.getFilterWrapper(t);return e?this.getModelFromFilterWrapper(e):null}setColumnFilterModel(t,e){if(this.isAdvancedFilterEnabled())return this.warnAdvancedFilters(),Promise.resolve();if(this.dataTypeService.isPendingInference()){let n=()=>{};const o=new Promise(a=>{n=a});return this.columnFilterModelUpdateQueue.push({key:t,model:e,resolve:n}),o}const i=this.columnModel.getPrimaryColumn(t),s=i?this.getOrCreateFilterWrapper(i,"NO_UI"):null;return s?(n=>new Promise(o=>{n.then(a=>o(a))}))(this.setModelOnFilterWrapper(s.filterPromise,e)):Promise.resolve()}getFilterWrapper(t){var e;const i=this.columnModel.getPrimaryColumn(t);return i&&(e=this.cachedFilter(i))!=null?e:null}destroy(){super.destroy(),this.allColumnFilters.forEach(t=>this.disposeFilterWrapper(t,"gridDestroyed")),this.allColumnListeners.clear()}};g([T("valueService")],Fi.prototype,"valueService",2);g([T("columnModel")],Fi.prototype,"columnModel",2);g([T("rowModel")],Fi.prototype,"rowModel",2);g([T("userComponentFactory")],Fi.prototype,"userComponentFactory",2);g([T("rowRenderer")],Fi.prototype,"rowRenderer",2);g([T("dataTypeService")],Fi.prototype,"dataTypeService",2);g([T("quickFilterService")],Fi.prototype,"quickFilterService",2);g([De("advancedFilterService")],Fi.prototype,"advancedFilterService",2);g([$],Fi.prototype,"init",1);Fi=g([Y("filterManager")],Fi);var Wh=class extends oe{constructor(t,e){super('<div class="ag-filter"></div>'),this.column=t,this.source=e,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedListener(this.eventService,S.EVENT_FILTER_DESTROYED,this.onFilterDestroyed.bind(this))}hasFilter(){return!!this.filterWrapper}getFilter(){var t,e;return(e=(t=this.filterWrapper)==null?void 0:t.filterPromise)!=null?e:null}afterInit(){var t,e,i;return(i=(e=(t=this.filterWrapper)==null?void 0:t.filterPromise)==null?void 0:e.then(()=>{}))!=null?i:Pi.resolve()}afterGuiAttached(t){var e,i;(i=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null||i.then(s=>{var r;(r=s==null?void 0:s.afterGuiAttached)==null||r.call(s,t)})}afterGuiDetached(){var t,e;(e=(t=this.filterWrapper)==null?void 0:t.filterPromise)==null||e.then(i=>{var s;(s=i==null?void 0:i.afterGuiDetached)==null||s.call(i)})}createFilter(t){var e;const{column:i,source:s}=this;this.filterWrapper=this.filterManager.getOrCreateFilterWrapper(i,s),(e=this.filterWrapper)!=null&&e.filterPromise&&this.filterWrapper.filterPromise.then(r=>{let n=r.getGui();if(U(n)||console.warn(`AG Grid: getGui method from filter returned ${n}, it should be a DOM element or an HTML template string.`),typeof n=="string"&&(n=Qt(n)),this.appendChild(n),t){const o={type:S.EVENT_FILTER_OPENED,column:i,source:s,eGui:this.getGui()};this.eventService.dispatchEvent(o)}})}onFilterDestroyed(t){(t.source==="api"||t.source==="paramsUpdated")&&t.column.getId()===this.column.getId()&&this.columnModel.getPrimaryColumn(this.column)&&(tt(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}};g([T("filterManager")],Wh.prototype,"filterManager",2);g([T("columnModel")],Wh.prototype,"columnModel",2);g([$],Wh.prototype,"postConstruct",1);var gm=class extends oe{constructor(t,e){super(t),this.ctrl=e}getCtrl(){return this.ctrl}},En=class sb extends gm{constructor(e){super(sb.TEMPLATE,e)}postConstruct(){const e=this.getGui(),i={addOrRemoveCssClass:(s,r)=>this.addOrRemoveCssClass(s,r),addOrRemoveBodyCssClass:(s,r)=>this.eFloatingFilterBody.classList.toggle(s,r),setButtonWrapperDisplayed:s=>ve(this.eButtonWrapper,s),setCompDetails:s=>this.setCompDetails(s),getFloatingFilterComp:()=>this.compPromise,setWidth:s=>e.style.width=s,setMenuIcon:s=>this.eButtonShowMainFilter.appendChild(s)};this.ctrl.setComp(i,e,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(i=>this.afterCompCreated(i))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}};En.TEMPLATE=`<div class="ag-header-cell ag-floating-filter" role="gridcell">
            <div ref="eFloatingFilterBody" role="presentation"></div>
            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">
                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>
            </div>
        </div>`;g([q("eFloatingFilterBody")],En.prototype,"eFloatingFilterBody",2);g([q("eButtonWrapper")],En.prototype,"eButtonWrapper",2);g([q("eButtonShowMainFilter")],En.prototype,"eButtonShowMainFilter",2);g([$],En.prototype,"postConstruct",1);g([Vt],En.prototype,"destroyFloatingFilterComp",1);var sO=En,zh=class extends z{constructor(t){super(),this.view=t}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const t=this.getDomLayout(),e={autoHeight:t==="autoHeight",normal:t==="normal",print:t==="print"},i=e.autoHeight?"ag-layout-auto-height":e.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(i,e)}getDomLayout(){var t;const e=(t=this.gos.get("domLayout"))!=null?t:"normal";return["normal","print","autoHeight"].indexOf(e)===-1?(ie(`${e} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):e}};g([$],zh.prototype,"postConstruct",1);var Qs=class extends z{constructor(t){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=t,this.resetLastHScrollDebounced=Ot(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=Ot(()=>this.lastScrollSource[0]=null,500)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(t=>{this.centerRowsCtrl=t.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const{fakeHScrollComp:t,fakeVScrollComp:e}=this.ctrlsService.getParams();this.addManagedListener(this.centerRowsCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),t.onScrollCallback(this.onFakeHScroll.bind(this));const i=this.gos.get("debounceVerticalScrollbar"),s=i?Ot(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=i?Ot(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",s),e.onScrollCallback(r)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(t){if(this.centerRowsCtrl==null)return;t===void 0&&(t=this.centerRowsCtrl.getCenterViewportScrollLeft());const i=this.enableRtl?t:-t,{topCenter:s,stickyTopCenter:r,stickyBottomCenter:n,centerHeader:o,bottomCenter:a,fakeHScrollComp:l}=this.ctrlsService.getParams();o.setHorizontalScroll(-i),a.setContainerTranslateX(i),s.setContainerTranslateX(i),r.setContainerTranslateX(i),n.setContainerTranslateX(i);const u=this.centerRowsCtrl.getViewportElement(),d=this.lastScrollSource[1]===0;t=Math.abs(t),d?l.setScrollPosition(t):yl(u,t,this.enableRtl)}isControllingScroll(t,e){return this.lastScrollSource[e]==null?(this.lastScrollSource[e]=t,!0):this.lastScrollSource[e]===t}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(t){const e=this.centerRowsCtrl.getViewportElement(),{scrollLeft:i}=e;if(this.shouldBlockScrollUpdate(1,i,!0))return;let s;t===0?s=vl(e,this.enableRtl):s=this.ctrlsService.get("fakeHScrollComp").getScrollPosition(),this.doHorizontalScroll(Math.round(s)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(t){let e;t===0?e=this.eBodyViewport.scrollTop:e=this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),!this.shouldBlockScrollUpdate(0,e,!0)&&(this.animationFrameService.setScrollTop(e),this.nextScrollTop=e,t===0?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(e):this.eBodyViewport.scrollTop=e,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(t){const e=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===t&&t===e||(this.scrollLeft=t,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(t),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(t){const e={type:S.EVENT_BODY_SCROLL,direction:t===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(e),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const i=He(te({},e),{type:S.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(i)},100)}shouldBlockScrollUpdate(t,e,i=!1){return i&&!Ks()?!1:t===0?this.shouldBlockVerticalScroll(e):this.shouldBlockHorizontalScroll(e)}shouldBlockVerticalScroll(t){const e=Xl(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return t<0||t+e>i}shouldBlockHorizontalScroll(t){const e=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&Cl()){if(t>0)return!0}else if(t<0)return!0;return Math.abs(t)+e>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(t,e=!1){const s=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!e&&this.shouldBlockScrollUpdate(1,t)&&(this.enableRtl&&Cl()?t=t>0?0:s:t=Math.min(Math.max(t,0),s)),yl(this.centerRowsCtrl.getViewportElement(),Math.abs(t),this.enableRtl),this.doHorizontalScroll(t)}setVerticalScrollPosition(t){this.eBodyViewport.scrollTop=t}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(t){const e=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(e+t),this.centerRowsCtrl.getViewportElement().scrollLeft-e}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(t,e=null){const i=this.rowModel.getRowCount();let s=-1;for(let r=0;r<i;r++){const n=this.rowModel.getRow(r);if(typeof t=="function"){if(n&&t(n)){s=r;break}}else if(t===n||t===n.data){s=r;break}}s>=0&&this.ensureIndexVisible(s,e)}ensureIndexVisible(t,e){if(this.gos.isDomLayout("print"))return;const i=this.paginationProxy.getRowCount();if(typeof t!="number"||t<0||t>=i){console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+t);return}const r=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{r||this.paginationProxy.goToPageWithIndex(t);const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),a=n.getStickyBottomHeight(),l=this.paginationProxy.getRow(t);let u;do{const d=l.rowTop,c=l.rowHeight,C=this.paginationProxy.getPixelOffset(),E=l.rowTop-C,y=E+l.rowHeight,_=this.getVScrollPosition(),b=this.heightScaler.getDivStretchOffset(),R=_.top+b,D=_.bottom+b,O=D-R,L=this.heightScaler.getScrollPositionForPixel(E),I=this.heightScaler.getScrollPositionForPixel(y-O),k=Math.min((L+I)/2,E),H=R+o>E,ee=D-a<y;let Q=null;e==="top"?Q=L:e==="bottom"?Q=I:e==="middle"?Q=k:H?Q=L-o:ee&&(Q=I+a),Q!==null&&(this.setVerticalScrollPosition(Q),this.rowRenderer.redraw({afterScroll:!0})),u=d!==l.rowTop||c!==l.rowHeight}while(u);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(t,e="auto"){const i=this.columnModel.getGridColumn(t);if(!i||i.isPinned()||!this.columnModel.isColumnDisplayed(i))return;const s=this.getPositionedHorizontalScroll(i,e);this.getFrameworkOverrides().wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(t,e){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(e),this.setVerticalScrollPosition(t),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(t,e){const{columnBeforeStart:i,columnAfterEnd:s}=this.isColumnOutsideViewport(t),r=this.centerRowsCtrl.getCenterWidth()<t.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?i:s)||r,l=o?s:i;e!=="auto"&&(a=e==="start",l=e==="end");const u=e==="middle";if(a||l||u){const{colLeft:d,colMiddle:c,colRight:C}=this.getColumnBounds(t);return u?c-n/2:a?o?C:d:o?d-n:C-n}return null}isColumnOutsideViewport(t){const{start:e,end:i}=this.getViewportBounds(),{colLeft:s,colRight:r}=this.getColumnBounds(t),n=this.enableRtl,o=n?e>r:i<r,a=n?i<s:e>s;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(t){const e=this.enableRtl,i=this.columnModel.getBodyContainerWidth(),s=t.getActualWidth(),r=t.getLeft(),n=e?-1:1,o=e?i-r:r,a=o+s*n,l=o+s/2*n;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const t=this.centerRowsCtrl.getCenterWidth(),e=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=e,s=t+e;return{start:i,end:s,width:t}}};g([T("ctrlsService")],Qs.prototype,"ctrlsService",2);g([T("animationFrameService")],Qs.prototype,"animationFrameService",2);g([T("paginationProxy")],Qs.prototype,"paginationProxy",2);g([T("rowModel")],Qs.prototype,"rowModel",2);g([T("rowContainerHeightService")],Qs.prototype,"heightScaler",2);g([T("rowRenderer")],Qs.prototype,"rowRenderer",2);g([T("columnModel")],Qs.prototype,"columnModel",2);g([$],Qs.prototype,"postConstruct",1);var rb="ag-force-vertical-scroll",rO="ag-selectable",nO="ag-column-moving",Ht=class extends z{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(t,e,i,s,r,n,o){this.comp=t,this.eGridBody=e,this.eBodyViewport=i,this.eTop=s,this.eBottom=r,this.eStickyTop=n,this.eStickyBottom=o,this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new zh(this.comp)),this.bodyScrollFeature=this.createManagedBean(new Qs(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([s,i,r,n,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(s),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,S.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(t){t.forEach(e=>{this.addManagedListener(e,"focusin",i=>{const{target:s}=i,r=Kr(s,"ag-root",e);e.classList.toggle("ag-has-focus",!r)}),this.addManagedListener(e,"focusout",i=>{const{target:s,relatedTarget:r}=i,n=e.contains(r),o=Kr(r,"ag-root",e);Kr(s,"ag-root",e)||(!n||o)&&e.classList.remove("ag-has-focus")})})}setColumnMovingCss(t){this.comp.setColumnMovingCss(nO,t)}setCellTextSelection(t=!1){this.comp.setCellSelectableCss(rO,t)}onScrollVisibilityChanged(){const t=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const e=t&&this.gos.getScrollbarWidth()||0,i=Wf()?16:0,s=`calc(100% + ${e+i}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(s))}onGridColumnsChanged(){const t=this.columnModel.getAllGridColumns();this.comp.setColumnCount(t.length)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",t=>{if(t.target instanceof HTMLImageElement)return t.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const t=i=>{const s=i.relatedTarget;if(Nd(s)===null){this.rowRenderer.stopEditing();return}let r=e.some(n=>n.contains(s))&&this.mouseEventService.isElementInThisGrid(s);if(!r){const n=this.popupService;r=n.getActivePopups().some(o=>o.contains(s))||n.isElementWithinCustomPopup(s)}r||this.rowRenderer.stopEditing()},e=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];e.forEach(i=>this.addManagedListener(i,"focusout",t))}updateRowCount(){const t=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),e=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,i=e===-1?-1:t+e;this.comp.setRowCount(i)}registerBodyViewportResizeListener(t){this.comp.registerBodyViewportResizeListener(t)}setVerticalScrollPaddingVisible(t){const e=t?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(e)}isVerticalScrollShowing(){const t=this.gos.get("alwaysShowVerticalScroll"),e=t?rb:null,i=this.gos.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(e,t),t||i&&Z0(this.eBodyViewport)}setupRowAnimationCssClass(){const t=()=>{const e=this.gos.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),i=e?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(i,e)};t(),this.addManagedListener(this.eventService,S.EVENT_HEIGHT_SCALE_CHANGED,t),this.addManagedPropertyListener("animateRows",t)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const t=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",t),this.mockContextMenuForIPad(t),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyWheel.bind(this)),this.addManagedListener(this.eStickyBottom,"wheel",this.onStickyWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const t=this.eBodyViewport.querySelector(".ag-full-width-container"),e=this.eBodyViewport.querySelector(".ag-center-cols-viewport");t&&e&&this.addManagedListener(t,"wheel",i=>this.onFullWidthContainerWheel(i,e))}onFullWidthContainerWheel(t,e){!t.deltaX||Math.abs(t.deltaY)>Math.abs(t.deltaX)||!this.mouseEventService.isEventFromThisGrid(t)||(t.preventDefault(),e.scrollBy({left:t.deltaX}))}onBodyViewportContextMenu(t,e,i){if(!t&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(t||i).preventDefault();const{target:s}=t||e;(s===this.eBodyViewport||s===this.ctrlsService.get("center").getViewportElement())&&this.menuService.showContextMenu({mouseEvent:t,touchEvent:i,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(t){if(!Ks())return;const e=new Ct(this.eBodyViewport),i=s=>{t(void 0,s.touchStart,s.touchEvent)};this.addManagedListener(e,Ct.EVENT_LONG_TAP,i),this.addDestroyFunc(()=>e.destroy())}onBodyViewportWheel(t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&t.preventDefault()}onStickyWheel(t){t.preventDefault(),t.offsetY&&this.scrollVertically(t.deltaY)}getGui(){return this.eGridBody}scrollVertically(t){const e=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(e+t),this.eBodyViewport.scrollTop-e}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new yi(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel:t}=this;let e=t.getPinnedTopTotalHeight(),i=t.getPinnedBottomTotalHeight();this.comp.setTopHeight(e),this.comp.setBottomHeight(i),this.comp.setTopDisplay(e?"inherit":"none"),this.comp.setBottomDisplay(i?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(t=0){this.comp.setStickyTopHeight(`${t}px`),this.stickyTopHeight=t}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(t=0){this.comp.setStickyBottomHeight(`${t}px`),this.stickyBottomHeight=t}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(t){if(!t)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const e=this.gos.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${e}px)`)}}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const e=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+this.filterManager.getHeaderHeight(),i=this.pinnedRowModel.getPinnedTopTotalHeight();let s=0;e>0&&(s+=e),i>0&&(s+=i),s>0&&(s+=1),this.comp.setStickyTopTop(`${s}px`)}setStickyBottomOffsetBottom(){const t=this.pinnedRowModel.getPinnedBottomTotalHeight(),i=this.scrollVisibleService.isHorizontalScrollShowing()&&this.gos.getScrollbarWidth()||0,s=t+i;this.comp.setStickyBottomBottom(`${s}px`)}sizeColumnsToFit(t,e){const s=this.isVerticalScrollShowing()?this.gos.getScrollbarWidth():0,n=mn(this.eGridBody)-s;if(n>0){this.columnModel.sizeColumnsToFit(n,"sizeColumnsToFit",!1,t);return}e===void 0?window.setTimeout(()=>{this.sizeColumnsToFit(t,100)},0):e===100?window.setTimeout(()=>{this.sizeColumnsToFit(t,500)},100):e===500?window.setTimeout(()=>{this.sizeColumnsToFit(t,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(t){this.eBodyViewport.addEventListener("scroll",t,{passive:!0})}removeScrollEventListener(t){this.eBodyViewport.removeEventListener("scroll",t)}};g([T("animationFrameService")],Ht.prototype,"animationFrameService",2);g([T("rowContainerHeightService")],Ht.prototype,"rowContainerHeightService",2);g([T("ctrlsService")],Ht.prototype,"ctrlsService",2);g([T("columnModel")],Ht.prototype,"columnModel",2);g([T("scrollVisibleService")],Ht.prototype,"scrollVisibleService",2);g([T("menuService")],Ht.prototype,"menuService",2);g([T("headerNavigationService")],Ht.prototype,"headerNavigationService",2);g([T("dragAndDropService")],Ht.prototype,"dragAndDropService",2);g([T("pinnedRowModel")],Ht.prototype,"pinnedRowModel",2);g([T("rowRenderer")],Ht.prototype,"rowRenderer",2);g([T("popupService")],Ht.prototype,"popupService",2);g([T("mouseEventService")],Ht.prototype,"mouseEventService",2);g([T("rowModel")],Ht.prototype,"rowModel",2);g([T("filterManager")],Ht.prototype,"filterManager",2);var xa="ag-cell-range-selected",oO="ag-cell-range-chart",aO="ag-cell-range-single-cell",lO="ag-cell-range-chart-category",uO="ag-cell-range-handle",dO="ag-cell-range-top",hO="ag-cell-range-right",cO="ag-cell-range-bottom",pO="ag-cell-range-left",gO=class{constructor(t,e){this.beans=t,this.rangeService=t.rangeService,this.selectionHandleFactory=t.selectionHandleFactory,this.cellCtrl=e}setComp(t,e){this.cellComp=t,this.eGui=e,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(xa,this.rangeCount!==0),this.cellComp.addOrRemoveCssClass(`${xa}-1`,this.rangeCount===1),this.cellComp.addOrRemoveCssClass(`${xa}-2`,this.rangeCount===2),this.cellComp.addOrRemoveCssClass(`${xa}-3`,this.rangeCount===3),this.cellComp.addOrRemoveCssClass(`${xa}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass(oO,this.hasChartRange),Ro(this.eGui,this.rangeCount>0?!0:void 0),this.cellComp.addOrRemoveCssClass(aO,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const t=this.getRangeBorders(),e=this.isSingleCell(),i=!e&&t.top,s=!e&&t.right,r=!e&&t.bottom,n=!e&&t.left;this.cellComp.addOrRemoveCssClass(dO,i),this.cellComp.addOrRemoveCssClass(hO,s),this.cellComp.addOrRemoveCssClass(cO,r),this.cellComp.addOrRemoveCssClass(pO,n)}isSingleCell(){const{rangeService:t}=this.beans;return this.rangeCount===1&&!!t&&!t.isMoreThanOneCell()}getHasChartRange(){const{rangeService:t}=this.beans;if(!this.rangeCount||!t)return!1;const e=t.getCellRanges();return e.length>0&&e.every(i=>fi([1,0],i.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const t=this.beans.gos.get("enableRtl");let e=!1,i=!1,s=!1,r=!1;const n=this.cellCtrl.getCellPosition().column,o=this.beans.columnModel;let a,l;t?(a=o.getDisplayedColAfter(n),l=o.getDisplayedColBefore(n)):(a=o.getDisplayedColBefore(n),l=o.getDisplayedColAfter(n));const u=this.rangeService.getCellRanges().filter(d=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),d));a||(r=!0),l||(i=!0);for(let d=0;d<u.length&&!(e&&i&&s&&r);d++){const c=u[d],C=this.rangeService.getRangeStartRow(c),E=this.rangeService.getRangeEndRow(c);!e&&this.beans.rowPositionUtils.sameRow(C,this.cellCtrl.getCellPosition())&&(e=!0),!s&&this.beans.rowPositionUtils.sameRow(E,this.cellCtrl.getCellPosition())&&(s=!0),!r&&a&&c.columns.indexOf(a)<0&&(r=!0),!i&&l&&c.columns.indexOf(l)<0&&(i=!0)}return{top:e,right:i,bottom:s,left:r}}refreshHandle(){if(this.beans.context.isDestroyed())return;const t=this.shouldHaveSelectionHandle();this.selectionHandle&&!t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),t&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass(uO,!!this.selectionHandle)}shouldHaveSelectionHandle(){const t=this.beans.gos,e=this.rangeService.getCellRanges(),i=e.length;if(this.rangeCount<1||i<1)return!1;const s=Se(e),r=this.cellCtrl.getCellPosition(),n=t.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),o=t.get("enableRangeHandle");let a=i===1&&!this.cellCtrl.isEditing()&&(n||o);if(this.hasChartRange){const u=e[0].type===1&&this.rangeService.isCellInSpecificRange(r,e[0]);this.cellComp.addOrRemoveCssClass(lO,u),a=s.type===0}return a&&s.endRow!=null&&this.rangeService.isContiguousRange(s)&&this.rangeService.isBottomRightCell(s,r)}addSelectionHandle(){const t=this.beans.gos,e=Se(this.rangeService.getCellRanges()).type,s=t.get("enableFillHandle")&&re(e)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==s&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(s)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},fO=class extends z{constructor(t,e){super(),this.cellCtrl=t,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListener(this.beans.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}setComp(t){this.eGui=t,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const t=this.column.getRowSpan(this.rowNode);this.rowSpan!==t&&(this.rowSpan=t,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const t=this.getColSpanningList();fs(this.colsSpanning,t)||(this.colsSpanning=t,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const t=this.getCellWidth();this.eGui.style.width=`${t}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((t,e)=>t+e.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const t=this.column.getColSpan(this.rowNode),e=[];if(t===1)e.push(this.column);else{let i=this.column;const s=this.column.getPinned();for(let r=0;i&&r<t&&(e.push(i),i=this.beans.columnModel.getDisplayedColAfter(i),!(!i||re(i)||s!==i.getPinned()));r++);}return e}onLeftChanged(){if(!this.eGui)return;const t=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=t+"px"}getCellLeft(){let t;return this.beans.gos.get("enableRtl")&&this.colsSpanning?t=Se(this.colsSpanning):t=this.column,t.getLeft()}modifyLeftForPrintLayout(t){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()==="left")return t;const e=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(this.column.getPinned()==="right"){const i=this.beans.columnModel.getBodyContainerWidth();return e+i+(t||0)}return e+(t||0)}applyRowSpan(t){if(this.rowSpan===1&&!t)return;const i=this.beans.gos.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${i}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},mO=class extends z{constructor(t,e){super(),this.staticClasses=[],this.cellCtrl=t,this.beans=e,this.column=t.getColumn(),this.rowNode=t.getRowNode()}setComp(t){this.cellComp=t,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const t=this.column.getColDef(),{cellClassRules:e}=t,i=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:t,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(e===this.cellClassRules?void 0:this.cellClassRules,e,i,s=>this.cellComp.addOrRemoveCssClass(s,!0),s=>this.cellComp.addOrRemoveCssClass(s,!1)),this.cellClassRules=e}applyUserStyles(){const t=this.column.getColDef();if(!t.cellStyle)return;let e;if(typeof t.cellStyle=="function"){const i=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex}),s=t.cellStyle;e=s(i)}else e=t.cellStyle;e&&this.cellComp.setUserStyles(e)}applyClassesFromColDef(){const t=this.column.getColDef(),e=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:t,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(i=>this.cellComp.addOrRemoveCssClass(i,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(t,e),this.staticClasses.length&&this.staticClasses.forEach(i=>this.cellComp.addOrRemoveCssClass(i,!0))}destroy(){super.destroy()}},de=class{postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gos.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};g([T("resizeObserverService")],de.prototype,"resizeObserverService",2);g([T("paginationProxy")],de.prototype,"paginationProxy",2);g([T("context")],de.prototype,"context",2);g([T("gridOptionsService")],de.prototype,"gos",2);g([T("environment")],de.prototype,"environment",2);g([T("rowRenderer")],de.prototype,"rowRenderer",2);g([T("valueService")],de.prototype,"valueService",2);g([T("eventService")],de.prototype,"eventService",2);g([T("columnModel")],de.prototype,"columnModel",2);g([T("headerNavigationService")],de.prototype,"headerNavigationService",2);g([T("navigationService")],de.prototype,"navigationService",2);g([T("columnAnimationService")],de.prototype,"columnAnimationService",2);g([T("focusService")],de.prototype,"focusService",2);g([T("popupService")],de.prototype,"popupService",2);g([T("stylingService")],de.prototype,"stylingService",2);g([T("columnHoverService")],de.prototype,"columnHoverService",2);g([T("userComponentFactory")],de.prototype,"userComponentFactory",2);g([T("userComponentRegistry")],de.prototype,"userComponentRegistry",2);g([T("animationFrameService")],de.prototype,"animationFrameService",2);g([T("dragService")],de.prototype,"dragService",2);g([T("dragAndDropService")],de.prototype,"dragAndDropService",2);g([T("sortController")],de.prototype,"sortController",2);g([T("filterManager")],de.prototype,"filterManager",2);g([T("rowContainerHeightService")],de.prototype,"rowContainerHeightService",2);g([T("frameworkOverrides")],de.prototype,"frameworkOverrides",2);g([T("cellPositionUtils")],de.prototype,"cellPositionUtils",2);g([T("rowPositionUtils")],de.prototype,"rowPositionUtils",2);g([T("selectionService")],de.prototype,"selectionService",2);g([T("rowCssClassCalculator")],de.prototype,"rowCssClassCalculator",2);g([T("rowModel")],de.prototype,"rowModel",2);g([T("ctrlsService")],de.prototype,"ctrlsService",2);g([T("ctrlsFactory")],de.prototype,"ctrlsFactory",2);g([T("agStackComponentsRegistry")],de.prototype,"agStackComponentsRegistry",2);g([T("valueCache")],de.prototype,"valueCache",2);g([T("rowNodeEventThrottle")],de.prototype,"rowNodeEventThrottle",2);g([T("localeService")],de.prototype,"localeService",2);g([T("syncService")],de.prototype,"syncService",2);g([T("ariaAnnouncementService")],de.prototype,"ariaAnnouncementService",2);g([De("rangeService")],de.prototype,"rangeService",2);g([De("selectionHandleFactory")],de.prototype,"selectionHandleFactory",2);g([$],de.prototype,"postConstruct",1);de=g([Y("beans")],de);var CO=class extends de{constructor(t,e,i){super(),this.cellCtrl=t,this.beans=e,this.column=i}onMouseEvent(t,e){if(!Yi(e))switch(t){case"click":this.onCellClicked(e);break;case"mousedown":case"touchstart":this.onMouseDown(e);break;case"dblclick":this.onCellDoubleClicked(e);break;case"mouseout":this.onMouseOut(e);break;case"mouseover":this.onMouseOver(e);break}}onCellClicked(t){if(this.isDoubleClickOnIPad()){this.onCellDoubleClicked(t),t.preventDefault();return}const{eventService:e,rangeService:i,gos:s}=this.beans,r=t.ctrlKey||t.metaKey;i&&r&&i.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&i.intersectLastRange(!0);const n=this.cellCtrl.createEvent(t,S.EVENT_CELL_CLICKED);e.dispatchEvent(n);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{o.onCellClicked(n)})},0),(s.get("singleClickEdit")||o.singleClickEdit)&&!s.get("suppressClickEdit")&&!(t.shiftKey&&(i==null?void 0:i.getCellRanges().length)!=0)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!Ks()||If("dblclick"))return!1;const t=new Date().getTime(),e=t-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=t,e}onCellDoubleClicked(t){const e=this.column.getColDef(),i=this.cellCtrl.createEvent(t,S.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(i),typeof e.onCellDoubleClicked=="function"&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{e.onCellDoubleClicked(i)})},0),!this.beans.gos.get("singleClickEdit")&&!this.beans.gos.get("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,t)}onMouseDown(t){const{ctrlKey:e,metaKey:i,shiftKey:s}=t,r=t.target,{cellCtrl:n,beans:o}=this,{eventService:a,rangeService:l,focusService:u}=o;if(this.isRightClickInExistingRange(t))return;const d=l&&l.getCellRanges().length!=0;if(!s||!d){const c=_s()&&!n.isEditing()&&!jf(r);n.focusCell(c)}if(s&&d&&!u.isCellFocused(n.getCellPosition())){t.preventDefault();const c=u.getFocusedCell();if(c){const{column:C,rowIndex:E,rowPinned:y}=c,_=o.rowRenderer.getRowByPosition({rowIndex:E,rowPinned:y}),b=_==null?void 0:_.getCellCtrl(C);b!=null&&b.isEditing()&&b.stopEditing(),u.setFocusedCell({column:C,rowIndex:E,rowPinned:y,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(r)){if(l){const c=this.cellCtrl.getCellPosition();if(s)l.extendLatestRangeToCell(c);else{const C=e||i;l.setRangeToCell(c,C)}}a.dispatchEvent(this.cellCtrl.createEvent(t,S.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(t){const{rangeService:e}=this.beans;if(e){const i=e.isCellInAnyRange(this.cellCtrl.getCellPosition()),s=t.button===2||t.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(i&&s)return!0}return!1}containsWidget(t){return Kr(t,"ag-selection-checkbox",3)}onMouseOut(t){if(this.mouseStayingInsideCell(t))return;const e=this.cellCtrl.createEvent(t,S.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.clearMouseOver()}onMouseOver(t){if(this.mouseStayingInsideCell(t))return;const e=this.cellCtrl.createEvent(t,S.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(t){if(!t.target||!t.relatedTarget)return!1;const e=this.cellCtrl.getGui(),i=e.contains(t.target),s=e.contains(t.relatedTarget);return i&&s}destroy(){}},vO=class extends z{constructor(t,e,i,s,r){super(),this.cellCtrl=t,this.beans=e,this.rowNode=s,this.rowCtrl=r}setComp(t){this.eGui=t}onKeyDown(t){const e=t.key;switch(e){case N.ENTER:this.onEnterKeyDown(t);break;case N.F2:this.onF2KeyDown(t);break;case N.ESCAPE:this.onEscapeKeyDown(t);break;case N.TAB:this.onTabKeyDown(t);break;case N.BACKSPACE:case N.DELETE:this.onBackspaceOrDeleteKeyDown(e,t);break;case N.DOWN:case N.UP:case N.RIGHT:case N.LEFT:this.onNavigationKeyDown(t,e);break}}onNavigationKeyDown(t,e){this.cellCtrl.isEditing()||(t.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(t):this.beans.navigationService.navigateToNextCell(t,e,this.cellCtrl.getCellPosition(),!0),t.preventDefault())}onShiftRangeSelect(t){if(!this.beans.rangeService)return;const e=this.beans.rangeService.extendLatestRangeInDirection(t);e&&this.beans.navigationService.ensureCellVisible(e)}onTabKeyDown(t){this.beans.navigationService.onTabKeyDown(this.cellCtrl,t)}onBackspaceOrDeleteKeyDown(t,e){var i;const{cellCtrl:s,beans:r,rowNode:n}=this,{gos:o,rangeService:a,eventService:l}=r;if(!s.isEditing()){if(l.dispatchEvent({type:S.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),uT(t,o.get("enableCellEditingOnBackspace"))){if(a&&o.get("enableRangeSelection"))a.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(s.isCellEditable()){const u=s.getColumn(),d=(i=this.beans.valueService.parseValue(u,n,"",n.getValueFromValueService(u)))!=null?i:null;n.setDataValue(u,d,"cellClear")}}else s.startRowOrCellEdit(t,e);l.dispatchEvent({type:S.EVENT_KEY_SHORTCUT_CHANGED_CELL_END})}}onEnterKeyDown(t){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,t.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const e=t.shiftKey?N.UP:N.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(N.ENTER,t),this.cellCtrl.isEditing()&&t.preventDefault()}onF2KeyDown(t){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(N.F2,t)}onEscapeKeyDown(t){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(t){if(t.target!==this.eGui||this.cellCtrl.isEditing())return;const s=t.key;s===" "?this.onSpaceKeyDown(t):(this.cellCtrl.startRowOrCellEdit(s,t),t.preventDefault())}onSpaceKeyDown(t){const{gos:e}=this.beans;if(!this.cellCtrl.isEditing()&&e.isRowSelection()){const i=this.rowNode.isSelected(),s=!i;if(s||!e.get("suppressRowDeselection")){const r=this.beans.gos.get("groupSelectsFiltered"),n=this.rowNode.setSelectedParams({newValue:s,rangeSelect:t.shiftKey,groupSelectsFiltered:r,event:t,source:"spaceKey"});i===void 0&&n===0&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:t.shiftKey,groupSelectsFiltered:r,event:t,source:"spaceKey"})}}t.preventDefault()}destroy(){super.destroy()}},nb=class extends oe{constructor(t,e,i){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=t,this.column=e,this.eCell=i}postConstruct(){this.getGui().appendChild(je("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(t){const e=this.column.getColDef().dndSourceOnRowDrag;t.dataTransfer.setDragImage(this.eCell,0,0);const i=()=>{try{const s=JSON.stringify(this.rowNode.data);t.dataTransfer.setData("application/json",s),t.dataTransfer.setData("text/plain",s)}catch{}};if(e){const s=this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:t});e(s)}else i()}checkVisibility(){const t=this.column.isDndSource(this.rowNode);this.setDisplayed(t)}};g([$],nb.prototype,"postConstruct",1);var yO="ag-column-first",SO="ag-column-last",$h=class{static getHeaderClassesFromColDef(t,e,i,s){return re(t)?[]:this.getColumnClassesFromCollDef(t.headerClass,t,e,i,s)}static getToolPanelClassesFromColDef(t,e,i,s){return re(t)?[]:this.getColumnClassesFromCollDef(t.toolPanelClass,t,e,i,s)}static refreshFirstAndLastStyles(t,e,i){t.addOrRemoveCssClass(yO,i.isColumnAtEdge(e,"first")),t.addOrRemoveCssClass(SO,i.isColumnAtEdge(e,"last"))}static getClassParams(t,e,i,s){return e.addGridCommonParams({colDef:t,column:i,columnGroup:s})}static getColumnClassesFromCollDef(t,e,i,s,r){if(re(t))return[];let n;if(typeof t=="function"){const o=this.getClassParams(e,i,s,r);n=t(o)}else n=t;return typeof n=="string"?[n]:Array.isArray(n)?[...n]:[]}},EO="ag-cell",wO="ag-cell-auto-height",TO="ag-cell-normal-height",bO="ag-cell-focus",_O="ag-cell-first-right-pinned",DO="ag-cell-last-left-pinned",RO="ag-cell-not-inline-editing",AO="ag-column-hover",xO="ag-cell-wrap-text",PO=0,ob=class ug extends z{constructor(e,i,s,r){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=e,this.rowNode=i,this.beans=s,this.rowCtrl=r,this.instanceId=e.getId()+"-"+PO++,this.colIdSanitised=at(this.column.getId()),s.gos.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new fO(this,this.beans),this.addDestroyFunc(()=>{var i;(i=this.cellPositionFeature)==null||i.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new mO(this,this.beans),this.addDestroyFunc(()=>{var i;(i=this.cellCustomStyleFeature)==null||i.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new CO(this,this.beans,this.column),this.addDestroyFunc(()=>{var i;(i=this.cellMouseListenerFeature)==null||i.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new vO(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var i;(i=this.cellKeyboardListenerFeature)==null||i.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()})),this.beans.rangeService&&this.beans.gos.get("enableRangeSelection")&&(this.cellRangeFeature=new gO(this.beans,this),this.addDestroyFunc(()=>{var i;(i=this.cellRangeFeature)==null||i.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(e,i){const s=()=>{const o=this.column.getColDef(),a=this.rowNode.data;if(o.tooltipField&&U(a))return lo(a,o.tooltipField,this.column.isTooltipFieldContainsDots());const l=o.tooltipValueGetter;return l?l(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},r=this.beans.gos.get("tooltipShowMode")==="whenTruncated";!i&&r&&!this.isCellRenderer()&&(i=()=>{const o=this.getGui(),a=o.children.length===0?o:o.querySelector(".ag-cell-value");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:e!=null?()=>e:s,getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:i};this.tooltipFeature=new Ys(n,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(e,i,s,r,n){var o,a,l,u;this.cellComp=e,this.eGui=i,this.printLayout=r,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(s),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(o=this.cellPositionFeature)==null||o.setComp(i),(a=this.cellCustomStyleFeature)==null||a.setComp(e),(l=this.tooltipFeature)==null||l.refreshToolTip(),(u=this.cellKeyboardListenerFeature)==null||u.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,i),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(d=>d()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(e){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!e)return;const i=e.parentElement,s=this.beans.gos.getRowHeightForNode(this.rowNode).height,r=a=>{if(this.editing||!this.isAlive())return;const{paddingTop:l,paddingBottom:u,borderBottomWidth:d,borderTopWidth:c}=Sr(i),C=l+u+d+c,y=e.offsetHeight+C;if(a<5){const b=this.beans.gos.getDocument(),R=!b||!b.contains(e),D=y==0;if(R||D){window.setTimeout(()=>r(a+1),0);return}}const _=Math.max(y,s);this.rowNode.setRowAutoHeight(_,this.column)},n=()=>r(0);n();const o=this.beans.resizeObserverService.observeResize(e,n);this.addDestroyFunc(()=>{o(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){var e;return(e=this.column.getColDef().cellAriaRole)!=null?e:"gridcell"}getInstanceId(){return this.instanceId}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){var e;return(e=this.valueFormatted)!=null?e:this.value}showValue(e=!1){var i;const s=this.getValueToDisplay();let r;if(this.rowNode.stub){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),n)}else if(this.isCellRenderer()){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n)}this.cellComp.setRenderDetails(r,s,e),(i=this.cellRangeFeature)==null||i.refreshHandle()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return this.rowNode.rowPinned!=null?!1:typeof e=="function"||e===!0}refreshShouldDestroy(){const e=this.column.getColDef(),i=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),s=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),r=this.includeDndSource!=this.isIncludeControl(e.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return i||s||r||n}startEditing(e=null,i=!1,s=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startEditing(e,i,s)});return}const r=this.createCellEditorParams(e,i),n=this.column.getColDef(),o=this.beans.userComponentFactory.getCellEditorDetails(n,r);this.editCompDetails=o;const a=(o==null?void 0:o.popupFromSelector)!=null?o.popupFromSelector:!!n.cellEditorPopup,l=(o==null?void 0:o.popupPositionFromSelector)!=null?o.popupPositionFromSelector:n.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(o,a,l,this.beans.gos.get("reactiveCustomComponents"));const u=this.createEvent(s,S.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}setEditing(e){var i;this.editing!==e&&(this.editing=e,(i=this.cellRangeFeature)==null||i.refreshHandle())}stopRowOrCellEdit(e=!1){this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.stopEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(e){const i={newValueExists:!1};if(e)return i;const s=this.cellComp.getCellEditor();return!s||s.isCancelAfterEnd&&s.isCancelAfterEnd()?i:{newValue:s.getValue(),newValueExists:!0}}saveNewValue(e,i){if(i===e)return!1;this.suppressRefreshCell=!0;const s=this.rowNode.setDataValue(this.column,i,"edit");return this.suppressRefreshCell=!1,s}stopEditing(e=!1){if(!this.editing)return!1;const{newValue:i,newValueExists:s}=this.takeValueFromCellEditor(e),r=this.rowNode.getValueFromValueService(this.column);let n=!1;return s&&(n=this.saveNewValue(r,i)),this.setEditing(!1),this.cellComp.setEditDetails(),this.editCompDetails=void 0,this.updateAndFormatValue(!1),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(r,i,!e&&!!n),n}dispatchEditingStoppedEvent(e,i,s){const r=He(te({},this.createEvent(null,S.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:i,valueChanged:s});this.beans.eventService.dispatchEvent(r)}createCellEditorParams(e,i){return this.beans.gos.addGridCommonParams({value:this.rowNode.getValueFromValueService(this.column),eventKey:e,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,cellStartedEdit:i,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)})}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:i=>this.beans.valueService.setValue(this.rowNode,this.column,i),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(i,s,r,n)=>this.registerRowDragger(i,s,n),setTooltip:(i,s)=>{var r;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(i,s),(r=this.tooltipFeature)==null||r.refreshToolTip()}})}parseValue(e){return this.beans.valueService.parseValue(this.column,this.rowNode,e,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){var i;this.refreshShouldDestroy()?(i=this.rowCtrl)==null||i.recreateCell(this):this.refreshCell(e)}refreshCell(e){var i,s,r,n;if(this.suppressRefreshCell||this.editing)return;const o=this.column.getColDef(),a=e!=null&&!!e.newData,l=e!=null&&!!e.suppressFlash||!!o.suppressCellFlash,u=o.field==null&&o.valueGetter==null&&o.showRowGroup==null,d=e&&e.forceRefresh||u||a,c=!!this.cellComp,C=this.updateAndFormatValue(c),E=d||C;if(c){if(E){this.showValue(a);const y=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!l&&!y&&(this.beans.gos.get("enableCellChangeFlash")||o.enableCellChangeFlash)&&this.flashCell(),(i=this.cellCustomStyleFeature)==null||i.applyUserStyles(),(s=this.cellCustomStyleFeature)==null||s.applyClassesFromColDef()}(r=this.tooltipFeature)==null||r.refreshToolTip(),(n=this.cellCustomStyleFeature)==null||n.applyCellClassRules()}}stopEditingAndFocus(e=!1,i=!1){this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit(i)}navigateAfterEdit(e){if(this.beans.gos.get("enterNavigatesVerticallyAfterEdit")){const s=e?N.UP:N.DOWN;this.beans.navigationService.navigateToNextCell(null,s,this.getCellPosition(),!1)}}flashCell(e){var i,s;const r=(i=e==null?void 0:e.flashDuration)!=null?i:e==null?void 0:e.flashDelay,n=(s=e==null?void 0:e.fadeDuration)!=null?s:e==null?void 0:e.fadeDelay;this.animateCell("data-changed",r,n)}animateCell(e,i,s){if(!this.cellComp)return;const r=`ag-cell-${e}`,n=`ag-cell-${e}-animation`,{gos:o}=this.beans;i||(i=o.get("cellFlashDuration")),U(s)||(s=o.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(r,!0),this.cellComp.addOrRemoveCssClass(n,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(r,!1),this.cellComp.addOrRemoveCssClass(n,!0),this.eGui.style.transition=`background-color ${s}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.eGui.style.transition="")},s))},i)})}onFlashCells(e){if(!this.cellComp)return;const i=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[i]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){var i;return(i=this.callValueFormatter(e))!=null?i:e}callValueFormatter(e){return this.beans.valueService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const i=this.value,s=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),e?!this.valuesAreEqual(i,this.value)||this.valueFormatted!=s:!0}valuesAreEqual(e,i){const s=this.column.getColDef();return s.equals?s.equals(e,i):e===i}getComp(){return this.cellComp}getValue(){return this.value}addDomData(){const e=this.getGui();this.beans.gos.setDomData(e,ug.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gos.setDomData(e,ug.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(e,i){return this.beans.gos.addGridCommonParams({type:i,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex})}processCharacter(e){var i;(i=this.cellKeyboardListenerFeature)==null||i.processCharacter(e)}onKeyDown(e){var i;(i=this.cellKeyboardListenerFeature)==null||i.onKeyDown(e)}onMouseEvent(e,i){var s;(s=this.cellMouseListenerFeature)==null||s.onMouseEvent(e,i)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var e;this.cellComp&&((e=this.cellPositionFeature)==null||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:e,column:i,beans:s}=this;$h.refreshFirstAndLastStyles(e,i,s.columnModel)}refreshAriaColIndex(){const e=this.beans.columnModel.getAriaColumnIndex(this.column);kf(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var e;return(e=this.cellPositionFeature)==null?void 0:e.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e,i=null){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(e,i)});return}this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,i)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return this.cellRangeFeature!=null}focusCell(e=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass(_O,e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass(DO,e)}onCellFocused(e){if(this.beans.gos.get("suppressCellFocus"))return;const i=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp){i&&(e!=null&&e.forceBrowserFocus)&&(this.focusEventToRestore=e);return}this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass(bO,i),i&&e&&e.forceBrowserFocus&&this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus});const s=this.beans.gos.get("editType")==="fullRow";!i&&!s&&this.editing&&this.stopRowOrCellEdit(),i&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:ys(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass(EO,!0),this.cellComp.addOrRemoveCssClass(RO,!0);const e=this.column.isAutoHeight()==!0;this.cellComp.addOrRemoveCssClass(wO,e),this.cellComp.addOrRemoveCssClass(TO,!e)}onColumnHover(){if(!this.cellComp||!this.beans.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass(AO,e)}onColDefChanged(){if(!this.cellComp)return;if(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),!this.editing)this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0});else{const i=this.getCellEditor();if(i!=null&&i.refresh){const{eventKey:s,cellStartedEdit:r}=this.editCompDetails.params,n=this.createCellEditorParams(s,r),o=this.column.getColDef(),a=this.beans.userComponentFactory.getCellEditorDetails(o,n);i.refresh(a.params)}}}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.cellComp.addOrRemoveCssClass(xO,e)}dispatchCellContextMenuEvent(e){const i=this.column.getColDef(),s=this.createEvent(e,S.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(s),i.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{i.onCellContextMenu(s)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new Hh;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new nb(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,i,s){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,i);return}const r=this.createRowDragComp(e,i,s);r&&(this.customRowDragComp=r,this.addDestroyFunc(()=>{this.beans.context.destroyBean(r),this.customRowDragComp=null}))}createRowDragComp(e,i,s){const r=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=this.beans.gos.isRowModelType("clientSide");if(n){if(!o){ie("managed row dragging is only allowed in the Client Side Row Model");return}if(r){ie("managed row dragging is not possible when doing pagination");return}}const a=new rn(()=>this.value,this.rowNode,this.column,e,i,s);return this.beans.context.createBean(a),a}};ob.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var Xr=ob,IO=0,ab=class dg extends z{constructor(e,i,s,r,n){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=i,this.gos=i.gos,this.rowNode=e,this.paginationPage=i.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=r,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+IO++,this.rowId=at(e.id),this.initRowBusinessKey(),this.rowFocused=i.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=i.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(s),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gos.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=at(e)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getInstanceId(){return this.instanceId}setComp(e,i,s){const r={rowComp:e,element:i,containerType:s};this.allRowGuis.push(r),s==="left"?this.leftGui=r:s==="right"?this.rightGui=r:s==="fullWidth"?this.fullWidthGui=r:this.centerGui=r,this.initialiseRowComp(r),this.rowType!=="FullWidthLoading"&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(e){switch(this.allRowGuis=this.allRowGuis.filter(i=>i.containerType!==e),e){case"left":this.leftGui=void 0;break;case"right":this.rightGui=void 0;break;case"fullWidth":this.fullWidthGui=void 0;break;case"center":this.centerGui=void 0;break}}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const i=e?"none":"";this.allRowGuis.forEach(s=>s.element.style.display=i)}initialiseRowComp(e){const i=this.gos;this.listenOnDomOrder(e),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),i.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const s=e.rowComp;this.getInitialRowClasses(e.containerType).forEach(n=>s.addOrRemoveCssClass(n,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&zs(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(s),this.setRowCompRowBusinessKey(s),i.setDomData(e.element,dg.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>i.setDomData(e.element,dg.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),i.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKeySanitised!=null&&e.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(e){this.rowId=at(this.rowNode.id),this.rowId!=null&&e.setRowId(this.rowId)}executeSlideAndFadeAnimations(e){const{containerType:i}=e;this.slideInAnimation[i]&&(Yp(()=>{this.onTopChanged()}),this.slideInAnimation[i]=!1),this.fadeInAnimation[i]&&(Yp(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[i]=!1)}addRowDraggerToRow(e){if(this.gos.get("enableRangeSelection")){ie("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");return}const i=this.beans.localeService.getLocaleTextFunc(),s=new rn(()=>`1 ${i("rowDragRow","row")}`,this.rowNode,void 0,e.element,void 0,!0),r=this.createBean(s,this.beans.context);this.rowDragComps.push(r)}setupFullWidth(e){const i=this.getPinnedForContainer(e.containerType);if(this.rowType=="FullWidthDetail"&&!_e.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const s=this.createFullWidthCompDetails(e.element,i);e.rowComp.showFullWidth(s)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var e,i;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(s=>{var r;return(r=s==null?void 0:s.rowComp)==null?void 0:r.getFullWidthCellRenderer()}):[(i=(e=this.fullWidthGui)==null?void 0:e.rowComp)==null?void 0:i.getFullWidthCellRenderer()]}getCellElement(e){const i=this.getCellCtrl(e);return i?i.getGui():null}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const i={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(i)}areAllContainersReady(){const e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),i=!!this.centerGui,s=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&i&&s}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow"),i=this.rowNode.isFullWidthCell(),s=this.gos.get("masterDetail")&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&this.gos.isGroupUseEntireRow(r);e?this.rowType="FullWidthLoading":s?this.rowType="FullWidthDetail":i?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,i=!1){if(this.isFullWidth())return;if(e||this.gos.get("suppressAnimationFrame")||this.printLayout){this.updateColumnListsImpl(i);return}this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(e,i,s=null){const r={list:[],map:{}},n=(o,a)=>{r.list.push(a),r.map[o]=a};return i.forEach(o=>{const a=o.getInstanceId();let l=e.map[a];l||(l=new Xr(o,this.rowNode,this.beans,this)),n(a,l)}),e.list.forEach(o=>{if(r.map[o.getColumn().getInstanceId()]!=null)return;if(!this.isCellEligibleToBeRemoved(o,s)){n(o.getColumn().getInstanceId(),o);return}o.destroy()}),r}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach(i=>{const s=this.getCellCtrlsForContainer(i.containerType);i.rowComp.setCellCtrls(s,e)})}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list;default:const i=e;throw new Error(`Unhandled case: ${i}`)}}createAllCellCtrls(){const e=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,e.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=e.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const s=e.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");const r=e.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(e,i){if(e.getColumn().getPinned()!=i)return!0;const o=e.isEditing(),a=this.beans.focusService.isCellFocused(e.getCellPosition());if(o||a){const u=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(u)>=0)}return!0}getDomOrder(){return this.gos.get("ensureDomOrder")||this.gos.isDomLayout("print")}listenOnDomOrder(e){const i=()=>{e.rowComp.setDomOrder(this.getDomOrder())};this.addManagedPropertyListener("domLayout",i),this.addManagedPropertyListener("ensureDomOrder",i)}setAnimateFlags(e){if(this.isSticky()||!e)return;const i=U(this.rowNode.oldRowTop),s=this.beans.columnModel.isPinningLeft(),r=this.beans.columnModel.isPinningRight();if(i){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.slideInAnimation.fullWidth=!0;return}this.slideInAnimation.center=!0,this.slideInAnimation.left=s,this.slideInAnimation.right=r}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.fadeInAnimation.fullWidth=!0;return}this.fadeInAnimation.center=!0,this.fadeInAnimation.left=s,this.fadeInAnimation.right=r}}isEditing(){return this.editingRow}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(a,l)=>a?a.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(a.element,l).params):!0,i=e(this.fullWidthGui,null),s=e(this.centerGui,null),r=e(this.leftGui,"left"),n=e(this.rightGui,"right");return i&&s&&r&&n}addListeners(){this.addManagedListener(this.rowNode,ce.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,ce.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,ce.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,ce.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,this.postProcessCss.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_DRAGGING_CHANGED,this.postProcessRowDragging.bind(this)),this.addManagedListener(this.rowNode,ce.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const e=this.beans.eventService;this.addManagedListener(e,S.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(e,S.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(e,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(e,S.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(e,S.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(e,S.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusChanged.bind(this)),this.addManagedListener(e,S.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(e,S.EVENT_MODEL_UPDATED,this.refreshFirstAndLastRowStyles.bind(this)),this.addManagedListener(e,S.EVENT_COLUMN_MOVED,this.updateColumnLists.bind(this)),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(s=>{this.addRowDraggerToRow(s)});return}this.destroyBeans(this.rowDragComps,this.beans.context),this.rowDragComps=[]}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListener(this.rowNode,ce.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())}),this.addManagedListener(this.rowNode,ce.EVENT_CELL_CHANGED,e=>{this.getAllCellCtrls().forEach(i=>i.onCellChanged(e))})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(s=>s.refreshCell({suppressFlash:!e.update,newData:!e.update})),this.allRowGuis.forEach(s=>{this.setRowCompRowId(s.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(s.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach(i=>{const s=e===0,r=e===1;i.rowComp.addOrRemoveCssClass("ag-row-highlight-above",s),i.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)})}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-dragging",e))}updateExpandedCss(){const e=this.rowNode.isExpandable(),i=this.rowNode.expanded==!0;this.allRowGuis.forEach(s=>{s.rowComp.addOrRemoveCssClass("ag-row-group",e),s.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&i),s.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!i),zs(s.element,e&&i)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:ys(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const i=this.allRowGuis.find(l=>l.element.contains(e.target));if(!((i?i.element:null)===e.target))return;const n=this.rowNode,o=this.beans.focusService.getFocusedCell(),a={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o&&o.column};this.beans.navigationService.navigateToNextCell(e,e.key,a,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||Yi(e))return;const i=this.allRowGuis.find(o=>o.element.contains(e.target)),s=i?i.element:null,r=s===e.target;let n=null;r||(n=this.beans.focusService.findNextFocusableElement(s,!1,e.shiftKey)),(this.isFullWidth()&&r||!n)&&this.beans.navigationService.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var e;const i=(e=this.allRowGuis.find(s=>ti(s.element)))==null?void 0:e.element;return i?i.getBoundingClientRect().top:0}onFullWidthRowFocused(e){var i;const s=this.rowNode,r=e?this.isFullWidth()&&e.rowIndex===s.rowIndex&&e.rowPinned==s.rowPinned:!1,n=this.fullWidthGui?this.fullWidthGui.element:(i=this.centerGui)==null?void 0:i.element;n&&(n.classList.toggle("ag-full-width-focus",r),r&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,i){const s={list:[],map:{}};return e.list.forEach(r=>{r!==i&&(s.list.push(r),s.map[r.getColumn().getInstanceId()]=r)}),s}onMouseEvent(e,i){switch(e){case"dblclick":this.onRowDblClick(i);break;case"click":this.onRowClick(i);break;case"touchstart":case"mousedown":this.onRowMouseDown(i);break}}createRowEvent(e,i){return this.gos.addGridCommonParams({type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:i})}createRowEventWithSource(e,i){const s=this.createRowEvent(e,i);return s.source=this,s}onRowDblClick(e){if(Yi(e))return;const i=this.createRowEventWithSource(S.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(i)}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Kr(e.target,"ag-row-drag",3),!this.isFullWidth())return;const i=this.rowNode,s=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:i.rowIndex,column:s.getAllDisplayedColumns()[0],rowPinned:i.rowPinned,forceBrowserFocus:!0})}onRowClick(e){if(Yi(e)||this.lastMouseDownOnDragger)return;const s=this.createRowEventWithSource(S.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(s);const r=e.ctrlKey||e.metaKey,n=e.shiftKey;if(this.gos.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gos.get("suppressRowClickSelection"))return;const a=this.gos.get("rowMultiSelectWithClick"),l=!this.gos.get("suppressRowDeselection"),u="rowClicked";if(this.rowNode.isSelected())a?this.rowNode.setSelectedParams({newValue:!1,event:e,source:u}):r?l&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:u}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:e,source:u});else{const d=a?!1:!r;this.rowNode.setSelectedParams({newValue:!0,clearSelection:d,rangeSelect:n,event:e,source:u})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gos.isRowSelection()}setupDetailRowAutoHeight(e){if(this.rowType!=="FullWidthDetail"||!this.gos.get("detailRowAutoHeight"))return;const i=()=>{const r=e.clientHeight;if(r!=null&&r>0){const n=()=>{this.rowNode.setRowHeight(r),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};window.setTimeout(n,0)}},s=this.beans.resizeObserverService.observeResize(e,i);this.addDestroyFunc(s),i()}createFullWidthCompDetails(e,i){const s=this.gos.addGridCommonParams({fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,eGridCell:e,eParentOfValue:e,pinned:i,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,n,o,a)=>this.addFullWidthRowDragging(r,n,o,a),setTooltip:(r,n)=>this.refreshRowTooltip(r,n)});switch(this.rowType){case"FullWidthDetail":return this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(s);case"FullWidthGroup":return this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(s);case"FullWidthLoading":return this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(s);default:return this.beans.userComponentFactory.getFullWidthCellRendererDetails(s)}}refreshRowTooltip(e,i){if(!this.fullWidthGui)return;const s={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>e,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:i};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new Ys(s,this.beans))}addFullWidthRowDragging(e,i,s="",r){if(!this.isFullWidth())return;const n=new rn(()=>s,this.rowNode,void 0,e,i,r);this.createBean(n,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(n,this.beans.context)})}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const i="ag-row-level-"+e,s="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(r=>{r.rowComp.addOrRemoveCssClass(i,!0),r.rowComp.addOrRemoveCssClass(s,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),i=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-row-first",e))),this.lastRowOnPage!==i&&(this.lastRowOnPage=i,this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-row-last",i)))}stopEditing(e=!1){if(this.stoppingRowEdit)return;const i=this.getAllCellCtrls(),s=this.editingRow;this.stoppingRowEdit=!0;let r=!1;for(const n of i){const o=n.stopEditing(e);s&&!e&&!r&&o&&(r=!0)}if(r){const n=this.createRowEvent(S.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(n)}s&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(e){this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),i.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)})}setEditingRow(e){this.editingRow=e,this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-row-editing",e));const i=e?this.createRowEvent(S.EVENT_ROW_EDITING_STARTED):this.createRowEvent(S.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(i)}startRowEditing(e=null,i=null,s=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((n,o)=>{const a=o===i;return a?o.startEditing(e,a,s):o.startEditing(null,a,s),n?!0:o.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!e||!e.length||e.forEach(i=>{this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass(i,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,e=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(e,!0))},e=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(e,!1))})}setStylesFromGridOptions(e,i){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(i,s=>s.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"?"left":e==="right"?"right":null}getInitialRowClasses(e){const i=this.getPinnedForContainer(e),s={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:i};return this.beans.rowCssClassCalculator.getInitialRowClasses(s)}processStylesFromGridOptions(){const e=this.gos.get("rowStyle");if(e&&typeof e=="function"){console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");return}const i=this.gos.getCallback("getRowStyle");let s;if(i){const r={data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex};s=i(r)}return s||e?Object.assign({},e,s):this.emptyStyle}onRowSelected(e){const i=!!this.rowNode.isSelected();this.forEachGui(e,s=>{s.rowComp.addOrRemoveCssClass("ag-row-selected",i),Ro(s.element,i),s.element.contains(this.beans.gos.getActiveDomElement())&&(s===this.centerGui||s===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const e=this.rowNode.isSelected();if(e&&this.beans.gos.get("suppressRowDeselection"))return;const s=this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(s)}addHoverFunctionality(e){this.active&&(this.addManagedListener(e,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(e,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,ce.EVENT_MOUSE_ENTER,()=>{!this.beans.dragService.isDragging()&&!this.gos.get("suppressRowHoverHighlight")&&(e.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,ce.EVENT_MOUSE_LEAVE,()=>{e.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(e){const i=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),s=this.applyPaginationOffset(i.top,!0)-100,r=this.applyPaginationOffset(i.bottom,!0)+100;return Math.min(Math.max(s,e),r)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,i){e?i(e):this.allRowGuis.forEach(i)}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const i=this.rowNode.rowHeight,s=this.beans.environment.getDefaultRowHeight(),n=this.gos.isGetRowHeightFunction()?this.gos.getRowHeightForNode(this.rowNode).height:void 0,o=n?`${Math.min(s,n)-2}px`:void 0;this.forEachGui(e,a=>{a.element.style.height=`${i}px`,o&&a.element.style.setProperty("--ag-line-height",o)})}addEventListener(e,i){super.addEventListener(e,i)}removeEventListener(e,i){super.removeEventListener(e,i)}destroyFirstPass(e=!1){if(this.active=!1,!e&&this.gos.isAnimateRows()&&!this.isSticky())if(this.rowNode.rowTop!=null){const r=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const i=this.createRowEvent(S.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(i),this.beans.eventService.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const e=i=>(i.list.forEach(s=>s.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,i=>{i.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),i.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,i=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const s=this.beans.paginationProxy.getPixelOffset();return e+s*(i?1:-1)}setRowTop(e){if(!this.printLayout&&U(e)){const i=this.applyPaginationOffset(e),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?i:this.beans.rowContainerHeightService.getRealPixelPosition(i)}px`;this.setRowTopStyle(n)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let i;if(this.isSticky())i=this.rowNode.stickyRowTop;else{const s=this.slideInAnimation[e]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,r=this.applyPaginationOffset(s);i=this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return i+"px"}setRowTopStyle(e){this.allRowGuis.forEach(i=>this.suppressRowTransform?i.rowComp.setTop(e):i.rowComp.setTransform(`translateY(${e})`))}getRowNode(){return this.rowNode}getCellCtrl(e){let i=null;return this.getAllCellCtrls().forEach(s=>{s.getColumn()==e&&(i=s)}),i!=null||this.getAllCellCtrls().forEach(s=>{s.getColSpanningList().indexOf(e)>=0&&(i=s)}),i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(e){const i=this.rowNode.getRowIndexString(),s=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),r=this.rowNode.rowIndex%2===0,n=s+this.rowNode.rowIndex+1;this.forEachGui(e,o=>{o.rowComp.setRowIndex(i),o.rowComp.addOrRemoveCssClass("ag-row-even",r),o.rowComp.addOrRemoveCssClass("ag-row-odd",!r),Nf(o.element,n)})}};ab.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Qr=ab,ri=class extends z{constructor(t){super(),this.element=t}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const t="keydown",e=this.processKeyboardEvent.bind(this,t);this.addManagedListener(this.element,t,e)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",If("touchstart")?"touchstart":"mousedown"].forEach(i=>{const s=this.processMouseEvent.bind(this,i);this.addManagedListener(this.element,i,s)})}processMouseEvent(t,e){if(!this.mouseEventService.isEventFromThisGrid(e)||Yi(e))return;const i=this.getRowForEvent(e),s=this.mouseEventService.getRenderedCellForEvent(e);t==="contextmenu"?this.handleContextMenuMouseEvent(e,void 0,i,s):(s&&s.onMouseEvent(t,e),i&&i.onMouseEvent(t,e))}mockContextMenuForIPad(){if(!Ks())return;const t=new Ct(this.element),e=i=>{const s=this.getRowForEvent(i.touchEvent),r=this.mouseEventService.getRenderedCellForEvent(i.touchEvent);this.handleContextMenuMouseEvent(void 0,i.touchEvent,s,r)};this.addManagedListener(t,Ct.EVENT_LONG_TAP,e),this.addDestroyFunc(()=>t.destroy())}getRowForEvent(t){let e=t.target;for(;e;){const i=this.gos.getDomData(e,Qr.DOM_DATA_KEY_ROW_CTRL);if(i)return i;e=e.parentElement}return null}handleContextMenuMouseEvent(t,e,i,s){const r=i?i.getRowNode():null,n=s?s.getColumn():null;let o=null;if(n){const u=t||e;s.dispatchCellContextMenuEvent(u??null),o=this.valueService.getValue(n,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=s?s.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:t,touchEvent:e,rowNode:r,column:n,value:o,anchorToElement:l})}getControlsForEventTarget(t){return{cellCtrl:Md(this.gos,t,Xr.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Md(this.gos,t,Qr.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(t,e){const{cellCtrl:i,rowCtrl:s}=this.getControlsForEventTarget(e.target);e.defaultPrevented||(i?this.processCellKeyboardEvent(i,t,e):s&&s.isFullWidth()&&this.processFullWidthRowKeyboardEvent(s,t,e))}processCellKeyboardEvent(t,e,i){const s=t.getRowNode(),r=t.getColumn(),n=t.isEditing();if(!kd(this.gos,i,s,r,n)&&e==="keydown"&&(!n&&this.navigationService.handlePageScrollingKey(i)||t.onKeyDown(i),this.doGridOperations(i,t.isEditing()),Fh(i)&&t.processCharacter(i)),e==="keydown"){const a=t.createEvent(i,S.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(a)}}processFullWidthRowKeyboardEvent(t,e,i){const s=t.getRowNode(),r=this.focusService.getFocusedCell(),n=r&&r.column;if(!kd(this.gos,i,s,n,!1)){const a=i.key;if(e==="keydown")switch(a){case N.PAGE_HOME:case N.PAGE_END:case N.PAGE_UP:case N.PAGE_DOWN:this.navigationService.handlePageScrollingKey(i,!0);break;case N.UP:case N.DOWN:t.onKeyboardNavigate(i);break;case N.TAB:t.onTabKeyDown(i);break}}if(e==="keydown"){const a=t.createRowEvent(S.EVENT_CELL_KEY_DOWN,i);this.eventService.dispatchEvent(a)}}doGridOperations(t,e){if(!t.ctrlKey&&!t.metaKey||e||!this.mouseEventService.isEventFromThisGrid(t))return;const i=lT(t);if(i===N.A)return this.onCtrlAndA(t);if(i===N.C)return this.onCtrlAndC(t);if(i===N.D)return this.onCtrlAndD(t);if(i===N.V)return this.onCtrlAndV(t);if(i===N.X)return this.onCtrlAndX(t);if(i===N.Y)return this.onCtrlAndY();if(i===N.Z)return this.onCtrlAndZ(t)}onCtrlAndA(t){const{pinnedRowModel:e,paginationProxy:i,rangeService:s}=this;if(s&&i.isRowsToRender()){const[r,n]=[e.isEmpty("top"),e.isEmpty("bottom")],o=r?null:"top";let a,l;n?(a=null,l=this.paginationProxy.getRowCount()-1):(a="bottom",l=e.getPinnedBottomRowData().length-1);const u=this.columnModel.getAllDisplayedColumns();if(bi(u))return;s.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:l,rowEndPinned:a,columnStart:u[0],columnEnd:Se(u)})}t.preventDefault()}onCtrlAndC(t){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:e,rowCtrl:i}=this.getControlsForEventTarget(t.target);e!=null&&e.isEditing()||i!=null&&i.isEditing()||(t.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(t){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:e,rowCtrl:i}=this.getControlsForEventTarget(t.target);e!=null&&e.isEditing()||i!=null&&i.isEditing()||(t.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(t){const{cellCtrl:e,rowCtrl:i}=this.getControlsForEventTarget(t.target);e!=null&&e.isEditing()||i!=null&&i.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(t){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),t.preventDefault()}onCtrlAndZ(t){this.gos.get("undoRedoCellEditing")&&(t.preventDefault(),t.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}};g([T("mouseEventService")],ri.prototype,"mouseEventService",2);g([T("valueService")],ri.prototype,"valueService",2);g([T("menuService")],ri.prototype,"menuService",2);g([T("ctrlsService")],ri.prototype,"ctrlsService",2);g([T("navigationService")],ri.prototype,"navigationService",2);g([T("focusService")],ri.prototype,"focusService",2);g([T("undoRedoService")],ri.prototype,"undoRedoService",2);g([T("columnModel")],ri.prototype,"columnModel",2);g([T("paginationProxy")],ri.prototype,"paginationProxy",2);g([T("pinnedRowModel")],ri.prototype,"pinnedRowModel",2);g([De("rangeService")],ri.prototype,"rangeService",2);g([De("clipboardService")],ri.prototype,"clipboardService",2);g([$],ri.prototype,"postConstruct",1);var Yo=class extends z{constructor(t){super(),this.centerContainerCtrl=t}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl,this.listenForResize()}),this.addManagedListener(this.eventService,S.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this)),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const t=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(t),this.gridBodyCtrl.registerBodyViewportResizeListener(t)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const t=this.centerContainerCtrl.getCenterWidth();t!==this.centerWidth&&(this.centerWidth=t,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const t=this.gridBodyCtrl.getBodyViewportElement(),e=mn(t);if(e<=50)return;let i=this.getPinnedColumnsOverflowingViewport(e-50);const s=this.gos.getCallback("processUnpinnedColumns");i.length&&(s&&(i=s({columns:i,viewportWidth:e})),this.columnModel.setColumnsPinned(i,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(t){const e=this.pinnedWidthService.getPinnedRightWidth(),i=this.pinnedWidthService.getPinnedLeftWidth(),s=e+i;if(s<t)return[];const r=[...this.columnModel.getDisplayedLeftColumns()],n=[...this.columnModel.getDisplayedRightColumns()];let o=0,a=0,l=0;const u=[];let d=s-l-t;for(;(a<r.length||o<n.length)&&d>0;){if(o<n.length){const c=n[o++];d-=c.getActualWidth(),u.push(c)}if(a<r.length&&d>0){const c=r[a++];d-=c.getActualWidth(),u.push(c)}}return u}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const t=this.gridBodyCtrl.getBodyViewportElement(),e=Xl(t);if(this.bodyHeight!==e){this.bodyHeight=e;const i={type:S.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(i)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const t={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(t)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const t=this.centerContainerCtrl.getCenterWidth(),e=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(t,e)}};g([T("ctrlsService")],Yo.prototype,"ctrlsService",2);g([T("pinnedWidthService")],Yo.prototype,"pinnedWidthService",2);g([T("columnModel")],Yo.prototype,"columnModel",2);g([T("scrollVisibleService")],Yo.prototype,"scrollVisibleService",2);g([$],Yo.prototype,"postConstruct",1);var fm=class extends z{constructor(t){super(),this.element=t}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const t=this.pinnedWidthService.getPinnedLeftWidth(),e=t>0;ve(this.element,e),xi(this.element,t)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}};g([T("pinnedWidthService")],fm.prototype,"pinnedWidthService",2);g([$],fm.prototype,"postConstruct",1);var mm=class extends z{constructor(t){super(),this.element=t}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const t=this.pinnedWidthService.getPinnedRightWidth(),e=t>0;ve(this.element,e),xi(this.element,t)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}};g([T("pinnedWidthService")],mm.prototype,"pinnedWidthService",2);g([$],mm.prototype,"postConstruct",1);var jh=class extends z{constructor(t,e){super(),this.eContainer=t,this.eViewport=e}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const t=this.maxDivHeightScaler.getUiContainerHeight(),e=t!=null?`${t}px`:"";this.eContainer.style.height=e,this.eViewport&&(this.eViewport.style.height=e)}};g([T("rowContainerHeightService")],jh.prototype,"maxDivHeightScaler",2);g([$],jh.prototype,"postConstruct",1);var qh=class extends z{constructor(t){super(),this.eContainer=t}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",e=>{if(e.currentValue){this.enableFeature();return}this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),this.gos.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}};g([T("dragService")],qh.prototype,"dragService",2);g([De("rangeService")],qh.prototype,"rangeService",2);g([$],qh.prototype,"postConstruct",1);var Xo=class extends z{constructor(t,e=!1){super(),this.callback=t,this.addSpacer=e}postConstruct(){const t=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",t),this.addManagedListener(this.eventService,S.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_LEFT_PINNED_WIDTH_CHANGED,t),this.addSpacer&&(this.addManagedListener(this.eventService,S.EVENT_RIGHT_PINNED_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_SCROLL_VISIBILITY_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_SCROLLBAR_WIDTH_CHANGED,t)),this.setWidth()}setWidth(){const{columnModel:t}=this,e=this.gos.isDomLayout("print"),i=t.getBodyContainerWidth(),s=t.getDisplayedColumnsLeftWidth(),r=t.getDisplayedColumnsRightWidth();let n;e?n=i+s+r:(n=i,this.addSpacer&&(this.gos.get("enableRtl")?s:r)===0&&this.scrollVisibleService.isVerticalScrollShowing()&&(n+=this.gos.getScrollbarWidth())),this.callback(n)}};g([T("columnModel")],Xo.prototype,"columnModel",2);g([T("scrollVisibleService")],Xo.prototype,"scrollVisibleService",2);g([$],Xo.prototype,"postConstruct",1);function LO(t){switch(t){case"center":case"topCenter":case"stickyTopCenter":case"bottomCenter":case"stickyBottomCenter":return"center";case"left":case"topLeft":case"stickyTopLeft":case"bottomLeft":case"stickyBottomLeft":return"left";case"right":case"topRight":case"stickyTopRight":case"bottomRight":case"stickyBottomRight":return"right";case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return"fullWidth";default:throw Error("Invalid Row Container Type")}}var FO=or([["center","ag-center-cols-container"],["left","ag-pinned-left-cols-container"],["right","ag-pinned-right-cols-container"],["fullWidth","ag-full-width-container"],["topCenter","ag-floating-top-container"],["topLeft","ag-pinned-left-floating-top"],["topRight","ag-pinned-right-floating-top"],["topFullWidth","ag-floating-top-full-width-container"],["stickyTopCenter","ag-sticky-top-container"],["stickyTopLeft","ag-pinned-left-sticky-top"],["stickyTopRight","ag-pinned-right-sticky-top"],["stickyTopFullWidth","ag-sticky-top-full-width-container"],["stickyBottomCenter","ag-sticky-bottom-container"],["stickyBottomLeft","ag-pinned-left-sticky-bottom"],["stickyBottomRight","ag-pinned-right-sticky-bottom"],["stickyBottomFullWidth","ag-sticky-bottom-full-width-container"],["bottomCenter","ag-floating-bottom-container"],["bottomLeft","ag-pinned-left-floating-bottom"],["bottomRight","ag-pinned-right-floating-bottom"],["bottomFullWidth","ag-floating-bottom-full-width-container"]]),MO=or([["center","ag-center-cols-viewport"],["topCenter","ag-floating-top-viewport"],["stickyTopCenter","ag-sticky-top-viewport"],["bottomCenter","ag-floating-bottom-viewport"],["stickyBottomCenter","ag-sticky-bottom-viewport"]]),wn=class lb extends z{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.isFullWithContainer=this.name==="topFullWidth"||this.name==="stickyTopFullWidth"||this.name==="stickyBottomFullWidth"||this.name==="bottomFullWidth"||this.name==="fullWidth"}static getRowContainerCssClasses(e){const i=FO.get(e),s=MO.get(e);return{container:i,viewport:s}}static getPinned(e){switch(e){case"bottomLeft":case"topLeft":case"stickyTopLeft":case"stickyBottomLeft":case"left":return"left";case"bottomRight":case"topRight":case"stickyTopRight":case"stickyBottomRight":case"right":return"right";default:return null}}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>this.viewportSizeFeature=this.createManagedBean(new Yo(this)))}registerWithCtrlsService(){switch(this.name){case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return;default:this.ctrlsService.register(this.name,this)}}forContainers(e,i){e.indexOf(this.name)>=0&&i()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,i,s){this.comp=e,this.eContainer=i,this.eViewport=s,this.createManagedBean(new ri(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const r=["topCenter","topLeft","topRight"],n=["stickyTopCenter","stickyTopLeft","stickyTopRight"],o=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],a=["bottomCenter","bottomLeft","bottomRight"],l=["center","left","right"],u=[...r,...a,...l,...n,...o],d=["center","left","right","fullWidth"],c=["center","topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],C=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],E=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"];this.forContainers(C,()=>{this.pinnedWidthFeature=this.createManagedBean(new fm(this.eContainer)),this.addManagedListener(this.eventService,S.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(E,()=>{this.pinnedWidthFeature=this.createManagedBean(new mm(this.eContainer)),this.addManagedListener(this.eventService,S.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(d,()=>this.createManagedBean(new jh(this.eContainer,this.name==="center"?s:void 0))),this.forContainers(u,()=>this.createManagedBean(new qh(this.eContainer))),this.forContainers(c,()=>this.createManagedBean(new Xo(y=>this.comp.setContainerWidth(`${y}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_ROWS_CHANGED,e=>this.onDisplayedRowsChanged(e.afterScroll)),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(["stickyTopCenter","stickyTopLeft","stickyTopRight","stickyTopFullWidth","stickyBottomCenter","stickyBottomLeft","stickyBottomRight","stickyBottomFullWidth"].indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const s=()=>{const r=this.gos.get("ensureDomOrder"),n=this.gos.isDomLayout("print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",s),s()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>{const e=()=>this.eViewport.scrollLeft=0;this.addManagedListener(this.eViewport,"scroll",e)})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const e=i=>{this.dragService.isDragging()&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(e=!1){const i=this.getCenterWidth(),s=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(i,s,e)}getCenterWidth(){return mn(this.eViewport)}getCenterViewportScrollLeft(){return vl(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const i=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>i())}isViewportInTheDOMTree(){return Yf(this.eViewport)}getViewportScrollLeft(){return vl(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||J0(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(e){this.eContainer.style.transform=`translateX(${e}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){yl(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!lb.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const i=this.getRowCtrls();if(!this.visible||i.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const s=this.gos.isDomLayout("print"),n=this.gos.get("embedFullWidthRows")||s,o=i.filter(a=>{const l=a.isFullWidth();return this.isFullWithContainer?!n&&l:n||!l});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:e})}getRowCtrls(){switch(this.name){case"topCenter":case"topLeft":case"topRight":case"topFullWidth":return this.rowRenderer.getTopRowCtrls();case"stickyTopCenter":case"stickyTopLeft":case"stickyTopRight":case"stickyTopFullWidth":return this.rowRenderer.getStickyTopRowCtrls();case"stickyBottomCenter":case"stickyBottomLeft":case"stickyBottomRight":case"stickyBottomFullWidth":return this.rowRenderer.getStickyBottomRowCtrls();case"bottomCenter":case"bottomLeft":case"bottomRight":case"bottomFullWidth":return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}}};g([T("dragService")],wn.prototype,"dragService",2);g([T("ctrlsService")],wn.prototype,"ctrlsService",2);g([T("columnModel")],wn.prototype,"columnModel",2);g([T("resizeObserverService")],wn.prototype,"resizeObserverService",2);g([T("rowRenderer")],wn.prototype,"rowRenderer",2);g([$],wn.prototype,"postConstruct",1);var ub=wn,OO=`<div class="ag-root ag-unselectable" role="treegrid">
        <ag-header-root ref="gridHeader"></ag-header-root>
        <div class="ag-floating-top" ref="eTop" role="presentation">
            <ag-row-container ref="topLeftContainer" name="topLeft"></ag-row-container>
            <ag-row-container ref="topCenterContainer" name="topCenter"></ag-row-container>
            <ag-row-container ref="topRightContainer" name="topRight"></ag-row-container>
            <ag-row-container ref="topFullWidthContainer" name="topFullWidth"></ag-row-container>
        </div>
        <div class="ag-body" ref="eBody" role="presentation">
            <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">
                <ag-row-container ref="leftContainer" name="left"></ag-row-container>
                <ag-row-container ref="centerContainer" name="center"></ag-row-container>
                <ag-row-container ref="rightContainer" name="right"></ag-row-container>
                <ag-row-container ref="fullWidthContainer" name="fullWidth"></ag-row-container>
            </div>
            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>
        </div>
        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">
            <ag-row-container ref="stickyTopLeftContainer" name="stickyTopLeft"></ag-row-container>
            <ag-row-container ref="stickyTopCenterContainer" name="stickyTopCenter"></ag-row-container>
            <ag-row-container ref="stickyTopRightContainer" name="stickyTopRight"></ag-row-container>
            <ag-row-container ref="stickyTopFullWidthContainer" name="stickyTopFullWidth"></ag-row-container>
        </div>
        <div class="ag-sticky-bottom" ref="eStickyBottom" role="presentation">
            <ag-row-container ref="stickyBottomLeftContainer" name="stickyBottomLeft"></ag-row-container>
            <ag-row-container ref="stickyBottomCenterContainer" name="stickyBottomCenter"></ag-row-container>
            <ag-row-container ref="stickyBottomRightContainer" name="stickyBottomRight"></ag-row-container>
            <ag-row-container ref="stickyBottomFullWidthContainer" name="stickyBottomFullWidth"></ag-row-container>
        </div>
        <div class="ag-floating-bottom" ref="eBottom" role="presentation">
            <ag-row-container ref="bottomLeftContainer" name="bottomLeft"></ag-row-container>
            <ag-row-container ref="bottomCenterContainer" name="bottomCenter"></ag-row-container>
            <ag-row-container ref="bottomRightContainer" name="bottomRight"></ag-row-container>
            <ag-row-container ref="bottomFullWidthContainer" name="bottomFullWidth"></ag-row-container>
        </div>
        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>
        <ag-overlay-wrapper></ag-overlay-wrapper>
    </div>`,is=class extends oe{constructor(){super(OO)}init(){const t=(i,s)=>{const r=`${i}px`;s.style.minHeight=r,s.style.height=r},e={setRowAnimationCssOnBodyViewport:(i,s)=>this.setRowAnimationCssOnBodyViewport(i,s),setColumnCount:i=>O0(this.getGui(),i),setRowCount:i=>M0(this.getGui(),i),setTopHeight:i=>t(i,this.eTop),setBottomHeight:i=>t(i,this.eBottom),setTopDisplay:i=>this.eTop.style.display=i,setBottomDisplay:i=>this.eBottom.style.display=i,setStickyTopHeight:i=>this.eStickyTop.style.height=i,setStickyTopTop:i=>this.eStickyTop.style.top=i,setStickyTopWidth:i=>this.eStickyTop.style.width=i,setStickyBottomHeight:i=>this.eStickyBottom.style.height=i,setStickyBottomBottom:i=>this.eStickyBottom.style.bottom=i,setStickyBottomWidth:i=>this.eStickyBottom.style.width=i,setColumnMovingCss:(i,s)=>this.addOrRemoveCssClass(i,s),updateLayoutClasses:(i,s)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(n=>{n.toggle("ag-layout-auto-height",s.autoHeight),n.toggle("ag-layout-normal",s.normal),n.toggle("ag-layout-print",s.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",s.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",s.normal),this.addOrRemoveCssClass("ag-layout-print",s.print)},setAlwaysVerticalScrollClass:(i,s)=>this.eBodyViewport.classList.toggle(rb,s),registerBodyViewportResizeListener:i=>{const s=this.resizeObserverService.observeResize(this.eBodyViewport,i);this.addDestroyFunc(()=>s())},setPinnedTopBottomOverflowY:i=>this.eTop.style.overflowY=this.eBottom.style.overflowY=i,setCellSelectableCss:(i,s)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(r=>r.classList.toggle(i,s))},setBodyViewportWidth:i=>this.eBodyViewport.style.width=i};this.ctrl=this.createManagedBean(new Ht),this.ctrl.setComp(e,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&this.gos.get("enableRangeSelection")||this.gos.get("rowSelection")==="multiple")&&F0(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(t,e){const i=this.eBodyViewport.classList;i.toggle("ag-row-animation",e),i.toggle("ag-row-no-animation",!e)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}};g([T("resizeObserverService")],is.prototype,"resizeObserverService",2);g([De("rangeService")],is.prototype,"rangeService",2);g([q("eBodyViewport")],is.prototype,"eBodyViewport",2);g([q("eStickyTop")],is.prototype,"eStickyTop",2);g([q("eStickyBottom")],is.prototype,"eStickyBottom",2);g([q("eTop")],is.prototype,"eTop",2);g([q("eBottom")],is.prototype,"eBottom",2);g([q("gridHeader")],is.prototype,"headerRootComp",2);g([q("eBody")],is.prototype,"eBody",2);g([$],is.prototype,"init",1);var Po=class extends z{postConstruct(){this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const t=this.ctrlsService.get("center");if(!t||this.columnAnimationService.isActive())return;const e={horizontalScrollShowing:t.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(e)}setScrollsVisible(t){if(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing){this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing;const i={type:S.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(i)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};g([T("ctrlsService")],Po.prototype,"ctrlsService",2);g([T("columnAnimationService")],Po.prototype,"columnAnimationService",2);g([$],Po.prototype,"postConstruct",1);Po=g([Y("scrollVisibleService")],Po);var Vs=class extends z{constructor(){super(...arguments),this.gridInstanceId=Vs.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(t){t[Vs.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(t){return Md(this.gos,t.target,Xr.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(t){return this.isElementInThisGrid(t.target)}isElementInThisGrid(t){let e=t;for(;e;){const i=e[Vs.GRID_DOM_KEY];if(U(i))return i===this.gridInstanceId;e=e.parentElement}return!1}getCellPositionForEvent(t){const e=this.getRenderedCellForEvent(t);return e?e.getCellPosition():null}getNormalisedPosition(t){const e=this.gos.isDomLayout("normal"),i=t;let s,r;if(i.clientX!=null||i.clientY!=null?(s=i.clientX,r=i.clientY):(s=i.x,r=i.y),e){const n=this.ctrlsService.getGridBodyCtrl(),o=n.getScrollFeature().getVScrollPosition(),a=n.getScrollFeature().getHScrollPosition();s+=a.left,r+=o.top}return{x:s,y:r}}};Vs.gridInstanceSequence=new xo;Vs.GRID_DOM_KEY="__ag_grid_instance";g([T("ctrlsService")],Vs.prototype,"ctrlsService",2);Vs=g([Y("mouseEventService")],Vs);var Dt=class extends z{constructor(){super(),this.onPageDown=Xp(this.onPageDown,100),this.onPageUp=Xp(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCon=t.gridBodyCtrl})}handlePageScrollingKey(t,e=!1){const i=t.key,s=t.altKey,r=t.ctrlKey||t.metaKey,n=!!this.rangeService&&t.shiftKey,o=this.mouseEventService.getCellPositionForEvent(t);let a=!1;switch(i){case N.PAGE_HOME:case N.PAGE_END:!r&&!s&&(this.onHomeOrEndKey(i),a=!0);break;case N.LEFT:case N.RIGHT:case N.UP:case N.DOWN:if(!o)return!1;r&&!s&&!n&&(this.onCtrlUpDownLeftRight(i,o),a=!0);break;case N.PAGE_DOWN:case N.PAGE_UP:!r&&!s&&(a=this.handlePageUpDown(i,o,e));break}return a&&t.preventDefault(),a}handlePageUpDown(t,e,i){return i&&(e=this.focusService.getFocusedCell()),e?(t===N.PAGE_UP?this.onPageUp(e):this.onPageDown(e),!0):!1}navigateTo(t){var e;const{scrollIndex:i,scrollType:s,scrollColumn:r,focusIndex:n,focusColumn:o}=t;U(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),U(i)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(i,s),t.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(n),this.focusService.setFocusedCell({rowIndex:n,column:o,rowPinned:null,forceBrowserFocus:!0}),(e=this.rangeService)==null||e.setRangeToCell({rowIndex:n,rowPinned:null,column:o})}onPageDown(t){const i=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),s=this.getViewportHeight(),r=this.paginationProxy.getPixelOffset(),n=i.top+s,o=this.paginationProxy.getRowIndexAtPixel(n+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,o):this.navigateToNextPage(t,o)}onPageUp(t){const i=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),s=this.paginationProxy.getPixelOffset(),r=i.top,n=this.paginationProxy.getRowIndexAtPixel(r+s);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,n,!0):this.navigateToNextPage(t,n,!0)}navigateToNextPage(t,e,i=!1){const s=this.getViewportHeight(),r=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow(),o=this.paginationProxy.getPixelOffset(),a=this.paginationProxy.getRow(t.rowIndex),l=i?(a==null?void 0:a.rowHeight)-s-o:s-o,u=(a==null?void 0:a.rowTop)+l;let d=this.paginationProxy.getRowIndexAtPixel(u+o);if(d===t.rowIndex){const C=i?-1:1;e=d=t.rowIndex+C}let c;i?(c="bottom",d<r&&(d=r),e<r&&(e=r)):(c="top",d>n&&(d=n),e>n&&(e=n)),this.isRowTallerThanView(d)&&(e=d,c="top"),this.navigateTo({scrollIndex:e,scrollType:c,scrollColumn:null,focusIndex:d,focusColumn:t.column})}navigateToNextPageWithAutoHeight(t,e,i=!1){this.navigateTo({scrollIndex:e,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column}),setTimeout(()=>{const s=this.getNextFocusIndexForAutoHeight(t,i);this.navigateTo({scrollIndex:e,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:s,focusColumn:t.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(t,e=!1){var i;const s=e?-1:1,r=this.getViewportHeight(),n=this.paginationProxy.getPageLastRow();let o=0,a=t.rowIndex;for(;a>=0&&a<=n;){const l=this.paginationProxy.getRow(a);if(l){const u=(i=l.rowHeight)!=null?i:0;if(o+u>r)break;o+=u}a+=s}return Math.max(0,Math.min(a,n))}getViewportHeight(){const{gridBodyCtrl:t,center:e}=this.ctrlsService.getParams(),i=t.getScrollFeature().getVScrollPosition(),s=this.gos.getScrollbarWidth();let r=i.bottom-i.top;return e.isHorizontalScrollShowing()&&(r-=s),r}isRowTallerThanView(t){const e=this.paginationProxy.getRow(t);if(!e)return!1;const i=e.rowHeight;return typeof i!="number"?!1:i>this.getViewportHeight()}onCtrlUpDownLeftRight(t,e){const i=this.cellNavigationService.getNextCellToFocus(t,e,!0),{rowIndex:s,column:r}=i;this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:r,focusIndex:s,focusColumn:r})}onHomeOrEndKey(t){const e=t===N.PAGE_HOME,i=this.columnModel.getAllDisplayedColumns(),s=e?i[0]:Se(i),r=e?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:s,focusIndex:r,focusColumn:s})}onTabKeyDown(t,e){const i=e.shiftKey,s=this.tabToNextCellCommon(t,i,e);if(s!==!1){s&&e.preventDefault();return}if(i){const{rowIndex:r,rowPinned:n}=t.getRowPosition();(n?r===0:r===this.paginationProxy.getPageFirstRow())&&(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(e.preventDefault(),this.focusService.focusPreviousFromFirstCell(e)))}else t instanceof Xr&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(i)&&e.preventDefault()}tabToNextCell(t,e){const i=this.focusService.getFocusedCell();if(!i)return!1;let s=this.getCellByPosition(i);return!s&&(s=this.rowRenderer.getRowByPosition(i),!s||!s.isFullWidth())?!1:!!this.tabToNextCellCommon(s,t,e)}tabToNextCellCommon(t,e,i){let s=t.isEditing();if(!s&&t instanceof Xr){const o=t.getRowCtrl();o&&(s=o.isEditing())}let r;return s?this.gos.get("editType")==="fullRow"?r=this.moveToNextEditingRow(t,e,i):r=this.moveToNextEditingCell(t,e,i):r=this.moveToNextCellNotEditing(t,e),r===null?r:r||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(t,e,i=null){const s=t.getCellPosition();t.getGui().focus(),t.stopEditing();const r=this.findNextCellToFocusOn(s,e,!0);return r===!1?null:r==null?!1:(r.startEditing(null,!0,i),r.focusCell(!1),!0)}moveToNextEditingRow(t,e,i=null){const s=t.getCellPosition(),r=this.findNextCellToFocusOn(s,e,!0);if(r===!1)return null;if(r==null)return!1;const n=r.getCellPosition(),o=this.isCellEditable(s),a=this.isCellEditable(n),l=n&&s.rowIndex===n.rowIndex&&s.rowPinned===n.rowPinned;return o&&t.setFocusOutOnEditor(),l||(t.getRowCtrl().stopEditing(),r.getRowCtrl().startRowEditing(void 0,void 0,i)),a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(t,e){const i=this.columnModel.getAllDisplayedColumns();let s;t instanceof Qr?s=He(te({},t.getRowPosition()),{column:e?i[0]:Se(i)}):s=t.getCellPosition();const r=this.findNextCellToFocusOn(s,e,!1);if(r===!1)return null;if(r instanceof Xr)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),e);return U(r)}findNextCellToFocusOn(t,e,i){var s;let r=t;for(;;){t!==r&&(t=r),e||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,e);const n=this.gos.getCallback("tabToNextCell");if(U(n)){const u=n({backwards:e,editing:i,previousCellPosition:t,nextCellPosition:r||null});if(u===!0||u===null)u===null&&ie("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),r=t;else{if(u===!1)return!1;u.floating&&(ie("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowIndex:u.rowIndex,column:u.column,rowPinned:u.rowPinned}}}if(!r)return null;if(r.rowIndex<0){const l=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l+r.rowIndex,column:r.column},fromCell:!0}),null}const o=this.gos.get("editType")==="fullRow";if(i&&!o&&!this.isCellEditable(r))continue;this.ensureCellVisible(r);const a=this.getCellByPosition(r);if(!a){const l=this.rowRenderer.getRowByPosition(r);if(!l||!l.isFullWidth()||i)continue;return l}if(!a.isSuppressNavigable())return(s=this.rangeService)==null||s.setRangeToCell(r),a}}isCellEditable(t){const e=this.lookupRowNodeForCell(t);return e?t.column.isCellEditable(e):!1}getCellByPosition(t){const e=this.rowRenderer.getRowByPosition(t);return e?e.getCellCtrl(t.column):null}lookupRowNodeForCell(t){return t.rowPinned==="top"?this.pinnedRowModel.getPinnedTopRow(t.rowIndex):t.rowPinned==="bottom"?this.pinnedRowModel.getPinnedBottomRow(t.rowIndex):this.paginationProxy.getRow(t.rowIndex)}navigateToNextCell(t,e,i,s){let r=i,n=!1;for(;r&&(r===i||!this.isValidNavigateCell(r));)this.gos.get("enableRtl")?e===N.LEFT&&(r=this.getLastCellOfColSpan(r)):e===N.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(e,r),n=re(r);if(n&&t&&t.key===N.UP&&(r={rowIndex:-1,rowPinned:null,column:i.column}),s){const a=this.gos.getCallback("navigateToNextCell");if(U(a)){const u=a({key:e,previousCellPosition:i,nextCellPosition:r||null,event:t});U(u)?(u.floating&&(ie("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowPinned:u.rowPinned,rowIndex:u.rowIndex,column:u.column}):r=null}}if(!r)return;if(r.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+r.rowIndex,column:i.column},event:t||void 0,fromCell:!0});return}const o=this.getNormalisedPosition(r);o?this.focusPosition(o):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(t){this.ensureCellVisible(t);const e=this.getCellByPosition(t);return e?(t=e.getCellPosition(),this.ensureCellVisible(t),t):null}tryToFocusFullWidthRow(t,e=!1){const i=this.columnModel.getAllDisplayedColumns(),s=this.rowRenderer.getRowByPosition(t);if(!s||!s.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),n={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column||(e?Se(i):i[0])};this.focusPosition(n);const o=r!=null?this.rowPositionUtils.before(n,r):!1,a={type:S.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:n.column,isFullWidthCell:!0,floating:n.rowPinned,fromBelow:o};return this.eventService.dispatchEvent(a),!0}focusPosition(t){var e;this.focusService.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0}),(e=this.rangeService)==null||e.setRangeToCell(t)}isValidNavigateCell(t){return!!this.rowPositionUtils.getRowNode(t)}getLastCellOfColSpan(t){const e=this.getCellByPosition(t);if(!e)return t;const i=e.getColSpanningList();return i.length===1?t:{rowIndex:t.rowIndex,column:Se(i),rowPinned:t.rowPinned}}ensureCellVisible(t){const e=this.gos.isGroupRowsSticky(),i=this.rowModel.getRow(t.rowIndex);!(e&&(i==null?void 0:i.sticky))&&re(t.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t.rowIndex),t.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(t.column)}};g([T("mouseEventService")],Dt.prototype,"mouseEventService",2);g([T("paginationProxy")],Dt.prototype,"paginationProxy",2);g([T("focusService")],Dt.prototype,"focusService",2);g([T("columnModel")],Dt.prototype,"columnModel",2);g([T("rowModel")],Dt.prototype,"rowModel",2);g([T("ctrlsService")],Dt.prototype,"ctrlsService",2);g([T("rowRenderer")],Dt.prototype,"rowRenderer",2);g([T("headerNavigationService")],Dt.prototype,"headerNavigationService",2);g([T("rowPositionUtils")],Dt.prototype,"rowPositionUtils",2);g([T("cellNavigationService")],Dt.prototype,"cellNavigationService",2);g([T("pinnedRowModel")],Dt.prototype,"pinnedRowModel",2);g([De("rangeService")],Dt.prototype,"rangeService",2);g([$],Dt.prototype,"postConstruct",1);Dt=g([Y("navigationService")],Dt);var Cm=class db extends yn{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){this.gos.setDomData(this.getGui(),db.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),i=this.params,s=r=>{kd(this.gos,r,i.node,i.column,!0)||i.onKeyDown(r)};this.addManagedListener(e,"keydown",s)}};Cm.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper";g([$],Cm.prototype,"postConstruct",1);var NO=Cm,kO=class extends oe{constructor(t,e,i,s,r){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode(),this.rowCtrl=e.getRowCtrl(),this.eRow=s,this.cellCtrl=e;const n=document.createElement("div");n.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(n);const o=this.getGui();this.forceWrapper=e.isForceWrapper(),this.refreshWrapper(!1);const a=(d,c)=>{c!=null&&c!=""?o.setAttribute(d,c):o.removeAttribute(d)};Qe(o,e.getCellAriaRole()),a("col-id",e.getColumnIdSanitised());const l=e.getTabIndex();l!==void 0&&a("tabindex",l.toString());const u={addOrRemoveCssClass:(d,c)=>this.addOrRemoveCssClass(d,c),setUserStyles:d=>Jf(o,d),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:d=>this.includeSelection=d,setIncludeRowDrag:d=>this.includeRowDrag=d,setIncludeDndSource:d=>this.includeDndSource=d,setRenderDetails:(d,c,C)=>this.setRenderDetails(d,c,C),setEditDetails:(d,c,C)=>this.setEditDetails(d,c,C),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};e.setComp(u,this.getGui(),this.eCellWrapper,i,r)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(t,e,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const r=this.refreshWrapper(!1);this.refreshEditStyles(!1),t?!(i||r)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(e))}setEditDetails(t,e,i){t?this.createCellEditorInstance(t,e,i):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(t){const e=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=e||this.forceWrapper,s=i&&this.eCellWrapper==null;if(s){const u=document.createElement("div");u.setAttribute("role","presentation"),u.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=u,this.getGui().appendChild(this.eCellWrapper)}const r=!i&&this.eCellWrapper!=null;r&&($i(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);const n=!t&&i,o=n&&this.eCellValue==null;if(o){const u=document.createElement("span");u.setAttribute("role","presentation"),u.setAttribute("class","ag-cell-value"),this.eCellValue=u,this.eCellWrapper.appendChild(this.eCellValue)}const a=!n&&this.eCellValue!=null;a&&($i(this.eCellValue),this.eCellValue=void 0);const l=s||r||o||a;return l&&this.removeControls(),t||e&&this.addControls(),l}addControls(){this.includeRowDrag&&this.rowDraggingComp==null&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&this.dndSourceComp==null&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(t,e,i){const s=this.editorVersion,r=t.newAgStackInstance();if(!r)return;const{params:n}=t;r.then(a=>this.afterCellEditorCreated(s,a,n,e,i)),re(this.cellEditor)&&n.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(t){const e=this.getParentOfValue();tt(e);const i=t!=null?at(t,!0):null;i!=null&&(e.textContent=i)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:t}=this.beans;this.cellRenderer=t.destroyBean(this.cellRenderer),$i(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:t}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),$i(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(t){if(this.cellRenderer==null||this.cellRenderer.refresh==null||this.cellRendererClass!==t.componentClass)return!1;const e=this.cellRenderer.refresh(t.params);return e===!0||e===void 0}createCellRendererInstance(t){const i=!this.beans.gos.get("suppressAnimationFrame"),s=this.rendererVersion,{componentClass:r}=t,n=()=>{if(this.rendererVersion!==s||!this.isAlive())return;const a=t.newAgStackInstance(),l=this.afterCellRendererCreated.bind(this,s,r);a&&a.then(l)};i&&this.firstRender?this.beans.animationFrameService.createTask(n,this.rowNode.rowIndex,"createTasksP2"):n()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(t,e,i){if(!this.isAlive()||t!==this.rendererVersion){this.beans.context.destroyBean(i);return}if(this.cellRenderer=i,this.cellRendererClass=e,this.cellRendererGui=this.cellRenderer.getGui(),this.cellRendererGui!=null){const r=this.getParentOfValue();tt(r),r.appendChild(this.cellRendererGui)}}afterCellEditorCreated(t,e,i,s,r){if(t!==this.editorVersion){this.beans.context.destroyBean(e);return}if(e.isCancelBeforeStart&&e.isCancelBeforeStart()){this.beans.context.destroyBean(e),this.cellCtrl.stopEditing(!0);return}if(!e.getGui){console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),this.beans.context.destroyBean(e);return}this.cellEditor=e,this.cellEditorGui=e.getGui();const a=s||e.isPopup!==void 0&&e.isPopup();a?this.addPopupCellEditor(i,r):this.addInCellEditor(),this.refreshEditStyles(!0,a),e.afterGuiAttached&&e.afterGuiAttached()}refreshEditStyles(t,e){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",t&&!e),this.addOrRemoveCssClass("ag-cell-popup-editing",t&&!!e),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!t||!!e),(i=this.rowCtrl)==null||i.setInlineEditingCss(t)}addInCellEditor(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(t,e){this.beans.gos.get("editType")==="fullRow"&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const i=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new NO(t));const s=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&s.appendChild(this.cellEditorGui);const r=this.beans.popupService,n=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),o=e??(i.getPopupPosition?i.getPopupPosition():"over"),a=this.beans.gos.get("enableRtl"),l={ePopup:s,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:o,alignSide:a?"right":"left",keepWithinBounds:!0},u=r.positionPopupByComponent.bind(r,l),d=this.beans.localeService.getLocaleTextFunc(),c=r.addPopup({modal:n,eChild:s,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:u,ariaLabel:d("ariaLabelCellEditor","Cell Editor")});c&&(this.hideEditorPopup=c.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&Uf()&&t.focus({preventScroll:!0}),tt(this.getParentOfValue())}},GO=class extends oe{constructor(t,e,i){super(),this.cellComps={},this.beans=e,this.rowCtrl=t;const s=document.createElement("div");s.setAttribute("comp-id",`${this.getCompId()}`),s.setAttribute("style",this.getInitialStyle(i)),this.setTemplateFromElement(s);const r=this.getGui(),n=r.style;this.domOrder=this.rowCtrl.getDomOrder(),Qe(r,"row");const o=this.rowCtrl.getTabIndex();o!=null&&r.setAttribute("tabindex",o.toString());const a={setDomOrder:l=>this.domOrder=l,setCellCtrls:l=>this.setCellCtrls(l),showFullWidth:l=>this.showFullWidth(l),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(l,u)=>this.addOrRemoveCssClass(l,u),setUserStyles:l=>Jf(r,l),setTop:l=>n.top=l,setTransform:l=>n.transform=l,setRowIndex:l=>r.setAttribute("row-index",l),setRowId:l=>r.setAttribute("row-id",l),setRowBusinessKey:l=>r.setAttribute("row-business-key",l),refreshFullWidth:l=>this.refreshFullWidth(l)};t.setComp(a,this.getGui(),i),this.addDestroyFunc(()=>{t.unsetComp(i)})}getInitialStyle(t){const e=this.rowCtrl.getInitialTransform(t);return e?`transform: ${e}`:`top: ${this.rowCtrl.getInitialRowTop(t)}`}showFullWidth(t){const e=s=>{if(this.isAlive()){const r=s.getGui();this.getGui().appendChild(r),this.rowCtrl.setupDetailRowAutoHeight(r),this.setFullWidthRowComp(s)}else this.beans.context.destroyBean(s)},i=t.newAgStackInstance();i&&i.then(e)}setCellCtrls(t){const e=Object.assign({},this.cellComps);t.forEach(s=>{const r=s.getInstanceId();this.cellComps[r]==null?this.newCellComp(s):e[r]=null});const i=hr(e).filter(s=>s!=null);this.destroyCells(i),this.ensureDomOrder(t)}ensureDomOrder(t){if(!this.domOrder)return;const e=[];t.forEach(i=>{const s=this.cellComps[i.getInstanceId()];s&&e.push(s.getGui())}),Qf(this.getGui(),e)}newCellComp(t){const e=new kO(this.beans,t,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=e,this.getGui().appendChild(e.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const t=hr(this.cellComps).filter(e=>e!=null);this.destroyCells(t)}setFullWidthRowComp(t){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(t){t.forEach(e=>{if(!e)return;const i=e.getCtrl().getInstanceId();this.cellComps[i]===e&&(e.detach(),e.destroy(),this.cellComps[i]=null)})}refreshFullWidth(t){const{fullWidthCellRenderer:e}=this;if(!e||!e.refresh)return!1;const i=t();return e.refresh(i)}};function VO(){const t=oe.elementGettingCreated.getAttribute("name"),e=ub.getRowContainerCssClasses(t);let i;return t==="center"||t==="topCenter"||t==="stickyTopCenter"||t==="bottomCenter"||t==="stickyBottomCenter"?i=`<div class="${e.viewport}" ref="eViewport" role="presentation">
                <div class="${e.container}" ref="eContainer"></div>
            </div>`:i=`<div class="${e.container}" ref="eContainer"></div>`,i}var Qo=class extends oe{constructor(){super(VO()),this.rowComps={},this.name=oe.elementGettingCreated.getAttribute("name"),this.type=LO(this.name)}postConstruct(){const t={setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>this.eContainer.style.width=i};this.createManagedBean(new ub(this.name)).setComp(t,this.eContainer,this.eViewport)}preDestroy(){this.setRowCtrls([])}setRowCtrls(t){const e=te({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;const i=s=>{const r=s.getInstanceId(),n=e[r];if(n)this.rowComps[r]=n,delete e[r],this.ensureDomOrder(n.getGui());else{if(!s.getRowNode().displayed)return;const o=new GO(s,this.beans,this.type);this.rowComps[r]=o,this.appendRow(o.getGui())}};t.forEach(i),hr(e).forEach(s=>{this.eContainer.removeChild(s.getGui()),s.destroy()}),Qe(this.eContainer,"rowgroup")}appendRow(t){this.domOrder?Q0(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t}ensureDomOrder(t){this.domOrder&&(Xf(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)}};g([T("beans")],Qo.prototype,"beans",2);g([q("eViewport")],Qo.prototype,"eViewport",2);g([q("eContainer")],Qo.prototype,"eContainer",2);g([$],Qo.prototype,"postConstruct",1);g([Vt],Qo.prototype,"preDestroy",1);var vm=class{constructor(t){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=t}onDragEnter(t){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const e=t.dragItem.columns;e&&e.forEach(i=>{i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?ae.ICON_PINNED:ae.ICON_MOVE:null}onDragLeave(t){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(t){}onDragStop(t){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}};g([T("columnModel")],vm.prototype,"columnModel",2);g([T("gridOptionsService")],vm.prototype,"gos",2);var Jr=class{static attemptMoveColumns(t){const{isFromHeader:e,hDirection:i,xPosition:s,fromEnter:r,fakeEvent:n,pinned:o,gos:a,columnModel:l}=t,u=i===0,d=i===1;let{allMovingColumns:c}=t;if(e){let L=[];c.forEach(I=>{var k;let H=null,ee=I.getParent();for(;ee!=null&&ee.getDisplayedLeafColumns().length===1;)H=ee,ee=ee.getParent();H!=null?(!!((k=H.getColGroupDef())!=null&&k.marryChildren)?H.getProvidedColumnGroup().getLeafColumns():H.getLeafColumns()).forEach(le=>{L.includes(le)||L.push(le)}):L.includes(I)||L.push(I)}),c=L}const C=c.slice();l.sortColumnsLikeGridColumns(C);const E=this.calculateValidMoves({movingCols:C,draggingRight:d,xPosition:s,pinned:o,gos:a,columnModel:l}),y=this.calculateOldIndex(C,l);if(E.length===0)return;const _=E[0];let b=y!==null&&!r;if(e&&(b=y!==null),b&&!n&&(u&&_>=y||d&&_<=y))return;const R=l.getAllDisplayedColumns();let D=[],O=null;for(let L=0;L<E.length;L++){const I=E[L],k=l.getProposedColumnOrder(C,I);if(!l.doesOrderPassRules(k))continue;const H=k.filter(Q=>R.includes(Q));if(O===null)O=H;else if(!fs(H,O))break;const ee=this.groupFragCount(k);D.push({move:I,fragCount:ee})}if(D.length!==0)return D.sort((L,I)=>L.fragCount-I.fragCount),this.moveColumns(c,D[0].move,"uiColumnMoved",!1,l)}static moveColumns(t,e,i,s,r){return r.moveColumns(t,e,i,s),s?null:{columns:t,toIndex:e}}static calculateOldIndex(t,e){const i=e.getAllGridColumns(),s=u0(t.map(l=>i.indexOf(l))),r=s[0];return Se(s)-r!==s.length-1?null:r}static groupFragCount(t){function e(s){let r=[],n=s.getOriginalParent();for(;n!=null;)r.push(n),n=n.getOriginalParent();return r}let i=0;for(let s=0;s<t.length-1;s++){let r=e(t[s]),n=e(t[s+1]);[r,n]=r.length>n.length?[r,n]:[n,r],r.forEach(o=>{n.indexOf(o)===-1&&i++})}return i}static getDisplayedColumns(t,e){switch(e){case"left":return t.getDisplayedLeftColumns();case"right":return t.getDisplayedRightColumns();default:return t.getDisplayedCenterColumns()}}static calculateValidMoves(t){const{movingCols:e,draggingRight:i,xPosition:s,pinned:r,gos:n,columnModel:o}=t;if(n.get("suppressMovableColumns")||e.some(D=>D.getColDef().suppressMovable))return[];const l=this.getDisplayedColumns(o,r),u=o.getAllGridColumns(),d=l.filter(D=>fi(e,D)),c=l.filter(D=>!fi(e,D)),C=u.filter(D=>!fi(e,D));let E=0,y=s;if(i){let D=0;d.forEach(O=>D+=O.getActualWidth()),y-=D}if(y>0){for(let D=0;D<c.length;D++){const O=c[D];if(y-=O.getActualWidth(),y<0)break;E++}i&&E++}let _;if(E>0){const D=c[E-1];_=C.indexOf(D)+1}else _=C.indexOf(c[0]),_===-1&&(_=0);const b=[_],R=(D,O)=>D-O;if(i){let D=_+1;const O=u.length-1;for(;D<=O;)b.push(D),D++;b.sort(R)}else{let D=_;const O=u.length-1;let L=u[D];for(;D<=O&&l.indexOf(L)<0;)D++,b.push(D),L=u[D];D=_-1;const I=0;for(;D>=I;)b.push(D),D--;b.sort(R).reverse()}return b}static normaliseX(t,e,i,s,r){const n=r.getHeaderRowContainerCtrl(e).getViewport();return i&&(t-=n.getBoundingClientRect().left),s.get("enableRtl")&&(t=n.clientWidth-t),e==null&&(t+=r.get("center").getCenterViewportScrollLeft()),t}},Jo=class{constructor(t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=t,this.isCenterContainer=!U(t)}init(){this.ctrlsService.whenReady(t=>{this.gridBodyCon=t.gridBodyCtrl})}getIconName(){return this.pinned?ae.ICON_PINNED:ae.ICON_MOVE}onDragEnter(t){const e=t.dragItem.columns;if(t.dragSource.type===0)this.setColumnsVisible(e,!0,"uiColumnDragged");else{const s=t.dragItem.visibleState,r=(e||[]).filter(n=>s[n.getId()]);this.setColumnsVisible(r,!0,"uiColumnDragged")}this.setColumnsPinned(e,this.pinned,"uiColumnDragged"),this.onDragging(t,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(t,e,i){if(t){const s=t.filter(r=>!r.getColDef().lockVisible);this.columnModel.setColumnsVisible(s,e,i)}}setColumnsPinned(t,e,i){if(t){const s=t.filter(r=>!r.getColDef().lockPinned);this.columnModel.setColumnsPinned(s,e,i)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(t){if(this.isCenterContainer){const e=this.ctrlsService.get("center"),i=e.getCenterViewportScrollLeft(),s=i+e.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=t<i+50,this.needToMoveLeft=t>s-50):(this.needToMoveLeft=t<i+50,this.needToMoveRight=t>s-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(t=this.lastDraggingEvent,e=!1,i=!1,s=!1){var r;if(s){if(this.lastMovedInfo){const{columns:d,toIndex:c}=this.lastMovedInfo;Jr.moveColumns(d,c,"uiColumnMoved",!0,this.columnModel)}return}if(this.lastDraggingEvent=t,re(t.hDirection))return;const n=Jr.normaliseX(t.x,this.pinned,!1,this.gos,this.ctrlsService);e||this.checkCenterForScrolling(n);const o=this.normaliseDirection(t.hDirection),a=t.dragSource.type,l=((r=t.dragSource.getDragItem().columns)==null?void 0:r.filter(d=>d.getColDef().lockPinned?d.getPinned()==this.pinned:!0))||[],u=Jr.attemptMoveColumns({allMovingColumns:l,isFromHeader:a===1,hDirection:o,xPosition:n,pinned:this.pinned,fromEnter:e,fakeEvent:i,gos:this.gos,columnModel:this.columnModel});u&&(this.lastMovedInfo=u)}normaliseDirection(t){if(this.gos.get("enableRtl"))switch(t){case 0:return 1;case 1:return 0;default:console.error(`AG Grid: Unknown direction ${t}`)}else return t}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(ae.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(ae.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(ae.ICON_MOVE))}moveInterval(){let t;this.intervalCount++,t=10+this.intervalCount*5,t>100&&(t=100);let e=null;const i=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?e=i.scrollHorizontally(-t):this.needToMoveRight&&(e=i.scrollHorizontally(t)),e!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const r=this.lastDraggingEvent.dragItem.columns.filter(n=>!n.getColDef().lockPinned);if(r.length>0&&(this.dragAndDropService.setGhostIcon(ae.ICON_PINNED),this.failedMoveAttempts>7)){const n=this.needToMoveLeft?"left":"right";this.setColumnsPinned(r,n,"uiColumnDragged"),this.dragAndDropService.nudge()}}}};g([T("columnModel")],Jo.prototype,"columnModel",2);g([T("dragAndDropService")],Jo.prototype,"dragAndDropService",2);g([T("gridOptionsService")],Jo.prototype,"gos",2);g([T("ctrlsService")],Jo.prototype,"ctrlsService",2);g([$],Jo.prototype,"init",1);var Zo=class extends z{constructor(t,e){super(),this.pinned=t,this.eContainer=e}postConstruct(){this.ctrlsService.whenReady(t=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.left.getContainerElement()],[t.bottomLeft.getContainerElement()],[t.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.right.getContainerElement()],[t.bottomRight.getContainerElement()],[t.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.center.getViewportElement()],[t.bottomCenter.getViewportElement()],[t.topCenter.getViewportElement()]];break}})}isInterestedIn(t){return t===1||t===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new Jo(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new vm(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(t){return this.columnModel.isPivotMode()&&t.dragSource.type===0}onDragEnter(t){this.currentDropListener=this.isDropColumnInPivotMode(t)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(t)}onDragLeave(t){this.currentDropListener.onDragLeave(t)}onDragging(t){this.currentDropListener.onDragging(t)}onDragStop(t){this.currentDropListener.onDragStop(t)}};g([T("dragAndDropService")],Zo.prototype,"dragAndDropService",2);g([T("columnModel")],Zo.prototype,"columnModel",2);g([T("ctrlsService")],Zo.prototype,"ctrlsService",2);g([$],Zo.prototype,"postConstruct",1);g([$],Zo.prototype,"init",1);var ea=class hb extends gm{constructor(e){super(hb.TEMPLATE,e),this.headerCompVersion=0,this.column=e.getColumnGroupChild(),this.pinned=e.getPinned()}postConstruct(){const e=this.getGui();((n,o)=>{o!=null&&o!=""?e.setAttribute(n,o):e.removeAttribute(n)})("col-id",this.column.getColId());const s={setWidth:n=>e.style.width=n,addOrRemoveCssClass:(n,o)=>this.addOrRemoveCssClass(n,o),setAriaSort:n=>n?k0(e,n):G0(e),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(s,this.getGui(),this.eResize,this.eHeaderCompWrapper);const r=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",r)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;const i=this.headerCompVersion;e.newAgStackInstance().then(s=>this.afterCompCreated(i,s))}afterCompCreated(e,i){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(i);return}this.destroyHeaderComp(),this.headerComp=i,this.headerCompGui=i.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}};ea.TEMPLATE=`<div class="ag-header-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>
        </div>`;g([q("eResize")],ea.prototype,"eResize",2);g([q("eHeaderCompWrapper")],ea.prototype,"eHeaderCompWrapper",2);g([$],ea.prototype,"postConstruct",1);g([Vt],ea.prototype,"destroyHeaderComp",1);var BO=ea,Kh=class cb extends gm{constructor(e){super(cb.TEMPLATE,e)}postConstruct(){const e=this.getGui(),i=(r,n)=>n!=null?e.setAttribute(r,n):e.removeAttribute(r);e.setAttribute("col-id",this.ctrl.getColId());const s={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setResizableDisplayed:r=>ve(this.eResize,r),setWidth:r=>e.style.width=r,setAriaExpanded:r=>i("aria-expanded",r),setUserCompDetails:r=>this.setUserCompDetails(r),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(s,e,this.eResize)}setUserCompDetails(e){e.newAgStackInstance().then(i=>this.afterHeaderCompCreated(i))}afterHeaderCompCreated(e){const i=()=>this.destroyBean(e);if(!this.isAlive()){i();return}const s=this.getGui(),r=e.getGui();s.appendChild(r),this.addDestroyFunc(i),this.headerGroupComp=e,this.ctrl.setDragSource(s)}};Kh.TEMPLATE=`<div class="ag-header-group-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
        </div>`;g([q("eResize")],Kh.prototype,"eResize",2);g([$],Kh.prototype,"postConstruct",1);var HO=Kh,ym=class extends oe{constructor(t){super(),this.headerComps={},this.ctrl=t,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}init(){Nf(this.getGui(),this.ctrl.getAriaRowIndex());const t={setHeight:e=>this.getGui().style.height=e,setTop:e=>this.getGui().style.top=e,setHeaderCtrls:(e,i)=>this.setHeaderCtrls(e,i),setWidth:e=>this.getGui().style.width=e};this.ctrl.setComp(t)}destroyHeaderCtrls(){this.setHeaderCtrls([],!1)}setHeaderCtrls(t,e){if(!this.isAlive())return;const i=this.headerComps;if(this.headerComps={},t.forEach(s=>{const r=s.getInstanceId();let n=i[r];delete i[r],n==null&&(n=this.createHeaderComp(s),this.getGui().appendChild(n.getGui())),this.headerComps[r]=n}),Tt(i,(s,r)=>{this.getGui().removeChild(r.getGui()),this.destroyBean(r)}),e){const s=hr(this.headerComps);s.sort((n,o)=>{const a=n.getCtrl().getColumnGroupChild().getLeft(),l=o.getCtrl().getColumnGroupChild().getLeft();return a-l});const r=s.map(n=>n.getGui());Qf(this.getGui(),r)}}createHeaderComp(t){let e;switch(this.ctrl.getType()){case"group":e=new HO(t);break;case"filter":e=new sO(t);break;default:e=new BO(t);break}return this.createBean(e),e.setParentComponent(this),e}};g([$],ym.prototype,"init",1);g([Vt],ym.prototype,"destroyHeaderCtrls",1);var UO=0,Js=class pb extends z{constructor(e,i,s){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=e,this.parentRowCtrl=s,this.beans=i,this.instanceId=e.getUniqueId()+"-"+UO++}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(e){const{headerRowIndex:i,column:s}=this.focusService.getFocusedHeader();return aT(this.gos,e,i,s)}getWrapperHasFocus(){return this.gos.getActiveDomElement()===this.eGui}setGui(e){this.eGui=e,this.addDomData(),this.addManagedListener(this.beans.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onDisplayedColumnsChanged(){!this.comp||!this.column||(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp:e,column:i,beans:s}=this;$h.refreshFirstAndLastStyles(e,i,s.columnModel)}refreshAriaColIndex(){const{beans:e,column:i}=this,s=e.columnModel.getAriaColumnIndex(i);kf(this.eGui,s)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&(this.addManagedListener(this.eGui,"keydown",this.onGuiKeyDown.bind(this)),this.addManagedListener(this.eGui,"keyup",this.onGuiKeyUp.bind(this)))}refreshTabIndex(){this.gos.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(e){var i;const s=this.gos.getActiveDomElement(),r=e.key===N.LEFT||e.key===N.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),s!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),!r))return;const n=e.key===N.LEFT!==this.gos.get("enableRtl"),o=GT[n?"Left":"Right"];if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const a=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(a,e.shiftKey),(i=this.resizeFeature)==null||i.toggleColumnResizing(!0)}else this.moveHeader(o)}getViewportAdjustedResizeDiff(e){let i=this.getResizeDiff(e);if(this.column.getPinned()){const r=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),o=mn(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(r+n+i>o)if(o>r+n)i=o-r-n;else return 0}return i}getResizeDiff(e){let i=e.key===N.LEFT!==this.gos.get("enableRtl");const s=this.column.getPinned(),r=this.gos.get("enableRtl");return s&&r!==(s==="right")&&(i=!i),(i?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=setTimeout(()=>{var e;(e=this.resizeFeature)==null||e.toggleColumnResizing(!1)},150))}handleKeyDown(e){const i=this.getWrapperHasFocus();switch(e.key){case N.PAGE_DOWN:case N.PAGE_UP:case N.PAGE_HOME:case N.PAGE_END:i&&e.preventDefault()}}addDomData(){const e=pb.DOM_DATA_KEY_HEADER_CTRL;this.gos.setDomData(this.eGui,e,this),this.addDestroyFunc(()=>this.gos.setDomData(this.eGui,e,null))}getGui(){return this.eGui}focus(e){return this.eGui?(this.lastFocusEvent=e||null,this.eGui.focus(),!0):!1}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,i,s){const r=e??i;this.gos.get("preventDefaultOnContextMenu")&&r.preventDefault();const n=s instanceof Pe?s:void 0;this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,e,i),this.dispatchColumnMouseEvent(S.EVENT_COLUMN_HEADER_CONTEXT_MENU,s)}dispatchColumnMouseEvent(e,i){const s={type:e,column:i};this.eventService.dispatchEvent(s)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}};Js.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";g([T("pinnedWidthService")],Js.prototype,"pinnedWidthService",2);g([T("focusService")],Js.prototype,"focusService",2);g([T("userComponentFactory")],Js.prototype,"userComponentFactory",2);g([T("ctrlsService")],Js.prototype,"ctrlsService",2);g([T("dragAndDropService")],Js.prototype,"dragAndDropService",2);g([T("menuService")],Js.prototype,"menuService",2);g([$],Js.prototype,"postConstruct",1);var Yh=Js,Xh=class extends z{constructor(t,e,i,s){super(),this.columnOrGroup=t,this.eCell=e,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=s,this.beans=i}setColsSpanning(t){this.colsSpanning=t,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?Se(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,Pe.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const t=this.beans.gos.get("suppressColumnMoveAnimation"),e=U(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&e&&!t?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const t=this.getColumnOrGroup(),e=t.getLeft(),i=t.getOldLeft(),s=this.modifyLeftForPrintLayout(t,i),r=this.modifyLeftForPrintLayout(t,e);this.setLeft(s),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const t=this.getColumnOrGroup(),e=t.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(t,e),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(t,e){if(!this.beans.gos.isDomLayout("print")||t.getPinned()==="left")return e;const s=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(t.getPinned()==="right"){const r=this.beans.columnModel.getBodyContainerWidth();return s+r+e}return s+e}setLeft(t){if(U(t)&&(this.eCell.style.left=`${t}px`),this.columnOrGroup instanceof Pe)this.columnOrGroup;else{const i=this.columnOrGroup.getLeafColumns();if(!i.length)return;i.length>1&&N0(this.ariaEl,i.length),i[0]}}};g([$],Xh.prototype,"postConstruct",1);var ru=class extends z{constructor(t,e){super(),this.columns=t,this.element=e}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};g([T("columnHoverService")],ru.prototype,"columnHoverService",2);g([$],ru.prototype,"postConstruct",1);var WO=class extends Yh{constructor(t,e,i){super(t,e,i),this.iconCreated=!1,this.column=t}setComp(t,e,i,s){this.comp=t,this.eButtonShowMainFilter=i,this.eFloatingFilterBody=s,this.setGui(e),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,Pe.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}resizeHeader(){}moveHeader(){}setupActive(){const t=this.column.getColDef(),e=!!t.filter,i=!!t.floatingFilter;this.active=e&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const t=je("filter",this.gos,this.column);t&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(t))}setupFocus(){this.createManagedBean(new Er(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const t=this.localeService.getLocaleTextFunc();Ci(this.eButtonShowMainFilter,t("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(t){if(this.gos.getActiveDomElement()===this.eGui)return;const s=this.focusService.findNextFocusableElement(this.eGui,null,t.shiftKey);if(s){this.beans.headerNavigationService.scrollToColumn(this.column),t.preventDefault(),s.focus();return}const r=this.findNextColumnWithFloatingFilter(t.shiftKey);r&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:r},event:t})&&t.preventDefault()}findNextColumnWithFloatingFilter(t){const e=this.beans.columnModel;let i=this.column;do if(i=t?e.getDisplayedColBefore(i):e.getDisplayedColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(t){super.handleKeyDown(t);const e=this.getWrapperHasFocus();switch(t.key){case N.UP:case N.DOWN:e||t.preventDefault();case N.LEFT:case N.RIGHT:if(e)return;t.stopPropagation();case N.ENTER:e&&this.focusService.focusInto(this.eGui)&&t.preventDefault();break;case N.ESCAPE:e||this.eGui.focus()}}onFocusIn(t){if(this.eGui.contains(t.relatedTarget))return;const i=!!t.relatedTarget&&!t.relatedTarget.classList.contains("ag-floating-filter"),s=!!t.relatedTarget&&Kr(t.relatedTarget,"ag-floating-filter");if(i&&s&&t.target===this.eGui){const n=this.lastFocusEvent,o=!!(n&&n.key===N.TAB);if(n&&o){const a=n.shiftKey;this.focusService.focusInto(this.eGui,a)}}const r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.column)}setupHover(){this.createManagedBean(new ru([this.column],this.eGui));const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,S.EVENT_COLUMN_HOVER_CHANGED,t),t()}setupLeft(){const t=new Xh(this.column,this.eGui,this.beans);this.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const t=this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());t&&this.setCompDetails(t)}setCompDetails(t){this.userCompDetails=t,this.comp.setCompDetails(t)}showParentFilter(){const t=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:t,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager:t}=this.beans,e=i=>{if((i==null?void 0:i.source)==="filterDestroyed"&&this.context.isDestroyed())return;const s=this.comp.getFloatingFilterComp();s&&s.then(r=>{var n;if(r){const o=t.getCurrentFloatingFilterParentModel(this.column);r.onParentModelChanged(o,i?this.gos.addGridCommonParams({columns:(n=i.columns)!=null?n:[],type:S.EVENT_FILTER_CHANGED,source:i.source==="api"?"api":"columnFilter"}):null)}})};this.destroySyncListener=this.addManagedListener(this.column,Pe.EVENT_FILTER_CHANGED,e),t.isFilterActive(this.column)&&e(null)}setupWidth(){const t=()=>{const e=`${this.column.getActualWidth()}px`;this.comp.setWidth(e)};this.addManagedListener(this.column,Pe.EVENT_WIDTH_CHANGED,t),t()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,Pe.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const t=this.beans.filterManager.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var t,e;const i=this.active;this.setupActive();const s=!i&&this.active;i&&!this.active&&((t=this.destroySyncListener)==null||t.call(this),(e=this.destroyFilterChangedListener)==null||e.call(this));const r=this.active?this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,n=this.comp.getFloatingFilterComp();!n||!r?this.updateCompDetails(r,s):n.then(o=>{var a;!o||this.beans.filterManager.areFilterCompsDifferent((a=this.userCompDetails)!=null?a:null,r)?this.updateCompDetails(r,s):this.updateFloatingFilterParams(r)})}updateCompDetails(t,e){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),e&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(t){var e;if(!t)return;const i=t.params;(e=this.comp.getFloatingFilterComp())==null||e.then(s=>{let r=!1;s!=null&&s.refresh&&typeof s.refresh=="function"&&s.refresh(i)!==null&&(r=!0),!r&&(s!=null&&s.onParamsUpdated)&&typeof s.onParamsUpdated=="function"&&s.onParamsUpdated(i)!==null&&ie("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},ta=class extends z{constructor(t,e,i,s,r){super(),this.pinned=t,this.column=e,this.eResize=i,this.comp=s,this.ctrl=r}postConstruct(){const t=[];let e,i;const s=()=>{if(ve(this.eResize,e),!e)return;const o=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(t.push(o),i){const a=this.gos.get("skipHeaderOnAutoSize"),l=()=>{this.columnModel.autoSizeColumn(this.column,"uiColumnResized",a)};this.eResize.addEventListener("dblclick",l);const u=new Ct(this.eResize);u.addEventListener(Ct.EVENT_DOUBLE_TAP,l),t.push(()=>{this.eResize.removeEventListener("dblclick",l),u.removeEventListener(Ct.EVENT_DOUBLE_TAP,l),u.destroy()})}},r=()=>{t.forEach(o=>o()),t.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==e||a!==i)&&(e=o,i=a,r(),s())};n(),this.addDestroyFunc(r),this.ctrl.addRefreshFunction(n)}onResizing(t,e){const{column:i,lastResizeAmount:s,resizeStartWidth:r}=this,n=this.normaliseResizeAmount(e),o=r+n,a=[{key:i,newWidth:o}];if(this.column.getPinned()){const l=this.pinnedWidthService.getPinnedLeftWidth(),u=this.pinnedWidthService.getPinnedRightWidth(),d=mn(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(l+u+(n-s)>d)return}this.lastResizeAmount=n,this.columnModel.setColumnWidths(a,this.resizeWithShiftKey,t,"uiColumnResized"),t&&this.toggleColumnResizing(!1)}onResizeStart(t){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=t,this.toggleColumnResizing(!0)}toggleColumnResizing(t){this.comp.addOrRemoveCssClass("ag-column-resizing",t)}normaliseResizeAmount(t){let e=t;const i=this.pinned!=="left",s=this.pinned==="right";return this.gos.get("enableRtl")?i&&(e*=-1):s&&(e*=-1),e}};g([T("horizontalResizeService")],ta.prototype,"horizontalResizeService",2);g([T("pinnedWidthService")],ta.prototype,"pinnedWidthService",2);g([T("ctrlsService")],ta.prototype,"ctrlsService",2);g([T("columnModel")],ta.prototype,"columnModel",2);g([$],ta.prototype,"postConstruct",1);var Sm=class extends z{constructor(t){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=t}onSpaceKeyDown(t){const e=this.cbSelectAll;e.isDisplayed()&&!e.getGui().contains(this.gos.getActiveDomElement())&&(t.preventDefault(),e.setValue(!e.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(t){this.headerCellCtrl=t,this.cbSelectAll=this.createManagedBean(new Gh),this.cbSelectAll.addCssClass("ag-header-select-all"),Qe(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,S.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),Yl(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const t=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(t);const e=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const t=this.localeService.getLocaleTextFunc(),i=this.cbSelectAll.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),s=t("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${s} (${i})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${s} (${i})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(t){return this.gos.get("rowSelection")==="multiple"?!0:(console.warn(`AG Grid: ${t} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(t){const e=this.rowModel.getType();return e==="clientSide"||e==="serverSide"?!0:(console.warn(`AG Grid: ${t} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${e}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const t=this.cbSelectAll.getValue(),e=this.isFilteredOnly(),i=this.isCurrentPageOnly();let s="uiSelectAll";i?s="uiSelectAllCurrentPage":e&&(s="uiSelectAllFiltered");const r={source:s,justFiltered:e,justCurrentPage:i};t?this.selectionService.selectAllRowNodes(r):this.selectionService.deselectAllRowNodes(r)}isCheckboxSelection(){let t=this.column.getColDef().headerCheckboxSelection;if(typeof t=="function"){const e=t,i=this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()});t=e(i)}return t?this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"):!1}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}};g([T("rowModel")],Sm.prototype,"rowModel",2);g([T("selectionService")],Sm.prototype,"selectionService",2);var zO=class extends Yh{constructor(t,e,i){super(t,e,i),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=t}setComp(t,e,i,s){this.comp=t,this.setGui(e),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(s),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new ta(this.getPinned(),this.column,i,t,this)),this.createManagedBean(new ru([this.column],e)),this.createManagedBean(new Xh(this.column,e,this.beans)),this.createManagedBean(new Er(e,{shouldStopEventPropagation:r=>this.shouldStopEventPropagation(r),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListener(this.column,Pe.EVENT_COL_DEF_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}resizeHeader(t,e){var i,s;if(!this.column.isResizable())return;const r=this.column.getActualWidth(),n=(i=this.column.getMinWidth())!=null?i:0,o=(s=this.column.getMaxWidth())!=null?s:Number.MAX_SAFE_INTEGER,a=Math.min(Math.max(r+t,n),o);this.beans.columnModel.setColumnWidths([{key:this.column,newWidth:a}],e,!0,"uiColumnResized")}moveHeader(t){const{eGui:e,column:i,gos:s,ctrlsService:r}=this,n=this.getPinned(),o=e.getBoundingClientRect().left,a=i.getActualWidth(),l=s.get("enableRtl"),u=t===0!==l,d=Jr.normaliseX(u?o-20:o+a+20,n,!0,s,r);Jr.attemptMoveColumns({allMovingColumns:[i],isFromHeader:!0,hDirection:t,xPosition:d,pinned:n,fromEnter:!1,fakeEvent:!1,gos:s,columnModel:this.beans.columnModel}),r.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(i,"auto")}setupUserComp(){const t=this.lookupUserCompDetails();this.setCompDetails(t)}setCompDetails(t){this.userCompDetails=t,this.comp.setUserCompDetails(t)}lookupUserCompDetails(){const t=this.createParams(),e=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(e,t)}createParams(){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:e=>{this.menuService.showColumnMenu({column:this.column,buttonElement:e,positionBy:"button"})},showColumnMenuAfterMouseClick:e=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:e,positionBy:"mouse"})},showFilter:e=>{this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"columnFilter",positionBy:"button"})},progressSort:e=>{this.beans.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,i)=>{this.beans.sortController.setSortForColumn(this.column,e,!!i,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(e,i)=>{this.setupTooltip(e,i)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new Sm(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(t){super.handleKeyDown(t),t.key===N.SPACE&&this.selectAllFeature.onSpaceKeyDown(t),t.key===N.ENTER&&this.onEnterKeyDown(t),t.key===N.DOWN&&t.altKey&&this.showMenuOnKeyPress(t,!1)}onEnterKeyDown(t){if(t.ctrlKey||t.metaKey)this.showMenuOnKeyPress(t,!0);else if(this.sortable){const e=t.shiftKey;this.beans.sortController.progressSort(this.column,e,"uiColumnSorted")}}showMenuOnKeyPress(t,e){const i=this.comp.getUserCompInstance();!i||!(i instanceof ag)||i.onMenuKeyboardShortcut(e)&&t.preventDefault()}onFocusIn(t){if(!this.getGui().contains(t.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(t){this.getGui().contains(t.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(t,e){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i=this.gos.get("tooltipShowMode")==="whenTruncated",s=this.eGui,r=this.column.getColDef();!e&&i&&!r.headerComponent&&(e=()=>{const a=s.querySelector(".ag-header-cell-text");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>s,getLocation:()=>"header",getTooltipValue:()=>t??this.column.getColDef().headerTooltip,shouldDisplayTooltip:e},o=this.createManagedBean(new Ys(n));this.refreshFunctions.push(()=>o.refreshToolTip())}setupClassesFromColDef(){const t=()=>{const e=this.column.getColDef(),i=$h.getHeaderClassesFromColDef(e,this.gos,this.column,null),s=this.userHeaderClasses;this.userHeaderClasses=new Set(i),i.forEach(r=>{s.has(r)?s.delete(r):this.comp.addOrRemoveCssClass(r,!0)}),s.forEach(r=>this.comp.addOrRemoveCssClass(r,!1))};this.refreshFunctions.push(t),t()}setDragSource(t){if(this.dragSourceElement=t,this.removeDragSource(),!t||!this.draggable)return;const{column:e,beans:i,displayName:s,dragAndDropService:r,gos:n}=this,{columnModel:o}=i;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:t,getDefaultIconName:()=>a?ae.ICON_HIDE:ae.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(e),dragItemName:s,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),e.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>e.setMoving(!1,"uiColumnMoved"),onGridEnter:u=>{var d;if(a){const c=((d=u==null?void 0:u.columns)==null?void 0:d.filter(C=>!C.getColDef().lockVisible))||[];o.setColumnsVisible(c,!0,"uiColumnMoved")}},onGridExit:u=>{var d;if(a){const c=((d=u==null?void 0:u.columns)==null?void 0:d.filter(C=>!C.getColDef().lockVisible))||[];o.setColumnsVisible(c,!1,"uiColumnMoved")}}};r.addDragSource(l,!0)}createDragItem(t){const e={};return e[t.getId()]=t.isVisible(),{columns:[t],visibleState:e}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(t){this.refreshFunctions.push(t)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(t=>t())}refreshHeaderComp(){const t=this.lookupUserCompDetails();(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==t.componentClass?this.attemptHeaderCompRefresh(t.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(t){const e=this.comp.getUserCompInstance();return!e||!e.refresh?!1:e.refresh(t)}calculateDisplayName(){return this.beans.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const t=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!t.suppressMovable&&!t.lockPosition)||!!t.enableRowGroup||!!t.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const t=()=>{const e=this.column.getActualWidth();this.comp.setWidth(`${e}px`)};this.addManagedListener(this.column,Pe.EVENT_WIDTH_CHANGED,t),t()}setupMovingCss(){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,Pe.EVENT_MOVING_CHANGED,t),t()}setupMenuClass(){const t=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,Pe.EVENT_MENU_VISIBLE_CHANGED,t),t()}setupSortableClass(){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.addRefreshFunction(t),this.addManagedListener(this.eventService,Pe.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupFilterClass(){const t=()=>{const e=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",e),this.refreshAria()};this.addManagedListener(this.column,Pe.EVENT_FILTER_ACTIVE_CHANGED,t),t()}setupWrapTextClass(){const t=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};t(),this.addRefreshFunction(t)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:t,column:e,comp:i,beans:s}=this;if(!e.isSpanHeaderHeight()){t.style.removeProperty("top"),t.style.removeProperty("height"),i.addOrRemoveCssClass("ag-header-span-height",!1),i.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:r,isSpanningTotal:n}=this.column.getColumnGroupPaddingInfo();i.addOrRemoveCssClass("ag-header-span-height",r>0);const{columnModel:o}=s,a=o.getColumnHeaderRowHeight();if(r===0){i.addOrRemoveCssClass("ag-header-span-total",!1),t.style.setProperty("top","0px"),t.style.setProperty("height",`${a}px`);return}i.addOrRemoveCssClass("ag-header-span-total",n);const u=o.isPivotMode()?o.getPivotGroupHeaderHeight():o.getGroupHeaderHeight(),d=r*u;t.style.setProperty("top",`${-d}px`),t.style.setProperty("height",`${a+d}px`)}setupAutoHeight(t){const{columnModel:e,resizeObserverService:i}=this.beans,s=u=>{if(!this.isAlive())return;const{paddingTop:d,paddingBottom:c,borderBottomWidth:C,borderTopWidth:E}=Sr(this.getGui()),y=d+c+C+E,b=t.offsetHeight+y;if(u<5){const R=this.beans.gos.getDocument(),D=!R||!R.contains(t),O=b==0;if(D||O){window.setTimeout(()=>s(u+1),0);return}}e.setColumnHeaderHeight(this.column,b)};let r=!1,n;const o=()=>{const u=this.column.isAutoHeaderHeight();u&&!r&&a(),!u&&r&&l()},a=()=>{r=!0,s(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),n=i.observeResize(t,()=>s(0))},l=()=>{r=!1,n&&n(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),n=void 0};o(),this.addDestroyFunc(()=>l()),this.addManagedListener(this.column,Pe.EVENT_WIDTH_CHANGED,()=>r&&s(0)),this.addManagedListener(this.eventService,Pe.EVENT_SORT_CHANGED,()=>{r&&window.setTimeout(()=>s(0))}),this.addRefreshFunction(o)}refreshAriaSort(){if(this.sortable){const t=this.localeService.getLocaleTextFunc(),e=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(D0(e)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const t=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",t("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const t=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",t("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const t=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",t("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(t,e){e!=null?this.ariaDescriptionProperties.set(t,e):this.ariaDescriptionProperties.delete(t)}announceAriaDescription(){if(!this.eGui.contains(this.beans.gos.getActiveDomElement()))return;const t=Array.from(this.ariaDescriptionProperties.keys()).sort((e,i)=>e==="filter"?-1:i.charCodeAt(0)-e.charCodeAt(0)).map(e=>this.ariaDescriptionProperties.get(e)).join(". ");this.beans.ariaAnnouncementService.announceValue(t)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};this.addManagedListener(this.eventService,S.EVENT_COLUMN_HOVER_CHANGED,t),t()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const t=s=>this.handleMouseOverChange(s.type==="mouseenter"),e=()=>this.dispatchColumnMouseEvent(S.EVENT_COLUMN_HEADER_CLICKED,this.column),i=s=>this.handleContextMenuMouseEvent(s,void 0,this.column);this.addManagedListener(this.getGui(),"mouseenter",t),this.addManagedListener(this.getGui(),"mouseleave",t),this.addManagedListener(this.getGui(),"click",e),this.addManagedListener(this.getGui(),"contextmenu",i)}handleMouseOverChange(t){this.setActiveHeader(t);const i={type:t?S.EVENT_COLUMN_HEADER_MOUSE_OVER:S.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column};this.eventService.dispatchEvent(i)}setActiveHeader(t){this.comp.addOrRemoveCssClass("ag-header-active",t)}getAnchorElementForMenu(t){const e=this.comp.getUserCompInstance();return e instanceof ag?e.getAnchorElementForMenu(t):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},nu=class extends z{constructor(t,e,i,s){super(),this.eResize=e,this.comp=t,this.pinned=i,this.columnGroup=s}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const t=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(t),!this.gos.get("suppressAutoSize")){const e=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const i=[];this.columnGroup.getDisplayedLeafColumns().forEach(r=>{r.getColDef().suppressAutoSize||i.push(r.getColId())}),i.length>0&&this.columnModel.autoSizeColumns({columns:i,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(t){const e=this.getInitialValues(t);this.storeLocalValues(e),this.toggleColumnResizing(!0)}onResizing(t,e,i="uiColumnResized"){const s=this.normaliseDragChange(e),r=this.resizeStartWidth+s;this.resizeColumnsFromLocalValues(r,i,t)}getInitialValues(t){const e=this.getColumnsToResize(),i=this.getInitialSizeOfColumns(e),s=this.getSizeRatiosOfColumns(e,i),r={columnsToResize:e,resizeStartWidth:i,resizeRatios:s};let n=null;if(t&&(n=this.columnModel.getDisplayedGroupAtDirection(this.columnGroup,"After")),n){const o=n.getDisplayedLeafColumns(),a=r.groupAfterColumns=o.filter(u=>u.isResizable()),l=r.groupAfterStartWidth=this.getInitialSizeOfColumns(a);r.groupAfterRatios=this.getSizeRatiosOfColumns(a,l)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}storeLocalValues(t){const{columnsToResize:e,resizeStartWidth:i,resizeRatios:s,groupAfterColumns:r,groupAfterStartWidth:n,groupAfterRatios:o}=t;this.resizeCols=e,this.resizeStartWidth=i,this.resizeRatios=s,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(t){const e=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();e>i.resizeStartWidth&&this.resizeColumns(i,e,t,!0)}resizeColumnsFromLocalValues(t,e,i=!0){var s,r,n;if(!this.resizeCols||!this.resizeRatios)return;const o={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:(s=this.resizeTakeFromCols)!=null?s:void 0,groupAfterStartWidth:(r=this.resizeTakeFromStartWidth)!=null?r:void 0,groupAfterRatios:(n=this.resizeTakeFromRatios)!=null?n:void 0};this.resizeColumns(o,t,e,i)}resizeColumns(t,e,i,s=!0){const{columnsToResize:r,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:u}=t,d=[];if(d.push({columns:r,ratios:o,width:e}),a){const c=e-n;d.push({columns:a,ratios:u,width:l-c})}this.columnModel.resizeColumnSets({resizeSets:d,finished:s,source:i}),s&&this.toggleColumnResizing(!1)}toggleColumnResizing(t){this.comp.addOrRemoveCssClass("ag-column-resizing",t)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(e=>e.isResizable())}getInitialSizeOfColumns(t){return t.reduce((e,i)=>e+i.getActualWidth(),0)}getSizeRatiosOfColumns(t,e){return t.map(i=>i.getActualWidth()/e)}normaliseDragChange(t){let e=t;return this.gos.get("enableRtl")?this.pinned!=="left"&&(e*=-1):this.pinned==="right"&&(e*=-1),e}destroy(){super.destroy(),this.clearLocalValues()}};g([T("horizontalResizeService")],nu.prototype,"horizontalResizeService",2);g([T("autoWidthCalculator")],nu.prototype,"autoWidthCalculator",2);g([T("columnModel")],nu.prototype,"columnModel",2);g([$],nu.prototype,"postConstruct",1);var gb=class extends z{constructor(t,e){super(),this.removeChildListenersFuncs=[],this.columnGroup=e,this.comp=t}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,gt.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const t=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(e=>{e.addEventListener("widthChanged",t),e.addEventListener("visibleChanged",t),this.removeChildListenersFuncs.push(()=>{e.removeEventListener("widthChanged",t),e.removeEventListener("visibleChanged",t)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(t=>t()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const t=this.columnGroup.getActualWidth();this.comp.setWidth(`${t}px`),this.comp.addOrRemoveCssClass("ag-hidden",t===0)}};g([$],gb.prototype,"postConstruct",1);var $O=class extends Yh{constructor(t,e,i){super(t,e,i),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const s=this.getGui();this.setDragSource(s)}},this.column=t}setComp(t,e,i){this.comp=t,this.setGui(e),this.displayName=this.beans.columnModel.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const s=this.getParentRowCtrl().getPinned(),r=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new ru(r,e)),this.createManagedBean(new Xh(this.column,e,this.beans)),this.createManagedBean(new gb(t,this.column)),this.resizeFeature=this.createManagedBean(new nu(t,i,s,this.column)),this.createManagedBean(new Er(e,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener(S.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(t,e){if(!this.resizeFeature)return;const i=this.resizeFeature.getInitialValues(e);this.resizeFeature.resizeColumns(i,i.resizeStartWidth+t,"uiColumnResized",!0)}moveHeader(t){const{beans:e,eGui:i,column:s,gos:r,ctrlsService:n}=this,o=r.get("enableRtl"),a=t===0,l=this.getPinned(),u=i.getBoundingClientRect(),d=u.left,c=u.width,C=Jr.normaliseX(a!==o?d-20:d+c+20,l,!0,r,n),E=s.getGroupId(),y=this.focusService.getFocusedHeader();Jr.attemptMoveColumns({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection:t,xPosition:C,pinned:l,fromEnter:!1,fakeEvent:!1,gos:r,columnModel:e.columnModel});const _=s.getDisplayedLeafColumns(),b=a?_[0]:Se(_);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(b,"auto"),!this.isAlive()&&y&&this.restoreFocus(E,s,y)}restoreFocus(t,e,i){const s=e.getLeafColumns();if(!s.length)return;const r=s[0].getParent();if(!r)return;const n=this.findGroupWidthId(r,t);n&&this.focusService.focusHeaderPosition({headerPosition:He(te({},i),{column:n})})}findGroupWidthId(t,e){for(;t;){if(t.getGroupId()===e)return t;t=t.getParent()}return null}resizeLeafColumnsToFit(t){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(t)}setupUserComp(){const t=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:i=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),i,"gridInitializing")},setTooltip:(i,s)=>{this.setupTooltip(i,s)}}),e=this.userComponentFactory.getHeaderGroupCompDetails(t);this.comp.setUserCompDetails(e)}addHeaderMouseListeners(){const t=s=>this.handleMouseOverChange(s.type==="mouseenter"),e=()=>this.dispatchColumnMouseEvent(S.EVENT_COLUMN_HEADER_CLICKED,this.column.getProvidedColumnGroup()),i=s=>this.handleContextMenuMouseEvent(s,void 0,this.column.getProvidedColumnGroup());this.addManagedListener(this.getGui(),"mouseenter",t),this.addManagedListener(this.getGui(),"mouseleave",t),this.addManagedListener(this.getGui(),"click",e),this.addManagedListener(this.getGui(),"contextmenu",i)}handleMouseOverChange(t){const i={type:t?S.EVENT_COLUMN_HEADER_MOUSE_OVER:S.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(i)}setupTooltip(t,e){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i=this.column.getColGroupDef(),s=this.gos.get("tooltipShowMode")==="whenTruncated",r=this.eGui;!e&&s&&!(i!=null&&i.headerGroupComponent)&&(e=()=>{const o=r.querySelector(".ag-header-group-text");return o?o.scrollWidth>o.clientWidth:!0});const n={getColumn:()=>this.column,getGui:()=>r,getLocation:()=>"headerGroup",getTooltipValue:()=>t??(i&&i.headerTooltip),shouldDisplayTooltip:e};i&&(n.getColDef=()=>i),this.createBean(new Ys(n))}setupExpandable(){const t=this.column.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(t,nt.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(t,nt.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const t=this.column;this.expandable=t.isExpandable();const e=t.isExpanded();this.expandable?this.comp.setAriaExpanded(e?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const t=this.column.getColGroupDef(),e=$h.getHeaderClassesFromColDef(t,this.gos,null,this.column);this.column.isPadding()?(e.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(s=>s.isSpanHeaderHeight())&&e.push("ag-header-span-height")):e.push("ag-header-group-cell-with-group"),e.forEach(i=>this.comp.addOrRemoveCssClass(i,!0))}setupMovingCss(){const e=this.column.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());e.forEach(s=>{this.addManagedListener(s,Pe.EVENT_MOVING_CHANGED,i)}),i()}onFocusIn(t){if(!this.eGui.contains(t.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.column)}}handleKeyDown(t){super.handleKeyDown(t);const e=this.getWrapperHasFocus();if(!(!this.expandable||!e)&&t.key===N.ENTER){const i=this.column,s=!i.isExpanded();this.beans.columnModel.setColumnGroupOpened(i.getProvidedColumnGroup(),s,"uiColumnExpanded")}}setDragSource(t){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!t))return;const{beans:e,column:i,displayName:s,gos:r,dragAndDropService:n}=this,{columnModel:o}=e,a=i.getProvidedColumnGroup().getLeafColumns();let l=!r.get("suppressDragLeaveHidesColumns");const u=this.dragSource={type:1,eElement:t,getDefaultIconName:()=>l?ae.ICON_HIDE:ae.ICON_NOT_ALLOWED,dragItemName:s,getDragItem:()=>this.getDragItemForGroup(i),onDragStarted:()=>{l=!r.get("suppressDragLeaveHidesColumns"),a.forEach(d=>d.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>a.forEach(d=>d.setMoving(!1,"uiColumnDragged")),onGridEnter:d=>{var c;if(l){const C=((c=d==null?void 0:d.columns)==null?void 0:c.filter(E=>!E.getColDef().lockVisible))||[];o.setColumnsVisible(C,!0,"uiColumnMoved")}},onGridExit:d=>{var c;if(l){const C=((c=d==null?void 0:d.columns)==null?void 0:c.filter(E=>!E.getColDef().lockVisible))||[];o.setColumnsVisible(C,!1,"uiColumnMoved")}}};n.addDragSource(u,!0)}getDragItemForGroup(t){const e=t.getProvidedColumnGroup().getLeafColumns(),i={};e.forEach(r=>i[r.getId()]=r.isVisible());const s=[];return this.beans.columnModel.getAllDisplayedColumns().forEach(r=>{e.indexOf(r)>=0&&(s.push(r),$t(e,r))}),e.forEach(r=>s.push(r)),{columns:s,visibleState:i}}isSuppressMoving(){let t=!1;return this.column.getLeafColumns().forEach(i=>{(i.getColDef().suppressMovable||i.getColDef().lockPosition)&&(t=!0)}),t||this.gos.get("suppressMovableColumns")}},jO=0,Za=class extends z{constructor(t,e,i){super(),this.instanceId=jO++,this.rowIndex=t,this.pinned=e,this.type=i;const s=i=="group"?"ag-header-row-column-group":i=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${s}`}postConstruct(){this.isPrintLayout=this.gos.isDomLayout("print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}getInstanceId(){return this.instanceId}setComp(t,e=!0){this.comp=t,e&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){this.addManagedListener(this.eventService,S.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_VIRTUAL_COLUMNS_CHANGED,t=>this.onVirtualColumnsChanged(t.afterScroll)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",t=>this.isEnsureDomOrder=t.currentValue),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(t){if(this.headerCellCtrls)return qr(this.headerCellCtrls).find(e=>e.getColumnGroupChild()===t)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gos.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const t=this.getWidthForRow();this.comp.setWidth(`${t}px`)}getWidthForRow(){const{columnModel:t}=this.beans;return this.isPrintLayout?this.pinned!=null?0:t.getContainerWidth("right")+t.getContainerWidth("left")+t.getContainerWidth(null):t.getContainerWidth(this.pinned)}onRowHeightChanged(){var{topOffset:t,rowHeight:e}=this.getTopAndHeight();this.comp.setTop(t+"px"),this.comp.setHeight(e+"px")}getTopAndHeight(){const{columnModel:t,filterManager:e}=this.beans;let i=t.getHeaderRowCount();const s=[];let r=0;e.hasFloatingFilters()&&(i++,r=1);const n=t.getColumnGroupHeaderRowHeight(),o=t.getColumnHeaderRowHeight(),a=1+r,l=i-a;for(let c=0;c<l;c++)s.push(n);s.push(o);for(let c=0;c<r;c++)s.push(t.getFloatingFiltersHeight());let u=0;for(let c=0;c<this.rowIndex;c++)u+=s[c];const d=s[this.rowIndex];return{topOffset:u,rowHeight:d}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(t=!1){const e=this.getHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(e,i,t)}getHeaderCtrls(){const t=this.headerCellCtrls;this.headerCellCtrls=new Map;const e=this.getColumnsInViewport();for(const r of e)this.recycleAndCreateHeaderCtrls(r,t);const i=r=>{const{focusService:n,columnModel:o}=this.beans;return n.isHeaderWrapperFocused(r)?o.isDisplayed(r.getColumnGroupChild()):!1};if(t)for(const[r,n]of t)i(n)?this.headerCellCtrls.set(r,n):this.destroyBean(n);return Array.from(this.headerCellCtrls.values())}recycleAndCreateHeaderCtrls(t,e){if(!this.headerCellCtrls||t.isEmptyGroup())return;const i=t.getUniqueId();let s;if(e&&(s=e.get(i),e.delete(i)),s&&s.getColumnGroupChild()!=t&&(this.destroyBean(s),s=void 0),s==null)switch(this.type){case"filter":s=this.createBean(new WO(t,this.beans,this));break;case"group":s=this.createBean(new $O(t,this.beans,this));break;default:s=this.createBean(new zO(t,this.beans,this));break}this.headerCellCtrls.set(i,s)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let t=[];const e=this.getActualDepth(),{columnModel:i}=this.beans;return["left",null,"right"].forEach(s=>{const r=i.getVirtualHeaderGroupRow(s,e);t=t.concat(r)}),t}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(t,e){if(!this.headerCellCtrls)return!1;const s=Array.from(this.headerCellCtrls.values()).find(r=>r.getColumnGroupChild()==t);return s?s.focus(e):!1}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(t=>{this.destroyBean(t)}),this.headerCellCtrls=void 0,super.destroy()}};g([T("beans")],Za.prototype,"beans",2);g([$],Za.prototype,"postConstruct",1);var Tn=class extends z{constructor(t){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=t}setComp(t,e){this.comp=t,this.eViewport=e,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,S.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(t){const e=new Zo(this.pinned,t);this.createManagedBean(e)}refresh(t=!1){const e=new xo,i=this.focusService.getFocusHeaderToUseAfterRefresh(),s=()=>{const a=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let l=0;l<a;l++){const u=this.createBean(new Za(e.next(),this.pinned,"group"));this.groupsRowCtrls.push(u)}},r=()=>{const a=e.next(),l=!this.hidden&&(this.columnsRowCtrl==null||!t||this.columnsRowCtrl.getRowIndex()!==a);(l||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),l&&(this.columnsRowCtrl=this.createBean(new Za(a,this.pinned,"column")))},n=()=>{this.includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;const a=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){a();return}const l=e.next();if(this.filtersRowCtrl){const u=this.filtersRowCtrl.getRowIndex()!==l;(!t||u)&&a()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new Za(l,this.pinned,"filter")))};s(),r(),n();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(i)}restoreFocusOnHeader(t){t==null||t.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:t})}getAllCtrls(){const t=[...this.groupsRowCtrls];return this.columnsRowCtrl&&t.push(this.columnsRowCtrl),this.filtersRowCtrl&&t.push(this.filtersRowCtrl),t}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const t=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Xo(t=>this.comp.setCenterWidth(`${t}px`),!0))}setHorizontalScroll(t){this.comp.setViewportScrollLeft(t)}setupPinnedWidth(){if(this.pinned==null)return;const t=this.pinned==="left",e=this.pinned==="right";this.hidden=!0;const i=()=>{const s=t?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(s==null)return;const r=s==0,n=this.hidden!==r,o=this.gos.get("enableRtl"),a=this.gos.getScrollbarWidth(),u=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&t||!o&&e)?s+a:s;this.comp.setPinnedContainerWidth(`${u}px`),this.comp.setDisplayed(!r),n&&(this.hidden=r,this.refresh())};this.addManagedListener(this.eventService,S.EVENT_LEFT_PINNED_WIDTH_CHANGED,i),this.addManagedListener(this.eventService,S.EVENT_RIGHT_PINNED_WIDTH_CHANGED,i),this.addManagedListener(this.eventService,S.EVENT_SCROLL_VISIBILITY_CHANGED,i),this.addManagedListener(this.eventService,S.EVENT_SCROLLBAR_WIDTH_CHANGED,i)}getHeaderCtrlForColumn(t){if(t instanceof Pe)return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(t):void 0;if(this.groupsRowCtrls.length!==0)for(let e=0;e<this.groupsRowCtrls.length;e++){const i=this.groupsRowCtrls[e].getHeaderCellCtrl(t);if(i)return i}}getHtmlElementForColumnHeader(t){const e=this.getHeaderCtrlForColumn(t);return e?e.getGui():null}getRowType(t){const i=this.getAllCtrls()[t];return i?i.getType():void 0}focusHeader(t,e,i){const r=this.getAllCtrls()[t];return r?r.focusHeader(e,i):!1}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}};g([T("ctrlsService")],Tn.prototype,"ctrlsService",2);g([T("scrollVisibleService")],Tn.prototype,"scrollVisibleService",2);g([T("pinnedWidthService")],Tn.prototype,"pinnedWidthService",2);g([T("columnModel")],Tn.prototype,"columnModel",2);g([T("focusService")],Tn.prototype,"focusService",2);g([T("filterManager")],Tn.prototype,"filterManager",2);var bn=class rd extends oe{constructor(e){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=e}init(){this.selectAndSetTemplate();const e={setDisplayed:s=>this.setDisplayed(s),setCtrls:s=>this.setCtrls(s),setCenterWidth:s=>this.eCenterContainer.style.width=s,setViewportScrollLeft:s=>this.getGui().scrollLeft=s,setPinnedContainerWidth:s=>{const r=this.getGui();r.style.width=s,r.style.maxWidth=s,r.style.minWidth=s}};this.createManagedBean(new Tn(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){const e=this.pinned=="left",i=this.pinned=="right",s=e?rd.PINNED_LEFT_TEMPLATE:i?rd.PINNED_RIGHT_TEMPLATE:rd.CENTER_TEMPLATE;this.setTemplate(s),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){const i=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let s;const r=n=>{const o=n.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),s&&Xf(this.eRowContainer,o,s),s=o};e.forEach(n=>{const o=n.getInstanceId(),a=i[o];delete i[o];const l=a||this.createBean(new ym(n));this.headerRowComps[o]=l,this.rowCompsList.push(l),r(l)}),hr(i).forEach(n=>this.destroyRowComp(n))}};bn.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="rowgroup"></div>';bn.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="rowgroup"></div>';bn.CENTER_TEMPLATE=`<div class="ag-header-viewport" role="presentation">
            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>
        </div>`;g([q("eCenterContainer")],bn.prototype,"eCenterContainer",2);g([$],bn.prototype,"init",1);g([Vt],bn.prototype,"destroyRowComps",1);var op=bn,nn=class extends z{constructor(){super(...arguments),this.currentHeaderRowWithoutSpan=-1}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl});const t=this.gos.getDocument();this.addManagedListener(t,"mousedown",()=>this.setCurrentHeaderRowWithoutSpan(-1))}getHeaderRowCount(){const t=this.ctrlsService.getHeaderRowContainerCtrl();return t?t.getRowCount():0}navigateVertically(t,e,i){if(e||(e=this.focusService.getFocusedHeader()),!e)return!1;const{headerRowIndex:s,column:r}=e,n=this.getHeaderRowCount(),o=t===0;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:u}=o?this.headerPositionUtils.getColumnVisibleParent(r,s):this.headerPositionUtils.getColumnVisibleChild(r,s),d=!1;return a<0&&(a=0,l=r,d=!0),a>=n?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):u!==void 0&&(this.currentHeaderRowWithoutSpan=u),!d&&!l?!1:this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:i})}setCurrentHeaderRowWithoutSpan(t){this.currentHeaderRowWithoutSpan=t}navigateHorizontally(t,e=!1,i){const s=this.focusService.getFocusedHeader(),r=t===2,n=this.gos.get("enableRtl");let o,a;if(this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,r!==n?(a="Before",o=this.headerPositionUtils.findHeader(s,a)):(a="After",o=this.headerPositionUtils.findHeader(s,a)),o||!e)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:e,allowUserOverride:!0,event:i});if(e){const l=this.gos.getCallback("tabToNextHeader");if(l)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a})}return this.focusNextHeaderRow(s,a,i)}focusNextHeaderRow(t,e,i){const s=t.headerRowIndex;let r=null,n;if(e==="Before"?s>0&&(n=s-1,this.currentHeaderRowWithoutSpan-=1,r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=s+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),!r)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(r.column,r==null?void 0:r.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:e,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(t,e="After"){if(t.getPinned())return;let i;if(t instanceof gt){const s=t.getDisplayedLeafColumns();i=e==="Before"?Se(s):s[0]}else i=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(i)}};g([T("focusService")],nn.prototype,"focusService",2);g([T("headerPositionUtils")],nn.prototype,"headerPositionUtils",2);g([T("ctrlsService")],nn.prototype,"ctrlsService",2);g([$],nn.prototype,"postConstruct",1);nn=g([Y("headerNavigationService")],nn);var _n=class extends z{setComp(t,e,i){this.comp=t,this.eGui=e,this.createManagedBean(new Er(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight();const s=this.onHeaderContextMenu.bind(this);this.addManagedListener(this.eGui,"contextmenu",s),this.mockContextMenuForIPad(s),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const t=this.setHeaderHeight.bind(this);t(),this.addManagedPropertyListener("headerHeight",t),this.addManagedPropertyListener("pivotHeaderHeight",t),this.addManagedPropertyListener("groupHeaderHeight",t),this.addManagedPropertyListener("pivotGroupHeaderHeight",t),this.addManagedPropertyListener("floatingFiltersHeight",t),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_GRID_STYLES_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,t)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:t}=this;let e=0,i=t.getHeaderRowCount(),s;this.filterManager.hasFloatingFilters()&&(i++,e=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),a=1+e,l=i-a;if(s=e*t.getFloatingFiltersHeight(),s+=l*n,s+=o,this.headerHeight===s)return;this.headerHeight=s;const u=`${s+1}px`;this.comp.setHeightAndMinHeight(u),this.eventService.dispatchEvent({type:S.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const t=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)}onDisplayedColumnsChanged(){const e=this.columnModel.getAllDisplayedColumns().some(i=>i.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(t){const e=this.gos.get("enableRtl"),i=t.shiftKey!==e?2:3;(this.headerNavigationService.navigateHorizontally(i,!0,t)||this.focusService.focusNextGridCoreContainer(t.shiftKey))&&t.preventDefault()}handleKeyDown(t){let e=null;switch(t.key){case N.LEFT:e=2;case N.RIGHT:U(e)||(e=3),this.headerNavigationService.navigateHorizontally(e,!1,t);break;case N.UP:e=0;case N.DOWN:U(e)||(e=1),this.headerNavigationService.navigateVertically(e,null,t)&&t.preventDefault();break;default:return}}onFocusOut(t){const{relatedTarget:e}=t;!e&&this.eGui.contains(this.gos.getActiveDomElement())||this.eGui.contains(e)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(t,e,i){if(!t&&!i||!this.menuService.isHeaderContextMenuEnabled())return;const{target:s}=t??e;(s===this.eGui||s===this.ctrlsService.getHeaderRowContainerCtrl().getViewport())&&this.menuService.showHeaderContextMenu(void 0,t,i)}mockContextMenuForIPad(t){if(!Ks())return;const e=new Ct(this.eGui),i=s=>{t(void 0,s.touchStart,s.touchEvent)};this.addManagedListener(e,Ct.EVENT_LONG_TAP,i),this.addDestroyFunc(()=>e.destroy())}};g([T("headerNavigationService")],_n.prototype,"headerNavigationService",2);g([T("focusService")],_n.prototype,"focusService",2);g([T("columnModel")],_n.prototype,"columnModel",2);g([T("ctrlsService")],_n.prototype,"ctrlsService",2);g([T("filterManager")],_n.prototype,"filterManager",2);g([T("menuService")],_n.prototype,"menuService",2);var Em=class fb extends oe{constructor(){super(fb.TEMPLATE)}postConstruct(){const e={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setHeightAndMinHeight:r=>{this.getGui().style.height=r,this.getGui().style.minHeight=r}};this.createManagedBean(new _n).setComp(e,this.getGui(),this.getFocusableElement());const s=r=>{this.createManagedBean(r),this.appendChild(r)};s(new op("left")),s(new op(null)),s(new op("right"))}};Em.TEMPLATE='<div class="ag-header" role="presentation"/>';g([$],Em.prototype,"postConstruct",1);var qO=Em,wl=class extends z{addResizeBar(t){const e={dragStartPixels:t.dragStartPixels||0,eElement:t.eResizeBar,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this,t),onDragging:this.onDragging.bind(this,t),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(e),()=>this.dragService.removeDragSource(e)}onDragStart(t,e){this.dragStartX=e.clientX,this.setResizeIcons();const i=e instanceof MouseEvent&&e.shiftKey===!0;t.onResizeStart(i)}setResizeIcons(){const t=this.ctrlsService.get("gridCtrl");t.setResizeCursor(!0),t.disableUserSelect(!0)}onDragStop(t,e){t.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const t=this.ctrlsService.get("gridCtrl");t.setResizeCursor(!1),t.disableUserSelect(!1)}onDragging(t,e){this.resizeAmount=e.clientX-this.dragStartX,t.onResizing(this.resizeAmount)}};g([T("dragService")],wl.prototype,"dragService",2);g([T("ctrlsService")],wl.prototype,"ctrlsService",2);wl=g([Y("horizontalResizeService")],wl);var pr=class extends z{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(t,e,i){this.showPopup(t,s=>{this.popupService.positionPopupUnderMouseEvent({column:t,type:i,mouseEvent:e,ePopup:s})},i,e.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(t,e,i){let s=-1,r="left";const n=this.menuService.isLegacyMenuEnabled();!n&&this.gos.get("enableRtl")&&(s=1,r="right");let o=n?void 0:4*s,a=n?void 0:4;this.showPopup(t,l=>{this.popupService.positionPopupByComponent({type:i,eventSource:e,ePopup:l,nudgeX:o,nudgeY:a,alignSide:r,keepWithinBounds:!0,position:"under",column:t})},i,e,n)}showPopup(t,e,i,s,r){const n=t?this.createBean(new Wh(t,"COLUMN_MENU")):void 0;if(this.activeMenu=n,!(n!=null&&n.hasFilter())||!t)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");Qe(o,"presentation"),o.classList.add("ag-menu"),r||o.classList.add("ag-filter-menu"),this.tabListener=this.addManagedListener(o,"keydown",y=>this.trapFocusWithin(y,o)),o.appendChild(n==null?void 0:n.getGui());let a;const l=()=>n==null?void 0:n.afterGuiDetached(),u=this.menuService.isColumnMenuAnchoringEnabled()?s??this.ctrlsService.getGridBodyCtrl().getGui():void 0,d=y=>{t.setMenuVisible(!1,"contextMenu");const _=y instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),_&&s&&ti(s)){const b=this.focusService.findTabbableParent(s);b&&b.focus()}l(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,t)},c=this.localeService.getLocaleTextFunc(),C=r&&i!=="columnFilter"?c("ariaLabelColumnMenu","Column Menu"):c("ariaLabelColumnFilter","Column Filter"),E=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:d,positionCallback:()=>e(o),anchorToElement:u,ariaLabel:C});E&&(this.hidePopup=a=E.hideFunc),n.afterInit().then(()=>{e(o),n.afterGuiAttached({container:i,hidePopup:a})}),t.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,t)}trapFocusWithin(t,e){t.key!==N.TAB||t.defaultPrevented||this.focusService.findNextFocusableElement(e,!1,t.shiftKey)||(t.preventDefault(),this.focusService.focusInto(e,t.shiftKey))}dispatchVisibleChangedEvent(t,e,i){const s={type:S.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:t,switchingTab:!1,key:e,column:i??null};this.eventService.dispatchEvent(s)}isMenuEnabled(t){var e;return t.isFilterAllowed()&&((e=t.getColDef().menuTabs)!=null?e:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}};g([T("filterManager")],pr.prototype,"filterManager",2);g([T("popupService")],pr.prototype,"popupService",2);g([T("focusService")],pr.prototype,"focusService",2);g([T("ctrlsService")],pr.prototype,"ctrlsService",2);g([T("menuService")],pr.prototype,"menuService",2);pr=g([Y("filterMenuFactory")],pr);var wm=class extends z{constructor(t){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1;const{comp:e,eTopGuard:i,eBottomGuard:s,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:n,focusInnerElement:o,onFocusIn:a,onFocusOut:l,shouldStopEventPropagation:u,onTabKeyDown:d,handleKeyDown:c,eFocusableElement:C}=t;this.comp=e,this.eTopGuard=i,this.eBottomGuard=s,this.providedFocusInnerElement=o,this.eFocusableElement=C,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!n,this.providedFocusIn=a,this.providedFocusOut=l,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=c}postConstruct(){this.createManagedBean(new Er(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t),onFocusIn:t=>this.onFocusIn(t),onFocusOut:t=>this.onFocusOut(t)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(t=>this.addManagedListener(t,"focus",this.onFocus.bind(this)))}handleKeyDown(t){this.providedHandleKeyDown&&this.providedHandleKeyDown(t)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const t=this.gos.get("tabIndex");this.comp.setTabIndex(t.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(t){if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length===0){this.findNextElementOutsideAndFocus(t.target===this.eBottomGuard);return}const e=t.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(e):this.focusInnerElement(e)}findNextElementOutsideAndFocus(t){const e=this.gos.getDocument(),i=this.focusService.findFocusableElements(e.body,null,!0),s=i.indexOf(t?this.eTopGuard:this.eBottomGuard);if(s===-1)return;let r,n;t?(r=0,n=s):(r=s+1,n=i.length);const o=i.slice(r,n),a=this.gos.get("tabIndex");o.sort((l,u)=>{const d=parseInt(l.getAttribute("tabindex")||"0"),c=parseInt(u.getAttribute("tabindex")||"0");return c===a?1:d===a?-1:d===0?1:c===0?-1:d-c}),o[t?o.length-1:0].focus()}onFocusIn(t){this.focusTrapActive||(this.providedFocusIn&&this.providedFocusIn(t),this.deactivateTabGuards())}onFocusOut(t){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(t),this.eFocusableElement.contains(t.relatedTarget)||this.activateTabGuards())}onTabKeyDown(t){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(t);return}if(this.focusTrapActive||t.defaultPrevented)return;const e=this.tabGuardsAreActive();e&&this.deactivateTabGuards();const i=this.getNextFocusableElement(t.shiftKey);e&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),t.preventDefault())}focusInnerElement(t=!1){const e=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(e.splice(0,1),e.splice(e.length-1,1)),e.length&&e[t?e.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(t){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,t)}forceFocusOutOfContainer(t=!1){if(this.forcingFocusOut)return;const e=t?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,e.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(t){return t===this.eTopGuard||t===this.eBottomGuard}};g([T("focusService")],wm.prototype,"focusService",2);g([$],wm.prototype,"postConstruct",1);var ou=class extends oe{initialiseTabGuard(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const e=[this.eTopGuard,this.eBottomGuard],i={setTabIndex:s=>{e.forEach(r=>s!=null?r.setAttribute("tabindex",s):r.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new wm({comp:i,focusTrapActive:!!t.focusTrapActive,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation,forceFocusOutWhenTabGuardsAreEmpty:t.forceFocusOutWhenTabGuardsAreEmpty}))}createTabGuard(t){const e=document.createElement("div"),i=t==="top"?"ag-tab-guard-top":"ag-tab-guard-bottom";return e.classList.add("ag-tab-guard",i),Qe(e,"presentation"),e}addTabGuards(t,e){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",e)}removeAllChildrenExceptTabGuards(){const t=[this.eTopGuard,this.eBottomGuard];tt(this.getFocusableElement()),this.addTabGuards(...t)}forceFocusOutOfContainer(t=!1){this.tabGuardCtrl.forceFocusOutOfContainer(t)}appendChild(t,e){Ql(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):super.appendChild(t,e)}},Qh=class mb extends ou{constructor(e){super(mb.getTemplate(e.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=e}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(e=>this.addItem(e)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var e,i,s;return(s=(i=(e=this.activeItem)==null?void 0:e.tabbedItem)==null?void 0:i.afterDetachedCallback)==null?void 0:s.call(i)})}static getTemplate(e){return`<div class="ag-tabs ${e}">
            <div ref="eHeader"></div>
            <div ref="eBody" role="presentation" class="ag-tabs-body ${e?`${e}-body`:""}"></div>
        </div>`}setupHeader(){const{enableCloseButton:e,cssClass:i}=this.params,s=(r,n)=>{r.classList.add(`ag-tabs-${n}`),i&&r.classList.add(`${i}-${n}`)};e?(this.setupCloseButton(s),this.eTabHeader=this.gos.getDocument().createElement("div"),s(this.eHeader,"header-wrapper"),Qe(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,Qe(this.eTabHeader,"tablist"),s(this.eTabHeader,"header")}setupCloseButton(e){const i=this.gos.getDocument(),s=i.createElement("button");e(s,"close-button");const r=je("close",this.gos,void 0,!0);Ci(s,this.params.closeButtonAriaLabel),s.appendChild(r),this.addManagedListener(s,"click",()=>{var o,a;return(a=(o=this.params).onCloseClicked)==null?void 0:a.call(o)});const n=i.createElement("div");e(n,"close-button-wrapper"),Qe(n,"presentation"),n.appendChild(s),this.eHeader.appendChild(n),this.eCloseButton=s}handleKeyDown(e){switch(e.key){case N.RIGHT:case N.LEFT:if(!this.eTabHeader.contains(this.gos.getActiveDomElement()))return;const i=e.key===N.RIGHT,s=this.gos.get("enableRtl"),r=this.items.indexOf(this.activeItem),n=i!==s?Math.min(r+1,this.items.length-1):Math.max(r-1,0);if(r===n)return;e.preventDefault();const o=this.items[n];this.showItemWrapper(o),o.eHeaderButton.focus();break;case N.UP:case N.DOWN:e.stopPropagation();break}}onTabKeyDown(e){var i,s,r,n;if(e.defaultPrevented)return;const{focusService:o,eHeader:a,eBody:l,activeItem:u,params:d}=this,{suppressTrapFocus:c,enableCloseButton:C}=d,E=this.gos.getActiveDomElement(),y=e.target,_=e.shiftKey;if(a.contains(E)){e.preventDefault(),C&&_&&!((i=this.eCloseButton)!=null&&i.contains(E))?(s=this.eCloseButton)==null||s.focus():c&&_?(r=this.focusService.findFocusableElementBeforeTabGuard(this.gos.getDocument().body,y))==null||r.focus():this.focusBody(e.shiftKey);return}let b=null;if(o.isTargetUnderManagedComponent(l,y)&&(_&&(b=this.focusService.findFocusableElementBeforeTabGuard(l,y)),!b&&!c&&(b=u.eHeaderButton)),!b&&l.contains(E)&&(b=o.findNextFocusableElement(l,!1,_),!b)){e.preventDefault(),c&&!_?this.forceFocusOutOfContainer(_):C&&!_?(n=this.eCloseButton)==null||n.focus():this.focusHeader();return}b&&(e.preventDefault(),b.focus())}focusInnerElement(e){e?this.focusHeader():this.focusBody(!0)}focusHeader(e){this.activeItem.eHeaderButton.focus({preventScroll:e})}focusBody(e){this.focusService.focusInto(this.eBody,e)}setAfterAttachedParams(e){this.afterAttachedParams=e}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(e){const i=document.createElement("span");Qe(i,"tab"),i.setAttribute("tabindex","-1"),i.appendChild(e.title),i.classList.add("ag-tab"),this.eTabHeader.appendChild(i),Ci(i,e.titleLabel);const s={tabbedItem:e,eHeaderButton:i};this.items.push(s),i.addEventListener("click",this.showItemWrapper.bind(this,s))}showItem(e){const i=this.items.find(s=>s.tabbedItem===e);i&&this.showItemWrapper(i)}showItemWrapper(e){var i,s,r,n,o,a;const{tabbedItem:l,eHeaderButton:u}=e;if((s=(i=this.params).onItemClicked)==null||s.call(i,{item:l}),this.activeItem===e){(n=(r=this.params).onActiveItemClicked)==null||n.call(r);return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),tt(this.eBody),l.bodyPromise.then(d=>{this.eBody.appendChild(d);const c=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,c),l.afterAttachedCallback&&l.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const C=l.getScrollableContainer&&l.getScrollableContainer()||d;this.lastScrollListener=this.addManagedListener(C,"scroll",()=>{this.tabbedItemScrollMap.set(l.name,C.scrollTop)});const E=this.tabbedItemScrollMap.get(l.name);E!==void 0&&setTimeout(()=>{C.scrollTop=E},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),(a=(o=this.activeItem.tabbedItem).afterDetachedCallback)==null||a.call(o)),u.classList.add("ag-tab-selected"),this.activeItem=e}};g([T("focusService")],Qh.prototype,"focusService",2);g([q("eHeader")],Qh.prototype,"eHeader",2);g([q("eBody")],Qh.prototype,"eBody",2);g([$],Qh.prototype,"postConstruct",1);var KO=50,hg=class extends z{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(t,e){const i=this.gos.getWindow(),s=()=>{const a=new i.ResizeObserver(e);return a.observe(t),()=>a.disconnect()},r=()=>{var a,l;let u=(a=t==null?void 0:t.clientWidth)!=null?a:0,d=(l=t==null?void 0:t.clientHeight)!=null?l:0,c=!0;const C=()=>{var E,y;if(c){const _=(E=t==null?void 0:t.clientWidth)!=null?E:0,b=(y=t==null?void 0:t.clientHeight)!=null?y:0;(_!==u||b!==d)&&(u=_,d=b,e()),this.doNextPolyfillTurn(C)}};return C(),()=>c=!1},n=this.gos.get("suppressBrowserResizeObserver");return!!i.ResizeObserver&&!n?s():this.getFrameworkOverrides().wrapIncoming(()=>r(),"resize-observer")}doNextPolyfillTurn(t){this.polyfillFunctions.push(t),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;const t=()=>{const e=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],e.forEach(i=>i())};this.polyfillScheduled=!0,window.setTimeout(t,KO)}};hg=g([Y("resizeObserverService")],hg);var Io=class extends z{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(t){const e=this.gos.get("pagination");if(this.scrollGoingDown=t>=this.lastScrollTop,e&&t===0){const i=this.paginationProxy.getCurrentPage();i!==this.lastPage&&(this.lastPage=i,this.scrollGoingDown=!0)}this.lastScrollTop=t}init(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(t){this.useAnimationFrame===!1&&console.warn(`AG Grid: AnimationFrameService.${t} called but animation frames are off`)}createTask(t,e,i){this.verifyAnimationFrameOn(i);const s={task:t,index:e,createOrder:++this.taskCount};this.addTaskToList(this[i],s),this.schedule()}cancelTask(t){this.cancelledTasks.add(t)}addTaskToList(t,e){t.list.push(e),t.sorted=!1}sortTaskList(t){if(t.sorted)return;const e=this.scrollGoingDown?1:-1;t.list.sort((i,s)=>i.index!==s.index?e*(s.index-i.index):s.createOrder-i.createOrder),t.sorted=!0}addDestroyTask(t){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(t),this.schedule()}executeFrame(t){this.verifyAnimationFrameOn("executeFrame");const e=this.createTasksP1,i=e.list,s=this.createTasksP2,r=s.list,n=this.destroyTasks,o=new Date().getTime();let a=new Date().getTime()-o;const l=t<=0,u=this.ctrlsService.getGridBodyCtrl();for(;l||a<t;){if(!u.getScrollFeature().scrollGridIfNeeded()){let c;if(i.length)this.sortTaskList(e),c=i.pop().task;else if(r.length)this.sortTaskList(s),c=r.pop().task;else if(n.length)c=n.pop();else{this.cancelledTasks.clear();break}this.cancelledTasks.has(c)||c()}a=new Date().getTime()-o}i.length||r.length||n.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const t=this.executeFrame.bind(this,60);this.requestAnimationFrame(t)}requestAnimationFrame(t){const e=this.gos.getWindow();e.requestAnimationFrame?e.requestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.setTimeout(t,0)}isQueueEmpty(){return!this.ticking}debounce(t){let e=!1;return()=>{if(!this.isOn()){window.setTimeout(t,0);return}e||(e=!0,this.addDestroyTask(()=>{e=!1,t()}))}}};g([T("ctrlsService")],Io.prototype,"ctrlsService",2);g([T("paginationProxy")],Io.prototype,"paginationProxy",2);g([$],Io.prototype,"init",1);Io=g([Y("animationFrameService")],Io);var Tl=class extends z{postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide"}expandRows(t){if(!this.isClientSideRowModel)return;const e=new Set(t);this.rowModel.forEachNode(i=>{i.id&&e.has(i.id)&&(i.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const t=[];return this.rowModel.forEachNode(({expanded:e,id:i})=>{e&&i&&t.push(i)}),t}expandAll(t){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(t)}setRowNodeExpanded(t,e,i,s){t&&(i&&t.parent&&t.parent.level!==-1&&this.setRowNodeExpanded(t.parent,e,i,s),t.setExpanded(e,void 0,s))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}};g([T("rowModel")],Tl.prototype,"rowModel",2);g([$],Tl.prototype,"postConstruct",1);Tl=g([Y("expansionService")],Tl);var Mi=class extends z{postConstruct(){var t;this.activeMenuFactory=(t=this.enterpriseMenuFactory)!=null?t:this.filterMenuFactory}showColumnMenu(t){this.showColumnMenuCommon(this.activeMenuFactory,t,"columnMenu")}showFilterMenu(t){const e=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(e,t,t.containerType,!0)}showHeaderContextMenu(t,e,i){this.activeMenuFactory.showMenuAfterContextMenuEvent(t,e,i)}getContextMenuPosition(t,e){const i=this.getRowCtrl(t),s=this.getCellGui(i,e);if(!s)return i?{x:0,y:i.getRowYPosition()}:{x:0,y:0};const r=s.getBoundingClientRect();return{x:r.x+r.width/2,y:r.y+r.height/2}}showContextMenu(t){var e,i,s;const{column:r,rowNode:n}=t;let{anchorToElement:o,value:a}=t;n&&r&&a==null&&(a=n.getValueFromValueService(r)),o==null&&(o=this.getContextMenuAnchorElement(n,r)),(s=this.contextMenuFactory)==null||s.onContextMenu((e=t.mouseEvent)!=null?e:null,(i=t.touchEvent)!=null?i:null,n??null,r??null,a,o)}showColumnChooser(t){var e;(e=this.columnChooserFactory)==null||e.showColumnChooser(t)}hidePopupMenu(){var t;(t=this.contextMenuFactory)==null||t.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var t;(t=this.columnChooserFactory)==null||t.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(t){const{suppressMenu:e,suppressHeaderMenuButton:i}=t.getColDef();return!(i??e)&&this.activeMenuFactory.isMenuEnabled(t)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(t){return!t.getColDef().suppressHeaderFilterButton&&this.filterManager.isFilterAllowed(t)}isHeaderContextMenuEnabled(t){return!(t!=null&&t.getColDef().suppressHeaderContextMenu)&&this.getColumnMenuType()==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const t=!this.isSuppressMenuHide();return!(Ks()&&t)}isHeaderFilterButtonEnabled(t){return this.isFilterMenuInHeaderEnabled(t)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(t)}isFilterMenuItemEnabled(t){return this.filterManager.isFilterAllowed(t)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(t)&&!this.isFloatingFilterButtonDisplayed(t)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return this.getColumnMenuType()==="new"}isLegacyMenuEnabled(){return this.getColumnMenuType()==="legacy"}isFloatingFilterButtonEnabled(t){var e;const i=t.getColDef(),s=(e=i.floatingFilterComponentParams)==null?void 0:e.suppressFilterButton;return s!=null&&ie("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),i.suppressFloatingFilterButton==null?!s:!i.suppressFloatingFilterButton}getColumnMenuType(){var t;return(t=this.gos.get("columnMenu"))!=null?t:"legacy"}isFloatingFilterButtonDisplayed(t){return!!t.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(t)}isSuppressMenuHide(){const t=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()||this.gos.exists("suppressMenuHide")?t:!0}showColumnMenuCommon(t,e,i,s){const{column:r,positionBy:n}=e;if(n==="button"){const{buttonElement:o}=e;t.showMenuAfterButtonClick(r,o,i,s)}else if(n==="mouse"){const{mouseEvent:o}=e;t.showMenuAfterMouseEvent(r,o,i,s)}else r&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const o=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()).getHeaderCtrlForColumn(r);t.showMenuAfterButtonClick(r,o.getAnchorElementForMenu(s),i,!0)}))}getRowCtrl(t){const{rowIndex:e,rowPinned:i}=t||{};if(e!=null)return this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:i})||void 0}getCellGui(t,e){if(!t||!e)return;const i=t.getCellCtrl(e);return(i==null?void 0:i.getGui())||void 0}getContextMenuAnchorElement(t,e){const i=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),s=this.getRowCtrl(t);if(!s)return i;const r=this.getCellGui(s,e);return r||(s.isFullWidth()?s.getFullWidthElement():i)}};g([T("filterMenuFactory")],Mi.prototype,"filterMenuFactory",2);g([T("ctrlsService")],Mi.prototype,"ctrlsService",2);g([T("animationFrameService")],Mi.prototype,"animationFrameService",2);g([T("filterManager")],Mi.prototype,"filterManager",2);g([T("rowRenderer")],Mi.prototype,"rowRenderer",2);g([De("columnChooserFactory")],Mi.prototype,"columnChooserFactory",2);g([De("contextMenuFactory")],Mi.prototype,"contextMenuFactory",2);g([De("enterpriseMenuFactory")],Mi.prototype,"enterpriseMenuFactory",2);g([$],Mi.prototype,"postConstruct",1);Mi=g([Y("menuService")],Mi);var on=class extends z{postConstruct(){this.ctrlsService.whenReady(t=>{this.centerRowContainerCtrl=t.center})}getPreferredWidthForColumn(t,e){const i=this.getHeaderCellForColumn(t);if(!i)return-1;const s=this.rowRenderer.getAllCellsForColumn(t);return e||s.push(i),this.addElementsToContainerAndGetWidth(s)}getPreferredWidthForColumnGroup(t){const e=this.getHeaderCellForColumn(t);return e?this.addElementsToContainerAndGetWidth([e]):-1}addElementsToContainerAndGetWidth(t){const e=document.createElement("form");e.style.position="fixed";const i=this.centerRowContainerCtrl.getContainerElement();t.forEach(n=>this.cloneItemIntoDummy(n,e)),i.appendChild(e);const s=e.offsetWidth;i.removeChild(e);const r=this.getAutoSizePadding();return s+r}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(t){let e=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(i=>{const s=i.getHtmlElementForColumnHeader(t);s!=null&&(e=s)}),e}cloneItemIntoDummy(t,e){const i=t.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";const s=document.createElement("div"),r=s.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(r.add("ag-header","ag-header-row"),s.style.position="static"):r.add("ag-row");let o=t.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const u=o.classList[l];u!="ag-row-position-absolute"&&r.add(u)}break}o=o.parentElement}s.appendChild(i),e.appendChild(s)}};g([T("rowRenderer")],on.prototype,"rowRenderer",2);g([T("ctrlsService")],on.prototype,"ctrlsService",2);g([T("rowCssClassCalculator")],on.prototype,"rowCssClassCalculator",2);g([$],on.prototype,"postConstruct",1);on=g([Y("autoWidthCalculator")],on);var au=class extends z{constructor(t,e){super(),this.createRowCon=t,this.destroyRowCtrls=e,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.topContainerHeight=0,this.bottomContainerHeight=0}postConstruct(){this.isClientSide=this.rowModel.getType()==="clientSide",this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl})}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}getLastPixelOfGroup(t){return this.isClientSide?this.getClientSideLastPixelOfGroup(t):this.getServerSideLastPixelOfGroup(t)}getFirstPixelOfGroup(t){return t.footer?t.sibling.rowTop+t.sibling.rowHeight-1:t.hasChildren()?t.rowTop-1:0}getServerSideLastPixelOfGroup(t){var e,i,s,r;if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(t.isExpandable()||t.footer){if(t.master)return t.detailNode.rowTop+t.detailNode.rowHeight;if(!t.sibling||Math.abs(t.sibling.rowIndex-t.rowIndex)===1){let o=(e=t.childStore)==null?void 0:e.getStoreBounds();return t.footer&&(o=(i=t.sibling.childStore)==null?void 0:i.getStoreBounds()),((s=o==null?void 0:o.heightPx)!=null?s:0)+((r=o==null?void 0:o.topPx)!=null?r:0)}return t.footer?t.rowTop+t.rowHeight:t.sibling.rowTop+t.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(t){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(t.isExpandable()||t.footer){const e=t.footer&&t.rowIndex===0,i=!t.sibling||Math.abs(t.sibling.rowIndex-t.rowIndex)===1;if(e||i){let s=t.footer?t.sibling:t;for(;s.isExpandable()&&s.expanded;)if(s.master)s=s.detailNode;else if(s.childrenAfterSort){if(s.childrenAfterSort.length===0)break;s=Se(s.childrenAfterSort)}return s.rowTop+s.rowHeight}return t.footer?t.rowTop+t.rowHeight:t.sibling.rowTop+t.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(t){const e=t==="top";let i=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(t,new Set,i);const s=e?this.rowRenderer.getFirstVisibleVerticalPixel():this.rowRenderer.getLastVisibleVerticalPixel(),r=new Set,n=u=>{if(r.add(u),e){const d=this.getLastPixelOfGroup(u),c=s+i+u.rowHeight;d<c?u.stickyRowTop=i+(d-c):u.stickyRowTop=i}else{const d=this.getFirstPixelOfGroup(u),c=s-(i+u.rowHeight);d>c?u.stickyRowTop=i-(d-c):u.stickyRowTop=i}i=0,r.forEach(d=>{const c=d.stickyRowTop+d.rowHeight;i<c&&(i=c)})},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=u=>u.displayed?u.footer?o===!0||o==="grand"&&u.level===-1||o==="group"&&u.level>-1?!1:!r.has(u):u.isExpandable()?a===!0?!1:!r.has(u)&&u.expanded:!1:!1;for(let u=0;u<100;u++){let d=s+i;e||(d=s-i);const c=this.rowModel.getRowIndexAtPixel(d),C=this.rowModel.getRow(c);if(C==null)break;const y=this.getStickyAncestors(C).find(b=>(e?b.rowIndex<c:b.rowIndex>c)&&l(b));if(y){n(y);continue}if((e?C.rowTop<d:C.rowTop+C.rowHeight>d)&&l(C)){n(C);continue}break}return e||r.forEach(u=>{u.stickyRowTop=i-(u.stickyRowTop+u.rowHeight)}),this.refreshNodesAndContainerHeight(t,r,i)}areFooterRowsStickySuppressed(){const t=this.gos.get("suppressStickyTotalRow");if(t===!0)return!0;const e=!!this.gos.get("groupIncludeFooter")||t==="group",i=!!this.gos.get("groupIncludeTotalFooter")||t==="grand";return e&&i?!0:i?"grand":e?"group":!1}canRowsBeSticky(){const t=this.gos.isGroupRowsSticky(),e=this.areFooterRowsStickySuppressed(),i=this.gos.get("suppressGroupRowsSticky");return t&&(!e||!i)}getStickyAncestors(t){const e=[];let i=t.footer?t.sibling:t.parent;for(;i;)i.sibling&&e.push(i.sibling),e.push(i),i=i.parent;return e.reverse()}checkStickyRows(){const t=this.updateStickyRows("top"),e=this.updateStickyRows("bottom");return t||e}destroyStickyCtrls(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(t){const e=new Set;if(this.stickyTopRowCtrls.some(i=>i.getRowNode()===t)){for(let i=0;i<this.stickyTopRowCtrls.length;i++){const s=this.stickyTopRowCtrls[i].getRowNode();s!==t&&e.add(s)}this.refreshNodesAndContainerHeight("top",e,this.topContainerHeight)&&this.checkStickyRows();return}for(let i=0;i<this.stickyBottomRowCtrls.length;i++){const s=this.stickyBottomRowCtrls[i].getRowNode();s!==t&&e.add(s)}this.refreshNodesAndContainerHeight("bottom",e,this.bottomContainerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(t,e,i){const s=t==="top",r=s?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,n={},o=[];for(let c=0;c<r.length;c++){const C=r[c].getRowNode();if(!e.has(C)){n[C.id]=r[c],C.sticky=!1;continue}o.push(r[c])}const a=new Set;for(let c=0;c<o.length;c++)a.add(o[c].getRowNode());const l=[];e.forEach(c=>{a.has(c)||(c.sticky=!0,l.push(this.createRowCon(c,!1,!1)))});let u=!!l.length||o.length!==r.length;s?this.topContainerHeight!==i&&(this.topContainerHeight=i,this.gridBodyCtrl.setStickyTopHeight(i),u=!0):this.bottomContainerHeight!==i&&(this.bottomContainerHeight=i,this.gridBodyCtrl.setStickyBottomHeight(i),u=!0),this.destroyRowCtrls(n,!1);const d=[...o,...l];return d.sort((c,C)=>C.getRowNode().rowIndex-c.getRowNode().rowIndex),s||d.reverse(),d.forEach(c=>c.setRowTop(c.getRowNode().stickyRowTop)),u?(s?this.stickyTopRowCtrls=d:this.stickyBottomRowCtrls=d,!0):!1}};g([T("rowModel")],au.prototype,"rowModel",2);g([T("rowRenderer")],au.prototype,"rowRenderer",2);g([T("ctrlsService")],au.prototype,"ctrlsService",2);g([$],au.prototype,"postConstruct",1);var vi=class extends z{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const t=()=>{this.getAllCellCtrls().forEach(n=>n.onRangeSelectionChanged())},e=()=>{this.getAllCellCtrls().forEach(n=>n.updateRangeBordersIfRangeCount())},i=()=>{this.eventService.addEventListener(S.EVENT_RANGE_SELECTION_CHANGED,t),this.eventService.addEventListener(S.EVENT_COLUMN_MOVED,e),this.eventService.addEventListener(S.EVENT_COLUMN_PINNED,e),this.eventService.addEventListener(S.EVENT_COLUMN_VISIBLE,e)},s=()=>{this.eventService.removeEventListener(S.EVENT_RANGE_SELECTION_CHANGED,t),this.eventService.removeEventListener(S.EVENT_COLUMN_MOVED,e),this.eventService.removeEventListener(S.EVENT_COLUMN_PINNED,e),this.eventService.removeEventListener(S.EVENT_COLUMN_VISIBLE,e)};this.addDestroyFunc(()=>s()),this.addManagedPropertyListener("enableRangeSelection",n=>{n.currentValue?i():s()}),this.gos.get("enableRangeSelection")&&i()}}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl,this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,S.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,S.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,S.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gos.isGroupRowsSticky()){const t=this.rowModel.getType();(t==="clientSide"||t==="serverSide")&&(this.stickyRowFeature=this.createManagedBean(new au(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gos.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const t=this.getKeepDetailRowsCount(),e=t??3;this.cachedRowCtrls=new YO(e)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const t=hr(this.rowCtrlsByRowIndex),e=hr(this.zombieRowCtrls),i=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];e.length>0||i.length>0?this.allRowCtrls=[...t,...e,...i]:this.allRowCtrls=t}onCellFocusChanged(t){this.getAllCellCtrls().forEach(e=>e.onCellFocused(t)),this.getFullWidthRowCtrls().forEach(e=>e.onFullWidthRowFocused(t))}registerCellEventListeners(){this.addManagedListener(this.eventService,S.EVENT_CELL_FOCUSED,t=>{this.onCellFocusChanged(t)}),this.addManagedListener(this.eventService,S.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,S.EVENT_FLASH_CELLS,t=>{this.getAllCellCtrls().forEach(e=>e.onFlashCells(t))}),this.addManagedListener(this.eventService,S.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(t=>t.onColumnHover())}),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(t=>t.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(t=>t.onLeftChanged())}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,S.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(t=>t()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getAllGridColumns().forEach(e=>{const i=l=>{this.getAllCellCtrls().forEach(u=>{u.getColumn()===e&&l(u)})},s=()=>{i(l=>l.onLeftChanged())},r=()=>{i(l=>l.onWidthChanged())},n=()=>{i(l=>l.onFirstRightPinnedChanged())},o=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};e.addEventListener("leftChanged",s),e.addEventListener("widthChanged",r),e.addEventListener("firstRightPinnedChanged",n),e.addEventListener("lastLeftPinnedChanged",o),e.addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{e.removeEventListener("leftChanged",s),e.removeEventListener("widthChanged",r),e.removeEventListener("firstRightPinnedChanged",n),e.removeEventListener("lastLeftPinnedChanged",o),e.removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const t=this.gos.isDomLayout("print"),e=t||this.gos.get("embedFullWidthRows"),i=e!==this.embedFullWidthRows||this.printLayout!==t;this.printLayout=t,this.embedFullWidthRows=e,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)}onPageLoaded(t){const e={recycleRows:t.keepRenderedRows,animate:t.animate,newData:t.newData,newPage:t.newPage,onlyBody:!0};this.redrawAfterModelUpdate(e)}getAllCellsForColumn(t){const e=[];return this.getAllRowCtrls().forEach(i=>{const s=i.getCellElement(t);s&&e.push(s)}),e}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(t,e){t.forEach(i=>{i.destroyFirstPass(),i.destroySecondPass()}),t.length=0,e&&e.forEach(i=>{const s=new Qr(i,this.beans,!1,!1,this.printLayout);t.push(s)})}onPinnedRowDataChanged(){const t={recycleRows:!0};this.redrawAfterModelUpdate(t)}redrawRow(t,e=!1){var i;if(t.sticky)this.stickyRowFeature.refreshStickyNode(t);else if((i=this.cachedRowCtrls)!=null&&i.has(t)){this.cachedRowCtrls.removeRow(t);return}else{const s=r=>{const n=r[t.rowIndex];n&&n.getRowNode()===t&&(n.destroyFirstPass(),n.destroySecondPass(),r[t.rowIndex]=this.createRowCon(t,!1,!1))};switch(t.rowPinned){case"top":s(this.topRowCtrls);break;case"bottom":s(this.bottomRowCtrls);break;default:s(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}e||this.dispatchDisplayedRowsChanged(!1)}redrawRows(t){if(t!=null){t==null||t.forEach(i=>this.redrawRow(i,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(t){const e=t!=null&&t.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(e==null)return null;const i=this.gos.getActiveDomElement(),s=this.gos.getDomData(i,Xr.DOM_DATA_KEY_CELL_CTRL),r=this.gos.getDomData(i,Qr.DOM_DATA_KEY_ROW_CTRL);return s||r?e:null}redrawAfterModelUpdate(t={}){this.getLockOnRefresh();const e=this.getCellToRestoreFocusToAfterRefresh(t);this.updateContainerHeights(),this.scrollToTopIfNewData(t);const i=!t.domLayoutChanged&&!!t.recycleRows,s=t.animate&&this.gos.isAnimateRows(),r=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(r,s),this.gridBodyCtrl.updateRowCount(),t.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),e!=null&&this.restoreFocusedCell(e),this.releaseLockOnRefresh()}scrollToTopIfNewData(t){const e=t.newData||t.newPage,i=this.gos.get("suppressScrollOnNewData");e&&!i&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout){this.rowContainerHeightService.setModelHeight(null);return}let t=this.paginationProxy.getCurrentPageHeight();t===0&&(t=1),this.rowContainerHeightService.setModelHeight(t)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(t){t&&(this.focusService.setRestoreFocusedCell(t),this.onCellFocusChanged(this.beans.gos.addGridCommonParams({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"mock"})))}stopEditing(t=!1){this.getAllRowCtrls().forEach(e=>{e.stopEditing(t)})}getAllCellCtrls(){const t=[],e=this.getAllRowCtrls(),i=e.length;for(let s=0;s<i;s++){const r=e[s].getAllCellCtrls(),n=r.length;for(let o=0;o<n;o++)t.push(r[o])}return t}getAllRowCtrls(){const t=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],e=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],i=[...this.topRowCtrls,...this.bottomRowCtrls,...t,...e];for(const s in this.rowCtrlsByRowIndex)i.push(this.rowCtrlsByRowIndex[s]);return i}addRenderedRowListener(t,e,i){const s=this.rowCtrlsByRowIndex[e];s&&s.addEventListener(t,i)}flashCells(t={}){this.getCellCtrls(t.rowNodes,t.columns).forEach(e=>e.flashCell(t))}refreshCells(t={}){const e={forceRefresh:t.force,newData:!1,suppressFlash:t.suppressFlash};this.getCellCtrls(t.rowNodes,t.columns).forEach(i=>i.refreshOrDestroyCell(e)),t.rowNodes&&(this.getRowCtrls(t.rowNodes).forEach(i=>{if(!i.isFullWidth())return;i.refreshFullWidth()||this.redrawRow(i.getRowNode(),!0)}),this.dispatchDisplayedRowsChanged(!1))}getCellRendererInstances(t){var e;const i=this.getCellCtrls(t.rowNodes,t.columns).map(n=>n.getCellRenderer()).filter(n=>n!=null);if((e=t.columns)!=null&&e.length)return i;const s=[],r=this.mapRowNodes(t.rowNodes);return this.getAllRowCtrls().forEach(n=>{if(r&&!this.isRowInMap(n.getRowNode(),r)||!n.isFullWidth())return;const o=n.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&s.push(l)}}),[...s,...i]}getCellEditorInstances(t){const e=[];return this.getCellCtrls(t.rowNodes,t.columns).forEach(i=>{const s=i.getCellEditor();s&&e.push(s)}),e}getEditingCells(){const t=[];return this.getAllCellCtrls().forEach(e=>{if(e.isEditing()){const i=e.getCellPosition();t.push(i)}}),t}mapRowNodes(t){if(!t)return;const e={top:{},bottom:{},normal:{}};return t.forEach(i=>{const s=i.id;switch(i.rowPinned){case"top":e.top[s]=i;break;case"bottom":e.bottom[s]=i;break;default:e.normal[s]=i;break}}),e}isRowInMap(t,e){const i=t.id;switch(t.rowPinned){case"top":return e.top[i]!=null;case"bottom":return e.bottom[i]!=null;default:return e.normal[i]!=null}}getRowCtrls(t){const e=this.mapRowNodes(t),i=this.getAllRowCtrls();return!t||!e?i:i.filter(s=>{const r=s.getRowNode();return this.isRowInMap(r,e)})}getCellCtrls(t,e){let i;U(e)&&(i={},e.forEach(r=>{const n=this.columnModel.getGridColumn(r);U(n)&&(i[n.getId()]=!0)}));const s=[];return this.getRowCtrls(t).forEach(r=>{r.getAllCellCtrls().forEach(n=>{const o=n.getColumn().getId();i&&!i[o]||s.push(n)})}),s}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const t=[];Tt(this.rowCtrlsByRowIndex,(i,s)=>{s.getRowNode().id==null&&t.push(i)}),this.removeRowCtrls(t);const e={};return Tt(this.rowCtrlsByRowIndex,(i,s)=>{const r=s.getRowNode();e[r.id]=s}),this.rowCtrlsByRowIndex={},e}removeRowCtrls(t,e=!1){t.forEach(i=>{const s=this.rowCtrlsByRowIndex[i];s&&(s.destroyFirstPass(e),s.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]})}onBodyScroll(t){t.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(t={}){const{afterScroll:e}=t;let i;this.stickyRowFeature&&Uf()&&(i=this.getCellToRestoreFocusToAfterRefresh()||void 0);const s=this.firstRenderedRow,r=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let n=!1;this.stickyRowFeature&&(n=this.stickyRowFeature.checkStickyRows());const o=this.firstRenderedRow!==s||this.lastRenderedRow!==r;if(!(e&&!n&&!o)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,e),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(e&&!n),i!=null)){const a=this.getCellToRestoreFocusToAfterRefresh();i!=null&&a==null&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(t,e){const i={};t.forEach(n=>i[n]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!i[n]);this.removeRowCtrls(r,e)}calculateIndexesToDraw(t){let e=q0(this.firstRenderedRow,this.lastRenderedRow);const i=(r,n)=>{const o=n.getRowNode().rowIndex;o!=null&&(o<this.firstRenderedRow||o>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&e.push(o)};Tt(this.rowCtrlsByRowIndex,i),Tt(t,i),e.sort((r,n)=>r-n);const s=[];for(let r=0;r<e.length;r++){const n=e[r],o=this.paginationProxy.getRow(n);o&&!o.sticky&&s.push(n)}return s}recycleRows(t,e=!1,i=!1){const s=this.calculateIndexesToDraw(t);(this.printLayout||i)&&(e=!1),this.removeRowCompsNotToDraw(s,!e),s.forEach(r=>{this.createOrUpdateRowCtrl(r,t,e,i)}),t&&(i&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(t,e),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(t,e)),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(t=!1){const e={type:S.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:t};this.eventService.dispatchEvent(e)}onDisplayedColumnsChanged(){const t=this.columnModel.isPinningLeft(),e=this.columnModel.isPinningRight();(this.pinningLeft!==t||e!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=e,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const t=[];this.getFullWidthRowCtrls().forEach(e=>{const i=e.getRowNode().rowIndex;t.push(i.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(t),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(t){const e=this.mapRowNodes(t);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;const s=i.getRowNode();return!(e!=null&&!this.isRowInMap(s,e))})}createOrUpdateRowCtrl(t,e,i,s){let r,n=this.rowCtrlsByRowIndex[t];if(n||(r=this.paginationProxy.getRow(t),U(r)&&U(e)&&e[r.id]&&r.alreadyRendered&&(n=e[r.id],e[r.id]=null)),!n)if(r||(r=this.paginationProxy.getRow(t)),U(r))n=this.createRowCon(r,i,s);else return;return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[t]=n,n}destroyRowCtrls(t,e){const i=[];Tt(t,(s,r)=>{if(r){if(this.cachedRowCtrls&&r.isCacheable()){this.cachedRowCtrls.addRow(r);return}r.destroyFirstPass(!e),e?(this.zombieRowCtrls[r.getInstanceId()]=r,i.push(()=>{r.destroySecondPass(),delete this.zombieRowCtrls[r.getInstanceId()]})):r.destroySecondPass()}}),e&&(i.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),Zw(i))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const t=this.getRowBuffer(),e=this.gos.getRowHeightAsNumber();return t*e}workOutFirstAndLastRowsToRender(){this.rowContainerHeightService.updateOffset();let t,e;if(!this.paginationProxy.isRowsToRender())t=0,e=-1;else if(this.printLayout)this.environment.refreshRowHeightVariable(),t=this.paginationProxy.getPageFirstRow(),e=this.paginationProxy.getPageLastRow();else{const a=this.getRowBufferInPixels(),l=this.ctrlsService.getGridBodyCtrl(),u=this.gos.get("suppressRowVirtualisation");let d=!1,c,C;do{const R=this.paginationProxy.getPixelOffset(),{pageFirstPixel:D,pageLastPixel:O}=this.paginationProxy.getCurrentPagePixelRange(),L=this.rowContainerHeightService.getDivStretchOffset(),I=l.getScrollFeature().getVScrollPosition(),k=I.top,H=I.bottom;u?(c=D+L,C=O+L):(c=Math.max(k+R-a,D)+L,C=Math.min(H+R+a,O)+L),this.firstVisibleVPixel=Math.max(k+R,D)+L,this.lastVisibleVPixel=Math.min(H+R,O)+L,d=this.ensureAllRowsInRangeHaveHeightsCalculated(c,C)}while(d);let E=this.paginationProxy.getRowIndexAtPixel(c),y=this.paginationProxy.getRowIndexAtPixel(C);const _=this.paginationProxy.getPageFirstRow(),b=this.paginationProxy.getPageLastRow();E<_&&(E=_),y>b&&(y=b),t=E,e=y}const i=this.gos.isDomLayout("normal"),s=this.gos.get("suppressMaxRenderedRowRestriction"),r=Math.max(this.getRowBuffer(),500);i&&!s&&e-t>r&&(e=t+r);const n=t!==this.firstRenderedRow,o=e!==this.lastRenderedRow;if(n||o){this.firstRenderedRow=t,this.lastRenderedRow=e;const a={type:S.EVENT_VIEWPORT_CHANGED,firstRow:t,lastRow:e};this.eventService.dispatchEvent(a)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const t={type:S.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(t)})}ensureAllRowsInRangeHaveHeightsCalculated(t,e){const i=this.paginationProxy.ensureRowHeightsValid(t,e,-1,-1);return i&&this.updateContainerHeights(),i}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(t){const s=t.getRowNode(),r=this.focusService.isRowNodeFocused(s),n=t.isEditing(),o=s.detail;return r||n||o?!!this.paginationProxy.isRowPresent(s):!1}createRowCon(t,e,i){const s=this.cachedRowCtrls?this.cachedRowCtrls.getRow(t):null;if(s)return s;const r=this.gos.get("suppressAnimationFrame"),n=i&&!r&&!this.printLayout;return new Qr(t,this.beans,e,n,this.printLayout)}getRenderedNodes(){const t=this.rowCtrlsByRowIndex;return Object.values(t).map(e=>e.getRowNode())}getRowByPosition(t){let e;const{rowIndex:i}=t;switch(t.rowPinned){case"top":e=this.topRowCtrls[i];break;case"bottom":e=this.bottomRowCtrls[i];break;default:e=this.rowCtrlsByRowIndex[i],e||(e=this.getStickyTopRowCtrls().find(s=>s.getRowNode().rowIndex===i)||null,e||(e=this.getStickyBottomRowCtrls().find(s=>s.getRowNode().rowIndex===i)||null));break}return e}isRangeInRenderedViewport(t,e){if(t==null||e==null)return!1;const s=t>this.lastRenderedRow;return!(e<this.firstRenderedRow)&&!s}};g([T("animationFrameService")],vi.prototype,"animationFrameService",2);g([T("paginationProxy")],vi.prototype,"paginationProxy",2);g([T("columnModel")],vi.prototype,"columnModel",2);g([T("pinnedRowModel")],vi.prototype,"pinnedRowModel",2);g([T("rowModel")],vi.prototype,"rowModel",2);g([T("focusService")],vi.prototype,"focusService",2);g([T("beans")],vi.prototype,"beans",2);g([T("rowContainerHeightService")],vi.prototype,"rowContainerHeightService",2);g([T("ctrlsService")],vi.prototype,"ctrlsService",2);g([$],vi.prototype,"postConstruct",1);vi=g([Y("rowRenderer")],vi);var YO=class{constructor(t){this.entriesMap={},this.entriesList=[],this.maxCount=t}addRow(t){if(this.entriesMap[t.getRowNode().id]=t,this.entriesList.push(t),t.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(t){if(t==null||t.id==null)return null;const e=this.entriesMap[t.id];return e?(this.removeFromCache(e),e.setCached(!1),e.getRowNode()!=t?null:e):null}has(t){return this.entriesMap[t.id]!=null}removeRow(t){const e=t.id,i=this.entriesMap[e];delete this.entriesMap[e],$t(this.entriesList,i)}removeFromCache(t){const e=t.getRowNode().id;delete this.entriesMap[e],$t(this.entriesList,t)}getEntries(){return this.entriesList}},bl=class extends z{init(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData())}isEmpty(t){const e=t==="top"?this.pinnedTopRows:this.pinnedBottomRows;return bi(e)}isRowsToRender(t){return!this.isEmpty(t)}getRowAtPixel(t,e){const i=e==="top"?this.pinnedTopRows:this.pinnedBottomRows;if(bi(i))return 0;for(let s=0;s<i.length;s++){const r=i[s];if(r.rowTop+r.rowHeight-1>=t)return s}return i.length-1}setPinnedTopRowData(){const t=this.gos.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(t,!0);const e={type:S.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)}setPinnedBottomRowData(){const t=this.gos.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(t,!1);const e={type:S.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)}createNodesFromData(t,e){const i=[];if(t){let s=0;t.forEach((r,n)=>{const o=new ce(this.beans);o.data=r;const a=e?ce.ID_PREFIX_TOP_PINNED:ce.ID_PREFIX_BOTTOM_PINNED;o.id=a+n,o.rowPinned=e?"top":"bottom",o.setRowTop(s),o.setRowHeight(this.gos.getRowHeightForNode(o).height),o.setRowIndex(n),s+=o.rowHeight,i.push(o)})}return i}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(t){return this.pinnedTopRows[t]}getPinnedBottomRow(t){return this.pinnedBottomRows[t]}forEachPinnedTopRow(t){bi(this.pinnedTopRows)||this.pinnedTopRows.forEach(t)}forEachPinnedBottomRow(t){bi(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(t)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(t){if(!t||t.length===0)return 0;const e=Se(t);return e.rowTop+e.rowHeight}};g([T("beans")],bl.prototype,"beans",2);g([$],bl.prototype,"init",1);bl=g([Y("pinnedRowModel")],bl);var Jh=class{constructor(t,e){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:e,children:null},this.mapToItems[e.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(t,e){if(t.children)for(let i=0;i<t.children.length;i++)this.depthFirstSearchChangedPath(t.children[i],e);e(t.rowNode)}depthFirstSearchEverything(t,e,i){if(t.childrenAfterGroup)for(let s=0;s<t.childrenAfterGroup.length;s++){const r=t.childrenAfterGroup[s];r.childrenAfterGroup?this.depthFirstSearchEverything(t.childrenAfterGroup[s],e,i):i&&e(r)}e(t)}forEachChangedNodeDepthFirst(t,e=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,t):this.depthFirstSearchEverything(this.pathRoot.rowNode,t,e)}executeFromRootNode(t){t(this.pathRoot.rowNode)}createPathItems(t){let e=t,i=0;for(;!this.mapToItems[e.id];){const s={rowNode:e,children:null};this.mapToItems[e.id]=s,i++,e=e.parent}return i}populateColumnsMap(t,e){if(!this.keepingColumns||!e)return;let i=t;for(;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),e.forEach(s=>this.nodeIdsToColumns[i.id][s.getId()]=!0),i=i.parent}linkPathItems(t,e){let i=t;for(let s=0;s<e;s++){const r=this.mapToItems[i.id],n=this.mapToItems[i.parent.id];n.children||(n.children=[]),n.children.push(r),i=i.parent}}addParentNode(t,e){if(!t||t.isRowPinned())return;const i=this.createPathItems(t);this.linkPathItems(t,i),this.populateColumnsMap(t,e)}canSkip(t){return this.active&&!this.mapToItems[t.id]}getValueColumnsForNode(t,e){if(!this.keepingColumns)return e;const i=this.nodeIdsToColumns[t.id];return e.filter(r=>i[r.getId()])}getNotValueColumnsForNode(t,e){if(!this.keepingColumns)return null;const i=this.nodeIdsToColumns[t.id];return e.filter(r=>!i[r.getId()])}},ia=class Gr extends z{constructor(e){super(),this.state=Gr.STATE_WAITING_TO_LOAD,this.version=0,this.id=e}getId(){return this.id}load(){this.state=Gr.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=Gr.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state=Gr.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,i){this.successCommon(e,i)}pageLoaded(e,i,s){this.successCommon(e,{rowData:i,rowCount:s})}isRequestMostRecentAndLive(e){const i=e===this.version,s=this.isAlive();return i&&s}successCommon(e,i){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state=Gr.STATE_LOADED,this.processServerResult(i))}dispatchLoadCompleted(e=!0){const i={type:Gr.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(i)}};ia.EVENT_LOAD_COMPLETE="loadComplete";ia.STATE_WAITING_TO_LOAD="needsLoading";ia.STATE_LOADING="loading";ia.STATE_LOADED="loaded";ia.STATE_FAILED="failed";var cg=ia,Ds=class extends z{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const t=this.gos.get("blockLoadDebounceMillis");t&&t>0&&(this.checkBlockToLoadDebounce=ge.debounce(this.performCheckBlocksToLoad.bind(this),t))}setBeans(t){this.logger=t.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const t=this.gos.get("maxConcurrentDatasourceRequests");if(t==null)return 2;if(!(t<=0))return t}addBlock(t){this.blocks.push(t),t.addEventListener(cg.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(t){ge.removeFromArray(this.blocks,t)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:Ds.BLOCK_LOADED_EVENT}),this.activeBlockLoadsCount==0&&this.dispatchEvent({type:Ds.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){this.logger.log("checkBlockToLoad: max loads exceeded");return}const t=this.getAvailableLoadingCount(),e=this.blocks.filter(i=>i.getState()===cg.STATE_WAITING_TO_LOAD).slice(0,t);this.registerLoads(e.length),e.forEach(i=>i.load()),this.printCacheStatus()}getBlockState(){if(this.gos.isRowModelType("serverSide"))return this.rowModel.getBlockStates();const t={};return this.blocks.forEach(e=>{const{id:i,state:s}=e.getBlockStateJson();t[i]=s}),t}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(t){this.activeBlockLoadsCount+=t}getAvailableLoadingCount(){return this.maxConcurrentRequests!==void 0?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};Ds.BLOCK_LOADED_EVENT="blockLoaded";Ds.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished";g([T("rowModel")],Ds.prototype,"rowModel",2);g([$],Ds.prototype,"postConstruct",1);g([zi(0,_i("loggerFactory"))],Ds.prototype,"setBeans",1);Ds=g([Y("rowNodeBlockLoader")],Ds);var _l=class extends z{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,S.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(t,e,i,s){const r=this.rowModel.ensureRowHeightsValid(t,e,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r}isPaginateChildRows(){return this.gos.get("groupRemoveSingleChildren")||this.gos.get("groupRemoveLowestSingleChildren")?!0:this.gos.get("paginateChildRows")}onModelUpdated(t){this.calculatePages();const e={type:S.EVENT_PAGINATION_CHANGED,animate:t?t.animate:!1,newData:t?t.newData:!1,newPage:t?t.newPage:!1,newPageSize:t?t.newPageSize:!1,keepRenderedRows:t?t.keepRenderedRows:!1};this.eventService.dispatchEvent(e)}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages();const t={type:S.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(t)}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(t){if(!this.active||this.currentPage===t||typeof this.currentPage!="number")return;this.currentPage=t,this.calculatePages();const e={type:S.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!0,newPageSize:!1,keepRenderedRows:!1};this.eventService.dispatchEvent(e)}getPixelOffset(){return this.pixelOffset}getRow(t){return this.rowModel.getRow(t)}getRowNode(t){return this.rowModel.getRowNode(t)}getRowIndexAtPixel(t){return this.rowModel.getRowIndexAtPixel(t)}getCurrentPageHeight(){return re(this.topRowBounds)||re(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){const t=this.topRowBounds?this.topRowBounds.rowTop:0,e=this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0;return{pageFirstPixel:t,pageLastPixel:e}}isRowPresent(t){return this.rowModel.isRowPresent(t)?t.rowIndex>=this.topDisplayedRowIndex&&t.rowIndex<=this.bottomDisplayedRowIndex:!1}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(t){return this.rowModel.forEachNode(t)}forEachNodeOnPage(t){const e=this.getPageFirstRow(),i=this.getPageLastRow();for(let s=e;s<=i;s++){const r=this.getRow(s);r&&t(r)}}getType(){return this.rowModel.getType()}getRowBounds(t){const e=this.rowModel.getRowBounds(t);return e.rowIndex=t,e}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(t){return Math.floor(t/this.pageSize)}goToPageWithIndex(t){if(!this.active)return;const e=this.getPageForIndex(t);this.goToPage(e)}isRowInPage(t){return this.active?this.getPageForIndex(t.rowIndex)===this.currentPage:!0}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const t=this.rowModel.getRowCount(),e=Math.floor(t/this.pageSize);this.goToPage(e)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(t){this.currentPage=t}get pageSize(){return U(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:U(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:U(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:U(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const t=this.pageSizeAutoCalculated;if(this.pageSizeAutoCalculated=void 0,this.pageSize===t)return;this.calculatePages();const e={type:S.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!1};this.eventService.dispatchEvent(e)}setPageSize(t,e){const i=this.pageSize;switch(e){case"autoCalculated":this.pageSizeAutoCalculated=t;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=t,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=t;break;case"gridOptions":this.pageSizeFromGridOptions=t,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}if(i!==this.pageSize){this.calculatePages();const s={type:S.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!0};this.eventService.dispatchEvent(s)}}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(U(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(t){this.pixelOffset!==t&&(this.pixelOffset=t,this.eventService.dispatchEvent({type:S.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0){this.setZeroRows();return}const t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const e=this.pageSize*this.currentPage;let i=this.pageSize*(this.currentPage+1)-1;if(i>t&&(i=t),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(e),i===t)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const s=this.rowModel.getTopLevelRowDisplayedIndex(i+1);this.bottomDisplayedRowIndex=s-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),this.masterRowCount===0){this.setZeroRows();return}const t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>t&&(this.bottomDisplayedRowIndex=t)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};g([T("rowModel")],_l.prototype,"rowModel",2);g([$],_l.prototype,"postConstruct",1);_l=g([Y("paginationProxy")],_l);var Bd=class extends z{processAllCellClasses(t,e,i,s){this.processClassRules(void 0,t.cellClassRules,e,i,s),this.processStaticCellClasses(t,e,i)}processClassRules(t,e,i,s,r){if(e==null&&t==null)return;const n={},o={},a=(l,u)=>{l.split(" ").forEach(d=>{d.trim()!=""&&u(d)})};if(e){const l=Object.keys(e);for(let u=0;u<l.length;u++){const d=l[u],c=e[d];let C;typeof c=="string"?C=this.expressionService.evaluate(c,i):typeof c=="function"&&(C=c(i)),a(d,E=>{C?n[E]=!0:o[E]=!0})}}t&&r&&Object.keys(t).forEach(l=>a(l,u=>{n[u]||(o[u]=!0)})),r&&Object.keys(o).forEach(r),Object.keys(n).forEach(s)}getStaticCellClasses(t,e){const{cellClass:i}=t;if(!i)return[];let s;return typeof i=="function"?s=i(e):s=i,typeof s=="string"&&(s=[s]),s||[]}processStaticCellClasses(t,e,i){this.getStaticCellClasses(t,e).forEach(r=>{i(r)})}};g([T("expressionService")],Bd.prototype,"expressionService",2);Bd=g([Y("stylingService")],Bd);var Cb=class extends Gh{constructor(t){super(t,"ag-toggle-button")}setValue(t,e){return super.setValue(t,e),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}},XO=class extends ji{constructor(t){super(t,"ag-text-area",null,"textarea")}setValue(t,e){const i=super.setValue(t,e);return this.eInput.value=t,i}setCols(t){return this.eInput.cols=t,this}setRows(t){return this.eInput.rows=t,this}},QO=class extends vn{constructor(t){super(t,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const t=_s();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||t||this.eInput.focus()}),this.eInput.step="any"}onWheel(t){this.gos.getActiveDomElement()===this.eInput&&t.preventDefault()}setMin(t){var e;const i=t instanceof Date?(e=Ai(t??null,!1))!=null?e:void 0:t;return this.min===i?this:(this.min=i,Ss(this.eInput,"min",i),this)}setMax(t){var e;const i=t instanceof Date?(e=Ai(t??null,!1))!=null?e:void 0:t;return this.max===i?this:(this.max=i,Ss(this.eInput,"max",i),this)}setStep(t){return this.step===t?this:(this.step=t,Ss(this.eInput,"step",t),this)}getDate(){var t;if(this.eInput.validity.valid)return(t=Xt(this.getValue()))!=null?t:void 0}setDate(t,e){this.setValue(Ai(t??null,!1),e)}},JO=class extends ji{constructor(t){super(t,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:t,max:e,step:i}=this.config;t!=null&&this.setMinValue(t),e!=null&&this.setMaxValue(e),this.setStep(i||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",t=>{const e=t.target.value;this.setValue(e)})}setMinValue(t){return this.min=t,this.eInput.setAttribute("min",t.toString()),this}setMaxValue(t){return this.max=t,this.eInput.setAttribute("max",t.toString()),this}setStep(t){return this.eInput.setAttribute("step",t.toString()),this}setValue(t,e){this.min!=null&&(t=Math.max(parseFloat(t),this.min).toString()),this.max!=null&&(t=Math.min(parseFloat(t),this.max).toString());const i=super.setValue(t,e);return this.eInput.value=t,i}},Tm=class extends oe{constructor(t,e){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=t,this.wrapperEl=e}postConstruct(){this.addManagedListener(this.getGui(),"click",this.onClick.bind(this))}setState(t){let e="";this.params.valueFormatter&&(e=this.params.valueFormatter(t)),this.populateWithRenderer(t,e)||this.populateWithoutRenderer(t,e),this.value=t}highlightString(t){const{parsedValue:e}=this;if(this.params.cellRenderer||!U(e))return;let i=U(t);if(i){const s=e==null?void 0:e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());if(s>=0){const r=s+t.length,n=at(e.slice(0,s),!0),o=at(e.slice(s,r),!0),a=at(e.slice(r));this.renderValueWithoutRenderer(`${n}<span class="ag-rich-select-row-text-highlight">${o}</span>${a}`)}else i=!1}i||this.renderValueWithoutRenderer(e)}updateHighlighted(t){var e;const i=this.getGui(),s=`ag-rich-select-row-${this.getCompId()}`;if((e=i.parentElement)==null||e.setAttribute("id",s),t){const r=this.getParentComponent().getAriaElement();Of(r,s),this.wrapperEl.setAttribute("data-active-option",s)}Ro(i.parentElement,t),this.addOrRemoveCssClass("ag-rich-select-row-selected",t)}populateWithoutRenderer(t,e){const i=this.gos.getDocument(),s=this.getGui(),r=i.createElement("span");r.style.overflow="hidden",r.style.textOverflow="ellipsis";const n=at(U(e)?e:t,!0);this.parsedValue=U(n)?n:null,s.appendChild(r),this.renderValueWithoutRenderer(n),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})}renderValueWithoutRenderer(t){const e=this.getGui().querySelector("span");e&&(e.innerHTML=U(t)?t:"&nbsp;")}populateWithRenderer(t,e){let i,s;return this.params.cellRenderer&&(s=this.userComponentFactory.getCellRendererDetails(this.params,{value:t,valueFormatted:e,setTooltip:(r,n)=>{this.setTooltip({newTooltipText:r,shouldDisplayTooltip:n})}})),s&&(i=s.newAgStackInstance()),i&&em(i,this.getGui()),i?(i.then(r=>{this.addDestroyFunc(()=>{this.getContext().destroyBean(r)})}),!0):!1}onClick(){const t=this.getParentComponent(),e={type:S.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};t==null||t.dispatchEvent(e)}};g([T("userComponentFactory")],Tm.prototype,"userComponentFactory",2);g([$],Tm.prototype,"postConstruct",1);var lu=class vb extends ou{constructor(e){super(vb.getTemplate((e==null?void 0:e.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0;const{cssIdentifier:i="default",ariaRole:s="listbox",listName:r}=e||{};this.cssIdentifier=i,this.ariaRole=s,this.listName=r}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedListener(this.eventService,S.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const i=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),s=this.eContainer;Qe(s,this.ariaRole),Ci(s,i)}addResizeObserver(){const e=()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()),i=this.resizeObserverService.observeResize(this.getGui(),e);this.addDestroyFunc(i)}focusInnerElement(e){this.focusRow(e?this.model.getRowCount()-1:0)}onFocusIn(e){const i=e.target;i.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=R0(i)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){switch(e.key){case N.UP:case N.DOWN:this.navigate(e.key===N.UP)&&e.preventDefault();break;case N.PAGE_HOME:case N.PAGE_END:case N.PAGE_UP:case N.PAGE_DOWN:this.navigateToPage(e.key)!==null&&e.preventDefault();break}}onTabKeyDown(e){this.navigate(e.shiftKey)?e.preventDefault():(Ji(e),this.forceFocusOutOfContainer(e.shiftKey))}navigate(e){if(this.lastFocusedRowIndex==null)return!1;const i=this.lastFocusedRowIndex+(e?-1:1);return i<0||i>=this.model.getRowCount()?!1:(this.focusRow(i),!0)}navigateToPage(e,i="focused"){let s=!1;i==="focused"&&(i=this.getLastFocusedRow(),s=!0);const r=this.model.getRowCount()-1;let n=-1;return e===N.PAGE_HOME?n=0:e===N.PAGE_END?n=r:e===N.PAGE_DOWN?n=Math.min(i+this.pageSize,r):e===N.PAGE_UP&&(n=Math.max(i-this.pageSize,0)),n===-1?null:(s?this.focusRow(n):this.ensureIndexVisible(n),n)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(e){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(e),this.animationFrameService.requestAnimationFrame(()=>{if(this.isScrolling=!1,!this.isAlive())return;const i=this.renderedRows.get(e);i&&i.eDiv.focus()}))}getComponentAt(e){const i=this.renderedRows.get(e);return i&&i.rowComponent}forEachRenderedRow(e){this.renderedRows.forEach((i,s)=>e(i.rowComponent,s))}static getTemplate(e){return`<div class="ag-virtual-list-viewport ag-${e}-virtual-list-viewport" role="presentation">
                <div class="ag-virtual-list-container ag-${e}-virtual-list-container" ref="eContainer"></div>
            </div>`}getItemHeight(){return this.isHeightFromTheme?this.environment.getListItemHeight():this.rowHeight}ensureIndexVisible(e,i=!0){const s=this.model.getRowCount();if(typeof e!="number"||e<0||e>=s)return console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e),!1;const r=e*this.rowHeight,n=r+this.rowHeight,o=this.getGui(),a=o.scrollTop,l=o.offsetHeight,u=a+l,d=i?0:this.rowHeight,c=a>r+d,C=u<n-d;if(c)return o.scrollTop=r,!0;if(C){const E=n-l;return o.scrollTop=E,!0}return!1}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.isHeightFromTheme=!1,this.rowHeight=e,this.refresh()}refresh(e){if(this.model==null||!this.isAlive())return;const i=this.model.getRowCount();this.eContainer.style.height=`${i*this.rowHeight}px`,Af(()=>this.eContainer.clientHeight>=i*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((e,i)=>this.removeRow(i))}drawVirtualRows(e){if(!this.isAlive()||!this.model)return;const i=this.getGui(),s=i.scrollTop,r=s+i.offsetHeight,n=Math.floor(s/this.rowHeight),o=Math.floor(r/this.rowHeight);this.pageSize=Math.floor((r-s)/this.rowHeight),this.ensureRowsRendered(n,o,e)}ensureRowsRendered(e,i,s){this.renderedRows.forEach((r,n)=>{(n<e||n>i)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)}),s&&this.refreshRows();for(let r=e;r<=i;r++)this.renderedRows.has(r)||r<this.model.getRowCount()&&this.insertRow(r)}insertRow(e){const i=this.model.getRow(e),s=document.createElement("div");s.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),Qe(s,this.ariaRole==="tree"?"treeitem":"option"),Ah(s,this.model.getRowCount()),xh(s,e+1),s.setAttribute("tabindex","-1"),s.style.height=`${this.rowHeight}px`,s.style.top=`${this.rowHeight*e}px`;const r=this.componentCreator(i,s);r.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=e),s.appendChild(r.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",s):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",s):this.eContainer.appendChild(s),this.renderedRows.set(e,{rowComponent:r,eDiv:s,value:i})}removeRow(e){const i=this.renderedRows.get(e);this.eContainer.removeChild(i.eDiv),this.destroyBean(i.rowComponent),this.renderedRows.delete(e)}refreshRows(){const e=this.model.getRowCount();this.renderedRows.forEach((i,s)=>{var r,n;if(s>=e)this.removeRow(s);else{const o=this.model.getRow(s);(n=(r=this.model).areRowsEqual)!=null&&n.call(r,i.value,o)?this.componentUpdater(o,i.rowComponent):this.removeRow(s)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(e){this.model=e}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}};g([T("resizeObserverService")],lu.prototype,"resizeObserverService",2);g([T("animationFrameService")],lu.prototype,"animationFrameService",2);g([q("eContainer")],lu.prototype,"eContainer",2);g([$],lu.prototype,"postConstruct",1);var yb=lu,ZO=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,Zh=class extends Cn{constructor(t){var e,i;super(He(te({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:(e=t==null?void 0:t.template)!=null?e:ZO,modalPicker:!1},t),{maxPickerHeight:(i=t==null?void 0:t.maxPickerHeight)!=null?i:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.highlightedItem=-1,this.lastRowHovered=-1,this.searchStringCreator=null;const{cellRowHeight:s,value:r,valueList:n,searchStringCreator:o}=t||{};s!=null&&(this.cellRowHeight=s),r!==void 0&&(this.value=r),n!=null&&(this.values=n),o&&(this.searchStringCreator=o)}postConstruct(){super.postConstruct(),this.createLoadingElement(),this.createListComponent();const{allowTyping:t,placeholder:e}=this.config;t?(this.eInput.setAutoComplete(!1).setInputPlaceholder(e),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{searchDebounceDelay:i=300}=this.config;this.clearSearchString=Ot(this.clearSearchString,i),this.renderSelectedValue(),t&&(this.eInput.onValueChange(s=>this.searchTextFromString(s)),this.addManagedListener(this.eWrapper,"focus",this.onWrapperFocus.bind(this))),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}createLoadingElement(){const t=this.gos.getDocument(),e=this.localeService.getLocaleTextFunc(),i=t.createElement("div");i.classList.add("ag-loading-text"),i.innerText=e("loadingOoo","Loading..."),this.eLoading=i}createListComponent(){this.listComponent=this.createBean(new yb({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this));const t=(a,l)=>{};this.listComponent.setComponentUpdater(t),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,S.EVENT_FIELD_PICKER_VALUE_SELECTED,a=>{this.onListValueSelected(a.value,a.fromEnterKey)});const{cellRowHeight:e}=this;e&&this.listComponent.setRowHeight(e);const i=this.listComponent.getGui(),s=this.listComponent.getAriaElement();this.addManagedListener(i,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(i,"mousedown",a=>a.preventDefault()),i.classList.add("ag-rich-select-list");const r=`ag-rich-select-list-${this.listComponent.getCompId()}`;s.setAttribute("id",r);const o=this.localeService.getLocaleTextFunc()(this.config.pickerAriaLabelKey,this.config.pickerAriaLabelValue);Ci(s,o),Gf(this.eWrapper,s)}renderSelectedValue(){const{value:t,eDisplayField:e,config:i}=this,{allowTyping:s,initialInputValue:r}=this.config,n=this.config.valueFormatter?this.config.valueFormatter(t):t;if(s){this.eInput.setValue(r??n);return}let o;i.cellRenderer&&(o=this.userComponentFactory.getCellRendererDetails(this.config,{value:t,valueFormatted:n}));let a;if(o&&(a=o.newAgStackInstance()),a)tt(e),em(a,e),a.then(l=>{this.addDestroyFunc(()=>this.getContext().destroyBean(l))});else{if(U(this.value))e.innerText=n,e.classList.remove("ag-display-as-placeholder");else{const{placeholder:l}=i;U(l)?(e.innerHTML=`${at(l)}`,e.classList.add("ag-display-as-placeholder")):tt(e)}this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}getCurrentValueIndex(){const{currentList:t,value:e}=this;if(e==null||!t)return-1;for(let i=0;i<t.length;i++)if(t[i]===e)return i;return-1}highlightFilterMatch(){var t;(t=this.listComponent)==null||t.forEachRenderedRow((e,i)=>{e.highlightString(this.searchString)})}highlightSelectedValue(t){var e;t==null&&(t=this.getCurrentValueIndex()),this.highlightedItem=t,(e=this.listComponent)==null||e.forEachRenderedRow((i,s)=>{const r=t===-1?!1:this.highlightedItem===s;i.updateHighlighted(r)})}setRowHeight(t){t!==this.cellRowHeight&&(this.cellRowHeight=t),this.listComponent&&this.listComponent.setRowHeight(t)}createPickerComponent(){const{values:t}=this;return t&&this.setValueList({valueList:t}),this.listComponent}setSearchStringCreator(t){this.searchStringCreator=t}setValueList(t){const{valueList:e,refresh:i}=t;this.listComponent&&this.currentList!==e&&(this.currentList=e,this.listComponent.setModel({getRowCount:()=>e.length,getRow:s=>e[s],areRowsEqual:(s,r)=>s===r}),i&&(this.values?this.listComponent.refresh(!0):(this.values=e,this.isPickerDisplayed&&this.showCurrentValueInPicker())))}showPicker(){super.showPicker(),this.showCurrentValueInPicker(),this.displayOrHidePicker()}showCurrentValueInPicker(){var t,e;if(!this.listComponent)return;if(!this.currentList){this.isPickerDisplayed&&this.eLoading&&this.listComponent.appendChild(this.eLoading);return}(t=this.eLoading)!=null&&t.offsetParent&&((e=this.eLoading.parentElement)==null||e.removeChild(this.eLoading));const i=this.getCurrentValueIndex();i!==-1?(this.listComponent.refresh(),this.listComponent.ensureIndexVisible(i),this.listComponent.refresh(!0),this.highlightSelectedValue(i)):this.listComponent.refresh()}beforeHidePicker(){this.highlightedItem=-1,super.beforeHidePicker()}onWrapperFocus(){if(!this.eInput)return;const t=this.eInput.getFocusableElement();t.focus(),t.select()}onWrapperFocusOut(t){this.eWrapper.contains(t.relatedTarget)||this.hidePicker()}buildSearchStringFromKeyboardEvent(t){let{key:e}=t;if(e===N.BACKSPACE)this.searchString=this.searchString.slice(0,-1),e="";else if(!Fh(t))return;t.preventDefault(),this.searchTextFromCharacter(e)}searchTextFromCharacter(t){this.searchString+=t,this.runSearch(),this.clearSearchString()}searchTextFromString(t){t==null&&(t=""),this.searchString=t,this.runSearch()}buildSearchStrings(t){const{valueFormatter:e=s=>s}=this.config;let i;return typeof t[0]=="number"||typeof t[0]=="string"?i=t.map(s=>e(s)):typeof t[0]=="object"&&this.searchStringCreator&&(i=this.searchStringCreator(t)),i}getSuggestionsAndFilteredValues(t,e){let i=[],s=[];if(!t.length)return{suggestions:i,filteredValues:s};const{searchType:r="fuzzy",filterList:n}=this.config;if(r==="fuzzy"){const o=Jl(this.searchString,e,!0);i=o.values;const a=o.indices;if(n&&a.length)for(let l=0;l<a.length;l++)s.push(this.values[a[l]])}else i=e.filter((o,a)=>{const l=o.toLocaleLowerCase(),u=this.searchString.toLocaleLowerCase(),d=r==="match"?l.startsWith(u):l.indexOf(u)!==-1;return n&&d&&s.push(this.values[a]),d});return{suggestions:i,filteredValues:s}}filterListModel(t){const{filterList:e}=this.config;e&&(this.setValueList({valueList:t,refresh:!0}),this.alignPickerToComponent())}runSearch(){var t,e;const{values:i}=this,s=this.buildSearchStrings(i);if(!s){this.highlightSelectedValue(-1);return}const{suggestions:r,filteredValues:n}=this.getSuggestionsAndFilteredValues(this.searchString,s),{filterList:o,highlightMatch:a,searchType:l="fuzzy"}=this.config,u=n.length,d=!!(o&&this.searchString!=="");if(this.filterListModel(d?n:i),r.length){const c=d?0:s.indexOf(r[0]);this.selectListItem(c)}else if(this.highlightSelectedValue(-1),!d||u)(t=this.listComponent)==null||t.ensureIndexVisible(0);else if(d){this.getAriaElement().removeAttribute("data-active-option");const c=(e=this.listComponent)==null?void 0:e.getAriaElement();c&&Of(c,null)}a&&l!=="fuzzy"&&this.highlightFilterMatch(),this.displayOrHidePicker()}displayOrHidePicker(){var t;const e=(t=this.listComponent)==null?void 0:t.getGui(),i=this.currentList?this.currentList.length===0:!1;e==null||e.classList.toggle("ag-hidden",i)}clearSearchString(){this.searchString=""}selectListItem(t,e){if(!this.isPickerDisplayed||!this.currentList||!this.listComponent||t<0||t>=this.currentList.length)return;this.listComponent.ensureIndexVisible(t,!e)&&!e&&this.listComponent.refresh(!0),this.highlightSelectedValue(t)}setValue(t,e,i){const s=this.currentList?this.currentList.indexOf(t):-1;return s===-1?this:(this.value=t,i||this.selectListItem(s),this.renderSelectedValue(),super.setValue(t,e))}createRowComponent(t){const e=new Tm(this.config,this.eWrapper);e.setParentComponent(this.listComponent),this.getContext().createBean(e),e.setState(t);const{highlightMatch:i,searchType:s="fuzzy"}=this.config;return i&&s!=="fuzzy"&&e.highlightString(this.searchString),e}getRowForMouseEvent(t){const{listComponent:e}=this;if(!e)return-1;const s=(e==null?void 0:e.getGui()).getBoundingClientRect(),r=e.getScrollTop(),n=t.clientY-s.top+r;return Math.floor(n/e.getRowHeight())}onPickerMouseMove(t){if(!this.listComponent)return;const e=this.getRowForMouseEvent(t);e!==-1&&e!=this.lastRowHovered&&(this.lastRowHovered=e,this.selectListItem(e,!0))}onNavigationKeyDown(t,e){t.preventDefault();const i=e===N.DOWN;if(!this.isPickerDisplayed&&i){this.showPicker();return}const s=this.highlightedItem,n=s===-1?0:s+(i?1:-1);this.selectListItem(n)}onPageNavigation(t){var e;if(!this.isPickerDisplayed)return;const i=(e=this.listComponent)==null?void 0:e.navigateToPage(t,this.highlightedItem);i!=null&&this.animationFrameService.requestAnimationFrame(()=>{if(!this.isAlive())return null;this.highlightSelectedValue(i)})}onEnterKeyDown(t){this.isPickerDisplayed&&(t.preventDefault(),this.currentList&&this.onListValueSelected(this.currentList[this.highlightedItem],!0))}onTabKeyDown(){!this.isPickerDisplayed||!this.currentList||this.setValue(this.currentList[this.highlightedItem],!1,!0)}onListValueSelected(t,e){this.setValue(t,!1,!0),this.dispatchPickerEvent(t,e),this.hidePicker()}dispatchPickerEvent(t,e){const i={type:S.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:e,value:t};this.dispatchEvent(i)}getFocusableElement(){const{allowTyping:t}=this.config;return t?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(t){const e=t.key,{allowTyping:i}=this.config;switch(e){case N.LEFT:case N.RIGHT:i||t.preventDefault();break;case N.PAGE_HOME:case N.PAGE_END:if(i){t.preventDefault();const s=this.eInput.getInputElement(),r=e===N.PAGE_HOME?0:s.value.length;s.setSelectionRange(r,r);break}case N.PAGE_UP:case N.PAGE_DOWN:t.preventDefault(),this.onPageNavigation(e);break;case N.DOWN:case N.UP:this.onNavigationKeyDown(t,e);break;case N.ESCAPE:this.isPickerDisplayed&&(ti(this.listComponent.getGui())&&(t.preventDefault(),Ji(t)),this.hidePicker());break;case N.ENTER:this.onEnterKeyDown(t);break;case N.TAB:this.onTabKeyDown();break;default:i||this.buildSearchStringFromKeyboardEvent(t)}}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),this.eLoading=void 0,super.destroy()}};g([T("userComponentFactory")],Zh.prototype,"userComponentFactory",2);g([T("animationFrameService")],Zh.prototype,"animationFrameService",2);g([q("eInput")],Zh.prototype,"eInput",2);var sa=class Sb extends rm{constructor(e){super(e,Sb.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field");const{minValue:e,maxValue:i,textFieldWidth:s,step:r,value:n,onValueChange:o}=this.config;e!=null&&this.setMinValue(e),i!=null&&this.setMaxValue(i),s!=null&&this.setTextFieldWidth(s),r!=null&&this.setStep(r),n!=null&&this.setValue(n),o!=null&&this.onValueChange(o)}onValueChange(e){const i=S.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,i,()=>{const s=parseFloat(this.eText.getValue());this.eSlider.setValue(s.toString(),!0),e(s||0)}),this.addManagedListener(this.eSlider,i,()=>{const s=this.eSlider.getValue();this.eText.setValue(s,!0),e(parseFloat(s))}),this}setSliderWidth(e){return this.eSlider.setWidth(e),this}setTextFieldWidth(e){return this.eText.setWidth(e),this}setMinValue(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this}setMaxValue(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this}getValue(){return this.eText.getValue()}setValue(e,i){return this.getValue()===e?this:(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),i||this.dispatchEvent({type:S.EVENT_FIELD_VALUE_CHANGED}),this)}setStep(e){return this.eSlider.setStep(e),this.eText.setStep(e),this}};sa.TEMPLATE=`<div class="ag-slider">
            <label ref="eLabel"></label>
            <div class="ag-wrapper ag-slider-wrapper">
                <ag-input-range ref="eSlider"></ag-input-range>
                <ag-input-number-field ref="eText"></ag-input-number-field>
            </div>
        </div>`;g([q("eLabel")],sa.prototype,"eLabel",2);g([q("eSlider")],sa.prototype,"eSlider",2);g([q("eText")],sa.prototype,"eText",2);g([$],sa.prototype,"init",1);var eN=sa,wr=class $n extends oe{constructor(e={}){super($n.getTemplate(e)),this.params=e,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1;const{enabled:i,items:s,suppressEnabledCheckbox:r,expanded:n,suppressToggleExpandOnEnableChange:o,useToggle:a}=e;this.cssIdentifier=e.cssIdentifier||"default",this.enabled=i??!0,this.items=s||[],this.useToggle=a??!1,this.alignItems=e.alignItems||"center",this.expanded=n??!0,r!=null&&(this.suppressEnabledCheckbox=r),o!=null&&(this.suppressToggleExpandOnEnableChange=o)}static getTemplate(e){const i=e.cssIdentifier||"default",s=e.direction||"vertical";return`
            <div class="ag-group ag-${i}-group" role="presentation">
                <div ref="eToolbar" class="ag-group-toolbar ag-${i}-group-toolbar">
                    <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>
                </div>
                <div ref="eContainer" class="ag-group-container ag-group-container-${s} ag-${i}-group-container"></div>
            </div>
        `}postConstruct(){if(this.setupTitleBar(),this.items.length){const r=this.items;this.items=[],this.addItems(r)}const e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange:i,suppressOpenCloseIcons:s}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(s??!1),this.refreshChildDisplay(),ve(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(r=>{this.setEnabled(r,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(r)}),i!=null&&this.onEnableChange(i)}refreshChildDisplay(){var e;ve(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),(e=this.eTitleBar)==null||e.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(e){this.alignItems!==e&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=e;const i=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(i),this}toggleGroupExpand(e){var i;let s=!1;if((i=this.eTitleBar)!=null&&i.isSuppressCollapse()&&!this.useToggle)e=!0,s=!0;else if(e=e??!this.expanded,this.expanded===e)return this;return this.expanded=e,this.refreshChildDisplay(),ve(this.eContainer,e),s||this.dispatchEvent({type:e?$n.EVENT_EXPANDED:$n.EVENT_COLLAPSED}),this}addItems(e){e.forEach(i=>this.addItem(i))}prependItem(e){this.insertItem(e,!0)}addItem(e){this.insertItem(e,!1)}insertItem(e,i){const s=this.eContainer,r=e instanceof oe?e.getGui():e;r.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),i?(s.insertAdjacentElement("afterbegin",r),this.items.unshift(r)):(s.appendChild(r),this.items.push(r))}hideItem(e,i){const s=this.items[i];ve(s,!e)}getItemIndex(e){const i=e instanceof oe?e.getGui():e;return this.items.indexOf(i)}setTitle(e){var i;return(i=this.eTitleBar)==null||i.setTitle(e),this}addTitleBarWidget(e){var i;return(i=this.eTitleBar)==null||i.addWidget(e),this}addCssClassToTitleBar(e){var i;(i=this.eTitleBar)==null||i.addCssClass(e)}dispatchEnableChangeEvent(e){const i={type:$n.EVENT_ENABLE_CHANGE,enabled:e};this.dispatchEvent(i)}setEnabled(e,i,s){var r;return this.enabled=e,this.refreshDisabledStyles(),s||this.toggleGroupExpand(e),i||(this.cbGroupEnabled.setValue(e),(r=this.eToggle)==null||r.setValue(e)),this}isEnabled(){return this.enabled}onEnableChange(e){return this.addManagedListener(this,$n.EVENT_ENABLE_CHANGE,i=>e(i.enabled)),this}hideEnabledCheckbox(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(e){var i;return(i=this.eTitleBar)==null||i.hideOpenCloseIcons(e),this}refreshDisabledStyles(){var e;const i=!this.enabled;this.eContainer.classList.toggle("ag-disabled",i),(e=this.eTitleBar)==null||e.refreshDisabledStyles(this.suppressEnabledCheckbox&&i),this.eContainer.classList.toggle("ag-disabled-group-container",i)}setupTitleBar(){const e=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",e.getGui())}createDefaultTitleBar(){const e=this.createManagedBean(new py(this.params));return this.eTitleBar=e,e.refreshOnExpand(this.expanded),this.addManagedListener(e,py.EVENT_EXPAND_CHANGED,i=>this.toggleGroupExpand(i.expanded)),e}createToggleTitleBar(){var e;const i=this.createManagedBean(new Cb({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:s=>{this.setEnabled(s,!0),this.dispatchEnableChangeEvent(s)}}));return i.addCssClass("ag-group-title-bar"),i.addCssClass(`ag-${(e=this.params.cssIdentifier)!=null?e:"default"}-group-title-bar ag-unselectable`),this.eToggle=i,this.toggleGroupExpand(this.enabled),i}};wr.EVENT_EXPANDED="expanded";wr.EVENT_COLLAPSED="collapsed";wr.EVENT_ENABLE_CHANGE="enableChange";g([q("eToolbar")],wr.prototype,"eToolbar",2);g([q("cbGroupEnabled")],wr.prototype,"cbGroupEnabled",2);g([q("eContainer")],wr.prototype,"eContainer",2);g([$],wr.prototype,"postConstruct",1);var tN=wr,ap="ag-disabled-group-title-bar",ra=class pg extends oe{constructor(e={}){super(pg.getTemplate(e)),this.suppressOpenCloseIcons=!1;const{title:i,suppressOpenCloseIcons:s}=e;i&&i.length>0&&(this.title=i),s!=null&&(this.suppressOpenCloseIcons=s)}static getTemplate(e){var i;const s=(i=e.cssIdentifier)!=null?i:"default";return`
            <div class="ag-group-title-bar ag-${s}-group-title-bar ag-unselectable" role="button">
                <span class="ag-group-title-bar-icon ag-${s}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>
                <span class="ag-group-title-bar-icon ag-${s}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>
                <span ref="eTitle" class="ag-group-title ag-${s}-group-title"></span>
            </div>
        `}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(wi("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild(wi("columnSelectOpen",this.gos,null)),this.addManagedListener(this.getGui(),"click",()=>this.dispatchExpandChanged()),this.addManagedListener(this.getGui(),"keydown",e=>{switch(e.key){case N.ENTER:case N.SPACE:e.preventDefault(),this.dispatchExpandChanged();break;case N.RIGHT:case N.LEFT:e.preventDefault(),this.dispatchExpandChanged(e.key===N.RIGHT);break}})}refreshOnExpand(e){this.refreshAriaStatus(e),this.refreshOpenCloseIcons(e)}refreshAriaStatus(e){this.suppressOpenCloseIcons||zs(this.getGui(),e)}refreshOpenCloseIcons(e){const i=!this.suppressOpenCloseIcons;ve(this.eGroupOpenedIcon,i&&e),ve(this.eGroupClosedIcon,i&&!e)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(e){const i={type:pg.EVENT_EXPAND_CHANGED,expanded:e};this.dispatchEvent(i)}setTitle(e){const i=this.getGui(),s=!!e&&e.length>0;e=s?e:void 0,this.eTitle.textContent=e??"",ve(i,s),e!==this.title&&(this.title=e);const r=i.classList.contains(ap);return this.refreshDisabledStyles(r),this}addWidget(e){return this.getGui().appendChild(e),this}hideOpenCloseIcons(e){return this.suppressOpenCloseIcons=e,e&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(e){const i=this.getGui();e?(i.classList.add(ap),i.removeAttribute("tabindex")):(i.classList.remove(ap),typeof this.title=="string"?i.setAttribute("tabindex","0"):i.removeAttribute("tabindex"))}};ra.EVENT_EXPAND_CHANGED="expandedChanged";g([q("eGroupOpenedIcon")],ra.prototype,"eGroupOpenedIcon",2);g([q("eGroupClosedIcon")],ra.prototype,"eGroupClosedIcon",2);g([q("eTitle")],ra.prototype,"eTitle",2);g([$],ra.prototype,"postConstruct",1);var py=ra,bm=class extends ou{constructor(t=0,e){super('<div class="ag-menu-list" role="tree"></div>'),this.level=t,this.menuItems=[],this.params=e??{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t),onFocusIn:t=>this.handleFocusIn(t),onFocusOut:t=>this.handleFocusOut(t)})}onTabKeyDown(t){const e=this.getParentComponent(),i=e&&e.getGui();i&&i.classList.contains("ag-focus-managed")||t.preventDefault(),t.shiftKey&&this.closeIfIsChild(t)}handleKeyDown(t){switch(t.key){case N.UP:case N.RIGHT:case N.DOWN:case N.LEFT:t.preventDefault(),this.handleNavKey(t.key);break;case N.ESCAPE:this.closeIfIsChild()&&Ji(t);break}}handleFocusIn(t){var e,i;const s=t.relatedTarget;!this.tabGuardCtrl.isTabGuard(s)&&(this.getGui().contains(s)||(i=(e=this.activeMenuItem)==null?void 0:e.getSubMenuGui())!=null&&i.contains(s))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(t){var e;const i=t.relatedTarget;!this.activeMenuItem||this.getGui().contains(i)||(e=this.activeMenuItem.getSubMenuGui())!=null&&e.contains(i)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(t){t!=null&&Pi.all(t.map(e=>e==="separator"?Pi.resolve({eGui:this.createSeparator()}):typeof e=="string"?(console.warn(`AG Grid: unrecognised menu item ${e}`),Pi.resolve({eGui:null})):this.addItem(e))).then(e=>{e.forEach(i=>{i!=null&&i.eGui&&(this.appendChild(i.eGui),i.comp&&this.menuItems.push(i.comp))})})}addItem(t){const e=this.createManagedBean(new qu);return e.init({menuItemDef:t,isAnotherSubMenuOpen:()=>this.menuItems.some(i=>i.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(e.setParentComponent(this),this.addManagedListener(e,qu.EVENT_CLOSE_MENU,i=>{this.dispatchEvent(i)}),this.addManagedListener(e,qu.EVENT_MENU_ITEM_ACTIVATED,i=>{this.activeMenuItem&&this.activeMenuItem!==i.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=i.menuItem}),{comp:e,eGui:e.getGui()}))}activateFirstItem(){const t=this.menuItems.filter(e=>!e.isDisabled())[0];t&&t.activate()}createSeparator(){return Qt(`
            <div class="ag-menu-separator" aria-hidden="true">
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
            </div>`)}handleNavKey(t){switch(t){case N.UP:case N.DOWN:const i=this.findNextItem(t===N.UP);i&&i!==this.activeMenuItem&&i.activate();return}const e=this.gos.get("enableRtl")?N.RIGHT:N.LEFT;t===e?this.closeIfIsChild():this.openChild()}closeIfIsChild(t){const e=this.getParentComponent();return e&&e instanceof qu?(t&&t.preventDefault(),e.closeSubMenu(),e.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(t){const e=this.menuItems.filter(r=>!r.isDisabled());if(!e.length)return;if(!this.activeMenuItem)return t?Se(e):e[0];t&&e.reverse();let i,s=!1;for(let r=0;r<e.length;r++){const n=e[r];if(!s){n===this.activeMenuItem&&(s=!0);continue}i=n;break}return s&&!i?e[0]:i||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}};g([T("focusService")],bm.prototype,"focusService",2);g([$],bm.prototype,"postConstruct",1);var Eb=class extends ou{constructor(t){super(),this.wrappedComponent=t,this.setTemplateFromElement(t.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t)})}handleKeyDown(t){t.key===N.ESCAPE&&this.closePanel()}onTabKeyDown(t){t.defaultPrevented||(this.closePanel(),t.preventDefault())}closePanel(){const t=this.parentComponent;t.closeSubMenu(),setTimeout(()=>t.getGui().focus(),0)}};g([$],Eb.prototype,"postConstruct",1);var na=class jn extends z{constructor(){super(...arguments),this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}init(e){var i,s;const{menuItemDef:r,isAnotherSubMenuOpen:n,level:o,childComponent:a,contextParams:l}=e;return this.params=e.menuItemDef,this.level=o,this.isAnotherSubMenuOpen=n,this.childComponent=a,this.contextParams=l,this.cssClassPrefix=(s=(i=this.params.menuItemParams)==null?void 0:i.cssClassPrefix)!=null?s:"ag-menu-option",this.userComponentFactory.getMenuItemCompDetails(this.params,He(te({},r),{level:o,isAnotherSubMenuOpen:n,openSubMenu:d=>this.openSubMenu(d),closeSubMenu:()=>this.closeSubMenu(),closeMenu:d=>this.closeMenu(d),updateTooltip:(d,c)=>this.refreshTooltip(d,c),onItemActivated:()=>this.onItemActivated()})).newAgStackInstance().then(d=>{var c;this.menuItemComp=d;const C=(c=d.configureDefaults)==null?void 0:c.call(d);C&&this.configureDefaults(C===!0?void 0:C)})}addListeners(e,i){i!=null&&i.suppressClick||this.addManagedListener(e,"click",s=>this.onItemSelected(s)),i!=null&&i.suppressKeyboardSelect||this.addManagedListener(e,"keydown",s=>{(s.key===N.ENTER||s.key===N.SPACE)&&(s.preventDefault(),this.onItemSelected(s))}),i!=null&&i.suppressMouseDown||this.addManagedListener(e,"mousedown",s=>{s.stopPropagation(),s.preventDefault()}),i!=null&&i.suppressMouseOver||(this.addManagedListener(e,"mouseenter",()=>this.onMouseEnter()),this.addManagedListener(e,"mouseleave",()=>this.onMouseLeave()))}isDisabled(){return!!this.params.disabled}openSubMenu(e=!1){var i,s;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const r=Qt('<div class="ag-menu" role="presentation"></div>');this.eSubMenuGui=r;let n,o=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const d=this.createBean(new Eb(this.childComponent));d.setParentComponent(this);const c=d.getGui(),C="mouseenter",E=()=>this.cancelDeactivate();c.addEventListener(C,E),n=()=>c.removeEventListener(C,E),r.appendChild(c),this.childComponent.afterGuiAttached&&(o=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const d=this.createBean(new bm(this.level+1,this.contextParams));d.setParentComponent(this),d.addMenuItems(this.params.subMenu),r.appendChild(d.getGui()),this.addManagedListener(d,jn.EVENT_CLOSE_MENU,c=>this.dispatchEvent(c)),d.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),n=()=>this.destroyBean(d),e&&(o=()=>{d.activateFirstItem(),this.subMenuIsOpening=!1})}const a=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup:r}),l=this.localeService.getLocaleTextFunc(),u=this.popupService.addPopup({modal:!0,eChild:r,positionCallback:a,anchorToElement:this.eGui,ariaLabel:l("ariaLabelSubMenu","SubMenu"),afterGuiAttached:o});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var d,c;u&&u.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),n(),(c=(d=this.menuItemComp).setExpanded)==null||c.call(d,!1),this.eSubMenuGui=void 0},(s=(i=this.menuItemComp).setExpanded)==null||s.call(i,!0)}setAriaExpanded(e){this.suppressAria||zs(this.eGui,e)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(e){var i,s;this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),(s=(i=this.menuItemComp).setActive)==null||s.call(i,!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),e&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var e,i;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),(i=(e=this.menuItemComp).setActive)==null||i.call(e,!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(e){this.parentComponent=e}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(e){var i,s;(s=(i=this.menuItemComp).select)==null||s.call(i),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gos.addGridCommonParams(te({},this.contextParams)))):this.openSubMenu(e&&e.type==="keydown"),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(e)}closeMenu(e){const i={type:jn.EVENT_CLOSE_MENU};e&&(e instanceof MouseEvent?i.mouseEvent=e:i.keyboardEvent=e),this.dispatchEvent(i)}onItemActivated(){const e={type:jn.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),jn.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),jn.ACTIVATION_DELAY):this.deactivate()}configureDefaults(e){var i,s,r;if(!this.menuItemComp){setTimeout(()=>this.configureDefaults(e));return}let n=this.menuItemComp.getGui();const o=(s=(i=this.menuItemComp).getRootElement)==null?void 0:s.call(i);o&&(e!=null&&e.suppressRootStyles||n.classList.add("ag-menu-option-custom"),n=o),this.eGui=n,this.suppressRootStyles=!!(e!=null&&e.suppressRootStyles),this.suppressRootStyles||(n.classList.add(this.cssClassPrefix),(r=this.params.cssClasses)==null||r.forEach(a=>n.classList.add(a)),this.params.disabled&&n.classList.add(`${this.cssClassPrefix}-disabled`)),e!=null&&e.suppressTooltip||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!(e!=null&&e.suppressAria),this.suppressAria||(Qe(n,"treeitem"),I0(n,this.level+1),this.params.disabled&&Mf(n,!0)),e!=null&&e.suppressTabIndex||n.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(n,e),this.suppressFocus=!!(e!=null&&e.suppressFocus)}refreshTooltip(e,i){this.tooltip=e,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),!(!e||!this.menuItemComp)&&(this.tooltipFeature=this.createBean(new Ys({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip:i})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}};na.EVENT_CLOSE_MENU="closeMenu";na.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated";na.ACTIVATION_DELAY=80;g([T("popupService")],na.prototype,"popupService",2);g([T("userComponentFactory")],na.prototype,"userComponentFactory",2);var qu=na,Dn=class gg extends oe{constructor(e){super(gg.getTemplate(e)),this.config=e,this.closable=!0}static getTemplate(e){const i=e.cssIdentifier||"default";return`<div class="ag-panel ag-${i}-panel" tabindex="-1">
            <div ref="eTitleBar" class="ag-panel-title-bar ag-${i}-panel-title-bar ag-unselectable">
                <span ref="eTitle" class="ag-panel-title-bar-title ag-${i}-panel-title-bar-title"></span>
                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${i}-panel-title-bar-buttons"></div>
            </div>
            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${i}-panel-content-wrapper"></div>
        </div>`}postConstruct(){const{component:e,closable:i,hideTitleBar:s,title:r,minWidth:n=250,width:o,minHeight:a=250,height:l,centered:u,popup:d,x:c,y:C}=this.config;this.positionableFeature=new qo(this.getGui(),{minWidth:n,width:o,minHeight:a,height:l,centered:u,x:c,y:C,popup:d,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const E=this.getGui();e&&this.setBodyComponent(e),s?ve(this.eTitleBar,!1):(r&&this.setTitle(r),this.setClosable(i??this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",y=>{if(E.contains(y.relatedTarget)||E.contains(this.gos.getActiveDomElement())||this.eTitleBarButtons.contains(y.target)){y.preventDefault();return}const _=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");_&&_.focus()}),!(d&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const e=this.getGui();e.focus(),this.close=()=>{e.parentElement.removeChild(e),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(e){this.positionableFeature.setHeight(e)}getWidth(){return this.positionableFeature.getWidth()}setWidth(e){this.positionableFeature.setWidth(e)}setClosable(e){if(e!==this.closable&&(this.closable=e),e){const i=this.closeButtonComp=new oe(gg.CLOSE_BTN_TEMPLATE);this.getContext().createBean(i);const s=i.getGui(),r=je("close",this.gos);r.classList.add("ag-panel-title-bar-button-icon"),s.appendChild(r),this.addTitleBarButton(i),i.addManagedListener(s,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const i=this.closeButtonComp.getGui();i.parentElement.removeChild(i),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())}addTitleBarButton(e,i){const s=this.eTitleBarButtons,r=s.children,n=r.length;i==null&&(i=n),i=Math.max(0,Math.min(i,n)),e.addCssClass("ag-panel-title-bar-button");const o=e.getGui();i===0?s.insertAdjacentElement("afterbegin",o):i===n?s.insertAdjacentElement("beforeend",o):r[i-1].insertAdjacentElement("afterend",o),e.setParentComponent(this)}getBodyHeight(){return Xl(this.eContentWrapper)}getBodyWidth(){return mn(this.eContentWrapper)}setTitle(e){this.eTitle.innerText=e}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const e=this.getGui();e&&ti(e)&&this.close(),super.destroy()}};Dn.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>';g([q("eContentWrapper")],Dn.prototype,"eContentWrapper",2);g([q("eTitleBar")],Dn.prototype,"eTitleBar",2);g([q("eTitleBarButtons")],Dn.prototype,"eTitleBarButtons",2);g([q("eTitle")],Dn.prototype,"eTitle",2);g([$],Dn.prototype,"postConstruct",1);var iN=Dn,sN=class extends iN{constructor(t){super(He(te({},t),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const t=this.getGui(),{movable:e,resizable:i,maximizable:s}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(t,"focusin",r=>{this.popupService.bringPopupToFront(t)}),e&&this.setMovable(e),s&&this.setMaximizable(s),i&&this.setResizable(i)}renderComponent(){const t=this.getGui(),{alwaysOnTop:e,modal:i,title:s,afterGuiAttached:r}=this.config,n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:i,eChild:t,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop:e,ariaLabel:s||n("ariaLabelDialog","Dialog"),afterGuiAttached:r});o&&(this.close=o.hideFunc)}onClosed(t){var e,i;this.destroy(),(i=(e=this.config).closedCallback)==null||i.call(e,t)}toggleMaximize(){const t=this.positionableFeature.getPosition();if(this.isMaximized){const{x:e,y:i,width:s,height:r}=this.lastPosition;this.setWidth(s),this.setHeight(r),this.positionableFeature.offsetElement(e,i)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=t.x,this.lastPosition.y=t.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){ve(this.maximizeIcon,!this.isMaximized),ve(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(t=>t()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(t){this.positionableFeature.setResizable(t)}setMovable(t){this.positionableFeature.setMovable(t,this.eTitleBar)}setMaximizable(t){if(!t){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const e=this.eTitleBar;if(!e||t===this.isMaximizable)return;const i=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),i.addManagedListener(i.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(i,0),this.maximizeListeners.push(this.addManagedListener(e,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const t=this.maximizeButtonComp=this.createBean(new oe('<div class="ag-dialog-button"></span>')),e=t.getGui();return this.maximizeIcon=je("maximize",this.gos),e.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=je("minimize",this.gos),e.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),t}};g([T("popupService")],sN.prototype,"popupService",2);var rN=0,$s=class extends z{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridCtrl=t.gridCtrl}),this.addManagedListener(this.eventService,S.EVENT_GRID_STYLES_CHANGED,this.handleThemeChange.bind(this))}getPopupParent(){const t=this.gos.get("popupParent");return t||this.gridCtrl.getGui()}positionPopupForMenu(t){const{eventSource:e,ePopup:i}=t,s=this.getPopupIndex(i);if(s!==-1){const E=this.popupList[s];E.alignedToElement=e}const r=e.getBoundingClientRect(),n=this.getParentRect(),o=this.keepXYWithinBounds(i,r.top-n.top,0),a=i.clientWidth>0?i.clientWidth:200;i.style.minWidth=`${a}px`;const u=n.right-n.left-a;let d;this.gos.get("enableRtl")?(d=C(),d<0&&(d=c(),this.setAlignedStyles(i,"left")),d>u&&(d=0,this.setAlignedStyles(i,"right"))):(d=c(),d>u&&(d=C(),this.setAlignedStyles(i,"right")),d<0&&(d=0,this.setAlignedStyles(i,"left"))),i.style.left=`${d}px`,i.style.top=`${o}px`;function c(){return r.right-n.left-2}function C(){return r.left-n.left-a}}positionPopupUnderMouseEvent(t){const{ePopup:e,nudgeX:i,nudgeY:s,skipObserver:r}=t;this.positionPopup({ePopup:e,nudgeX:i,nudgeY:s,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(t.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(t.type,t.ePopup,null,t.mouseEvent,t.column,t.rowNode)})}calculatePointerAlign(t){const e=this.getParentRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}positionPopupByComponent(t){const{ePopup:e,nudgeX:i,nudgeY:s,keepWithinBounds:r,eventSource:n,alignSide:o="left",position:a="over",column:l,rowNode:u,type:d}=t,c=n.getBoundingClientRect(),C=this.getParentRect(),E=this.getPopupIndex(e);if(E!==-1){const _=this.popupList[E];_.alignedToElement=n}const y=()=>{let _=c.left-C.left;o==="right"&&(_-=e.offsetWidth-c.width);let b;return a==="over"?(b=c.top-C.top,this.setAlignedStyles(e,"over")):(this.setAlignedStyles(e,"under"),this.shouldRenderUnderOrAbove(e,c,C,t.nudgeY||0)==="under"?b=c.top-C.top+c.height:b=c.top-e.offsetHeight-(s||0)*2-C.top),{x:_,y:b}};this.positionPopup({ePopup:e,nudgeX:i,nudgeY:s,keepWithinBounds:r,updatePosition:y,postProcessCallback:()=>this.callPostProcessPopup(d,e,n,null,l,u)})}shouldRenderUnderOrAbove(t,e,i,s){const r=i.bottom-e.bottom,n=e.top-i.top,o=t.offsetHeight+s;return r>o?"under":n>o||n>r?"above":"under"}setAlignedStyles(t,e){const i=this.getPopupIndex(t);if(i===-1)return;const s=this.popupList[i],{alignedToElement:r}=s;!r||(["right","left","over","above","under"].forEach(o=>{r.classList.remove(`ag-has-popup-positioned-${o}`),t.classList.remove(`ag-popup-positioned-${o}`)}),!e)||(r.classList.add(`ag-has-popup-positioned-${e}`),t.classList.add(`ag-popup-positioned-${e}`))}callPostProcessPopup(t,e,i,s,r,n){const o=this.gos.getCallback("postProcessPopup");o&&o({column:r,rowNode:n,ePopup:e,type:t,eventSource:i,mouseEvent:s})}positionPopup(t){const{ePopup:e,keepWithinBounds:i,nudgeX:s,nudgeY:r,skipObserver:n,updatePosition:o}=t,a={width:0,height:0},l=(u=!1)=>{let{x:d,y:c}=o();u&&e.clientWidth===a.width&&e.clientHeight===a.height||(a.width=e.clientWidth,a.height=e.clientHeight,s&&(d+=s),r&&(c+=r),i&&(d=this.keepXYWithinBounds(e,d,1),c=this.keepXYWithinBounds(e,c,0)),e.style.left=`${d}px`,e.style.top=`${c}px`,t.postProcessCallback&&t.postProcessCallback())};if(l(),!n){const u=this.resizeObserverService.observeResize(e,()=>l(!0));setTimeout(()=>u(),$s.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(t=>t.element)}getPopupList(){return this.popupList}getParentRect(){const t=this.gos.getDocument();let e=this.getPopupParent();return e===t.body?e=t.documentElement:getComputedStyle(e).position==="static"&&(e=e.offsetParent),Kf(e)}keepXYWithinBounds(t,e,i){const s=i===0,r=s?"clientHeight":"clientWidth",n=s?"top":"left",o=s?"offsetHeight":"offsetWidth",a=s?"scrollTop":"scrollLeft",l=this.gos.getDocument(),u=l.documentElement,d=this.getPopupParent(),c=d.getBoundingClientRect(),C=l.documentElement.getBoundingClientRect(),E=d===l.body,y=t[o];let b=E?(s?qf:ml)(u)+u[a]:d[r];E&&(b-=Math.abs(C[n]-c[n]));const R=b-y;return Math.min(Math.max(e,0),Math.abs(R))}addPopup(t){const e=this.gos.getDocument(),{eChild:i,ariaLabel:s,alwaysOnTop:r,positionCallback:n,anchorToElement:o}=t;if(!e)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(i);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(i);const l=this.createPopupWrapper(i,s,!!r),u=this.addEventListenersToPopup(He(te({},t),{wrapperEl:l}));return n&&n(),this.addPopupToPopupList(i,l,u,o),{hideFunc:u}}initialisePopupPosition(t){const i=this.getPopupParent().getBoundingClientRect();U(t.style.top)||(t.style.top=`${i.top*-1}px`),U(t.style.left)||(t.style.left=`${i.left*-1}px`)}createPopupWrapper(t,e,i){const s=this.getPopupParent(),r=document.createElement("div"),{allThemes:n}=this.environment.getTheme();return n.length&&r.classList.add(...n),r.classList.add("ag-popup"),t.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),t.hasAttribute("role")||Qe(t,"dialog"),Ci(t,e),r.appendChild(t),s.appendChild(r),i?this.setAlwaysOnTop(t,!0):this.bringPopupToFront(t),r}handleThemeChange(){const{allThemes:t}=this.environment.getTheme();for(const e of this.popupList){for(const i of Array.from(e.wrapper.classList))i.startsWith("ag-theme-")&&e.wrapper.classList.remove(i);t.length&&e.wrapper.classList.add(...t)}}addEventListenersToPopup(t){const e=this.gos.getDocument(),i=this.getPopupParent(),{wrapperEl:s,eChild:r,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l}=t;let u=!1;const d=y=>{if(!s.contains(this.gos.getActiveDomElement()))return;y.key===N.ESCAPE&&!Yi(y)&&E({keyboardEvent:y})},c=y=>E({mouseEvent:y}),C=y=>E({touchEvent:y}),E=(y={})=>{const{mouseEvent:_,touchEvent:b,keyboardEvent:R,forceHide:D}=y;!D&&(this.isEventFromCurrentPopup({mouseEvent:_,touchEvent:b},r)||u)||(u=!0,i.removeChild(s),e.removeEventListener("keydown",d),e.removeEventListener("mousedown",c),e.removeEventListener("touchstart",C),e.removeEventListener("contextmenu",c),this.eventService.removeEventListener(S.EVENT_DRAG_STARTED,c),n&&n(_||b||R),this.removePopupFromPopupList(r))};return o&&o({hidePopup:E}),window.setTimeout(()=>{a&&e.addEventListener("keydown",d),l&&(e.addEventListener("mousedown",c),this.eventService.addEventListener(S.EVENT_DRAG_STARTED,c),e.addEventListener("touchstart",C),e.addEventListener("contextmenu",c))},0),E}addPopupToPopupList(t,e,i,s){this.popupList.push({element:t,wrapper:e,hideFunc:i,instanceId:rN++,isAnchored:!!s}),s&&this.setPopupPositionRelatedToElement(t,s)}getPopupIndex(t){return this.popupList.findIndex(e=>e.element===t)}setPopupPositionRelatedToElement(t,e){const i=this.getPopupIndex(t);if(i===-1)return;const s=this.popupList[i];if(s.stopAnchoringPromise&&s.stopAnchoringPromise.then(n=>n&&n()),s.stopAnchoringPromise=void 0,s.isAnchored=!1,!e)return;const r=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:s.hideFunc});return s.stopAnchoringPromise=r,s.isAnchored=!0,r}removePopupFromPopupList(t){this.setAlignedStyles(t,null),this.setPopupPositionRelatedToElement(t,null),this.popupList=this.popupList.filter(e=>e.element!==t)}keepPopupPositionedRelativeTo(t){const e=this.getPopupParent(),i=e.getBoundingClientRect(),{element:s,ePopup:r}=t,n=s.getBoundingClientRect(),o=i.top-n.top,a=i.left-n.left;let l=o,u=a;const d=r.style.top,c=parseInt(d.substring(0,d.length-1),10),C=r.style.left,E=parseInt(C.substring(0,C.length-1),10);return new Pi(y=>{this.getFrameworkOverrides().setInterval(()=>{const _=e.getBoundingClientRect(),b=s.getBoundingClientRect();if(b.top==0&&b.left==0&&b.height==0&&b.width==0){t.hidePopup();return}const D=_.top-b.top;if(D!=l){const L=this.keepXYWithinBounds(r,c+o-D,0);r.style.top=`${L}px`}l=D;const O=_.left-b.left;if(O!=u){const L=this.keepXYWithinBounds(r,E+a-O,1);r.style.left=`${L}px`}u=O},200).then(_=>{y(()=>{_!=null&&window.clearInterval(_)})})})}hasAnchoredPopup(){return this.popupList.some(t=>t.isAnchored)}isEventFromCurrentPopup(t,e){const{mouseEvent:i,touchEvent:s}=t,r=i||s;if(!r)return!1;const n=this.getPopupIndex(e);if(n===-1)return!1;for(let o=n;o<this.popupList.length;o++){const a=this.popupList[o];if(Od(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(t){const e=this.gos.getDocument();for(;t&&t!==e.body;){if(t.classList.contains("ag-custom-component-popup")||t.parentElement===null)return!0;t=t.parentElement}return!1}getWrapper(t){for(;!t.classList.contains("ag-popup")&&t.parentElement;)t=t.parentElement;return t.classList.contains("ag-popup")?t:null}setAlwaysOnTop(t,e){const i=this.getWrapper(t);i&&(i.classList.toggle("ag-always-on-top",!!e),e&&this.bringPopupToFront(i))}bringPopupToFront(t){const e=this.getPopupParent(),i=Array.prototype.slice.call(e.querySelectorAll(".ag-popup")),s=i.length,r=Array.prototype.slice.call(e.querySelectorAll(".ag-popup.ag-always-on-top")),n=r.length,o=this.getWrapper(t);if(!o||s<=1||!e.contains(t))return;const a=i.indexOf(o),l=o.querySelectorAll("div"),u=[];for(l.forEach(d=>{d.scrollTop!==0&&u.push([d,d.scrollTop])}),n?o.classList.contains("ag-always-on-top")?a!==s-1&&Se(r).insertAdjacentElement("afterend",o):a!==s-n-1&&r[0].insertAdjacentElement("beforebegin",o):a!==s-1&&Se(i).insertAdjacentElement("afterend",o);u.length;){const d=u.pop();d[0].scrollTop=d[1]}}};$s.WAIT_FOR_POPUP_CONTENT_RESIZE=200;g([T("focusService")],$s.prototype,"focusService",2);g([T("ctrlsService")],$s.prototype,"ctrlsService",2);g([T("resizeObserverService")],$s.prototype,"resizeObserverService",2);g([$],$s.prototype,"postConstruct",1);$s=g([Y("popupService")],$s);var nN=class extends oe{constructor(){super(`
        <div class="ag-autocomplete-row" role="presentation">
            <div class="ag-autocomplete-row-label"></div>
        </div>`),this.hasHighlighting=!1}setState(t,e){this.value=t,this.render(),this.updateSelected(e)}updateSelected(t){this.addOrRemoveCssClass("ag-autocomplete-row-selected",t)}setSearchString(t){var e;let i=!1;if(U(t)){const s=(e=this.value)==null?void 0:e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());if(s>=0){i=!0,this.hasHighlighting=!0;const r=s+t.length,n=at(this.value.slice(0,s)),o=at(this.value.slice(s,r)),a=at(this.value.slice(r));this.getGui().lastElementChild.innerHTML=`${n}<b>${o}</b>${a}`}}!i&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var t;this.getGui().lastElementChild.innerHTML=(t=at(this.value))!=null?t:"&nbsp;"}},ec=class wb extends yn{constructor(e){super(wb.TEMPLATE),this.params=e,this.searchString=""}destroy(){super.destroy()}init(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new yb({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:i=>this.autocompleteEntries[i]});const e=this.virtualList.getGui();this.addManagedListener(e,"click",()=>this.params.onConfirmed()),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",i=>i.preventDefault()),this.setSelectedValue(0)}onNavigationKeyDown(e,i){e.preventDefault();const s=this.autocompleteEntries.indexOf(this.selectedValue),r=i===N.UP?s-1:s+1;this.checkSetSelectedValue(r)}setSearch(e){this.searchString=e,U(e)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(e,i){let s,r=!1;const n=e.toLocaleLowerCase(),o=i.filter(a=>{const u=a.toLocaleLowerCase().indexOf(n),d=u===0,c=u>=0;return c&&(!s||!r&&d||r===d&&a.length<s.length)&&(s=a,r=d),c});return!s&&o.length&&(s=o[0]),{topMatch:s,allMatches:o}}runSearch(){var e,i;const{autocompleteEntries:s}=this.params,r=s.map(u=>{var d;return(d=u.displayValue)!=null?d:u.key});let n,o;if(this.params.useFuzzySearch)n=Jl(this.searchString,r,!0).values,o=n.length?n[0]:void 0;else{const u=this.runContainsSearch(this.searchString,r);n=u.allMatches,o=u.topMatch}let a=s.filter(({key:u,displayValue:d})=>n.includes(d??u));if(!a.length&&this.selectedValue&&((i=(e=this.params)==null?void 0:e.forceLastSelection)!=null&&i.call(e,this.selectedValue,this.searchString))&&(a=[this.selectedValue]),this.autocompleteEntries=a,this.virtualList.refresh(),!o)return;const l=n.indexOf(o);this.checkSetSelectedValue(l)}updateSearchInList(){this.virtualList.forEachRenderedRow(e=>e.setSearchString(this.searchString))}checkSetSelectedValue(e){e>=0&&e<this.autocompleteEntries.length&&this.setSelectedValue(e)}setSelectedValue(e){const i=this.autocompleteEntries[e];this.selectedValue!==i&&(this.selectedValue=i,this.virtualList.ensureIndexVisible(e),this.virtualList.forEachRenderedRow((s,r)=>{s.updateSelected(e===r)}))}createRowComponent(e){var i;const s=new nN;return this.getContext().createBean(s),s.setState((i=e.displayValue)!=null?i:e.key,e===this.selectedValue),s}onMouseMove(e){const i=this.virtualList.getGui().getBoundingClientRect(),s=this.virtualList.getScrollTop(),r=e.clientY-i.top+s,n=Math.floor(r/this.virtualList.getRowHeight());this.checkSetSelectedValue(n)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var e;return this.autocompleteEntries.length&&(e=this.selectedValue)!=null?e:null}};ec.TEMPLATE=`<div class="ag-autocomplete-list-popup">
            <div ref="eList" class="ag-autocomplete-list"></div>
        <div>`;g([q("eList")],ec.prototype,"eList",2);g([$],ec.prototype,"init",1);var oN=ec,Tr=class Ba extends oe{constructor(){super(`
            <div class="ag-autocomplete" role="presentation">
                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>
            </div>`),this.isListOpen=!1,this.lastPosition=0,this.valid=!0}postConstruct(){this.eAutocompleteInput.onValueChange(e=>this.onValueChanged(e)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(e){const i=ys(e);this.updateValue(i),this.updateAutocompleteList(i)}updateValue(e){this.updateLastPosition(),this.dispatchEvent({type:Ba.EVENT_VALUE_CHANGED,value:e}),this.validate(e)}updateAutocompleteList(e){var i,s,r,n;const o=(s=(i=this.listGenerator)==null?void 0:i.call(this,e,this.lastPosition))!=null?s:{enabled:!1};if((!o.type||o.type!==((r=this.autocompleteListParams)==null?void 0:r.type))&&this.isListOpen&&this.closeList(),this.autocompleteListParams=o,(n=this.autocompleteListParams)!=null&&n.enabled){this.isListOpen||this.openList();const{searchString:a}=this.autocompleteListParams;this.autocompleteList.setSearch(a??"")}else this.isListOpen&&this.closeList()}onKeyDown(e){const i=e.key;switch(this.updateLastPosition(),i){case N.ENTER:this.onEnterKeyDown(e);break;case N.TAB:this.onTabKeyDown(e);break;case N.DOWN:case N.UP:this.onUpDownKeyDown(e,i);break;case N.LEFT:case N.RIGHT:case N.PAGE_HOME:case N.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case N.ESCAPE:this.onEscapeKeyDown(e);break;case N.SPACE:e.ctrlKey&&!this.isListOpen&&(e.preventDefault(),this.forceOpenList());break}}confirmSelection(){var e;const i=(e=this.autocompleteList)==null?void 0:e.getSelectedValue();i&&(this.closeList(),this.dispatchEvent({type:Ba.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:i,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(e){this.isListOpen&&(e.preventDefault(),e.stopPropagation(),this.confirmSelection())}onEnterKeyDown(e){e.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(e,i){var s;e.preventDefault(),this.isListOpen?(s=this.autocompleteList)==null||s.onNavigationKeyDown(e,i):this.forceOpenList()}onEscapeKeyDown(e){this.isListOpen&&(e.preventDefault(),e.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var e;this.updateLastPosition(),this.updateAutocompleteList((e=this.eAutocompleteInput.getValue())!=null?e:null)}setCaret(e,i){const s=this.gos.getDocument(),r=this.gos.getActiveDomElement();i&&(!r||r===s.body)&&this.eAutocompleteInput.getFocusableElement().focus();const n=this.eAutocompleteInput.getInputElement();n.setSelectionRange(e,e),e===n.value.length&&(n.scrollLeft=n.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var e;this.lastPosition=(e=this.eAutocompleteInput.getInputElement().selectionStart)!=null?e:0}validate(e){var i;this.validator&&(this.validationMessage=this.validator(e),this.eAutocompleteInput.getInputElement().setCustomValidity((i=this.validationMessage)!=null?i:""),this.valid=!this.validationMessage,this.dispatchEvent({type:Ba.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new oN({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const e=this.autocompleteList.getGui(),i={ePopup:e,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gos.get("enableRtl")?"right":"left",keepWithinBounds:!0},s=this.popupService.addPopup({eChild:e,anchorToElement:this.getGui(),positionCallback:()=>this.popupService.positionPopupByComponent(i),ariaLabel:this.listAriaLabel});this.hidePopup=s.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:Ba.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})}getValue(){return ys(this.eAutocompleteInput.getValue())}setInputPlaceholder(e){return this.eAutocompleteInput.setInputPlaceholder(e),this}setInputAriaLabel(e){return this.eAutocompleteInput.setInputAriaLabel(e),this}setListAriaLabel(e){return this.listAriaLabel=e,this}setListGenerator(e){return this.listGenerator=e,this}setValidator(e){return this.validator=e,this}isValid(){return this.valid}setValue(e){const{value:i,position:s,silent:r,updateListOnlyIfOpen:n,restoreFocus:o}=e;this.eAutocompleteInput.setValue(i,!0),this.setCaret(s??this.lastPosition,o),r||this.updateValue(i),(!n||this.isListOpen)&&this.updateAutocompleteList(i)}setForceLastSelection(e){return this.forceLastSelection=e,this}setInputDisabled(e){return this.eAutocompleteInput.setDisabled(e),this}};Tr.EVENT_VALUE_CHANGED="eventValueChanged";Tr.EVENT_VALUE_CONFIRMED="eventValueConfirmed";Tr.EVENT_OPTION_SELECTED="eventOptionSelected";Tr.EVENT_VALID_CHANGED="eventValidChanged";g([T("popupService")],Tr.prototype,"popupService",2);g([q("eAutocompleteInput")],Tr.prototype,"eAutocompleteInput",2);g([$],Tr.prototype,"postConstruct",1);var aN=Tr,br=class nd extends oe{constructor(e,i,s,r){super(),this.dragSourceDropTarget=e,this.ghost=i,this.horizontal=s,this.template=r}init(){var e;this.setTemplate((e=this.template)!=null?e:nd.TEMPLATE);const i=this.getGui();this.addElementClasses(i),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(je("columnDrag",this.gos)),this.eButton.appendChild(je("cancel",this.gos)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const e=this.localeService.getLocaleTextFunc(),i=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(i,e),Ci(this.getGui(),i.join(". "))}addAdditionalAriaInstructions(e,i){if(this.isRemovable()){const s=i("ariaDropZoneColumnComponentDescription","Press DELETE to remove");e.push(s)}}setupTooltip(){const e=()=>{const i=this.getTooltip();this.setTooltip({newTooltipText:i})};e(),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,e)}getDragSourceId(){}getDefaultIconName(){return ae.ICON_NOT_ALLOWED}addDragSource(){const{dragAndDropService:e,eDragHandle:i}=this,s=this.createGetDragItem(),r=this.getDefaultIconName(),n={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:i,getDefaultIconName:()=>r,getDragItem:s,dragItemName:this.getDisplayName()};e.addDragSource(n,!0),this.addDestroyFunc(()=>e.removeDragSource(n))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){ve(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const e={type:nd.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",s=>this.onKeyDown(s)),this.addManagedListener(this.eButton,"click",s=>{this.dispatchEvent(e),s.stopPropagation()});const i=new Ct(this.eButton);this.addManagedListener(i,Ct.EVENT_TAP,()=>{this.dispatchEvent(e)}),this.addDestroyFunc(i.destroy.bind(i))}onKeyDown(e){e.key===N.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchEvent({type:nd.EVENT_COLUMN_REMOVE}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const e=this.getDisplayValue(),i=at(e);this.eText.innerHTML=i}addElementClasses(e,i){i=i?`-${i}`:"";const s=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop-cell${i}`,`ag-column-drop-${s}-cell${i}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}};br.EVENT_COLUMN_REMOVE="columnRemove";br.TEMPLATE=`<span role="option">
          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>
          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>
          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>
        </span>`;g([T("dragAndDropService")],br.prototype,"dragAndDropService",2);g([q("eText")],br.prototype,"eText",2);g([q("eDragHandle")],br.prototype,"eDragHandle",2);g([q("eButton")],br.prototype,"eButton",2);g([$],br.prototype,"init",1);var lN=br,uu=class ns extends oe{constructor(e){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=e,this.state=ns.STATE_NOT_DRAGGING,this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),Qe(this.ePillDropList,"listbox")}isHorizontal(){return this.horizontal}toggleResizable(e){this.positionableFeature.setResizable(e?{bottom:!0}:!1),this.resizeEnabled=e}isSourceEventFromTarget(e){const{dropZoneTarget:i,dragSource:s}=e;return i.contains(s.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(e=>e()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,tt(this.getGui()),tt(this.ePillDropList)}init(e){this.params=e??{},this.createManagedBean(new Er(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new qo(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),Ci(this.ePillDropList,this.getAriaLabel())}handleKeyDown(e){const i=!this.horizontal;let s=e.key===N.DOWN,r=e.key===N.UP;if(!i){const o=this.gos.get("enableRtl");s=!o&&e.key===N.RIGHT||o&&e.key===N.LEFT,r=!o&&e.key===N.LEFT||o&&e.key===N.RIGHT}if(!s&&!r)return;const n=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,r);n&&(e.preventDefault(),n.focus())}addElementClasses(e,i){i=i?`-${i}`:"";const s=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop${i}`,`ag-column-drop-${s}${i}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(e){const i=this.getNewInsertIndex(e);if(i<0)return!1;const s=this.minimumAllowedNewInsertIndex(),r=Math.max(s,i),n=r!==this.insertIndex;return n&&(this.insertIndex=r),n}getNewInsertIndex(e){const i=e.event,s=this.horizontal?i.clientX:i.clientY,r=this.childPillComponents.map(o=>o.getGui().getBoundingClientRect()),n=r.findIndex(o=>this.horizontal?o.right>s&&o.left<s:o.top<s&&o.bottom>s);if(n===-1){const o=this.gos.get("enableRtl");return r.every(u=>s>(this.horizontal?u.right:u.bottom))?o&&this.horizontal?0:this.childPillComponents.length:r.every(u=>s<(this.horizontal?u.left:u.top))?o&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=n?n+1:n}checkDragStartedBySelf(e){this.state===ns.STATE_NOT_DRAGGING&&(this.state=ns.STATE_REARRANGE_ITEMS,this.potentialDndItems=this.getItems(e.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(e),this.refreshGui())}onDragging(e){this.checkDragStartedBySelf(e),this.checkInsertIndex(e)&&this.refreshGui()}handleDragEnterEnd(e){}onDragEnter(e){const i=this.getItems(e.dragSource.getDragItem());this.state=ns.STATE_NEW_ITEMS_IN;const s=i.filter(n=>this.isItemDroppable(n,e)),r=s.every(n=>this.childPillComponents.map(o=>o.getItem()).indexOf(n)!==-1);if(s.length!==0){if(this.potentialDndItems=s,r){this.state=ns.STATE_NOT_DRAGGING;return}this.handleDragEnterEnd(e),this.checkInsertIndex(e),this.refreshGui()}}isPotentialDndItems(){return l0(this.potentialDndItems)}handleDragLeaveEnd(e){}onDragLeave(e){if(this.state===ns.STATE_REARRANGE_ITEMS){const i=this.getItems(e.dragSource.getDragItem());this.removeItems(i)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state=ns.STATE_NOT_DRAGGING}refreshOnDragStop(){return!0}onDragStop(){if(this.isPotentialDndItems()){let e=!1;this.state===ns.STATE_NEW_ITEMS_IN?(this.addItems(this.potentialDndItems),e=!0):e=this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],(this.refreshOnDragStop()||!e)&&this.refreshGui()}this.state=ns.STATE_NOT_DRAGGING}removeItems(e){const i=this.getExistingItems().filter(s=>!fi(e,s));this.updateItems(i)}addItems(e){if(!e)return;const i=this.getExistingItems().slice(),s=e.filter(r=>i.indexOf(r)<0);Qp(i,s,this.insertIndex),this.updateItems(i)}addItem(e){this.insertIndex=this.getExistingItems().length,this.addItems([e]),this.refreshGui()}rearrangeItems(e){const i=this.getNonGhostItems().slice();return Qp(i,e,this.insertIndex),fs(i,this.getExistingItems())?!1:(this.updateItems(i),!0)}refreshGui(){const e=this.ePillDropList.scrollTop,i=this.resizeEnabled,s=this.getFocusedItem();let r=this.focusService.findNextFocusableElement();r||(r=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=e),i&&this.toggleResizable(i),this.focusService.isKeyboardMode()&&this.restoreFocus(s,r)}getFocusedItem(){const e=this.getGui(),i=this.gos.getActiveDomElement();return e.contains(i)?Array.from(e.querySelectorAll(".ag-column-drop-cell")).indexOf(i):-1}restoreFocus(e,i){const s=this.getGui(),r=Array.from(s.querySelectorAll(".ag-column-drop-cell"));if(e===-1)return;r.length===0&&i.focus();const n=Math.min(r.length-1,e),o=r[n];o&&o.focus()}focusList(e){const i=e?this.childPillComponents.length-1:0;this.restoreFocus(i,this.getFocusableElement())}getNonGhostItems(){const e=this.getExistingItems();return this.isPotentialDndItems()?e.filter(i=>!fi(this.potentialDndItems,i)):e}addItemsToGui(){const i=this.getNonGhostItems().map(s=>this.createItemComponent(s,!1));if(this.isPotentialDndItems()){const s=this.potentialDndItems.map(r=>this.createItemComponent(r,!0));this.insertIndex>=i.length?i.push(...s):i.splice(this.insertIndex,0,...s)}this.appendChild(this.ePillDropList),i.forEach((s,r)=>{r>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(s.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((e,i)=>{const s=e.getGui();xh(s,i+1),Ah(s,this.childPillComponents.length)})}createItemComponent(e,i){const s=this.createPillComponent(e,this.dropTarget,i,this.horizontal);return s.addEventListener(lN.EVENT_COLUMN_REMOVE,this.removeItems.bind(this,[e])),this.context.createBean(s),this.guiDestroyFunctions.push(()=>this.destroyBean(s)),i||this.childPillComponents.push(s),s}addIconAndTitleToGui(){const{title:e,icon:i}=this.params;if(!e||!i)return;const s=document.createElement("div");if(Yl(s,!0),this.addElementClasses(s,"title-bar"),this.addElementClasses(i,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),s.appendChild(i),!this.horizontal){const r=document.createElement("span");this.addElementClasses(r,"title"),r.innerHTML=e,s.appendChild(r)}this.appendChild(s)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage:e}=this.params;if(!e||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const i=document.createElement("span");i.innerHTML=e,this.addElementClasses(i,"empty-message"),this.ePillDropList.appendChild(i)}addArrow(e){if(this.horizontal){const i=this.gos.get("enableRtl"),s=je(i?"smallLeft":"smallRight",this.gos);this.addElementClasses(s,"cell-separator"),e.appendChild(s)}}};uu.STATE_NOT_DRAGGING="notDragging";uu.STATE_NEW_ITEMS_IN="newItemsIn";uu.STATE_REARRANGE_ITEMS="rearrangeItems";g([T("focusService")],uu.prototype,"focusService",2);g([T("dragAndDropService")],uu.prototype,"dragAndDropService",2);var uN=["touchstart","touchend","touchmove","touchcancel"],dN=class{constructor(t="javascript"){this.frameworkName=t,this.renderingEngine="vanilla",this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e()}setInterval(t,e){return new Pi(i=>{i(window.setInterval(t,e))})}addEventListener(t,e,i,s){const r=fi(uN,e);t.addEventListener(e,i,{capture:!!s,passive:r})}get shouldWrapOutgoing(){return!1}frameworkComponent(t){return null}isFrameworkComponent(t){return!1}getDocLink(t){return`https://www.ag-grid.com/${this.frameworkName==="solid"?"react":this.frameworkName}-data-grid${t?`/${t}`:""}`}},gr=class extends z{getNextCellToFocus(t,e,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(t,e):this.getNextCellToFocusWithoutCtrlPressed(t,e)}getNextCellToFocusWithCtrlPressed(t,e){const i=t===N.UP,s=t===N.DOWN,r=t===N.LEFT;let n,o;if(i||s)o=i?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=e.column;else{const a=this.columnModel.getAllDisplayedColumns(),l=this.gos.get("enableRtl");o=e.rowIndex,n=r!==l?a[0]:Se(a)}return{rowIndex:o,rowPinned:null,column:n}}getNextCellToFocusWithoutCtrlPressed(t,e){let i=e,s=!1;for(;!s;){switch(t){case N.UP:i=this.getCellAbove(i);break;case N.DOWN:i=this.getCellBelow(i);break;case N.RIGHT:this.gos.get("enableRtl")?i=this.getCellToLeft(i):i=this.getCellToRight(i);break;case N.LEFT:this.gos.get("enableRtl")?i=this.getCellToRight(i):i=this.getCellToLeft(i);break;default:i=null,console.warn("AG Grid: unknown key for navigation "+t);break}i?s=this.isCellGoodToFocusOn(i):s=!0}return i}isCellGoodToFocusOn(t){const e=t.column;let i;switch(t.rowPinned){case"top":i=this.pinnedRowModel.getPinnedTopRow(t.rowIndex);break;case"bottom":i=this.pinnedRowModel.getPinnedBottomRow(t.rowIndex);break;default:i=this.rowModel.getRow(t.rowIndex);break}return i?!e.isSuppressNavigable(i):!1}getCellToLeft(t){if(!t)return null;const e=this.columnModel.getDisplayedColBefore(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null}getCellToRight(t){if(!t)return null;const e=this.columnModel.getDisplayedColAfter(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null}getRowBelow(t){const e=t.rowIndex,i=t.rowPinned;if(this.isLastRowInContainer(t))switch(i){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const s=this.rowModel.getRow(t.rowIndex),r=this.getNextStickyPosition(s);return r||{rowIndex:e+1,rowPinned:i}}getNextStickyPosition(t,e){if(!this.gos.isGroupRowsSticky()||!t||!t.sticky)return;const i=this.rowRenderer.getStickyTopRowCtrls().some(a=>a.getRowNode().rowIndex===t.rowIndex);let s=[];i?s=[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,l)=>a.getRowNode().rowIndex-l.getRowNode().rowIndex):s=[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,l)=>l.getRowNode().rowIndex-a.getRowNode().rowIndex);const r=e?-1:1,n=s.findIndex(a=>a.getRowNode().rowIndex===t.rowIndex),o=s[n+r];if(o)return{rowIndex:o.getRowNode().rowIndex,rowPinned:null}}getCellBelow(t){if(!t)return null;const e=this.getRowBelow(t);return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null}isLastRowInContainer(t){const e=t.rowPinned,i=t.rowIndex;return e==="top"?this.pinnedRowModel.getPinnedTopRowData().length-1<=i:e==="bottom"?this.pinnedRowModel.getPinnedBottomRowData().length-1<=i:this.paginationProxy.getPageLastRow()<=i}getRowAbove(t){const e=t.rowIndex,i=t.rowPinned;if(i?e===0:e===this.paginationProxy.getPageFirstRow())return i==="top"?null:i?this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null:this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const r=this.rowModel.getRow(t.rowIndex),n=this.getNextStickyPosition(r,!0);return n||{rowIndex:e-1,rowPinned:i}}getCellAbove(t){if(!t)return null;const e=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(t,e){return e?this.getNextTabbedCellBackwards(t):this.getNextTabbedCellForwards(t)}getNextTabbedCellForwards(t){const e=this.columnModel.getAllDisplayedColumns();let i=t.rowIndex,s=t.rowPinned,r=this.columnModel.getDisplayedColAfter(t.column);if(!r){r=e[0];const n=this.getRowBelow(t);if(re(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;i=n?n.rowIndex:null,s=n?n.rowPinned:null}return{rowIndex:i,column:r,rowPinned:s}}getNextTabbedCellBackwards(t){const e=this.columnModel.getAllDisplayedColumns();let i=t.rowIndex,s=t.rowPinned,r=this.columnModel.getDisplayedColBefore(t.column);if(!r){r=Se(e);const n=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(re(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;i=n?n.rowIndex:null,s=n?n.rowPinned:null}return{rowIndex:i,column:r,rowPinned:s}}};g([T("columnModel")],gr.prototype,"columnModel",2);g([T("rowModel")],gr.prototype,"rowModel",2);g([T("rowRenderer")],gr.prototype,"rowRenderer",2);g([T("pinnedRowModel")],gr.prototype,"pinnedRowModel",2);g([T("paginationProxy")],gr.prototype,"paginationProxy",2);gr=g([Y("cellNavigationService")],gr);var an=class extends z{constructor(){super(...arguments),this.consuming=!1}setBeans(t){this.logger=t.create("AlignedGridsService")}getAlignedGridApis(){var t;let e=(t=this.gos.get("alignedGrids"))!=null?t:[];const i=typeof e=="function";typeof e=="function"&&(e=e());const s=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return e.map(n=>{var o;if(!n){gs("alignedGrids contains an undefined option."),i||gs(`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`),gs(s());return}if(n instanceof me)return n;const a=n;return"current"in a?(o=a.current)==null?void 0:o.api:(a.api||gs(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${s()}`),a.api)}).filter(n=>!!n&&!n.isDestroyed())}init(){this.addManagedListener(this.eventService,S.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(t){this.consuming||this.getAlignedGridApis().forEach(e=>{if(e.isDestroyed())return;const i=e.__getAlignedGridService();t(i)})}onEvent(t){this.consuming=!0,t(),this.consuming=!1}fireColumnEvent(t){this.fireEvent(e=>{e.onColumnEvent(t)})}fireScrollEvent(t){t.direction==="horizontal"&&this.fireEvent(e=>{e.onScrollEvent(t)})}onScrollEvent(t){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(t.left,!0)})}getMasterColumns(t){const e=[];return t.columns?t.columns.forEach(i=>{e.push(i)}):t.column&&e.push(t.column),e}getColumnIds(t){const e=[];return t.columns?t.columns.forEach(i=>{e.push(i.getColId())}):t.column&&e.push(t.column.getColId()),e}onColumnEvent(t){this.onEvent(()=>{switch(t.type){case S.EVENT_COLUMN_MOVED:case S.EVENT_COLUMN_VISIBLE:case S.EVENT_COLUMN_PINNED:case S.EVENT_COLUMN_RESIZED:const e=t;this.processColumnEvent(e);break;case S.EVENT_COLUMN_GROUP_OPENED:const i=t;this.processGroupOpenedEvent(i);break;case S.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");break}})}processGroupOpenedEvent(t){t.columnGroups.forEach(e=>{let i=null;if(e){const s=e.getGroupId();i=this.columnModel.getProvidedColumnGroup(s)}e&&!i||(this.logger.log("onColumnEvent-> processing "+t+" expanded = "+e.isExpanded()),this.columnModel.setColumnGroupOpened(i,e.isExpanded(),"alignedGridChanged"))})}processColumnEvent(t){var e;const i=t.column;let s=null;if(i&&(s=this.columnModel.getPrimaryColumn(i.getColId())),i&&!s)return;const r=this.getMasterColumns(t);switch(t.type){case S.EVENT_COLUMN_MOVED:{const u=t,c=t.api.getColumnState().map(C=>({colId:C.colId}));this.columnModel.applyColumnState({state:c,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} toIndex = ${u.toIndex}`)}break;case S.EVENT_COLUMN_VISIBLE:{const u=t,c=t.api.getColumnState().map(C=>({colId:C.colId,hide:C.hide}));this.columnModel.applyColumnState({state:c},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} visible = ${u.visible}`)}break;case S.EVENT_COLUMN_PINNED:{const u=t,c=t.api.getColumnState().map(C=>({colId:C.colId,pinned:C.pinned}));this.columnModel.applyColumnState({state:c},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${t.type} pinned = ${u.pinned}`)}break;case S.EVENT_COLUMN_RESIZED:const a=t,l={};r.forEach(u=>{this.logger.log(`onColumnEvent-> processing ${t.type} actualWidth = ${u.getActualWidth()}`),l[u.getId()]={key:u.getColId(),newWidth:u.getActualWidth()}}),(e=a.flexColumns)==null||e.forEach(u=>{l[u.getId()]&&delete l[u.getId()]}),this.columnModel.setColumnWidths(Object.values(l),!1,a.finished,"alignedGridChanged");break}const o=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(a=>{a.setGridOption("alwaysShowVerticalScroll",o)})}};g([T("columnModel")],an.prototype,"columnModel",2);g([T("ctrlsService")],an.prototype,"ctrlsService",2);g([zi(0,_i("loggerFactory"))],an.prototype,"setBeans",1);g([$],an.prototype,"init",1);an=g([Y("alignedGridsService")],an);var ln=class extends z{constructor(){super(...arguments),this.selectedNodes=new Map,this.lastRowNode=null}init(){this.rowSelection=this.gos.get("rowSelection"),this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.rowSelection=this.gos.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedListener(this.eventService,S.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}destroy(){super.destroy(),this.resetNodes(),this.lastRowNode=null}isMultiselect(){return this.rowSelection==="multiple"}setNodesSelected(t){var e;const{newValue:i,clearSelection:s,suppressFinishActions:r,rangeSelect:n,nodes:o,event:a,source:l="api"}=t;if(o.length===0)return 0;if(o.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const u=this.groupSelectsChildren&&t.groupSelectsFiltered===!0,d=o.map(C=>C.footer?C.sibling:C);if(n){if(o.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;let C=null;if(l==="checkboxSelected"&&i===!1&&this.lastRowNode&&(this.lastRowNode.id?C=this.lastRowNode:this.lastRowNode=null),C==null&&(C=this.getLastSelectedNode()),C){const E=d[0];if(E!==C&&this.isMultiselect())return this.selectRange(E,C,i,l)}}this.lastRowNode=i?null:d[0];let c=0;for(let C=0;C<d.length;C++){const E=d[C];u&&E.group||E.selectThisNode(i,a,l)&&c++,this.groupSelectsChildren&&((e=E.childrenAfterGroup)!=null&&e.length)&&(c+=this.selectChildren(E,i,u,l))}if(!r&&(i&&(s||!this.isMultiselect())&&(c+=this.clearOtherNodes(d[0],l)),c>0)){this.updateGroupsFromChildrenSelections(l);const E={type:S.EVENT_SELECTION_CHANGED,source:l};this.eventService.dispatchEvent(E)}return c}selectRange(t,e,i=!0,s){const r=this.rowModel.getNodesInRangeForSelection(t,e);let n=0;r.forEach(a=>{if(a.group&&this.groupSelectsChildren)return;a.selectThisNode(i,void 0,s)&&n++}),this.updateGroupsFromChildrenSelections(s);const o={type:S.EVENT_SELECTION_CHANGED,source:s};return this.eventService.dispatchEvent(o),n}selectChildren(t,e,i,s){const r=i?t.childrenAfterAggFilter:t.childrenAfterGroup;return re(r)?0:this.setNodesSelected({newValue:e,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:i,source:s,nodes:r})}getLastSelectedNode(){const t=Array.from(this.selectedNodes.keys());if(t.length==0)return null;const e=this.selectedNodes.get(Se(t));return e||null}getSelectedNodes(){const t=[];return this.selectedNodes.forEach(e=>{e&&t.push(e)}),t}getSelectedRows(){const t=[];return this.selectedNodes.forEach(e=>{e&&e.data&&t.push(e.data)}),t}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(t){const e=new Map;this.selectedNodes.forEach((i,s)=>{i&&t(i)&&e.set(s,i)}),this.selectedNodes=e}updateGroupsFromChildrenSelections(t,e){if(!this.groupSelectsChildren||this.rowModel.getType()!=="clientSide")return!1;const s=this.rowModel.getRootNode();e||(e=new Jh(!0,s),e.setInactive());let r=!1;return e.forEachChangedNodeDepthFirst(n=>{if(n!==s){const o=n.calculateSelectedFromChildren();r=n.selectThisNode(o===null?!1:o,void 0,t)||r}}),r}clearOtherNodes(t,e){const i=new Map;let s=0;return this.selectedNodes.forEach(r=>{if(r&&r.id!==t.id){const n=this.selectedNodes.get(r.id);s+=n.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:e}),this.groupSelectsChildren&&r.parent&&i.set(r.parent.id,r.parent)}}),i.forEach(r=>{const n=r.calculateSelectedFromChildren();r.selectThisNode(n===null?!1:n,void 0,e)}),s}onRowSelected(t){const e=t.node;this.groupSelectsChildren&&e.group||(e.isSelected()?this.selectedNodes.set(e.id,e):this.selectedNodes.delete(e.id))}syncInRowNode(t,e){this.syncInOldRowNode(t,e),this.syncInNewRowNode(t)}syncInOldRowNode(t,e){if(U(e)&&t.id!==e.id&&e){const s=e.id;this.selectedNodes.get(s)==t&&this.selectedNodes.set(e.id,e)}}syncInNewRowNode(t){this.selectedNodes.has(t.id)?(t.setSelectedInitialValue(!0),this.selectedNodes.set(t.id,t)):t.setSelectedInitialValue(!1)}reset(t){const e=this.getSelectionCount();if(this.resetNodes(),e){const i={type:S.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(i)}}resetNodes(){var t;(t=this.selectedNodes)==null||t.clear()}getBestCostNodeSelection(){if(this.rowModel.getType()!=="clientSide")return;const e=this.rowModel.getTopLevelNodes();if(e===null)return;const i=[];function s(r){for(let n=0,o=r.length;n<o;n++){const a=r[n];if(a.isSelected())i.push(a);else{const l=a;l.group&&l.children&&s(l.children)}}}return s(e),i}isEmpty(){let t=0;return this.selectedNodes.forEach(e=>{e&&t++}),t===0}deselectAllRowNodes(t){const e=a=>a.selectThisNode(!1,void 0,s),i=this.rowModel.getType()==="clientSide",{source:s,justFiltered:r,justCurrentPage:n}=t;if(n||r){if(!i){console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");return}this.getNodesToSelect(r,n).forEach(e)}else this.selectedNodes.forEach(a=>{a&&e(a)}),this.reset(s);i&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(s);const o={type:S.EVENT_SELECTION_CHANGED,source:s};this.eventService.dispatchEvent(o)}getSelectedCounts(t,e){let i=0,s=0;const r=n=>{this.groupSelectsChildren&&n.group||(n.isSelected()?i++:n.selectable&&s++)};return this.getNodesToSelect(t,e).forEach(r),{selectedCount:i,notSelectedCount:s}}getSelectAllState(t,e){const{selectedCount:i,notSelectedCount:s}=this.getSelectedCounts(t,e);return i===0&&s===0?!1:i>0&&s>0?null:i>0}hasNodesToSelect(t=!1,e=!1){return this.getNodesToSelect(t,e).filter(i=>i.selectable).length>0}getNodesToSelect(t=!1,e=!1){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const i=[];if(e)return this.paginationProxy.forEachNodeOnPage(r=>{if(!r.group){i.push(r);return}if(!r.expanded){const n=o=>{var a;i.push(o),(a=o.childrenAfterFilter)!=null&&a.length&&o.childrenAfterFilter.forEach(n)};n(r);return}this.groupSelectsChildren||i.push(r)}),i;const s=this.rowModel;return t?(s.forEachNodeAfterFilter(r=>{i.push(r)}),i):(s.forEachNode(r=>{i.push(r)}),i)}selectAllRowNodes(t){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source:e,justFiltered:i,justCurrentPage:s}=t,r=o=>o.selectThisNode(!0,void 0,e);this.getNodesToSelect(i,s).forEach(r),this.rowModel.getType()==="clientSide"&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(e);const n={type:S.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(n)}getSelectionState(){const t=[];return this.selectedNodes.forEach(e=>{e!=null&&e.id&&t.push(e.id)}),t.length?t:null}setSelectionState(t,e){if(!Array.isArray(t))return;const i=new Set(t),s=[];this.rowModel.forEachNode(r=>{i.has(r.id)&&s.push(r)}),this.setNodesSelected({newValue:!0,nodes:s,source:e})}};g([T("rowModel")],ln.prototype,"rowModel",2);g([T("paginationProxy")],ln.prototype,"paginationProxy",2);g([$],ln.prototype,"init",1);ln=g([Y("selectionService")],ln);var Dl=class{constructor(t){this.viaApi=(e,...i)=>(ie(`Since v31, 'columnApi.${e}' is deprecated and moved to 'api.${e}'.`),this.api[e](...i)),this.api=t}sizeColumnsToFit(t){this.viaApi("sizeColumnsToFit",t)}setColumnGroupOpened(t,e){this.viaApi("setColumnGroupOpened",t,e)}getColumnGroup(t,e){return this.viaApi("getColumnGroup",t,e)}getProvidedColumnGroup(t){return this.viaApi("getProvidedColumnGroup",t)}getDisplayNameForColumn(t,e){return this.viaApi("getDisplayNameForColumn",t,e)}getDisplayNameForColumnGroup(t,e){return this.viaApi("getDisplayNameForColumnGroup",t,e)}getColumn(t){return this.viaApi("getColumn",t)}getColumns(){return this.viaApi("getColumns")}applyColumnState(t){return this.viaApi("applyColumnState",t)}getColumnState(){return this.viaApi("getColumnState")}resetColumnState(){this.viaApi("resetColumnState")}getColumnGroupState(){return this.viaApi("getColumnGroupState")}setColumnGroupState(t){this.viaApi("setColumnGroupState",t)}resetColumnGroupState(){this.viaApi("resetColumnGroupState")}isPinning(){return this.viaApi("isPinning")}isPinningLeft(){return this.viaApi("isPinningLeft")}isPinningRight(){return this.viaApi("isPinningRight")}getDisplayedColAfter(t){return this.viaApi("getDisplayedColAfter",t)}getDisplayedColBefore(t){return this.viaApi("getDisplayedColBefore",t)}setColumnVisible(t,e){this.viaApi("setColumnVisible",t,e)}setColumnsVisible(t,e){this.viaApi("setColumnsVisible",t,e)}setColumnPinned(t,e){this.viaApi("setColumnPinned",t,e)}setColumnsPinned(t,e){this.viaApi("setColumnsPinned",t,e)}getAllGridColumns(){return this.viaApi("getAllGridColumns")}getDisplayedLeftColumns(){return this.viaApi("getDisplayedLeftColumns")}getDisplayedCenterColumns(){return this.viaApi("getDisplayedCenterColumns")}getDisplayedRightColumns(){return this.viaApi("getDisplayedRightColumns")}getAllDisplayedColumns(){return this.viaApi("getAllDisplayedColumns")}getAllDisplayedVirtualColumns(){return this.viaApi("getAllDisplayedVirtualColumns")}moveColumn(t,e){this.viaApi("moveColumn",t,e)}moveColumnByIndex(t,e){this.viaApi("moveColumnByIndex",t,e)}moveColumns(t,e){this.viaApi("moveColumns",t,e)}moveRowGroupColumn(t,e){this.viaApi("moveRowGroupColumn",t,e)}setColumnAggFunc(t,e){this.viaApi("setColumnAggFunc",t,e)}setColumnWidth(t,e,i=!0,s){this.viaApi("setColumnWidth",t,e,i,s)}setColumnWidths(t,e=!0,i){this.viaApi("setColumnWidths",t,e,i)}setPivotMode(t){this.viaApi("setPivotMode",t)}isPivotMode(){return this.viaApi("isPivotMode")}getPivotResultColumn(t,e){return this.viaApi("getPivotResultColumn",t,e)}setValueColumns(t){this.viaApi("setValueColumns",t)}getValueColumns(){return this.viaApi("getValueColumns")}removeValueColumn(t){this.viaApi("removeValueColumn",t)}removeValueColumns(t){this.viaApi("removeValueColumns",t)}addValueColumn(t){this.viaApi("addValueColumn",t)}addValueColumns(t){this.viaApi("addValueColumns",t)}setRowGroupColumns(t){this.viaApi("setRowGroupColumns",t)}removeRowGroupColumn(t){this.viaApi("removeRowGroupColumn",t)}removeRowGroupColumns(t){this.viaApi("removeRowGroupColumns",t)}addRowGroupColumn(t){this.viaApi("addRowGroupColumn",t)}addRowGroupColumns(t){this.viaApi("addRowGroupColumns",t)}getRowGroupColumns(){return this.viaApi("getRowGroupColumns")}setPivotColumns(t){this.viaApi("setPivotColumns",t)}removePivotColumn(t){this.viaApi("removePivotColumn",t)}removePivotColumns(t){this.viaApi("removePivotColumns",t)}addPivotColumn(t){this.viaApi("addPivotColumn",t)}addPivotColumns(t){this.viaApi("addPivotColumns",t)}getPivotColumns(){return this.viaApi("getPivotColumns")}getLeftDisplayedColumnGroups(){return this.viaApi("getLeftDisplayedColumnGroups")}getCenterDisplayedColumnGroups(){return this.viaApi("getCenterDisplayedColumnGroups")}getRightDisplayedColumnGroups(){return this.viaApi("getRightDisplayedColumnGroups")}getAllDisplayedColumnGroups(){return this.viaApi("getAllDisplayedColumnGroups")}autoSizeColumn(t,e){return this.viaApi("autoSizeColumn",t,e)}autoSizeColumns(t,e){this.viaApi("autoSizeColumns",t,e)}autoSizeAllColumns(t){this.viaApi("autoSizeAllColumns",t)}setPivotResultColumns(t){this.viaApi("setPivotResultColumns",t)}getPivotResultColumns(){return this.viaApi("getPivotResultColumns")}};g([T("gridApi")],Dl.prototype,"api",2);Dl=g([Y("columnApi")],Dl);var fr=class extends z{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gos.isRowModelType("serverSide"),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const t=i=>this.callColumnCellValueChangedHandler(i),e=this.gos.useAsyncEvents();this.eventService.addEventListener(S.EVENT_CELL_VALUE_CHANGED,t,e),this.addDestroyFunc(()=>this.eventService.removeEventListener(S.EVENT_CELL_VALUE_CHANGED,t,e)),this.addManagedPropertyListener("treeData",i=>this.isTreeData=i.currentValue)}getValue(t,e,i=!1,s=!1){if(this.initialised||this.init(),!e)return;const r=t.getColDef(),n=r.field,o=t.getColId(),a=e.data;let l;const u=e.groupData&&e.groupData[o]!==void 0,d=!s&&e.aggData&&e.aggData[o]!==void 0,c=this.isSsrm&&s&&!!t.getColDef().aggFunc,C=this.isSsrm&&e.footer&&e.field&&(t.getColDef().showRowGroup===!0||t.getColDef().showRowGroup===e.field);if(i&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,t,e):this.isTreeData&&d?l=e.aggData[o]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,t,e):this.isTreeData&&n&&a?l=lo(a,n,t.isFieldContainsDots()):u?l=e.groupData[o]:d?l=e.aggData[o]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,t,e):C?l=lo(a,e.field,t.isFieldContainsDots()):n&&a&&!c&&(l=lo(a,n,t.isFieldContainsDots())),this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const E=l.substring(1);l=this.executeValueGetter(E,a,t,e)}if(l==null){const E=this.getOpenedGroup(e,t);if(E!=null)return E}return l}parseValue(t,e,i,s){const r=t.getColDef(),n=this.gos.addGridCommonParams({node:e,data:e==null?void 0:e.data,oldValue:s,newValue:i,colDef:r,column:t}),o=r.valueParser;return U(o)?typeof o=="function"?o(n):this.expressionService.evaluate(o,n):i}formatValue(t,e,i,s,r=!0){let n=null,o;const a=t.getColDef();if(s?o=s:r&&(o=a.valueFormatter),o){const l=this.gos.addGridCommonParams({value:i,node:e,data:e?e.data:null,colDef:a,column:t});typeof o=="function"?n=o(l):n=this.expressionService.evaluate(o,l)}else if(a.refData)return a.refData[i]||"";return n==null&&Array.isArray(i)&&(n=i.join(", ")),n}getOpenedGroup(t,e){if(!this.gos.get("showOpenedGroup")||!e.getColDef().showRowGroup)return;const s=e.getColDef().showRowGroup;let r=t.parent;for(;r!=null;){if(r.rowGroupColumn&&(s===!0||s===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}setValue(t,e,i,s){const r=this.columnModel.getPrimaryColumn(e);if(!t||!r)return!1;re(t.data)&&(t.data={});const{field:n,valueSetter:o}=r.getColDef();if(re(n)&&re(o))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(r,i))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:t,data:t.data,oldValue:this.getValue(r,t),newValue:i,colDef:r.getColDef(),column:r});a.newValue=i;let l;if(U(o)?typeof o=="function"?l=o(a):l=this.expressionService.evaluate(o,a):l=this.setValueUsingField(t.data,n,i,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;t.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(r,t);const u={type:S.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:a.column,api:a.api,columnApi:a.columnApi,colDef:a.colDef,context:a.context,data:t.data,node:t,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:s};return this.eventService.dispatchEvent(u),!0}callColumnCellValueChangedHandler(t){const e=t.colDef.onCellValueChanged;typeof e=="function"&&this.getFrameworkOverrides().wrapOutgoing(()=>{e({node:t.node,data:t.data,oldValue:t.oldValue,newValue:t.newValue,colDef:t.colDef,column:t.column,api:t.api,columnApi:t.columnApi,context:t.context})})}setValueUsingField(t,e,i,s){if(!e)return!1;let r=!1;if(!s)r=t[e]===i,r||(t[e]=i);else{const n=e.split(".");let o=t;for(;n.length>0&&o;){const a=n.shift();n.length===0?(r=o[a]===i,r||(o[a]=i)):o=o[a]}}return!r}executeFilterValueGetter(t,e,i,s){const r=this.gos.addGridCommonParams({data:e,node:s,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,s)});return typeof t=="function"?t(r):this.expressionService.evaluate(t,r)}executeValueGetter(t,e,i,s){const r=i.getColId(),n=this.valueCache.getValue(s,r);if(n!==void 0)return n;const o=this.gos.addGridCommonParams({data:e,node:s,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,s)});let a;return typeof t=="function"?a=t(o):a=this.expressionService.evaluate(t,o),this.valueCache.setValue(s,r,a),a}getValueCallback(t,e){const i=this.columnModel.getPrimaryColumn(e);return i?this.getValue(i,t):null}getKeyForNode(t,e){const i=this.getValue(t,e),s=t.getColDef().keyCreator;let r=i;if(s){const n=this.gos.addGridCommonParams({value:i,colDef:t.getColDef(),column:t,node:e,data:e.data});r=s(n)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&ie("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),r}};g([T("expressionService")],fr.prototype,"expressionService",2);g([T("columnModel")],fr.prototype,"columnModel",2);g([T("valueCache")],fr.prototype,"valueCache",2);g([T("dataTypeService")],fr.prototype,"dataTypeService",2);g([$],fr.prototype,"init",1);fr=g([Y("valueService")],fr);var Hd=class extends z{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(t){this.logger=t.create("ExpressionService")}evaluate(t,e){if(typeof t=="string")return this.evaluateExpression(t,e);console.error("AG Grid: value should be either a string or a function",t)}evaluateExpression(t,e){try{return this.createExpressionFunction(t)(e.value,e.context,e.oldValue,e.newValue,e.value,e.node,e.data,e.colDef,e.rowIndex,e.api,e.columnApi,e.getValue,e.column,e.columnGroup)}catch(i){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",e),console.log("Exception = "+i),null}}createExpressionFunction(t){if(this.expressionToFunctionCache[t])return this.expressionToFunctionCache[t];const e=this.createFunctionBody(t),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",e);return this.expressionToFunctionCache[t]=i,i}createFunctionBody(t){return t.indexOf("return")>=0?t:"return "+t+";"}};g([zi(0,_i("loggerFactory"))],Hd.prototype,"setBeans",1);Hd=g([Y("expressionService")],Hd);var Ud=class extends z{setBeans(t){this.logging=t.get("debug")}create(t){return new _m(t,this.isLogging.bind(this))}isLogging(){return this.logging}};g([zi(0,_i("gridOptionsService"))],Ud.prototype,"setBeans",1);Ud=g([Y("loggerFactory")],Ud);var _m=class{constructor(t,e){this.name=t,this.isLoggingFunc=e}isLogging(){return this.isLoggingFunc()}log(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)}},Rn=class extends z{setComp(t,e,i){this.view=t,this.eGridHostDiv=e,this.eGui=i,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:r=>r===1||r===0,getIconName:()=>ae.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(e),this.createManagedBean(new zh(this.view)),this.addRtlSupport();const s=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),this.ctrlsService.register("gridCtrl",this)}isDetailGrid(){var t;const e=this.focusService.findTabbableParent(this.getGui());return((t=e==null?void 0:e.getAttribute("row-id"))==null?void 0:t.startsWith("detail"))||!1}showDropZones(){return _e.__isRegistered("@ag-grid-enterprise/row-grouping",this.context.getGridId())}showSideBar(){return _e.__isRegistered("@ag-grid-enterprise/side-bar",this.context.getGridId())}showStatusBar(){return _e.__isRegistered("@ag-grid-enterprise/status-bar",this.context.getGridId())}showWatermark(){return _e.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId())}onGridSizeChanged(){const t={type:S.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(t)}addRtlSupport(){const t=this.gos.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(t)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(t){this.view.setCursor(t?"ew-resize":null)}disableUserSelect(t){this.view.setUserSelect(t?"none":null)}focusNextInnerContainer(t){const e=this.view.getFocusableContainers(),i=this.gos.getActiveDomElement(),r=e.findIndex(n=>n.contains(i))+(t?-1:1);return r<=0||r>=e.length?!1:this.focusService.focusInto(e[r])}focusInnerElement(t){const e=this.view.getFocusableContainers(),i=this.columnModel.getAllDisplayedColumns();if(t){if(e.length>1)return this.focusService.focusInto(Se(e),!0);const s=Se(i);if(this.focusService.focusGridView(s,!0))return!0}if(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")){if(this.focusService.focusGridView(i[0]))return!0;for(let s=1;s<e.length;s++)if(this.focusService.focusInto(e[s]))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(t=!1){this.view.forceFocusOutOfContainer(t)}};g([T("focusService")],Rn.prototype,"focusService",2);g([T("resizeObserverService")],Rn.prototype,"resizeObserverService",2);g([T("columnModel")],Rn.prototype,"columnModel",2);g([T("ctrlsService")],Rn.prototype,"ctrlsService",2);g([T("mouseEventService")],Rn.prototype,"mouseEventService",2);g([T("dragAndDropService")],Rn.prototype,"dragAndDropService",2);var oa=class extends ou{constructor(t){super(),this.eGridDiv=t}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const t={destroyGridUi:()=>this.destroyBean(this),setRtlClass:i=>this.addCssClass(i),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:i=>{this.getGui().style.userSelect=i??"",this.getGui().style.webkitUserSelect=i??""},setCursor:i=>{this.getGui().style.cursor=i??""}};this.ctrl=this.createManagedBean(new Rn);const e=this.createTemplate();this.setTemplate(e),this.ctrl.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:i=>this.ctrl.focusInnerElement(i),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(t),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(t,e){const i=this.eRootWrapperBody.classList;i.toggle("ag-layout-auto-height",e.autoHeight),i.toggle("ag-layout-normal",e.normal),i.toggle("ag-layout-print",e.print),this.addOrRemoveCssClass("ag-layout-auto-height",e.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",e.normal),this.addOrRemoveCssClass("ag-layout-print",e.print)}createTemplate(){const t=this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",e=this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"",i=this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"",s=this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"";return`<div class="ag-root-wrapper" role="presentation">
                ${t}
                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">
                    <ag-grid-body ref="gridBody"></ag-grid-body>
                    ${e}
                </div>
                ${i}
                <ag-pagination></ag-pagination>
                ${s}
            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter(e=>ti(e))}};g([T("loggerFactory")],oa.prototype,"loggerFactory",2);g([q("gridBody")],oa.prototype,"gridBodyComp",2);g([q("sideBar")],oa.prototype,"sideBarComp",2);g([q("rootWrapperBody")],oa.prototype,"eRootWrapperBody",2);g([$],oa.prototype,"postConstruct",1);var un=class extends z{progressSort(t,e,i){const s=this.getNextSortDirection(t);this.setSortForColumn(t,s,e,i)}setSortForColumn(t,e,i,s){e!=="asc"&&e!=="desc"&&(e=null);const r=this.gos.isColumnsSortingCoupledToGroup();let n=[t];if(r&&t.getColDef().showRowGroup){const l=this.columnModel.getSourceColumnsForGroupColumn(t),u=l==null?void 0:l.filter(d=>d.isSortable());u&&(n=[t,...u])}n.forEach(l=>l.setSort(e,s));const o=(i||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"),a=[];if(!o){const l=this.clearSortBarTheseColumns(n,s);a.push(...l)}this.updateSortIndex(t),a.push(...n),this.dispatchSortChangedEvents(s,a)}updateSortIndex(t){const e=this.gos.isColumnsSortingCoupledToGroup(),i=this.columnModel.getGroupDisplayColumnForGroup(t.getId()),s=e&&i||t,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(a=>a.setSortIndex(null));const n=r.filter(a=>e&&a.getColDef().showRowGroup?!1:a!==s);(s.getSort()?[...n,s]:n).forEach((a,l)=>{a.setSortIndex(l)})}onSortChanged(t,e){this.dispatchSortChangedEvents(t,e)}isSortActive(){const e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(i=>!!i.getSort());return e&&e.length>0}dispatchSortChangedEvents(t,e){const i={type:S.EVENT_SORT_CHANGED,source:t};e&&(i.columns=e),this.eventService.dispatchEvent(i)}clearSortBarTheseColumns(t,e){const i=[];return this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(s=>{t.includes(s)||(s.getSort()&&i.push(s),s.setSort(void 0,e))}),i}getNextSortDirection(t){let e;if(t.getColDef().sortingOrder?e=t.getColDef().sortingOrder:this.gos.get("sortingOrder")?e=this.gos.get("sortingOrder"):e=un.DEFAULT_SORTING_ORDER,!Array.isArray(e)||e.length<=0)return console.warn(`AG Grid: sortingOrder must be an array with at least one element, currently it's ${e}`),null;const i=e.indexOf(t.getSort()),s=i<0,r=i==e.length-1;let n;return s||r?n=e[0]:n=e[i+1],un.DEFAULT_SORTING_ORDER.indexOf(n)<0?(console.warn("AG Grid: invalid sort type "+n),null):n}getIndexedSortMap(){let t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(n=>!!n.getSort());if(this.columnModel.isPivotMode()){const n=this.gos.isColumnsSortingCoupledToGroup();t=t.filter(o=>{const a=!!o.getAggFunc(),l=!o.isPrimary(),u=n?this.columnModel.getGroupDisplayColumnForGroup(o.getId()):o.getColDef().showRowGroup;return a||l||u})}const e=this.columnModel.getRowGroupColumns().filter(n=>!!n.getSort()),i={};t.forEach((n,o)=>i[n.getId()]=o),t.sort((n,o)=>{const a=n.getSortIndex(),l=o.getSortIndex();if(a!=null&&l!=null)return a-l;if(a==null&&l==null){const u=i[n.getId()],d=i[o.getId()];return u>d?1:-1}else return l==null?-1:1});const s=this.gos.isColumnsSortingCoupledToGroup()&&!!e.length;s&&(t=[...new Set(t.map(n=>{var o;return(o=this.columnModel.getGroupDisplayColumnForGroup(n.getId()))!=null?o:n}))]);const r=new Map;return t.forEach((n,o)=>r.set(n,o)),s&&e.forEach(n=>{const o=this.columnModel.getGroupDisplayColumnForGroup(n.getId());r.set(n,r.get(o))}),r}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([t,e],[i,s])=>e-s).map(([t])=>t)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(t=>t.getSort()).map(t=>({sort:t.getSort(),colId:t.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(t=>t.getSort()).map(t=>({sort:t.getSort(),column:t}))}canColumnDisplayMixedSort(t){const e=this.gos.isColumnsSortingCoupledToGroup(),i=!!t.getColDef().showRowGroup;return e&&i}getDisplaySortForColumn(t){const e=this.columnModel.getSourceColumnsForGroupColumn(t);if(!this.canColumnDisplayMixedSort(t)||!(e!=null&&e.length))return t.getSort();const s=t.getColDef().field!=null||!!t.getColDef().valueGetter?[t,...e]:e,r=s[0].getSort();return s.every(o=>o.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(t){return this.getIndexedSortMap().get(t)}};un.DEFAULT_SORTING_ORDER=["asc","desc",null];g([T("columnModel")],un.prototype,"columnModel",2);un=g([Y("sortController")],un);var xe=class extends z{static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",xe.toggleKeyboardMode),t.addEventListener("mousedown",xe.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",xe.toggleKeyboardMode),t.addEventListener("mousedown",xe.toggleKeyboardMode))}static toggleKeyboardMode(t){const e=xe.keyboardModeActive,i=t.type==="keydown";i&&(t.ctrlKey||t.metaKey||t.altKey)||e!==i&&(xe.keyboardModeActive=i)}static unregisterGridCompController(t){xe.removeKeyboardModeEvents(t)}init(){const t=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_GROUP_OPENED,t),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl})}registerKeyboardFocusEvents(){const t=this.gos.getDocument();xe.addKeyboardModeEvents(t),xe.instanceCount++,this.addDestroyFunc(()=>{xe.instanceCount--,xe.unregisterGridCompController(t)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const t=this.focusedCellPosition.column,e=this.columnModel.getGridColumn(t.getId());t!==e&&this.clearFocusedCell()}isKeyboardMode(){return xe.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),Qr.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),Yh.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(t,e){let i=t;for(;i;){if(this.gos.getDomData(i,e))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(t){return this.isCellRestoreFocused(t)?(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0):!1}isCellRestoreFocused(t){return this.restoredFocusedCellPosition==null?!1:this.cellPositionUtils.equals(t,this.restoredFocusedCellPosition)}setRestoreFocusedCell(t){this.getFrameworkOverrides().renderingEngine==="react"&&(this.restoredFocusedCellPosition=t)}getFocusEventParams(){const{rowIndex:t,rowPinned:e,column:i}=this.focusedCellPosition,s={rowIndex:t,rowPinned:e,column:i,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:e});return r&&(s.isFullWidthCell=r.isFullWidth()),s}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,this.focusedCellPosition==null)return;const t=te({type:S.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(t)}setFocusedCell(t){const{column:e,rowIndex:i,rowPinned:s,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:n=!1}=t,o=this.columnModel.getGridColumn(e);if(!o){this.focusedCellPosition=null;return}this.focusedCellPosition=o?{rowIndex:i,rowPinned:ys(s),column:o}:null;const a=He(te({type:S.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:r,preventScrollOnBrowserFocus:n,floating:null});this.eventService.dispatchEvent(a)}isCellFocused(t){return this.focusedCellPosition==null?!1:this.cellPositionUtils.equals(t,this.focusedCellPosition)}isRowNodeFocused(t){return this.isRowFocused(t.rowIndex,t.rowPinned)}isHeaderWrapperFocused(t){if(this.focusedHeaderPosition==null)return!1;const e=t.getColumnGroupChild(),i=t.getRowIndex(),s=t.getPinned(),{column:r,headerRowIndex:n}=this.focusedHeaderPosition;return e===r&&i===n&&s==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(t,e){this.focusedHeaderPosition={headerRowIndex:t,column:e}}focusHeaderPosition(t){if(this.gos.get("suppressHeaderFocus"))return!1;const{direction:e,fromTab:i,allowUserOverride:s,event:r,fromCell:n,rowWithoutSpanValue:o}=t;let{headerPosition:a}=t;if(n&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(a);if(s){const l=this.getFocusedHeader(),u=this.headerNavigationService.getHeaderRowCount();if(i){const d=this.gos.getCallback("tabToNextHeader");d&&(a=this.getHeaderPositionFromUserFunc({userFunc:d,direction:e,currentPosition:l,headerPosition:a,headerRowCount:u}))}else{const d=this.gos.getCallback("navigateToNextHeader");if(d&&r){const c={key:r.key,previousHeaderPosition:l,nextHeaderPosition:a,headerRowCount:u,event:r};a=d(c)}}}return a?this.focusProvidedHeaderPosition({headerPosition:a,direction:e,event:r,fromCell:n,rowWithoutSpanValue:o}):!1}focusHeaderPositionFromUserFunc(t){if(this.gos.get("suppressHeaderFocus"))return!1;const{userFunc:e,headerPosition:i,direction:s,event:r}=t,n=this.getFocusedHeader(),o=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:e,direction:s,currentPosition:n,headerPosition:i,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:s,event:r})}getHeaderPositionFromUserFunc(t){const{userFunc:e,direction:i,currentPosition:s,headerPosition:r,headerRowCount:n}=t,a=e({backwards:i==="Before",previousHeaderPosition:s,nextHeaderPosition:r,headerRowCount:n});return a===!0||a===null?(a===null&&ie("Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),s):a===!1?null:a}focusProvidedHeaderPosition(t){const{headerPosition:e,direction:i,fromCell:s,rowWithoutSpanValue:r,event:n}=t;if(e.headerRowIndex===-1)return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(e):this.focusGridView(e.column);this.headerNavigationService.scrollToColumn(e.column,i);const a=this.ctrlsService.getHeaderRowContainerCtrl(e.column.getPinned()).focusHeader(e.headerRowIndex,e.column,n);return a&&(r!=null||s)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(r??-1),a}focusFirstHeader(){let t=this.columnModel.getAllDisplayedColumns()[0];if(!t)return!1;t.getParent()&&(t=this.columnModel.getColumnGroupAtLevel(t,0));const e=this.headerPositionUtils.getHeaderIndexToFocus(t,0);return this.focusHeaderPosition({headerPosition:e,rowWithoutSpanValue:0})}focusLastHeader(t){const e=this.headerNavigationService.getHeaderRowCount()-1,i=Se(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:e,column:i},rowWithoutSpanValue:-1,event:t})}focusPreviousFromFirstCell(t){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(t,e){return this.focusedCellPosition==null?!1:this.focusedCellPosition.rowIndex===t&&this.focusedCellPosition.rowPinned===ys(e)}findFocusableElements(t,e,i=!1){const s=Y0;let r=$f;e&&(r+=", "+e),i&&(r+=', [tabindex="-1"]');const n=Array.prototype.slice.apply(t.querySelectorAll(s)).filter(l=>ti(l)),o=Array.prototype.slice.apply(t.querySelectorAll(r));return o.length?((l,u)=>l.filter(d=>u.indexOf(d)===-1))(n,o):n}focusInto(t,e=!1,i=!1){const s=this.findFocusableElements(t,null,i),r=e?Se(s):s[0];return r?(r.focus({preventScroll:!0}),!0):!1}findFocusableElementBeforeTabGuard(t,e){if(!e)return null;const i=this.findFocusableElements(t),s=i.indexOf(e);if(s===-1)return null;let r=-1;for(let n=s-1;n>=0;n--)if(i[n].classList.contains("ag-tab-guard-top")){r=n;break}return r<=0?null:i[r-1]}findNextFocusableElement(t=this.eGridDiv,e,i){const s=this.findFocusableElements(t,e?':not([tabindex="-1"])':null),r=this.gos.getActiveDomElement();let n;e?n=s.findIndex(a=>a.contains(r)):n=s.indexOf(r);const o=n+(i?-1:1);return o<0||o>=s.length?null:s[o]}isTargetUnderManagedComponent(t,e){if(!e)return!1;const i=t.querySelectorAll(`.${Er.FOCUS_MANAGED_CLASS}`);if(!i.length)return!1;for(let s=0;s<i.length;s++)if(i[s].contains(e))return!0;return!1}findTabbableParent(t,e=5){let i=0;for(;t&&Nd(t)===null&&++i<=e;)t=t.parentElement;return Nd(t)===null?null:t}focusGridView(t,e){var i;if(this.gos.get("suppressCellFocus"))return e?this.gos.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const s=e?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!s)return!1;const{rowIndex:r,rowPinned:n}=s,o=this.getFocusedHeader();return!t&&o&&(t=o.column),r==null||!t?!1:(this.navigationService.ensureCellVisible({rowIndex:r,column:t,rowPinned:n}),this.setFocusedCell({rowIndex:r,column:t,rowPinned:ys(n),forceBrowserFocus:!0}),(i=this.rangeService)==null||i.setRangeToCell({rowIndex:r,rowPinned:n,column:t}),!0)}focusNextGridCoreContainer(t,e=!1){return!e&&this.gridCtrl.focusNextInnerContainer(t)?!0:((e||!t&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(t),!1)}focusAdvancedFilter(t){var e,i;return this.advancedFilterFocusColumn=t==null?void 0:t.column,(i=(e=this.advancedFilterService)==null?void 0:e.getCtrl().focusHeaderComp())!=null?i:!1}focusNextFromAdvancedFilter(t,e){var i,s;const r=(s=e?void 0:this.advancedFilterFocusColumn)!=null?s:(i=this.columnModel.getAllDisplayedColumns())==null?void 0:i[0];return t?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(r)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}};xe.keyboardModeActive=!1;xe.instanceCount=0;g([T("eGridDiv")],xe.prototype,"eGridDiv",2);g([T("columnModel")],xe.prototype,"columnModel",2);g([T("headerNavigationService")],xe.prototype,"headerNavigationService",2);g([T("headerPositionUtils")],xe.prototype,"headerPositionUtils",2);g([T("rowRenderer")],xe.prototype,"rowRenderer",2);g([T("rowPositionUtils")],xe.prototype,"rowPositionUtils",2);g([T("cellPositionUtils")],xe.prototype,"cellPositionUtils",2);g([T("navigationService")],xe.prototype,"navigationService",2);g([T("ctrlsService")],xe.prototype,"ctrlsService",2);g([T("filterManager")],xe.prototype,"filterManager",2);g([De("rangeService")],xe.prototype,"rangeService",2);g([De("advancedFilterService")],xe.prototype,"advancedFilterService",2);g([$],xe.prototype,"init",1);xe=g([Y("focusService")],xe);var fg=class extends z{setMouseOver(t){this.selectedColumns=t;const e={type:S.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}clearMouseOver(){this.selectedColumns=null;const t={type:S.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}isHovered(t){return!!this.selectedColumns&&this.selectedColumns.indexOf(t)>=0}};fg=g([Y("columnHoverService")],fg);var Rl=class extends z{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(t=>this.gridBodyCtrl=t.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(t){this.suppressAnimation=t}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(t){this.active?this.executeNextFuncs.push(t):t()}executeLaterVMTurn(t){this.active?this.executeLaterFuncs.push(t):t()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const t=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===t&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(t){if(this.executeNextFuncs.length===0&&this.executeLaterFuncs.length===0){t();return}const e=i=>{for(;i.length;){const s=i.pop();s&&s()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>e(this.executeNextFuncs),0),window.setTimeout(()=>{t(),e(this.executeLaterFuncs)},200)})}};g([T("ctrlsService")],Rl.prototype,"ctrlsService",2);g([$],Rl.prototype,"postConstruct",1);Rl=g([Y("columnAnimationService")],Rl);var Lo=class extends z{postConstruct(){this.ctrlsService.whenReady(t=>{this.centerRowsCtrl=t.center,this.addManagedListener(this.eventService,S.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,S.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.paginationProxy.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const t=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(t>0){const e=()=>{const i=this.gos.getRowHeightAsNumber(),s=Math.floor(t/i);this.paginationProxy.setPageSize(s,"autoCalculated")};this.isBodyRendered?Ot(()=>e(),50)():(e(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};g([T("ctrlsService")],Lo.prototype,"ctrlsService",2);g([T("paginationProxy")],Lo.prototype,"paginationProxy",2);g([$],Lo.prototype,"postConstruct",1);Lo=g([Y("paginationAutoPageSizeService")],Lo);var Wd=class extends z{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(t,e,i){this.active&&(t.__cacheVersion!==this.cacheVersion&&(t.__cacheVersion=this.cacheVersion,t.__cacheData={}),t.__cacheData[e]=i)}getValue(t,e){if(!(!this.active||t.__cacheVersion!==this.cacheVersion))return t.__cacheData[e]}};g([$],Wd.prototype,"init",1);Wd=g([Y("valueCache")],Wd);var hN="paste",Fo=class extends z{init(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,S.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(t){t.source!==hN&&this.doChangeDetection(t.node,t.column)}doChangeDetection(t,e){if(this.gos.get("suppressChangeDetection"))return;const i=[t];if(this.clientSideRowModel&&!t.isRowPinned()){const s=this.gos.get("aggregateOnlyChangedColumns"),r=new Jh(s,this.clientSideRowModel.getRootNode());r.addParentNode(t.parent,[e]),this.clientSideRowModel.doAggregate(r),r.forEachChangedNodeDepthFirst(n=>{i.push(n)})}this.rowRenderer.refreshCells({rowNodes:i})}};g([T("rowModel")],Fo.prototype,"rowModel",2);g([T("rowRenderer")],Fo.prototype,"rowRenderer",2);g([$],Fo.prototype,"init",1);Fo=g([Y("changeDetectionService")],Fo);var zd=class extends z{adaptFunction(t,e){const i=this.componentMetadataProvider.retrieve(t);return i&&i.functionAdapter?i.functionAdapter(e):null}adaptCellRendererFunction(t){class e{refresh(s){return!1}getGui(){return this.eGui}init(s){const r=t(s),n=typeof r;if(n==="string"||n==="number"||n==="boolean"){this.eGui=Qt("<span>"+r+"</span>");return}if(r==null){this.eGui=Qt("<span></span>");return}this.eGui=r}}return e}doesImplementIComponent(t){return t?t.prototype&&"getGui"in t.prototype:!1}};g([T("componentMetadataProvider")],zd.prototype,"componentMetadataProvider",2);zd=g([Y("agComponentUtils")],zd);var Al=class extends z{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(t){return this.componentMetaData[t]}};g([T("agComponentUtils")],Al.prototype,"agComponentUtils",2);g([$],Al.prototype,"postConstruct",1);Al=g([Y("componentMetadataProvider")],Al);var cN=25,gy=10,lp=8,pN=4,up=4,dp=6,gN=16,fy=14,hp=8,fN={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:pN*5,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:lp*7,headerCellMinWidth:48,listItemHeight:lp*4,rowHeight:lp*6,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:up*8,headerCellMinWidth:24,listItemHeight:up*6,rowHeight:up*7,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:dp*8,headerCellMinWidth:36,listItemHeight:dp*4,rowHeight:dp*7,chartMenuPanelWidth:240},"ag-theme-quartz":{headerHeight:fy+hp*4.25,headerCellMinWidth:36,listItemHeight:gN+hp,rowHeight:fy+hp*3.5,chartMenuPanelWidth:260}},my={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},xl=class extends z{constructor(){super(...arguments),this.calculatedSizes={},this.calculatedTheme=null}postConstruct(){var t;const e=(t=this.getTheme().el)!=null?t:this.eGridDiv;this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.calculatedTheme=null,this.calculatedTheme=this.getTheme(),this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(e||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const t={type:S.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(t)}getSassVariable(t){const{themeFamily:e,el:i}=this.getTheme();if(!e||e.indexOf("ag-theme")!==0)return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[e]||(this.calculatedSizes[e]={});const s=this.calculatedSizes[e][t];return s??(this.calculatedSizes[e][t]=this.calculateValueForSassProperty(t,e,i),this.calculatedSizes[e][t])}calculateValueForSassProperty(t,e,i){const s="ag-theme-"+(e.match("material")?"material":e.match("balham")?"balham":e.match("alpine")?"alpine":"custom"),r=fN[s][t],n=this.gos.getDocument();if(i||(i=this.eGridDiv),!my[t])return r;const o=my[t],a=n.createElement("div"),l=Array.from(i.classList);a.classList.add(e,...l),a.style.position="absolute";const u=o.reduce((c,C)=>{const E=n.createElement("div");return E.style.position="static",E.classList.add(C),c.appendChild(E),E},a);let d=0;if(n.body){n.body.appendChild(a);const c=t.toLowerCase().indexOf("height")!==-1?"height":"width";d=parseInt(window.getComputedStyle(u)[c],10),n.body.removeChild(a)}return d||r}isThemeDark(){const{theme:t}=this.getTheme();return!!t&&t.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){if(this.calculatedTheme)return this.calculatedTheme;const t=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let e=this.eGridDiv,i=null,s=[];for(;e;)if(i=t.exec(e.className),!i)e=e.parentElement||void 0;else{const n=e.className.match(t);n&&(s=n);break}if(!i)return{allThemes:s};const r=i[0];return this.calculatedTheme={theme:r,el:e,themeFamily:r.replace(/-dark$/,""),allThemes:s},this.calculatedTheme}getFromTheme(t,e){var i;return(i=this.getSassVariable(e))!=null?i:t}getDefaultRowHeight(){return this.getFromTheme(cN,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}refreshRowHeightVariable(){const t=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),e=this.gos.get("rowHeight");if(e==null||isNaN(e)||!isFinite(e))return t!==null&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const i=`${e}px`;return t!=i?(this.eGridDiv.style.setProperty("--ag-line-height",i),e):t!=""?parseFloat(t):-1}getMinColWidth(){const t=this.getFromTheme(null,"headerCellMinWidth");return U(t)?Math.max(t,gy):gy}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};g([T("eGridDiv")],xl.prototype,"eGridDiv",2);g([$],xl.prototype,"postConstruct",1);xl=g([Y("environment")],xl);var Mo=class extends z{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(t){this.logger=t.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=B0(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,i=this.getUiBodyHeight();(e!==this.scrollY||i!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=i,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const t=this.scrollY/this.maxScrollY,e=t*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${e} (${this.pixelsToShave} * ${t})`),this.setDivStretchOffset(e)}setUiContainerHeight(t){t!==this.uiContainerHeight&&(this.uiContainerHeight=t,this.eventService.dispatchEvent({type:S.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(t){const e=typeof t=="number"?Math.floor(t):null;this.divStretchOffset!==e&&(this.divStretchOffset=e,this.eventService.dispatchEvent({type:S.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(t){this.modelHeight=t,this.stretching=t!=null&&this.maxDivHeight>0&&t>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(t){return t-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(t){if(this.pixelsToShave<=0)return t;const e=this.modelHeight-this.getUiBodyHeight(),i=t/e;return this.maxScrollY*i}};g([T("ctrlsService")],Mo.prototype,"ctrlsService",2);g([zi(0,_i("loggerFactory"))],Mo.prototype,"agWire",1);g([$],Mo.prototype,"postConstruct",1);Mo=g([Y("rowContainerHeightService")],Mo);var Oo=class extends z{init(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(t=!1){const e=!!this.gos.get("rowSelection"),i=this.gos.get("isRowSelectable");if(!e||!i)return;const s=this.gos.get("groupSelectsChildren"),r=this.rowModel.getType()==="clientSide"&&s,n=[],o=a=>{if(t&&!a.group)return;if(r&&a.group){const u=a.childrenAfterGroup.some(d=>d.selectable===!0);a.setRowSelectable(u,!0);return}const l=i?i(a):!0;a.setRowSelectable(l,!0),!l&&a.isSelected()&&n.push(a)};if(r){const a=this.rowModel;new Jh(!1,a.getRootNode()).forEachChangedNodeDepthFirst(o,!0,!0)}else this.rowModel.forEachNode(o);n.length&&this.selectionService.setNodesSelected({nodes:n,newValue:!1,source:"selectableChanged"}),r&&this.selectionService instanceof ln&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}};g([T("rowModel")],Oo.prototype,"rowModel",2);g([T("selectionService")],Oo.prototype,"selectionService",2);g([$],Oo.prototype,"init",1);Oo=g([Y("selectableService")],Oo);var ni=class extends oe{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const t=this.gos.get("enableRtl");this.setTemplate(this.getTemplate());const{btFirst:e,btPrevious:i,btNext:s,btLast:r,pageSizeComp:n}=this;this.activateTabIndex([e,i,s,r]),e.insertAdjacentElement("afterbegin",je(t?"last":"first",this.gos)),i.insertAdjacentElement("afterbegin",je(t?"next":"previous",this.gos)),s.insertAdjacentElement("afterbegin",je(t?"previous":"next",this.gos)),r.insertAdjacentElement("afterbegin",je(t?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.onPaginationChanged()}onPaginationChanged(){const e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,S.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(t=>{const{el:e,fn:i}=t;this.addManagedListener(e,"click",i),this.addManagedListener(e,"keydown",s=>{(s.key===N.ENTER||s.key===N.SPACE)&&(s.preventDefault(),i())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const t=this.paginationProxy.getTotalPages()>0,e=this.paginationProxy.getCurrentPage(),i=t?e+1:0;this.lbCurrent.textContent=this.formatNumber(i)}formatNumber(t){const e=this.gos.getCallback("paginationNumberFormatter");if(e)return e({value:t});const i=this.localeService.getLocaleTextFunc(),s=i("thousandSeparator",","),r=i("decimalSeparator",".");return zf(t,s,r)}getTemplate(){const t=this.localeService.getLocaleTextFunc(),e=t("page","Page"),i=t("to","to"),s=t("of","of"),r=t("firstPage","First Page"),n=t("previousPage","Previous Page"),o=t("nextPage","Next Page"),a=t("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">
                <ag-page-size-selector ref="pageSizeComp"></ag-page-size-selector>
                <span class="ag-paging-row-summary-panel" role="status">
                    <span id="ag-${l}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-to">${i}</span>
                    <span id="ag-${l}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-of">${s}</span>
                    <span id="ag-${l}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>
                </span>
                <span class="ag-paging-page-summary-panel" role="presentation">
                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>
                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${n}"></div>
                    <span class="ag-paging-description" role="status">
                        <span id="ag-${l}-start-page">${e}</span>
                        <span id="ag-${l}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>
                        <span id="ag-${l}-of-page">${s}</span>
                        <span id="ag-${l}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>
                    </span>
                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>
                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>
                </span>
            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const t=this.paginationProxy.getCurrentPage(),e=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=t===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const s=this.isZeroPagesToDisplay(),r=t===i-1;this.nextButtonDisabled=r||s,this.lastButtonDisabled=!e||s||t===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(t,e){Mf(t,e),t.classList.toggle("ag-disabled",e)}updateRowLabels(){const t=this.paginationProxy.getCurrentPage(),e=this.paginationProxy.getPageSize(),i=this.paginationProxy.isLastPageFound(),s=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let r,n;if(this.isZeroPagesToDisplay()?r=n=0:(r=e*t+1,n=r+e-1,i&&n>s&&(n=s)),this.lbFirstRowOnPage.textContent=this.formatNumber(r),this.rowNodeBlockLoader.isLoading()){const o=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=o("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(n)}isZeroPagesToDisplay(){const t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages();return t&&e===0}setTotalLabels(){const t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages(),i=t?this.paginationProxy.getMasterRowCount():null;if(i===1){const s=this.paginationProxy.getRow(0);if(s&&s.group&&!(s.groupData||s.aggData)){this.setTotalLabelsToZero();return}}if(t)this.lbTotal.textContent=this.formatNumber(e),this.lbRecordCount.textContent=this.formatNumber(i);else{const s=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=s,this.lbRecordCount.innerHTML=s}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}};g([T("paginationProxy")],ni.prototype,"paginationProxy",2);g([T("rowNodeBlockLoader")],ni.prototype,"rowNodeBlockLoader",2);g([q("btFirst")],ni.prototype,"btFirst",2);g([q("btPrevious")],ni.prototype,"btPrevious",2);g([q("btNext")],ni.prototype,"btNext",2);g([q("btLast")],ni.prototype,"btLast",2);g([q("lbRecordCount")],ni.prototype,"lbRecordCount",2);g([q("lbFirstRowOnPage")],ni.prototype,"lbFirstRowOnPage",2);g([q("lbLastRowOnPage")],ni.prototype,"lbLastRowOnPage",2);g([q("lbCurrent")],ni.prototype,"lbCurrent",2);g([q("lbTotal")],ni.prototype,"lbTotal",2);g([q("pageSizeComp")],ni.prototype,"pageSizeComp",2);g([$],ni.prototype,"postConstruct",1);var du=class Tb extends oe{constructor(){super(Tb.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1}updateLayoutClasses(e,i){const s=this.eOverlayWrapper.classList;s.toggle("ag-layout-auto-height",i.autoHeight),s.toggle("ag-layout-normal",i.normal),s.toggle("ag-layout-print",i.print)}postConstruct(){this.createManagedBean(new zh(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(e){const i=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&i.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,i.toggle(e,!0)}showOverlay(e,i,s){this.inProgress||(this.setWrapperTypeClass(i),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then(r=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,this.updateListenerDestroyFunc=s,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){var e;if(this.inProgress){this.destroyRequested=!0;return}this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),(e=this.updateListenerDestroyFunc)==null||e.call(this),tt(this.eOverlayWrapper))}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}};du.TEMPLATE=`
        <div class="ag-overlay" role="presentation">
            <div class="ag-overlay-panel" role="presentation">
                <div class="ag-overlay-wrapper" ref="eOverlayWrapper" role="presentation"></div>
            </div>
        </div>`;g([T("overlayService")],du.prototype,"overlayService",2);g([q("eOverlayWrapper")],du.prototype,"eOverlayWrapper",2);g([$],du.prototype,"postConstruct",1);var mN=du,No=class extends z{getFirstRow(){let t=0,e;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),e===void 0?null:{rowIndex:t,rowPinned:e}}getLastRow(){let t,e=null;const i=this.pinnedRowModel.getPinnedBottomRowCount(),s=this.pinnedRowModel.getPinnedTopRowCount();return i?(e="bottom",t=i-1):this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageLastRow()):s&&(e="top",t=s-1),t===void 0?null:{rowIndex:t,rowPinned:e}}getRowNode(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}}sameRow(t,e){return!t&&!e?!0:t&&!e||!t&&e?!1:t.rowIndex===e.rowIndex&&t.rowPinned==e.rowPinned}before(t,e){switch(t.rowPinned){case"top":if(e.rowPinned!=="top")return!0;break;case"bottom":if(e.rowPinned!=="bottom")return!1;break;default:if(U(e.rowPinned))return e.rowPinned!=="top";break}return t.rowIndex<e.rowIndex}};g([T("rowModel")],No.prototype,"rowModel",2);g([T("pinnedRowModel")],No.prototype,"pinnedRowModel",2);g([T("paginationProxy")],No.prototype,"paginationProxy",2);No=g([Y("rowPositionUtils")],No);var mg=class extends z{createId(t){const{rowIndex:e,rowPinned:i,column:s}=t;return this.createIdFromValues({rowIndex:e,column:s,rowPinned:i})}createIdFromValues(t){const{rowIndex:e,rowPinned:i,column:s}=t;return`${e}.${i??"null"}.${s.getId()}`}equals(t,e){const i=t.column===e.column,s=t.rowPinned===e.rowPinned,r=t.rowIndex===e.rowIndex;return i&&s&&r}};mg=g([Y("cellPositionUtils")],mg);var Ha=class{constructor(t){this.cellValueChanges=t}},cp=class extends Ha{constructor(t,e,i,s){super(t),this.initialRange=e,this.finalRange=i,this.ranges=s}},bb=class _b{constructor(e){this.actionStack=[],this.maxStackSize=e||_b.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};bb.DEFAULT_STACK_SIZE=10;var Cy=bb,Rs=class extends z{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=t=>{const e={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned},i=this.activeCellEdit!==null&&this.cellPositionUtils.equals(this.activeCellEdit,e),s=this.activeRowEdit!==null&&this.rowPositionUtils.sameRow(this.activeRowEdit,e);if(!(i||s||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:u}=t,d={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:u,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gos.get("undoRedoCellEditing"))return;const t=this.gos.get("undoRedoCellEditingLimit");t<=0||(this.undoStack=new Cy(t),this.redoStack=new Cy(t),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,S.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,S.EVENT_MODEL_UPDATED,e=>{e.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,S.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(t){const e={type:S.EVENT_UNDO_STARTED,source:t};this.eventService.dispatchEvent(e);const i=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),s={type:S.EVENT_UNDO_ENDED,source:t,operationPerformed:i};this.eventService.dispatchEvent(s)}redo(t){const e={type:S.EVENT_REDO_STARTED,source:t};this.eventService.dispatchEvent(e);const i=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),s={type:S.EVENT_REDO_ENDED,source:t,operationPerformed:i};this.eventService.dispatchEvent(s)}undoRedo(t,e,i,s,r){if(!t)return!1;const n=t.pop();return!n||!n.cellValueChanges?!1:(this.processAction(n,o=>o[s],r),n instanceof cp?this.processRange(this.rangeService,n.ranges||[n[i]]):this.processCell(n.cellValueChanges),e.push(n),!0)}processAction(t,e,i){t.cellValueChanges.forEach(s=>{const{rowIndex:r,rowPinned:n,columnId:o}=s,a={rowIndex:r,rowPinned:n},l=this.rowPositionUtils.getRowNode(a);l.displayed&&l.setDataValue(o,e(s),i)})}processRange(t,e){let i;t.removeAllCellRanges(!0),e.forEach((s,r)=>{if(!s)return;const n=s.startRow,o=s.endRow;r===e.length-1&&(i={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:s.startColumn.getColId()},this.setLastFocusedCell(i));const a={rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:s.startColumn,columns:s.columns};t.addCellRange(a)})}processCell(t){const e=t[0],{rowIndex:i,rowPinned:s}=e,r={rowIndex:i,rowPinned:s},n=this.rowPositionUtils.getRowNode(r),o={rowPinned:e.rowPinned,rowIndex:n.rowIndex,columnId:e.columnId};this.setLastFocusedCell(o,this.rangeService)}setLastFocusedCell(t,e){const{rowIndex:i,columnId:s,rowPinned:r}=t,n=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getGridColumn(s);if(!o)return;n.ensureIndexVisible(i),n.ensureColumnVisible(o);const a={rowIndex:i,column:o,rowPinned:r};this.focusService.setFocusedCell(He(te({},a),{forceBrowserFocus:!0})),e==null||e.setRangeToCell(a)}addRowEditingListeners(){this.addManagedListener(this.eventService,S.EVENT_ROW_EDITING_STARTED,t=>{this.activeRowEdit={rowIndex:t.rowIndex,rowPinned:t.rowPinned}}),this.addManagedListener(this.eventService,S.EVENT_ROW_EDITING_STOPPED,()=>{const t=new Ha(this.cellValueChanges);this.pushActionsToUndoStack(t),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,S.EVENT_CELL_EDITING_STARTED,t=>{this.activeCellEdit={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned}}),this.addManagedListener(this.eventService,S.EVENT_CELL_EDITING_STOPPED,t=>{if(this.activeCellEdit=null,t.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const i=new Ha(this.cellValueChanges);this.pushActionsToUndoStack(i)}})}addPasteListeners(){this.addManagedListener(this.eventService,S.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,S.EVENT_PASTE_END,()=>{const t=new Ha(this.cellValueChanges);this.pushActionsToUndoStack(t),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,S.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,S.EVENT_FILL_END,t=>{const e=new cp(this.cellValueChanges,t.initialRange,t.finalRange);this.pushActionsToUndoStack(e),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,S.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,S.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let t;this.rangeService&&this.gos.get("enableRangeSelection")?t=new cp(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):t=new Ha(this.cellValueChanges),this.pushActionsToUndoStack(t),this.isRangeInAction=!1})}pushActionsToUndoStack(t){this.undoStack.push(t),this.cellValueChanges=[],this.redoStack.clear()}};g([T("focusService")],Rs.prototype,"focusService",2);g([T("ctrlsService")],Rs.prototype,"ctrlsService",2);g([T("cellPositionUtils")],Rs.prototype,"cellPositionUtils",2);g([T("rowPositionUtils")],Rs.prototype,"rowPositionUtils",2);g([T("columnModel")],Rs.prototype,"columnModel",2);g([De("rangeService")],Rs.prototype,"rangeService",2);g([$],Rs.prototype,"init",1);Rs=g([Y("undoRedoService")],Rs);var Pl=class extends z{findHeader(t,e){let i,s;if(t.column instanceof gt?i=this.columnModel.getDisplayedGroupAtDirection(t.column,e):(s=`getDisplayedCol${e}`,i=this.columnModel[s](t.column)),!i)return;let{headerRowIndex:r}=t;if(this.getHeaderRowType(r)!=="filter"){const a=[i];for(;i.getParent();)i=i.getParent(),a.push(i);i=a[a.length-1-r]}const{column:n,headerRowIndex:o}=this.getHeaderIndexToFocus(i,r);return{column:n,headerRowIndex:o}}getHeaderIndexToFocus(t,e){let i;if(t instanceof gt&&this.isAnyChildSpanningHeaderHeight(t)&&t.isPadding()){const s=t;i=s.getLeafColumns()[0];let r=i;for(;r!==s;)e++,r=r.getParent()}return{column:i||t,headerRowIndex:e}}isAnyChildSpanningHeaderHeight(t){return t?t.getLeafColumns().some(e=>e.isSpanHeaderHeight()):!1}getColumnVisibleParent(t,e){const i=this.getHeaderRowType(e),s=i==="filter",r=i==="column";let n=s?t:t.getParent(),o=e-1,a=o;if(r&&this.isAnyChildSpanningHeaderHeight(t.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;a=o,o<0&&(n=t,o=e,a=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:a}}getColumnVisibleChild(t,e,i="After"){const s=this.getHeaderRowType(e);let r=t,n=e+1,o=n;if(s==="group"){const a=t.getDisplayedLeafColumns(),l=i==="After"?a[0]:Se(a),u=[];let d=l;for(;d.getParent()!==t;)d=d.getParent(),u.push(d);if(r=l,l.isSpanHeaderHeight())for(let c=u.length-1;c>=0;c--){const C=u[c];if(!C.isPadding()){r=C;break}n++}else r=Se(u),r||(r=l)}return{column:r,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(t){const e=this.ctrlsService.getHeaderRowContainerCtrl();if(e)return e.getRowType(t)}findColAtEdgeForHeaderRow(t,e){const i=this.columnModel.getAllDisplayedColumns(),s=i[e==="start"?0:i.length-1];if(!s)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(s.getPinned()).getRowType(t);if(n=="group"){const o=this.columnModel.getColumnGroupAtLevel(s,t);return{headerRowIndex:t,column:o}}return{headerRowIndex:n==null?-1:t,column:s}}};g([T("columnModel")],Pl.prototype,"columnModel",2);g([T("ctrlsService")],Pl.prototype,"ctrlsService",2);Pl=g([Y("headerPositionUtils")],Pl);var Cg=class{buildColumnDefs(t,e,i){const s=[],r={};return t.forEach(n=>{const o=this.createDefFromColumn(n,e,i);let a=!0,l=o,u=n.getOriginalParent(),d=null;for(;u;){let c=null;if(u.isPadding()){u=u.getOriginalParent();continue}const C=r[u.getGroupId()];if(C){C.children.push(l),a=!1;break}if(c=this.createDefFromGroup(u),c&&(c.children=[l],r[c.groupId]=c,l=c,u=u.getOriginalParent()),u!=null&&d===u){a=!1;break}d=u}a&&s.push(l)}),s}createDefFromGroup(t){const e=Ld(t.getColGroupDef(),["children"]);return e&&(e.groupId=t.getGroupId()),e}createDefFromColumn(t,e,i){const s=Ld(t.getColDef());return s.colId=t.getColId(),s.width=t.getActualWidth(),s.rowGroup=t.isRowGroupActive(),s.rowGroupIndex=t.isRowGroupActive()?e.indexOf(t):null,s.pivot=t.isPivotActive(),s.pivotIndex=t.isPivotActive()?i.indexOf(t):null,s.aggFunc=t.isValueActive()?t.getAggFunc():null,s.hide=t.isVisible()?void 0:!0,s.pinned=t.isPinned()?t.getPinned():null,s.sort=t.getSort()?t.getSort():null,s.sortIndex=t.getSortIndex()!=null?t.getSortIndex():null,s}};Cg=g([Y("columnDefFactory")],Cg);var Il=class{getInitialRowClasses(t){const e=[];return U(t.extraCssClass)&&e.push(t.extraCssClass),e.push("ag-row"),e.push(t.rowFocused?"ag-row-focus":"ag-row-no-focus"),t.fadeRowIn&&e.push("ag-opacity-zero"),e.push(t.rowIsEven?"ag-row-even":"ag-row-odd"),t.rowNode.isRowPinned()&&e.push("ag-row-pinned"),t.rowNode.isSelected()&&e.push("ag-row-selected"),t.rowNode.footer&&e.push("ag-row-footer"),e.push("ag-row-level-"+t.rowLevel),t.rowNode.stub&&e.push("ag-row-loading"),t.fullWidthRow&&e.push("ag-full-width-row"),t.expandable&&(e.push("ag-row-group"),e.push(t.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),t.rowNode.dragging&&e.push("ag-row-dragging"),Zp(e,this.processClassesFromGridOptions(t.rowNode)),Zp(e,this.preProcessRowClassRules(t.rowNode)),e.push(t.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),t.firstRowOnPage&&e.push("ag-row-first"),t.lastRowOnPage&&e.push("ag-row-last"),t.fullWidthRow&&(t.pinned==="left"&&e.push("ag-cell-last-left-pinned"),t.pinned==="right"&&e.push("ag-cell-first-right-pinned")),e}processClassesFromGridOptions(t){const e=[],i=n=>{typeof n=="string"?e.push(n):Array.isArray(n)&&n.forEach(o=>e.push(o))},s=this.gos.get("rowClass");if(s){if(typeof s=="function")return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];i(s)}const r=this.gos.getCallback("getRowClass");if(r){const n={data:t.data,node:t,rowIndex:t.rowIndex},o=r(n);i(o)}return e}preProcessRowClassRules(t){const e=[];return this.processRowClassRules(t,i=>{e.push(i)},i=>{}),e}processRowClassRules(t,e,i){const s=this.gos.addGridCommonParams({data:t.data,node:t,rowIndex:t.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),s,e,i)}calculateRowLevel(t){return t.group?t.level:t.parent?t.parent.level+1:0}};g([T("stylingService")],Il.prototype,"stylingService",2);g([T("gridOptionsService")],Il.prototype,"gos",2);Il=g([Y("rowCssClassCalculator")],Il);var ko=class extends z{init(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup())}doFullSort(t,e){const i=(r,n)=>({currentPos:n,rowNode:r}),s=t.map(i);return s.sort(this.compareRowNodes.bind(this,e)),s.map(r=>r.rowNode)}compareRowNodes(t,e,i){const s=e.rowNode,r=i.rowNode;for(let n=0,o=t.length;n<o;n++){const a=t[n],l=a.sort==="desc",u=this.getValue(s,a.column),d=this.getValue(r,a.column);let c;const C=this.getComparator(a,s);if(C?c=C(u,d,s,r,l):c=ge.defaultComparator(u,d,this.isAccentedSort),!isNaN(c)&&c!==0)return a.sort==="asc"?c:c*-1}return e.currentPos-i.currentPos}getComparator(t,e){const i=t.column,s=i.getColDef().comparator;if(s!=null)return s;if(!i.getColDef().showRowGroup)return;const r=!e.group&&i.getColDef().field;if(!r)return;const n=this.columnModel.getPrimaryColumn(r);if(n)return n.getColDef().comparator}getValue(t,e){var i,s;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(e,t,!1,!1);if(t.rowGroupColumn===e){if(this.gos.isGroupUseEntireRow(this.columnModel.isPivotActive())){const a=(i=t.allLeafChildren)==null?void 0:i[0];return a?this.valueService.getValue(e,a,!1,!1):void 0}const o=this.columnModel.getGroupDisplayColumnForGroup(e.getId());return o?(s=t.groupData)==null?void 0:s[o.getId()]:void 0}if(!(t.group&&e.getColDef().showRowGroup))return this.valueService.getValue(e,t,!1,!1)}};g([T("valueService")],ko.prototype,"valueService",2);g([T("columnModel")],ko.prototype,"columnModel",2);g([$],ko.prototype,"init",1);ko=g([Y("rowNodeSorter")],ko);var el=class extends z{constructor(){super(...arguments),this.params={},this.ready=!1,this.readyCallbacks=[]}checkReady(){const t=this.params;this.ready=t.gridCtrl!=null&&t.gridBodyCtrl!=null&&t.center!=null&&t.left!=null&&t.right!=null&&t.bottomCenter!=null&&t.bottomLeft!=null&&t.bottomRight!=null&&t.topCenter!=null&&t.topLeft!=null&&t.topRight!=null&&t.stickyTopCenter!=null&&t.stickyTopLeft!=null&&t.stickyTopRight!=null&&t.stickyBottomCenter!=null&&t.stickyBottomLeft!=null&&t.stickyBottomRight!=null&&t.centerHeader!=null&&t.leftHeader!=null&&t.rightHeader!=null&&t.fakeHScrollComp!=null&&t.fakeVScrollComp!=null&&t.gridHeaderCtrl!=null,this.ready&&(this.readyCallbacks.forEach(e=>e(t)),this.readyCallbacks.length=0)}whenReady(t){this.ready?t(this.params):this.readyCallbacks.push(t)}register(t,e){this.params[t]=e,this.checkReady()}registerHeaderContainer(t,e){switch(e){case"left":this.params.leftHeader=t;break;case"right":this.params.rightHeader=t;break;default:this.params.centerHeader=t;break}this.checkReady()}get(t){return this.params[t]}getParams(){return this.params}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.params.leftHeader,this.params.rightHeader,this.params.centerHeader]}getHeaderRowContainerCtrl(t){switch(t){case"left":return this.params.leftHeader;case"right":return this.params.rightHeader;default:return this.params.centerHeader}}};el.NAME="ctrlsService";el=g([Y(el.NAME)],el);var vg=class extends z{constructor(){super(...arguments),this.registry={}}register(t){this.registry[t.controllerName]=t.controllerClass}getInstance(t){const e=this.registry[t];if(e!=null)return new e}};vg=g([Y("ctrlsFactory")],vg);var An=class extends oe{constructor(t,e){super(t),this.direction=e,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Hf()||Ks())}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=Wf(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const t=["mouseenter","mousedown","touchstart"],e=["mouseleave","touchend"],i=this.getGui();t.forEach(s=>this.addManagedListener(i,s,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),e.forEach(s=>this.addManagedListener(i,s,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL,t=>{t.direction===this.direction&&(this.hideTimeout!==null&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(t){const e=this.getViewport();Af(()=>ti(e),()=>this.setScrollPosition(t),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(t){this.addManagedListener(this.getViewport(),"scroll",t)}};g([q("eViewport")],An.prototype,"eViewport",2);g([q("eContainer")],An.prototype,"eContainer",2);g([T("scrollVisibleService")],An.prototype,"scrollVisibleService",2);g([T("ctrlsService")],An.prototype,"ctrlsService",2);g([T("animationFrameService")],An.prototype,"animationFrameService",2);var xn=class Db extends An{constructor(){super(Db.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,S.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new Xo(i=>this.eContainer.style.width=`${i}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let i=this.columnModel.getDisplayedColumnsRightWidth();const s=!this.enableRtl&&e,r=this.gos.getScrollbarWidth();s&&(i+=r),xi(this.eRightSpacer,i),this.eRightSpacer.classList.toggle("ag-scroller-corner",i<=r);let n=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(n+=r),xi(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=r)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),i=this.invisibleScrollbar,s=this.gos.get("suppressHorizontalScroll"),r=e&&this.gos.getScrollbarWidth()||0,o=s?0:r===0&&i?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",i),Yr(this.getGui(),o),Yr(this.eViewport,o),Yr(this.eContainer,o),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return vl(this.getViewport(),this.enableRtl)}setScrollPosition(e){ti(this.getViewport())||this.attemptSettingScrollPosition(e),yl(this.getViewport(),e,this.enableRtl)}};xn.TEMPLATE=`<div class="ag-body-horizontal-scroll" aria-hidden="true">
            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>
            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">
                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>
            </div>
            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>
        </div>`;g([q("eLeftSpacer")],xn.prototype,"eLeftSpacer",2);g([q("eRightSpacer")],xn.prototype,"eRightSpacer",2);g([T("columnModel")],xn.prototype,"columnModel",2);g([T("pinnedRowModel")],xn.prototype,"pinnedRowModel",2);g([$],xn.prototype,"postConstruct",1);var CN=xn,Ll=class extends z{postConstruct(){const t=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedPropertyListener("domLayout",t)}checkContainerWidths(){const t=this.gos.isDomLayout("print"),e=t?0:this.columnModel.getDisplayedColumnsLeftWidth(),i=t?0:this.columnModel.getDisplayedColumnsRightWidth();e!=this.leftWidth&&(this.leftWidth=e,this.eventService.dispatchEvent({type:S.EVENT_LEFT_PINNED_WIDTH_CHANGED})),i!=this.rightWidth&&(this.rightWidth=i,this.eventService.dispatchEvent({type:S.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};g([T("columnModel")],Ll.prototype,"columnModel",2);g([$],Ll.prototype,"postConstruct",1);Ll=g([Y("pinnedWidthService")],Ll);var Go=class extends z{constructor(){super(...arguments),this.events=[]}postConstruct(){this.rowModel.getType()=="clientSide"&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(t,e){if(this.clientSideRowModel==null){this.eventService.dispatchEvent(t);return}this.events.push(t);const i=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(s=>this.eventService.dispatchEvent(s)),this.events=[]};e?i():(this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(i)),this.dispatchExpandedDebounced())}};g([T("animationFrameService")],Go.prototype,"animationFrameService",2);g([T("rowModel")],Go.prototype,"rowModel",2);g([$],Go.prototype,"postConstruct",1);Go=g([Y("rowNodeEventThrottle")],Go);var vN={columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},dndSource:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."},dndSourceOnRowDrag:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."}},rr=(t,e)=>{var i;return((i=e.rowModelType)!=null?i:"clientSide")==="clientSide"?{module:"@ag-grid-enterprise/row-grouping"}:null},yN={enableRowGroup:rr,rowGroup:rr,rowGroupIndex:rr,enablePivot:rr,enableValue:rr,pivot:rr,pivotIndex:rr,aggFunc:rr,cellEditor:t=>t.cellEditor==="agRichSelect"||t.cellEditor==="agRichSelectCellEditor"?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:t=>{var e;const i=["columnsMenuTab","generalMenuTab"];return(e=t.menuTabs)!=null&&e.some(s=>i.includes(s))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(t,{rowSelection:e})=>e==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(t,{rowSelection:e})=>e==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(t,{rowSelection:e})=>e==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>Zn},SN={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0},EN=Object.keys(SN),Zn={objectName:"colDef",allProperties:EN,docsUrl:"column-properties/",deprecations:vN,validations:yN},wN={enableChartToolPanelsButton:{version:"29"},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",renamed:"enterNavigatesVertically"},enterMovesDownAfterEdit:{version:"30",renamed:"enterNavigatesVerticallyAfterEdit"},suppressParentsInRowNodes:{version:"30.2",message:"Using suppressParentsInRowNodes is no longer recommended. To serialize nodes it is now recommended to instead remove the parent node reference before serialization."},advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."}},TN={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!1,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,suppressChartToolPanelsButton:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,functionsPassive:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1},bN={sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:t=>{var e;const i=(e=t.rowModelType)!=null?e:"clientSide";switch(i){case"clientSide":const s=`treeData requires 'getDataPath' in the ${i} row model.`;return t.getDataPath?null:s;case"serverSide":const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${i} row model.`;return t.isServerSideGroup&&t.getServerSideGroupKey?null:r}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:t=>{var e;switch((e=t.rowModelType)!=null?e:"clientSide"){case"clientSide":return null;case"serverSide":return t.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},suppressParentsInRowNodes:{dependencies:{groupSelectsChildren:[void 0,!1]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>Zn,defaultColDef:()=>Zn,defaultColGroupDef:()=>Zn,autoGroupColumnDef:()=>Zn},_N={objectName:"gridOptions",allProperties:[...fl.ALL_PROPERTIES,...T0.EVENT_CALLBACKS],propertyExceptions:["api","columnApi"],docsUrl:"grid-options/",deprecations:wN,validations:bN},Te=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new Qi,this.globalEventHandlerFactory=t=>(e,i)=>{if(this.destroyed)return;const s=ed.has(e);if(s&&!t||!s&&t)return;const r=T0.getCallbackForEvent(e),n=this.gridOptions[r];typeof n=="function"&&this.frameworkOverrides.wrapOutgoing(()=>{n(i)})}}get context(){return this.gridOptions.context}init(){this.columnApi=new Dl(this.api);const t=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),t),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth()}destroy(){this.destroyed=!0,this.columnApi=void 0}get(t){var e;return(e=this.gridOptions[t])!=null?e:TN[t]}getCallback(t){return this.mergeGridCommonParams(this.gridOptions[t])}exists(t){return U(this.gridOptions[t])}mergeGridCommonParams(t){return t&&(i=>{const s=i;return s.api=this.api,s.columnApi=this.columnApi,s.context=this.context,t(s)})}static toBoolean(t){return typeof t=="boolean"?t:typeof t=="string"?t.toUpperCase()==="TRUE"||t=="":!1}static toNumber(t){if(typeof t=="number")return t;if(typeof t=="string"){const e=parseInt(t);return isNaN(e)?void 0:e}}static toConstrainedNum(t,e){return i=>{const s=Te.toNumber(i);if(!(s==null||s<t||s>e))return s}}static getCoercedValue(t,e){const i=Te.PROPERTY_COERCIONS.get(t);return i?i(e):e}static getCoercedGridOptions(t){const e={};return Object.entries(t).forEach(([i,s])=>{const r=Te.getCoercedValue(i,s);e[i]=r}),e}updateGridOptions({options:t,force:e,source:i="api"}){const s={id:Te.changeSetId++,properties:[]},r=[];Object.entries(t).forEach(([n,o])=>{i==="api"&&YM[n]&&ie(`${n} is an initial property and cannot be updated.`);const a=Te.getCoercedValue(n,o),l=e||typeof a=="object"&&i==="api",u=this.gridOptions[n];if(l||u!==a){this.gridOptions[n]=a;const d={type:n,currentValue:a,previousValue:u,changeSet:s,source:i};r.push(d)}}),this.validationService.processGridOptions(this.gridOptions),s.properties=r.map(n=>n.type),r.forEach(n=>{this.gridOptions.debug&&console.log(`AG Grid: Updated property ${n.type} from `,n.previousValue," to  ",n.currentValue),this.propertyEventService.dispatchEvent(n)})}addEventListener(t,e){this.propertyEventService.addEventListener(t,e)}removeEventListener(t,e){this.propertyEventService.removeEventListener(t,e)}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=typeof this.gridOptions.scrollbarWidth=="number"&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:W0();e!=null&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:S.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(t){return this.gridOptions.rowModelType===t||t==="clientSide"&&re(this.gridOptions.rowModelType)}isDomLayout(t){var e;return((e=this.gridOptions.domLayout)!=null?e:"normal")===t}isRowSelection(){return this.gridOptions.rowSelection==="single"||this.gridOptions.rowSelection==="multiple"}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return typeof this.gridOptions.getRowHeight=="function"}getRowHeightForNode(t,e=!1,i){if(i==null&&(i=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(e)return{height:i,estimated:!0};const r={node:t,data:t.data},n=this.getCallback("getRowHeight")(r);if(this.isNumeric(n))return n===0&&ie("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,n),estimated:!1}}return t.detail&&this.get("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:i,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||re(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const t=this.environment.refreshRowHeightVariable();return t!==-1?t:(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(t){return!isNaN(t)&&typeof t=="number"&&isFinite(t)}getDomDataKey(){return this.domDataKey}getDomData(t,e){const i=t[this.getDomDataKey()];return i?i[e]:void 0}setDomData(t,e,i){const s=this.getDomDataKey();let r=t[s];re(r)&&(r={},t[s]=r),r[e]=i}getDocument(){let t=null;return this.gridOptions.getDocument&&U(this.gridOptions.getDocument)?t=this.gridOptions.getDocument():this.eGridDiv&&(t=this.eGridDiv.ownerDocument),t&&U(t)?t:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getActiveDomElement(){return this.getRootNode().activeElement}getAsyncTransactionWaitMillis(){return U(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return this.get("ensureDomOrder")?!1:this.get("animateRows")}isGroupRowsSticky(){return!(this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const t=this.gridOptions.autoGroupColumnDef;return!(t!=null&&t.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const t=this.gridOptions.groupAggFiltering;if(typeof t=="function")return this.getCallback("groupAggFiltering");if(t===!0)return()=>!0}getGrandTotalRow(){const t=this.gridOptions.grandTotalRow;if(t)return t;if(this.gridOptions.groupIncludeTotalFooter)return"bottom"}getGroupTotalRowCallback(){const t=this.get("groupTotalRow");if(typeof t=="function")return this.getCallback("groupTotalRow");if(t)return()=>t;const e=this.get("groupIncludeFooter");if(typeof e=="function"){const i=this.getCallback("groupIncludeFooter");return s=>i(s)?"bottom":void 0}return()=>e?"bottom":void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?this.gridOptions.groupDisplayType==="multipleColumns":this.get("groupHideOpenParents")}isGroupUseEntireRow(t){return t?!1:this.gridOptions.groupDisplayType==="groupRows"}getGridCommonParams(){return{api:this.api,columnApi:this.columnApi,context:this.context}}addGridCommonParams(t){const e=t;return e.api=this.api,e.columnApi=this.columnApi,e.context=this.context,e}};Te.PROPERTY_COERCIONS=new Map([...fl.BOOLEAN_PROPERTIES.map(t=>[t,Te.toBoolean]),...fl.NUMBER_PROPERTIES.map(t=>[t,Te.toNumber]),["groupAggFiltering",t=>typeof t=="function"?t:Te.toBoolean(t)],["pageSize",Te.toConstrainedNum(1,Number.MAX_VALUE)],["autoSizePadding",Te.toConstrainedNum(0,Number.MAX_VALUE)],["keepDetailRowsCount",Te.toConstrainedNum(1,Number.MAX_VALUE)],["rowBuffer",Te.toConstrainedNum(0,Number.MAX_VALUE)],["infiniteInitialRowCount",Te.toConstrainedNum(1,Number.MAX_VALUE)],["cacheOverflowSize",Te.toConstrainedNum(1,Number.MAX_VALUE)],["cacheBlockSize",Te.toConstrainedNum(1,Number.MAX_VALUE)],["serverSideInitialRowCount",Te.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelPageSize",Te.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelBufferSize",Te.toConstrainedNum(0,Number.MAX_VALUE)]]);Te.changeSetId=0;g([T("gridOptions")],Te.prototype,"gridOptions",2);g([T("eventService")],Te.prototype,"eventService",2);g([T("environment")],Te.prototype,"environment",2);g([T("frameworkOverrides")],Te.prototype,"frameworkOverrides",2);g([T("eGridDiv")],Te.prototype,"eGridDiv",2);g([T("validationService")],Te.prototype,"validationService",2);g([T("gridApi")],Te.prototype,"api",2);g([$],Te.prototype,"init",1);g([Vt],Te.prototype,"destroy",1);Te=g([Y("gridOptionsService")],Te);var yg=class extends z{getLocaleTextFunc(){const t=this.gos.getCallback("getLocaleText");if(t)return(i,s,r)=>t({key:i,defaultValue:s,variableValues:r});const e=this.gos.get("localeText");return(i,s,r)=>{let n=e&&e[i];if(n&&r&&r.length){let o=0;for(;!(o>=r.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",r[o++])}return n??s}}};yg=g([Y("localeService")],yg);var Dm=class Rb extends An{constructor(){super(Rb.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new jh(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedListener(this.eventService,S.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),i=this.invisibleScrollbar,s=e&&this.gos.getScrollbarWidth()||0,r=s===0&&i?16:s;this.addOrRemoveCssClass("ag-scrollbar-invisible",i),xi(this.getGui(),r),xi(this.eViewport,r),xi(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,s=e.getGridBodyCtrl().getBodyViewportElement(),r=this.getScrollPosition(),n=s.scrollTop;r!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(e,i){!i&&!ti(this.getViewport())&&this.attemptSettingScrollPosition(e),this.getViewport().scrollTop=e}};Dm.TEMPLATE=`<div class="ag-body-vertical-scroll" aria-hidden="true">
            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">
                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>
            </div>
        </div>`;g([$],Dm.prototype,"postConstruct",1);var DN=Dm,vy={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},yy=["january","february","march","april","may","june","july","august","september","october","november","december"],dn=class extends z{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",t=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(Jn(t.source))})}processDataTypeDefinitions(){var t;const e=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(e).forEach(([s,r])=>{this.dataTypeDefinitions[s]=He(te({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})});const i=(t=this.gos.get("dataTypeDefinitions"))!=null?t:{};this.dataTypeMatchers={},Object.entries(i).forEach(([s,r])=>{const n=this.processDataTypeDefinition(r,i,[s],e);n&&(this.dataTypeDefinitions[s]=n,r.dataTypeMatcher&&(this.dataTypeMatchers[s]=r.dataTypeMatcher))}),this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(s=>{const r=this.dataTypeMatchers[s];r&&delete this.dataTypeMatchers[s],this.dataTypeMatchers[s]=r??e[s].dataTypeMatcher})}mergeDataTypeDefinitions(t,e){const i=te(te({},t),e);return t.columnTypes&&e.columnTypes&&e.appendColumnTypes&&(i.columnTypes=[...this.convertColumnTypes(t.columnTypes),...this.convertColumnTypes(e.columnTypes)]),i}processDataTypeDefinition(t,e,i,s){let r;const n=t.extendsDataType;if(t.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),t.extendsDataType===t.baseDataType){let o=s[n];const a=e[n];if(o&&a&&(o=a),!this.validateDataTypeDefinition(t,o,n))return;r=this.mergeDataTypeDefinitions(o,t)}else{if(i.includes(n)){ie('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');return}const o=e[n];if(!this.validateDataTypeDefinition(t,o,n))return;const a=this.processDataTypeDefinition(o,e,[...i,n],s);if(!a)return;r=this.mergeDataTypeDefinitions(a,t)}return He(te({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})}validateDataTypeDefinition(t,e,i){return e?e.baseDataType!==t.baseDataType?(ie('The "baseDataType" property of a data type definition must match that of its parent.'),!1):!0:(ie(`The data type definition ${i} does not exist.`),!1)}createGroupSafeValueFormatter(t){if(t.valueFormatter)return e=>{var i,s;if((i=e.node)!=null&&i.group){const r=e.column.getAggFunc();if(r){if(r==="first"||r==="last")return t.valueFormatter(e);if(t.baseDataType==="number"&&r!=="count"){if(typeof e.value=="number")return t.valueFormatter(e);if(typeof e.value=="object"){if(!e.value)return;if("toNumber"in e.value)return t.valueFormatter(He(te({},e),{value:e.value.toNumber()}));if("value"in e.value)return t.valueFormatter(He(te({},e),{value:e.value.value}))}}}if(!this.gos.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&e.column.isRowGroupActive()){if(typeof e.value!="string"||(s=t.dataTypeMatcher)!=null&&s.call(t,e.value))return t.valueFormatter(e);if(!this.gos.get("suppressGroupMaintainValueType"))return}return t.valueFormatter(e)}}updateColDefAndGetDataTypeDefinitionColumnType(t,e,i){let{cellDataType:s}=e;const{field:r}=e;if(s===void 0&&(s=t.cellDataType),(s==null||s===!0)&&(s=this.canInferCellDataType(t,e)?this.inferCellDataType(r,i):!1),!s){t.cellDataType=!1;return}const n=this.dataTypeDefinitions[s];if(!n){ie(`Missing data type definition - "${s}"`);return}return t.cellDataType=s,n.groupSafeValueFormatter&&(t.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(t.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(t,n,i),n.columnTypes}updateColDefAndGetColumnType(t,e,i){var s,r;const n=this.updateColDefAndGetDataTypeDefinitionColumnType(t,e,i),o=(r=(s=e.type)!=null?s:n)!=null?r:t.type;return t.type=o,o?this.convertColumnTypes(o):void 0}addColumnListeners(t){if(!this.isWaitingForRowData)return;const e=this.columnStateUpdatesPendingInference[t.getColId()];if(!e)return;const i=s=>{e.add(s.key)};t.addEventListener(Pe.EVENT_STATE_UPDATED,i),this.columnStateUpdateListenerDestroyFuncs.push(()=>t.removeEventListener(Pe.EVENT_STATE_UPDATED,i))}canInferCellDataType(t,e){var i;if(this.rowModel.getType()!=="clientSide")return!1;const s={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(e,s))return!1;const r=e.type===null?t.type:e.type;if(r){const n=(i=this.gos.get("columnTypes"))!=null?i:{};if(this.convertColumnTypes(r).some(a=>{const l=n[a.trim()];return l&&this.doColDefPropsPreventInference(l,s)}))return!1}return!this.doColDefPropsPreventInference(t,s)}doColDefPropsPreventInference(t,e){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,s])=>this.doesColDefPropPreventInference(t,e,i,s))}doesColDefPropPreventInference(t,e,i,s){if(!e[i])return!1;const r=t[i];return r===null?(e[i]=!1,!1):s===void 0?!!r:r===s}inferCellDataType(t,e){var i;if(!t)return;let s;const r=this.getInitialData();if(r){const o=t.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");s=lo(r,t,o)}else this.initWaitForRowData(e);if(s==null)return;const[n]=(i=Object.entries(this.dataTypeMatchers).find(([o,a])=>a(s)))!=null?i:["object"];return n}getInitialData(){const t=this.gos.get("rowData");if(t!=null&&t.length)return t[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(e!=null&&e.length)return e[0].data}return null}initWaitForRowData(t){if(this.columnStateUpdatesPendingInference[t]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const e=this.isColumnTypeOverrideInDataTypeDefinitions;e&&this.columnModel.queueResizeOperations();const i=this.addManagedListener(this.eventService,S.EVENT_ROW_DATA_UPDATE_STARTED,s=>{const{firstRowData:r}=s;if(!r)return;i==null||i(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(r,e),this.columnStateUpdatesPendingInference={},e&&this.columnModel.processResizeOperations();const n={type:S.EVENT_DATA_TYPES_INFERRED};this.eventService.dispatchEvent(n)})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(t,e){this.initialData=t;const i=[];this.columnStateUpdateListenerDestroyFuncs.forEach(n=>n()),this.columnStateUpdateListenerDestroyFuncs=[];const s={},r={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([n,o])=>{const a=this.columnModel.getGridColumn(n);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(a,"cellDataTypeInferred"))return;const u=a.getColDef();if(e&&u.type&&u.type!==l.type){const d=this.getUpdatedColumnState(a,o);d.rowGroup&&d.rowGroupIndex==null&&(s[n]=d),d.pivot&&d.pivotIndex==null&&(r[n]=d),i.push(d)}}),e&&i.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(s,r)),i.length&&this.columnModel.applyColumnState({state:i},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(t,e){const i=this.columnModel.getColumnStateFromColDef(t);return e.forEach(s=>{delete i[s],s==="rowGroup"?delete i.rowGroupIndex:s==="pivot"&&delete i.pivotIndex}),i}checkObjectValueHandlers(t){const e=this.dataTypeDefinitions.object,i=t.object;this.hasObjectValueParser=e.valueParser!==i.valueParser,this.hasObjectValueFormatter=e.valueFormatter!==i.valueFormatter}convertColumnTypes(t){let e=[];return t instanceof Array?t.some(s=>typeof s!="string")?console.warn("if colDef.type is supplied an array it should be of type 'string[]'"):e=t:typeof t=="string"?e=t.split(","):console.warn("colDef.type should be of type 'string' | 'string[]'"),e}getDateStringTypeDefinition(t){var e;return t?(e=this.getDataTypeDefinition(t))!=null?e:this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(t){return this.getDateStringTypeDefinition(t).dateParser}getDateFormatterFunction(t){return this.getDateStringTypeDefinition(t).dateFormatter}getDataTypeDefinition(t){const e=t.getColDef();if(e.cellDataType)return this.dataTypeDefinitions[e.cellDataType]}getBaseDataType(t){var e;return(e=this.getDataTypeDefinition(t))==null?void 0:e.baseDataType}checkType(t,e){var i;if(e==null)return!0;const s=(i=this.getDataTypeDefinition(t))==null?void 0:i.dataTypeMatcher;return s?s(e):!0}validateColDef(t){t.cellDataType==="object"&&(t.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&ie('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),t.editable&&t.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&ie('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}setColDefPropertiesForBaseDataType(t,e,i){const s=(a,l,u)=>{let d=a.getColDef().valueFormatter;return d===e.groupSafeValueFormatter&&(d=e.valueFormatter),this.valueService.formatValue(a,l,u,d)},r=_e.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()),n=this.localeService.getLocaleTextFunc(),o=a=>{const{filterParams:l}=t;t.filterParams=typeof l=="object"?te(te({},l),a):a};switch(e.baseDataType){case"number":{t.cellEditor="agNumberCellEditor",r&&o({comparator:(a,l)=>{const u=a==null?0:parseInt(a),d=l==null?0:parseInt(l);return u===d?0:u>d?1:-1}});break}case"boolean":{t.cellEditor="agCheckboxCellEditor",t.cellRenderer="agCheckboxCellRenderer",t.suppressKeyboardEvent=a=>!!a.colDef.editable&&a.event.key===N.SPACE,o(r?{valueFormatter:a=>U(a.value)?n(String(a.value),a.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(a,l)=>l,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(a,l)=>l===!1,numberOfInputs:0}]});break}case"date":{t.cellEditor="agDateCellEditor",t.keyCreator=a=>s(a.column,a.node,a.value),r&&o({valueFormatter:a=>{const l=s(a.column,a.node,a.value);return U(l)?l:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(a,l)=>{if(l===1&&a!=null){const u=yy[Number(a)-1];return n(u,vy[u])}return a??n("blanks","(Blanks)")}});break}case"dateString":{t.cellEditor="agDateStringCellEditor",t.keyCreator=l=>s(l.column,l.node,l.value);const a=e.dateParser;o(r?{valueFormatter:l=>{const u=s(l.column,l.node,l.value);return U(u)?u:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:l=>{const u=a(l??void 0);return u?[String(u.getFullYear()),String(u.getMonth()+1),String(u.getDate())]:null},treeListFormatter:(l,u)=>{if(u===1&&l!=null){const d=yy[Number(l)-1];return n(d,vy[d])}return l??n("blanks","(Blanks)")}}:{comparator:(l,u)=>{const d=a(u);return u==null||d<l?-1:d>l?1:0}});break}case"object":{t.cellEditorParams={useFormatter:!0},t.comparator=(a,l)=>{const u=this.columnModel.getPrimaryColumn(i),d=u==null?void 0:u.getColDef();if(!u||!d)return 0;const c=a==null?"":s(u,null,a),C=l==null?"":s(u,null,l);return c===C?0:c>C?1:-1},t.keyCreator=a=>s(a.column,a.node,a.value),r?o({valueFormatter:a=>{const l=s(a.column,a.node,a.value);return U(l)?l:n("blanks","(Blanks)")}}):t.filterValueGetter=a=>s(a.column,a.node,this.valueService.getValue(a.column,a.node));break}}}getDefaultDataTypes(){const t=i=>!!i.match("^\\d{4}-\\d{2}-\\d{2}$"),e=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:i=>{var s,r;return((r=(s=i.newValue)==null?void 0:s.trim)==null?void 0:r.call(s))===""?null:Number(i.newValue)},valueFormatter:i=>i.value==null?"":typeof i.value!="number"||isNaN(i.value)?e("invalidNumber","Invalid Number"):String(i.value),dataTypeMatcher:i=>typeof i=="number"},text:{baseDataType:"text",valueParser:i=>i.newValue===""?null:hl(i.newValue),dataTypeMatcher:i=>typeof i=="string"},boolean:{baseDataType:"boolean",valueParser:i=>{var s,r;return i.newValue==null?i.newValue:((r=(s=i.newValue)==null?void 0:s.trim)==null?void 0:r.call(s))===""?null:String(i.newValue).toLowerCase()==="true"},valueFormatter:i=>i.value==null?"":String(i.value),dataTypeMatcher:i=>typeof i=="boolean"},date:{baseDataType:"date",valueParser:i=>Xt(i.newValue==null?null:String(i.newValue)),valueFormatter:i=>{var s;return i.value==null?"":!(i.value instanceof Date)||isNaN(i.value.getTime())?e("invalidDate","Invalid Date"):(s=Ai(i.value,!1))!=null?s:""},dataTypeMatcher:i=>i instanceof Date},dateString:{baseDataType:"dateString",dateParser:i=>{var s;return(s=Xt(i))!=null?s:void 0},dateFormatter:i=>{var s;return(s=Ai(i??null,!1))!=null?s:void 0},valueParser:i=>t(String(i.newValue))?i.newValue:null,valueFormatter:i=>t(String(i.value))?i.value:"",dataTypeMatcher:i=>typeof i=="string"&&t(i)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:i=>{var s;return(s=hl(i.value))!=null?s:""}}}}};g([T("rowModel")],dn.prototype,"rowModel",2);g([T("columnModel")],dn.prototype,"columnModel",2);g([T("valueService")],dn.prototype,"valueService",2);g([$],dn.prototype,"init",1);dn=g([Y("dataTypeService")],dn);var hn=class extends z{constructor(){super(...arguments),this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",t=>this.setColumnDefs(t))}start(){this.ctrlsService.whenReady(()=>{const t=this.gos.get("columnDefs");t?this.setColumnsAndData(t):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(t){this.columnModel.setColumnDefs(t??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const t=_e.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId());new _m("AG Grid",()=>this.gos.get("debug")).log(`initialised successfully, enterprise = ${t}`)}dispatchGridReadyEvent(){const t={type:S.EVENT_GRID_READY};this.eventService.dispatchEvent(t)}setColumnDefs(t){const e=this.gos.get("columnDefs");if(e){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(e);return}this.columnModel.setColumnDefs(e,Jn(t.source))}}};g([T("ctrlsService")],hn.prototype,"ctrlsService",2);g([T("columnModel")],hn.prototype,"columnModel",2);g([T("rowModel")],hn.prototype,"rowModel",2);g([$],hn.prototype,"postConstruct",1);hn=g([Y("syncService")],hn);var cn=class extends z{constructor(){super(...arguments),this.manuallyDisplayed=!1}postConstruct(){this.addManagedListener(this.eventService,S.EVENT_ROW_DATA_UPDATED,()=>this.onRowDataUpdated()),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}registerOverlayWrapperComp(t){this.overlayWrapperComp=t,(!this.gos.get("columnDefs")||this.gos.isRowModelType("clientSide")&&!this.gos.get("rowData"))&&this.showLoadingOverlay()}showLoadingOverlay(){if(this.gos.get("suppressLoadingOverlay"))return;const t={},e=this.userComponentFactory.getLoadingOverlayCompDetails(t);this.showOverlay(e,"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}showNoRowsOverlay(){if(this.gos.get("suppressNoRowsOverlay"))return;const t={},e=this.userComponentFactory.getNoRowsOverlayCompDetails(t);this.showOverlay(e,"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}showOverlay(t,e,i){const s=t.newAgStackInstance(),r=this.addManagedPropertyListener(i,({currentValue:n})=>{s.then(o=>{o.refresh&&o.refresh(this.gos.addGridCommonParams(te({},n??{})))})});this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.overlayWrapperComp.showOverlay(s,e,r)}hideOverlay(){this.manuallyDisplayed=!1,this.overlayWrapperComp.hideOverlay()}showOrHideOverlay(){const t=this.paginationProxy.isEmpty(),e=this.gos.get("suppressNoRowsOverlay");t&&!e?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&!this.manuallyDisplayed&&this.hideOverlay()}};g([T("userComponentFactory")],cn.prototype,"userComponentFactory",2);g([T("paginationProxy")],cn.prototype,"paginationProxy",2);g([T("columnModel")],cn.prototype,"columnModel",2);g([$],cn.prototype,"postConstruct",1);cn=g([Y("overlayService")],cn);var kt=class extends z{constructor(){super(...arguments),this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Ot(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Ot(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=Ot(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){var t;this.isClientSideRowModel=this.rowModel.getType()==="clientSide",this.cachedState=(t=this.gos.get("initialState"))!=null?t:{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const e=this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,({source:r})=>{r==="gridInitializing"&&(e==null||e(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))}),i=this.addManagedListener(this.eventService,S.EVENT_ROW_COUNT_READY,()=>{i==null||i(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())}),s=this.addManagedListener(this.eventService,S.EVENT_FIRST_DATA_RENDERED,()=>{s==null||s(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState()),this.addManagedListener(this.eventService,S.EVENT_TOOL_PANEL_VISIBLE_CHANGED,()=>this.updateCachedState("sideBar",this.getSideBarState())),this.addManagedListener(this.eventService,S.EVENT_SIDE_BAR_UPDATED,()=>this.updateCachedState("sideBar",this.getSideBarState()))}setupStateOnColumnsInitialised(){var t;const e=(t=this.gos.get("initialState"))!=null?t:{};this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VALUE_CHANGED,()=>this.updateColumnState(["aggregation"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_MOVED,()=>this.updateColumnState(["columnOrder"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PINNED,()=>this.updateColumnState(["columnPinning"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_RESIZED,()=>this.updateColumnState(["columnSizing"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VISIBLE,()=>this.updateColumnState(["columnVisibility"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateColumnState(["rowGroup"])),this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,()=>this.updateColumnState(["sort"])),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"])),this.addManagedListener(this.eventService,S.EVENT_COLUMN_GROUP_OPENED,()=>this.updateCachedState("columnGroup",this.getColumnGroupState()))}setupStateOnRowCountReady(){var t;const{filter:e,rowGroupExpansion:i,rowSelection:s,pagination:r}=(t=this.gos.get("initialState"))!=null?t:{},n=this.gos.get("advancedFilterModel");(e||n)&&this.setFilterState(e,n),i&&this.setRowGroupExpansionState(i),s&&this.setRowSelectionState(s),r&&this.setPaginationState(r),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedListener(this.eventService,S.EVENT_FILTER_CHANGED,()=>this.updateCachedState("filter",this.getFilterState())),this.addManagedListener(this.eventService,S.EVENT_ROW_GROUP_OPENED,()=>this.onRowGroupOpenedDebounced()),this.addManagedListener(this.eventService,S.EVENT_EXPAND_COLLAPSE_ALL,()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),this.addManagedListener(this.eventService,S.EVENT_SELECTION_CHANGED,()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()}),this.addManagedListener(this.eventService,S.EVENT_PAGINATION_CHANGED,o=>{(o.newPage||o.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())})}setupStateOnFirstDataRendered(){var t;const{scroll:e,rangeSelection:i,focusedCell:s,columnOrder:r}=(t=this.gos.get("initialState"))!=null?t:{};s&&this.setFocusedCellState(s),i&&this.setRangeSelectionState(i),e&&this.setScrollState(e),this.setColumnPivotState(!!(r!=null&&r.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedListener(this.eventService,S.EVENT_CELL_FOCUSED,()=>this.updateCachedState("focusedCell",this.getFocusedCellState())),this.addManagedListener(this.eventService,S.EVENT_RANGE_SELECTION_CHANGED,n=>{n.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())}),this.addManagedListener(this.eventService,S.EVENT_BODY_SCROLL_END,()=>this.updateCachedState("scroll",this.getScrollState()))}getColumnState(){const t=this.columnModel.isPivotMode(),e=[],i=[],s=[],r=[],n=[],o=[],a=[],l=[],u=[],d=this.columnModel.getColumnState();for(let c=0;c<d.length;c++){const{colId:C,sort:E,sortIndex:y,rowGroup:_,rowGroupIndex:b,aggFunc:R,pivot:D,pivotIndex:O,pinned:L,hide:I,width:k,flex:H}=d[c];u.push(C),E&&(e[y??0]={colId:C,sort:E}),_&&(i[b??0]=C),typeof R=="string"&&s.push({colId:C,aggFunc:R}),D&&(r[O??0]=C),L&&(L==="right"?o:n).push(C),I&&a.push(C),(H||k)&&l.push({colId:C,flex:H??void 0,width:k})}return{sort:e.length?{sortModel:e}:void 0,rowGroup:i.length?{groupColIds:i}:void 0,aggregation:s.length?{aggregationModel:s}:void 0,pivot:r.length||t?{pivotMode:t,pivotColIds:r}:void 0,columnPinning:n.length||o.length?{leftColIds:n,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:u.length?{orderedColIds:u}:void 0}}setColumnState(t){const{sort:e,rowGroup:i,aggregation:s,pivot:r,columnPinning:n,columnVisibility:o,columnSizing:a,columnOrder:l}=t,u={},d=y=>{let _=u[y];return _||(_={colId:y},u[y]=_,_)};e&&e.sortModel.forEach(({colId:y,sort:_},b)=>{const R=d(y);R.sort=_,R.sortIndex=b}),i&&i.groupColIds.forEach((y,_)=>{const b=d(y);b.rowGroup=!0,b.rowGroupIndex=_}),s&&s.aggregationModel.forEach(({colId:y,aggFunc:_})=>{d(y).aggFunc=_}),r&&(r.pivotColIds.forEach((y,_)=>{const b=d(y);b.pivot=!0,b.pivotIndex=_}),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"})),n&&(n.leftColIds.forEach(y=>{d(y).pinned="left"}),n.rightColIds.forEach(y=>{d(y).pinned="right"})),o&&o.hiddenColIds.forEach(y=>{d(y).hide=!0}),a&&a.columnSizingModel.forEach(({colId:y,flex:_,width:b})=>{const R=d(y);R.flex=_??null,R.width=b});const c=l==null?void 0:l.orderedColIds,C=!!(c!=null&&c.length),E=C?c.map(y=>d(y)):Object.values(u);if(E.length){this.columnStates=E;const y={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnModel.applyColumnState({state:E,applyOrder:C,defaultState:y},"gridInitializing")}}setColumnPivotState(t){const e=this.columnStates;this.columnStates=void 0;const i=this.columnGroupStates;if(this.columnGroupStates=void 0,!!this.columnModel.isSecondaryColumnsPresent()){if(e){let s=[];for(const r of e)this.columnModel.getSecondaryColumn(r.colId)&&s.push(r);this.columnModel.applyColumnState({state:s,applyOrder:t},"gridInitializing")}i&&this.columnModel.setColumnGroupState(i,"gridInitializing")}}getColumnGroupState(){const t=this.columnModel.getColumnGroupState(),e=[];return t.forEach(({groupId:i,open:s})=>{s&&e.push(i)}),e.length?{openColumnGroupIds:e}:void 0}setColumnGroupState(t){var e;if(!t.hasOwnProperty("columnGroup"))return;const i=new Set((e=t.columnGroup)==null?void 0:e.openColumnGroupIds),r=this.columnModel.getColumnGroupState().map(({groupId:n})=>{const o=i.has(n);return o&&i.delete(n),{groupId:n,open:o}});i.forEach(n=>{r.push({groupId:n,open:!0})}),r.length&&(this.columnGroupStates=r),this.columnModel.setColumnGroupState(r,"gridInitializing")}getFilterState(){var t;let e=this.filterManager.getFilterModel();e&&Object.keys(e).length===0&&(e=void 0);const i=(t=this.filterManager.getAdvancedFilterModel())!=null?t:void 0;return e||i?{filterModel:e,advancedFilterModel:i}:void 0}setFilterState(t,e){const{filterModel:i,advancedFilterModel:s}=t??{advancedFilterModel:e};i&&this.filterManager.setFilterModel(i,"columnFilter"),s&&this.filterManager.setAdvancedFilterModel(s)}getRangeSelectionState(){var t;const e=(t=this.rangeService)==null?void 0:t.getCellRanges().map(i=>{const{id:s,type:r,startRow:n,endRow:o,columns:a,startColumn:l}=i;return{id:s,type:r,startRow:n,endRow:o,colIds:a.map(u=>u.getColId()),startColId:l.getColId()}});return e!=null&&e.length?{cellRanges:e}:void 0}setRangeSelectionState(t){if(!this.gos.get("enableRangeSelection")||!this.rangeService)return;const e=[];t.cellRanges.forEach(i=>{const s=[];if(i.colIds.forEach(n=>{const o=this.columnModel.getGridColumn(n);o&&s.push(o)}),!s.length)return;let r=this.columnModel.getGridColumn(i.startColId);if(!r){const n=this.columnModel.getAllDisplayedColumns(),o=new Set(s);r=n.find(a=>o.has(a))}e.push(He(te({},i),{columns:s,startColumn:r}))}),this.rangeService.setCellRanges(e)}getScrollState(){var t,e,i;if(!this.isClientSideRowModel)return;const s=(t=this.ctrlsService.getGridBodyCtrl())==null?void 0:t.getScrollFeature(),{left:r}=(e=s==null?void 0:s.getHScrollPosition())!=null?e:{left:0},{top:n}=(i=s==null?void 0:s.getVScrollPosition())!=null?i:{top:0};return n||r?{top:n,left:r}:void 0}setScrollState(t){var e;if(!this.isClientSideRowModel)return;const{top:i,left:s}=t;(e=this.ctrlsService.getGridBodyCtrl())==null||e.getScrollFeature().setScrollPosition(i,s)}getSideBarState(){var t,e;return(e=(t=this.sideBarService)==null?void 0:t.getSideBarComp())==null?void 0:e.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const t=this.focusService.getFocusedCell();if(t){const{column:e,rowIndex:i,rowPinned:s}=t;return{colId:e.getColId(),rowIndex:i,rowPinned:s}}}setFocusedCellState(t){if(!this.isClientSideRowModel)return;const{colId:e,rowIndex:i,rowPinned:s}=t;this.focusService.setFocusedCell({column:this.columnModel.getGridColumn(e),rowIndex:i,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const t=this.paginationProxy.getCurrentPage(),e=this.gos.get("paginationAutoPageSize")?void 0:this.paginationProxy.getPageSize();if(!(!t&&!e))return{page:t,pageSize:e}}setPaginationState(t){t.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationProxy.setPageSize(t.pageSize,"initialState"),typeof t.page=="number"&&this.paginationProxy.setPage(t.page)}getRowSelectionState(){var t;const e=this.selectionService.getSelectionState();return!e||!Array.isArray(e)&&(e.selectAll===!1||e.selectAllChildren===!1)&&!((t=e==null?void 0:e.toggledNodes)!=null&&t.length)?void 0:e}setRowSelectionState(t){this.selectionService.setSelectionState(t,"gridInitializing")}getRowGroupExpansionState(){const t=this.expansionService.getExpandedRows();return t.length?{expandedRowGroupIds:t}:void 0}setRowGroupExpansionState(t){this.expansionService.expandRows(t.expandedRowGroupIds)}updateColumnState(t){const e=this.getColumnState();let i=!1;Object.entries(e).forEach(([s,r])=>{Kp(r,this.cachedState[s])||(i=!0)}),this.cachedState=te(te({},this.cachedState),e),i&&this.dispatchStateUpdateEvent(t)}updateCachedState(t,e){const i=this.cachedState[t];this.setCachedStateValue(t,e),Kp(e,i)||this.dispatchStateUpdateEvent([t])}setCachedStateValue(t,e){this.cachedState=He(te({},this.cachedState),{[t]:e})}refreshStaleState(){this.staleStateKeys.forEach(t=>{switch(t){case"rowSelection":this.setCachedStateValue(t,this.getRowSelectionState());break}}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(t){this.suppressEvents||(t.forEach(e=>this.queuedUpdateSources.add(e)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const t=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const e={type:S.EVENT_STATE_UPDATED,sources:t,state:this.cachedState};this.eventService.dispatchEvent(e)}suppressEventsAndDispatchInitEvent(t){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),t(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}};g([T("filterManager")],kt.prototype,"filterManager",2);g([T("ctrlsService")],kt.prototype,"ctrlsService",2);g([T("focusService")],kt.prototype,"focusService",2);g([T("columnModel")],kt.prototype,"columnModel",2);g([T("paginationProxy")],kt.prototype,"paginationProxy",2);g([T("rowModel")],kt.prototype,"rowModel",2);g([T("selectionService")],kt.prototype,"selectionService",2);g([T("expansionService")],kt.prototype,"expansionService",2);g([T("columnAnimationService")],kt.prototype,"columnAnimationService",2);g([De("sideBarService")],kt.prototype,"sideBarService",2);g([De("rangeService")],kt.prototype,"rangeService",2);g([$],kt.prototype,"postConstruct",1);kt=g([Y("stateService")],kt);var Fl=class extends z{init(){this.processGridOptions(this.gridOptions)}processGridOptions(t){this.processOptions(t,_N)}processColumnDefs(t){this.processOptions(t,Zn)}processOptions(t,e){const{validations:i,deprecations:s,allProperties:r,propertyExceptions:n,objectName:o,docsUrl:a}=e;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(t,[...n??[],...Object.keys(s)],r,o,a);const l=new Set;Object.keys(t).forEach(d=>{var c;const C=s[d];if(C)if("renamed"in C){const{renamed:O,version:L}=C;l.add(`As of v${L}, ${String(d)} is deprecated. Please use ${String(O)} instead.`),t[O]=t[d]}else{const{message:O,version:L}=C;l.add(`As of v${L}, ${String(d)} is deprecated. ${O??""}`)}const E=t[d];if(E==null||E===!1)return;const y=i[d];let _;if(y)if(typeof y=="function"){const O=y(t,this.gridOptions);if(!O)return;if("objectName"in O){const L=t[d];if(Array.isArray(L)){L.forEach(I=>{this.processOptions(I,O)});return}this.processOptions(t[d],O);return}_=O}else _=y;else return;const{module:b,dependencies:R,supportedRowModels:D}=_;if(D){const O=(c=this.gridOptions.rowModelType)!=null?c:"clientSide";if(!D.includes(O)){l.add(`${String(d)} is not supported with the '${O}' row model.`);return}}if(b){const O=Array.isArray(b)?b:[b];let L=!0;if(O.forEach(I=>{_e.__assertRegistered(I,String(d),this.context.getGridId())||(L=!1,l.add(`${String(d)} is only available when ${I} is loaded.`))}),!L)return}if(R){const O=this.checkForWarning(d,R,t);if(O){l.add(O);return}}}),l.size>0&&l.forEach(d=>{ie(d)})}checkForWarning(t,e,i){if(typeof e=="function")return e(i,this.gridOptions);const r=Object.entries(e).find(([a,l])=>{const u=i[a];return!l.includes(u)});if(!r)return null;const[n,o]=r;return o.length>1?`'${String(t)}' requires '${n}' to be one of [${o.join(", ")}].`:`'${String(t)}' requires '${n}' to be ${o[0]}.`}checkProperties(t,e,i,s,r){const n=["__ob__","__v_skip","__metadata__"],o=sT(Object.getOwnPropertyNames(t),[...n,...e,...i],i);if(Tt(o,(a,l)=>{ie(`invalid ${s} property '${a}' did you mean any of these: ${l.slice(0,8).join(", ")}`)}),Object.keys(o).length>0&&r){const a=this.getFrameworkOverrides().getDocLink(r);ie(`to see all the valid ${s} properties please check: ${a}`)}}};g([T("gridOptions")],Fl.prototype,"gridOptions",2);g([$],Fl.prototype,"init",1);Fl=g([Y("validationService")],Fl);var $d=class extends z{constructor(){super(...arguments),this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new xf(this.getFrameworkOverrides())}addEventListener(t,e){const i=this.frameworkEventWrappingService.wrap(e),s=this.gos.useAsyncEvents()&&!ed.has(t),r=s?this.asyncEventListeners:this.syncEventListeners;r.has(t)||r.set(t,new Set),r.get(t).add(i),this.eventService.addEventListener(t,i,s)}removeEventListener(t,e){var i;const s=this.frameworkEventWrappingService.unwrap(e),r=this.asyncEventListeners.get(t),n=!!(r!=null&&r.delete(s));n||(i=this.syncEventListeners.get(t))==null||i.delete(s),this.eventService.removeEventListener(t,s,n)}addGlobalListener(t){const e=this.frameworkEventWrappingService.wrapGlobal(t);if(this.gos.useAsyncEvents()){const s=(n,o)=>{ed.has(n)&&e(n,o)},r=(n,o)=>{ed.has(n)||e(n,o)};this.globalEventListenerPairs.set(t,{syncListener:s,asyncListener:r}),this.eventService.addGlobalListener(s,!1),this.eventService.addGlobalListener(r,!0)}else this.syncGlobalEventListeners.add(e),this.eventService.addGlobalListener(e,!1)}removeGlobalListener(t){const e=this.frameworkEventWrappingService.unwrapGlobal(t);if(this.globalEventListenerPairs.has(e)){const{syncListener:s,asyncListener:r}=this.globalEventListenerPairs.get(e);this.eventService.removeGlobalListener(s,!1),this.eventService.removeGlobalListener(r,!0),this.globalEventListenerPairs.delete(t)}else this.syncGlobalEventListeners.delete(e),this.eventService.removeGlobalListener(e,!1)}destroyEventListeners(t,e){t.forEach((i,s)=>{i.forEach(r=>this.eventService.removeEventListener(s,r,e)),i.clear()}),t.clear()}destroyGlobalListeners(t,e){t.forEach(i=>this.eventService.removeGlobalListener(i,e)),t.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener:t,asyncListener:e})=>{this.eventService.removeGlobalListener(t,!1),this.eventService.removeGlobalListener(e,!0)}),this.globalEventListenerPairs.clear()}};g([$],$d.prototype,"postConstruct",1);$d=g([Y("apiEventService")],$d);var Rm=class extends oe{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const t=this.selectPageSizeComp.getValue();if(!t)return;const e=Number(t);isNaN(e)||e<1||e===this.paginationProxy.getPageSize()||(this.paginationProxy.setPageSize(e,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}init(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedListener(this.eventService,S.EVENT_PAGINATION_CHANGED,t=>this.handlePaginationChanged(t))}handlePaginationChanged(t){if(!this.selectPageSizeComp||!(t!=null&&t.newPageSize))return;const e=this.paginationProxy.getPageSize();this.getPageSizeSelectorValues().includes(e)?this.selectPageSizeComp.setValue(e.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(t){this.selectPageSizeComp&&this.reset(),t&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){tt(this.getGui()),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0)}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get("paginationPageSizeSelector")!==!1}reloadPageSizesSelector(){const t=this.getPageSizeSelectorValues(),e=this.paginationProxy.getPageSize(),i=!e||!t.includes(e);i&&(t.unshift(""),ie(`The paginationPageSize grid option is set to a value that is not in the list of page size options.
                Please make sure that the paginationPageSize grid option is set to one of the values in the 
                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.`)),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0);const s=this.localeService.getLocaleTextFunc(),r=s("pageSizeSelectorLabel","Page Size:"),n=t.map(a=>({value:String(a),text:String(a)})),o=s("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new kh).addOptions(n).setValue(String(i?"":e)).setAriaLabel(o).setLabel(r).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=i}getPageSizeSelectorValues(){const t=[20,50,100],e=this.gos.get("paginationPageSizeSelector");return!Array.isArray(e)||!this.validateValues(e)?t:[...e].sort((i,s)=>i-s)}validateValues(t){if(!t.length)return ie(`The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.
                If you want to hide the page size selector, please set the paginationPageSizeSelector to false.`),!1;for(let e=0;e<t.length;e++){const i=t[e],s=typeof i=="number",r=i>0;if(!s)return ie(`The paginationPageSizeSelector grid option contains a non-numeric value.
                    Please make sure that all values in the paginationPageSizeSelector array are numbers.`),!1;if(!r)return ie(`The paginationPageSizeSelector grid option contains a negative number or zero.
                    Please make sure that all values in the paginationPageSizeSelector array are positive.`),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}};g([T("paginationProxy")],Rm.prototype,"paginationProxy",2);g([$],Rm.prototype,"init",1);var Ml=class extends z{constructor(){super(),this.descriptionContainer=null,this.announceValue=Ot(this.announceValue.bind(this),200)}postConstruct(){const t=this.gos.getDocument(),e=this.descriptionContainer=t.createElement("div");e.classList.add("ag-aria-description-container"),Ff(e,"polite"),P0(e,"additions text"),x0(e,!0),this.eGridDiv.appendChild(e)}announceValue(t){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=t)},50))}destroy(){super.destroy();const{descriptionContainer:t}=this;t&&(tt(t),t.parentElement&&t.parentElement.removeChild(t)),this.descriptionContainer=null,this.eGridDiv=null}};g([T("eGridDiv")],Ml.prototype,"eGridDiv",2);g([$],Ml.prototype,"postConstruct",1);Ml=g([Y("ariaAnnouncementService")],Ml);var Sg=class{};Sg.gridOptions=void 0;function RN(t,e,i){if(!e)return gs("No gridOptions provided to createGrid"),{};const s=new xN().create(t,e,r=>{const n=new oa(t);r.createBean(n)},void 0,i);if(!Object.isFrozen(e)){const r="https://ag-grid.com/javascript-data-grid/grid-interface/#grid-api";Object.defineProperty(e,"api",{get:()=>{gs(`gridOptions.api is no longer supported. See ${r}.`)},configurable:!0}),Object.defineProperty(e,"columnApi",{get:()=>{gs(`gridOptions.columnApi is no longer supported and all methods moved to the grid api. See ${r}.`)},configurable:!0})}return s}var AN=1,xN=class{create(t,e,i,s,r){var n;let o={};Sg.gridOptions?(Yt(o,Sg.gridOptions,!0,!0),o=te(te({},o),e)):o=e;const a=Te.getCoercedGridOptions(o),l=!!a.debug,u=(n=a.gridId)!=null?n:String(AN++),d=this.getRegisteredModules(r,u),c=this.createBeansList(a.rowModelType,d,u),C=this.createProvidedBeans(t,a,r);if(!c){gs("Failed to create grid.");return}const E={providedBeanInstances:C,beanClasses:c,debug:l,gridId:u},y=new _m("Context",()=>E.debug),_=new MM(E,y),b=_.getBean("beans");return this.registerModuleUserComponents(b,d),this.registerStackComponents(b,d),this.registerControllers(b,d),i(_),b.syncService.start(),s&&s(_),_.getBean("gridApi")}registerControllers(t,e){e.forEach(i=>{i.controllers&&i.controllers.forEach(s=>t.ctrlsFactory.register(s))})}registerStackComponents(t,e){const i=this.createAgStackComponentsList(e);t.agStackComponentsRegistry.setupComponents(i)}getRegisteredModules(t,e){const i=t?t.modules:null,s=_e.__getRegisteredModules(e),r=[],n={},o=(a,l,u)=>{(c=>{n[c.moduleName]||(n[c.moduleName]=!0,r.push(c),_e.__register(c,a,u))})(l),l.dependantModules&&l.dependantModules.forEach(c=>o(a,c,u))};return i&&i.forEach(a=>o(!0,a,e)),s&&s.forEach(a=>o(!_e.__isPackageBased(),a,void 0)),r}registerModuleUserComponents(t,e){this.extractModuleEntity(e,s=>s.userComponents?s.userComponents:[]).forEach(s=>{t.userComponentRegistry.registerDefaultComponent(s.componentName,s.componentClass)})}createProvidedBeans(t,e,i){let s=i?i.frameworkOverrides:null;re(s)&&(s=new dN);const r={gridOptions:e,eGridDiv:t,globalEventListener:i?i.globalEventListener:null,globalSyncEventListener:i?i.globalSyncEventListener:null,frameworkOverrides:s};return i&&i.providedBeanInstances&&Object.assign(r,i.providedBeanInstances),r}createAgStackComponentsList(t){let e=[{componentName:"AgCheckbox",componentClass:Gh},{componentName:"AgRadioButton",componentClass:ET},{componentName:"AgToggleButton",componentClass:Cb},{componentName:"AgInputTextField",componentClass:vn},{componentName:"AgInputTextArea",componentClass:XO},{componentName:"AgInputNumberField",componentClass:lm},{componentName:"AgInputDateField",componentClass:QO},{componentName:"AgInputRange",componentClass:JO},{componentName:"AgRichSelect",componentClass:Zh},{componentName:"AgSelect",componentClass:kh},{componentName:"AgSlider",componentClass:eN},{componentName:"AgGridBody",componentClass:is},{componentName:"AgHeaderRoot",componentClass:qO},{componentName:"AgSortIndicator",componentClass:dm},{componentName:"AgPagination",componentClass:ni},{componentName:"AgPageSizeSelector",componentClass:Rm},{componentName:"AgOverlayWrapper",componentClass:mN},{componentName:"AgGroupComponent",componentClass:tN},{componentName:"AgRowContainer",componentClass:Qo},{componentName:"AgFakeHorizontalScroll",componentClass:CN},{componentName:"AgFakeVerticalScroll",componentClass:DN},{componentName:"AgAutocomplete",componentClass:aN}];const i=this.extractModuleEntity(t,s=>s.agStackComponents?s.agStackComponents:[]);return e=e.concat(i),e}createBeansList(t="clientSide",e,i){const s=e.filter(l=>!l.rowModel||l.rowModel===t),r={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!r[t]){gs("Could not find row model for rowModelType = "+t);return}if(!_e.__assertRegistered(r[t],`rowModelType = '${t}'`,i))return;const n=[de,No,mg,Pl,Lo,me,Vd,zd,Al,hg,cr,Mo,wl,yg,Fl,bl,El,eg,Qi,Te,$s,ln,Fi,yt,nn,_l,vi,Hd,pl,an,Dt,Wd,fr,Ud,on,pr,ae,Dl,xe,Vs,xl,gr,Bd,Po,un,fg,Rl,Oo,gl,Fo,Io,Rs,tg,Cg,Il,Ds,ko,el,Ll,Go,vg,dn,Jt,hn,cn,kt,Tl,$d,Ml,Mi],o=this.extractModuleEntity(s,l=>l.beans?l.beans:[]);n.push(...o);const a=[];return n.forEach(l=>{a.indexOf(l)<0&&a.push(l)}),a}extractModuleEntity(t,e){return[].concat(...t.map(e))}},aa=typeof global>"u"?{}:global;aa.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement;aa.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement;aa.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement;aa.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement;aa.Node=typeof Node>"u"?{}:Node;aa.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var Am=class Ua{constructor(e,i,s,r,n,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=i,this.eventService=s,this.columnModel=r,this.beans=o,this.selectionService=n,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=Ua.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return ge.cloneObject(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if(typeof e=="string"){console.warn("AG Grid: rowData must be an array.");return}this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const i=this.rootNode,s=this.rootNode.sibling;i.childrenAfterFilter=null,i.childrenAfterGroup=null,i.childrenAfterAggFilter=null,i.childrenAfterSort=null,i.childrenMapped=null,i.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?i.allLeafChildren=e.map(r=>this.createNode(r,this.rootNode,Ua.TOP_LEVEL)):(i.allLeafChildren=[],i.childrenAfterGroup=[]),s&&(s.childrenAfterFilter=i.childrenAfterFilter,s.childrenAfterGroup=i.childrenAfterGroup,s.childrenAfterAggFilter=i.childrenAfterAggFilter,s.childrenAfterSort=i.childrenAfterSort,s.childrenMapped=i.childrenMapped,s.allLeafChildren=i.allLeafChildren)}updateRowData(e,i){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const s={remove:[],update:[],add:[]},r=[];return this.executeRemove(e,s,r),this.executeUpdate(e,s,r),this.executeAdd(e,s),this.updateSelection(r,"rowDataChanged"),i&&ge.sortRowNodesByOrder(this.rootNode.allLeafChildren,i),s}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){const i={type:S.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:e!=null&&e.length?e[0]:null};this.eventService.dispatchEvent(i)}updateSelection(e,i){const s=e.length>0;if(s&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:i}),this.selectionService.updateGroupsFromChildrenSelections(i),s){const r={type:S.EVENT_SELECTION_CHANGED,source:i};this.eventService.dispatchEvent(r)}}executeAdd(e,i){var s;const{add:r,addIndex:n}=e;if(ge.missingOrEmpty(r))return;const o=r.map(a=>this.createNode(a,this.rootNode,Ua.TOP_LEVEL));if(typeof n=="number"&&n>=0){const{allLeafChildren:a}=this.rootNode,l=a.length;let u=n;if(this.gos.get("treeData")&&n>0&&l>0){for(let E=0;E<l;E++)if(((s=a[E])==null?void 0:s.rowIndex)==n-1){u=E+1;break}}const c=a.slice(0,u),C=a.slice(u,a.length);this.rootNode.allLeafChildren=[...c,...o,...C]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...o];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),i.add=o}executeRemove(e,i,s){const{remove:r}=e;if(ge.missingOrEmpty(r))return;const n={};r.forEach(o=>{const a=this.lookupRowNode(o);a&&(a.isSelected()&&s.push(a),a.clearRowTopAndRowIndex(),n[a.id]=!0,delete this.allNodesMap[a.id],i.remove.push(a))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(o=>!n[o.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,i,s){const{update:r}=e;ge.missingOrEmpty(r)||r.forEach(n=>{const o=this.lookupRowNode(n);o&&(o.updateData(n),!o.selectable&&o.isSelected()&&s.push(o),this.setMasterForRow(o,n,Ua.TOP_LEVEL,!1),i.update.push(o))})}lookupRowNode(e){const i=this.gos.getCallback("getRowId");let s;if(i){const r=i({data:e,level:0});if(s=this.allNodesMap[r],!s)return console.error(`AG Grid: could not find row id=${r}, data item was not found for this id`),null}else if(s=this.rootNode.allLeafChildren.find(r=>r.data===e),!s)return console.error("AG Grid: could not find data item as object was not found",e),console.error("Consider using getRowId to help the Grid find matching row data"),null;return s||null}createNode(e,i,s){const r=new ce(this.beans);r.group=!1,this.setMasterForRow(r,e,s,!0);const n=this.gos.get("suppressParentsInRowNodes");return i&&!n&&(r.parent=i),r.level=s,r.setDataAndId(e,this.nextId.toString()),this.allNodesMap[r.id]&&console.warn(`AG Grid: duplicate node id '${r.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[r.id]=r,this.nextId++,r}setMasterForRow(e,i,s,r){if(this.gos.get("treeData"))e.setMaster(!1),r&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const a=this.gos.get("isRowMaster");a?e.setMaster(a(i)):e.setMaster(!0)}else e.setMaster(!1);if(r){const a=this.columnModel.getRowGroupColumns(),l=a?a.length:0,u=s+l;e.expanded=e.master?this.isExpanded(u):!1}}}isExpanded(e){const i=this.gos.get("groupDefaultExpanded");return i===-1?!0:e<i}};Am.TOP_LEVEL=0;Am.ROOT_NODE_ID="ROOT_NODE_ID";var PN=Am,Gt=class extends z{constructor(){super(...arguments),this.onRowHeightChanged_debounced=ge.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}init(){const t=this.refreshModel.bind(this,{step:"group"}),e=!this.gos.get("suppressAnimationFrame"),i=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:e});this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,i),this.addManagedListener(this.eventService,S.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:"pivot"})),this.addManagedListener(this.eventService,S.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,S.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this)),this.addManagedListener(this.eventService,S.EVENT_GRID_READY,()=>this.onGridReady()),this.addPropertyListeners(),this.rootNode=new ce(this.beans),this.nodeManager=new PN(this.rootNode,this.gos,this.eventService,this.columnModel,this.selectionService,this.beans)}addPropertyListeners(){const t=new Set(["treeData","masterDetail"]),e=new Set(["suppressParentsInRowNodes","groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),i=new Set(["excludeChildrenWhenTreeDataFiltering"]),s=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),r=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),n=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...t,...e,...i,...s,...s,...r,...n,...o,...a];this.addManagedPropertyListeners(l,u=>{var d;const c=(d=u.changeSet)==null?void 0:d.properties;if(!c)return;const C=E=>c.some(y=>E.has(y));if(C(t)){this.setRowData(this.rootNode.allLeafChildren.map(E=>E.data));return}if(C(e)){this.refreshModel({step:"group"});return}if(C(i)){this.refreshModel({step:"filter"});return}if(C(s)){this.refreshModel({step:"pivot"});return}if(C(r)){this.refreshModel({step:"aggregate"});return}if(C(n)){this.refreshModel({step:"sort"});return}if(C(o)){this.refreshModel({step:"filter_aggregates"});return}C(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const t=this.gos.get("rowData");t&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(t))}ensureRowHeightsValid(t,e,i,s){let r,n=!1;do{r=!1;const o=this.getRowIndexAtPixel(t),a=this.getRowIndexAtPixel(e),l=Math.max(o,i),u=Math.min(a,s);for(let d=l;d<=u;d++){const c=this.getRow(d);if(c.rowHeightEstimated){const C=this.gos.getRowHeightForNode(c);c.setRowHeight(C.height),r=!0,n=!0}}r&&this.setRowTopAndRowIndex()}while(r);return n}setRowTopAndRowIndex(){const t=this.environment.getDefaultRowHeight();let e=0;const i=new Set,s=this.gos.isDomLayout("normal");for(let r=0;r<this.rowsToDisplay.length;r++){const n=this.rowsToDisplay[r];if(n.id!=null&&i.add(n.id),n.rowHeight==null){const o=this.gos.getRowHeightForNode(n,s,t);n.setRowHeight(o.height,o.estimated)}n.setRowTop(e),n.setRowIndex(r),e+=n.rowHeight}return i}clearRowTopAndRowIndex(t,e){const i=t.isActive(),s=n=>{n&&n.id!=null&&!e.has(n.id)&&n.clearRowTopAndRowIndex()},r=n=>{if(s(n),s(n.detailNode),s(n.sibling),n.hasChildren()&&n.childrenAfterGroup){const o=n.level==-1;i&&!o&&!n.expanded||n.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(t,e,i=0){const s=this.getRowIndexAtPixel(e),r=this.getRow(s),n=!this.gos.get("suppressAnimationFrame");return r===t[0]?!1:(t.forEach(o=>{ge.removeFromArray(this.rootNode.allLeafChildren,o)}),t.forEach((o,a)=>{ge.insertIntoArray(this.rootNode.allLeafChildren,o,Math.max(s+i,0)+a)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:n}),!0)}highlightRowAtPixel(t,e){const i=e!=null?this.getRowIndexAtPixel(e):null,s=i!=null?this.getRow(i):null;if(!s||!t||s===t||e==null){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null);return}const r=this.getHighlightPosition(e,s);this.lastHighlightedRow&&this.lastHighlightedRow!==s&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),s.setHighlighted(r),this.lastHighlightedRow=s}getHighlightPosition(t,e){if(!e){const r=this.getRowIndexAtPixel(t);if(e=this.getRow(r||0),!e)return 1}const{rowTop:i,rowHeight:s}=e;return t-i<s/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter;return e?e.length:0}getTopLevelRowDisplayedIndex(t){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return t;let i=this.rootNode.childrenAfterSort[t];if(this.gos.get("groupHideOpenParents"))for(;i.expanded&&i.childrenAfterSort&&i.childrenAfterSort.length>0;)i=i.childrenAfterSort[0];return i.rowIndex}getRowBounds(t){if(ge.missing(this.rowsToDisplay))return null;const e=this.rowsToDisplay[t];return e?{rowTop:e.rowTop,rowHeight:e.rowHeight}:null}onRowGroupOpened(){const t=this.gos.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate:t})}onFilterChanged(t){if(t.afterDataChange)return;const e=this.gos.isAnimateRows(),s=t.columns.length===0||t.columns.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:s,keepRenderedRows:!0,animate:e})}onSortChanged(){const t=this.gos.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate:t,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(t){const e=ge.missingOrEmpty(t),i=new Jh(!1,this.rootNode);return(e||this.gos.get("treeData"))&&i.setInactive(),i}isSuppressModelUpdateAfterUpdateTransaction(t){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||t.rowNodeTransactions==null)return!1;const e=t.rowNodeTransactions.filter(s=>s.add!=null&&s.add.length>0||s.remove!=null&&s.remove.length>0);return e==null||e.length==0}buildRefreshModelParams(t){let e="group";const i={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(ge.exists(t)&&(e=i[t]),ge.missing(e)){console.error(`AG Grid: invalid step ${t}, available steps are ${Object.keys(i).join(", ")}`);return}const s=!this.gos.get("suppressAnimationFrame");return{step:e,keepRenderedRows:!0,keepEditingRows:!0,animate:s}}refreshModel(t){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.shouldRowModelIgnoreRefresh())return;let e=typeof t=="object"&&"step"in t?t:this.buildRefreshModelParams(t);if(!e||this.isSuppressModelUpdateAfterUpdateTransaction(e))return;const i=this.createChangePath(e.rowNodeTransactions);switch(this.isRefreshingModel=!0,e.step){case"group":this.doRowGrouping(e.rowNodeTransactions,e.rowNodeOrder,i,!!e.afterColumnsChanged);case"filter":this.doFilter(i);case"pivot":this.doPivot(i);case"aggregate":this.doAggregate(i);case"filter_aggregates":this.doFilterAggregates(i);case"sort":this.doSort(e.rowNodeTransactions,i);case"map":this.doRowsToDisplay()}const s=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(i,s),this.isRefreshingModel=!1;const r={type:S.EVENT_MODEL_UPDATED,animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack};this.eventService.dispatchEvent(r)}isEmpty(){const t=ge.missing(this.rootNode.allLeafChildren)||this.rootNode.allLeafChildren.length===0;return ge.missing(this.rootNode)||t||!this.columnModel.isReady()}isRowsToRender(){return ge.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(t,e){let i=!e,s=!1;const r=[],n=this.gos.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(o=>{if(s)return;if(i&&(o===e||o===t)&&(s=!0,o.group&&n)){r.push(...o.allLeafChildren);return}if(!i){if(o!==e&&o!==t)return;i=!0}if(!o.group||!n){r.push(o);return}}),r}setDatasource(t){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(t){return this.rowsToDisplay[t]}isRowPresent(t){return this.rowsToDisplay.indexOf(t)>=0}getRowIndexAtPixel(t){if(this.isEmpty()||this.rowsToDisplay.length===0)return-1;let e=0,i=this.rowsToDisplay.length-1;if(t<=0)return 0;if(ge.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;let r=-1,n=-1;for(;;){const o=Math.floor((e+i)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,t)||(a.rowTop<t?e=o+1:a.rowTop>t&&(i=o-1),r===e&&n===i))return o;r=e,n=i}}isRowInPixel(t,e){const i=t.rowTop,s=t.rowTop+t.rowHeight;return i<=e&&s>e}forEachLeafNode(t){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((e,i)=>t(e,i))}forEachNode(t,e=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:t,recursionType:0,index:0,includeFooterNodes:e})}forEachNodeAfterFilter(t,e=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:t,recursionType:1,index:0,includeFooterNodes:e})}forEachNodeAfterFilterAndSort(t,e=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:t,recursionType:2,index:0,includeFooterNodes:e})}forEachPivotNode(t,e=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:t,recursionType:3,index:0,includeFooterNodes:e})}recursivelyWalkNodesAndCallback(t){const{nodes:e,callback:i,recursionType:s,includeFooterNodes:r}=t;let{index:n}=t;const o=a=>{var l;const u=(l=e[0])==null?void 0:l.parent;if(!u)return;const d=r&&this.gos.getGrandTotalRow(),c=this.gos.getGroupTotalRowCallback(),C=r&&c({node:u});if(u===this.rootNode){d===a&&(u.createFooter(),i(u.sibling,n++));return}C===a&&(u.createFooter(),i(u.sibling,n++))};o("top");for(let a=0;a<e.length;a++){const l=e[a];if(i(l,n++),l.hasChildren()&&!l.footer){let u=null;switch(s){case 0:u=l.childrenAfterGroup;break;case 1:u=l.childrenAfterAggFilter;break;case 2:u=l.childrenAfterSort;break;case 3:u=l.leafGroup?null:l.childrenAfterSort;break}u&&(n=this.recursivelyWalkNodesAndCallback({nodes:[...u],callback:i,recursionType:s,index:n,includeFooterNodes:r}))}}return o("bottom"),n}doAggregate(t){var e;(e=this.aggregationStage)==null||e.execute({rowNode:this.rootNode,changedPath:t})}doFilterAggregates(t){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:t}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(t){const e=this.gos.get("treeData"),i=this.columnModel.isPivotActive(),s=o=>{o&&o.forEach(a=>{const l=()=>{a.expanded=t,s(a.childrenAfterGroup)};if(e){ge.exists(a.childrenAfterGroup)&&l();return}if(i){!a.leafGroup&&l();return}a.group&&l()})};this.rootNode&&s(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const r=t?"expandAll":"collapseAll",n={type:S.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(n)}doSort(t,e){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,changedPath:e})}doRowGrouping(t,e,i,s){if(this.groupStage){if(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:e,changedPath:i}):this.groupStage.execute({rowNode:this.rootNode,changedPath:i,afterColumnsChanged:s}),this.gos.get("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",i)){const n={type:S.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(n)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:S.EVENT_ROW_COUNT_READY}))}doFilter(t){this.filterStage.execute({rowNode:this.rootNode,changedPath:t})}doPivot(t){var e;(e=this.pivotStage)==null||e.execute({rowNode:this.rootNode,changedPath:t})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(t){if(typeof t=="string"&&t.indexOf(ce.ID_PREFIX_ROW_GROUP)==0){let i;return this.forEachNode(s=>{s.id===t&&(i=s)}),i}return this.nodeManager.getRowNode(t)}setRowData(t){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(t),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const t={type:S.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(t),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(t,e){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const i=this.gos.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},i)}this.rowDataTransactionBatch.push({rowDataTransaction:t,callback:e})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const t=[],e=[];let i=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(s=>{const r=this.nodeManager.updateRowData(s.rowDataTransaction,void 0);e.push(r),s.callback&&t.push(s.callback.bind(null,r)),typeof s.rowDataTransaction.addIndex=="number"&&(i=!0)}),this.commonUpdateRowData(e,void 0,i),t.length>0&&window.setTimeout(()=>{t.forEach(s=>s())},0),e.length>0){const s={type:S.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:e};this.eventService.dispatchEvent(s)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(t,e){this.valueCache.onDataChanged();const i=this.nodeManager.updateRowData(t,e),s=typeof t.addIndex=="number";return this.commonUpdateRowData([i],e,s),i}createRowNodeOrder(){if(this.gos.get("suppressMaintainUnsortedOrder"))return;const e={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let i=0;i<this.rootNode.allLeafChildren.length;i++){const s=this.rootNode.allLeafChildren[i];e[s.id]=i}return e}commonUpdateRowData(t,e,i){if(!this.hasStarted)return;const s=!this.gos.get("suppressAnimationFrame");i&&(e=this.createRowNodeOrder());const r={type:S.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r),this.refreshModel({step:"group",rowNodeTransactions:t,rowNodeOrder:e,keepRenderedRows:!0,keepEditingRows:!0,animate:s})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const t=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let t=!1;return this.forEachNode(e=>{e.setRowHeight(e.rowHeight,!0);const i=e.detailNode;i&&i.setRowHeight(i.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t=!0}),t}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}};g([T("columnModel")],Gt.prototype,"columnModel",2);g([T("selectionService")],Gt.prototype,"selectionService",2);g([T("valueCache")],Gt.prototype,"valueCache",2);g([T("beans")],Gt.prototype,"beans",2);g([T("filterStage")],Gt.prototype,"filterStage",2);g([T("sortStage")],Gt.prototype,"sortStage",2);g([T("flattenStage")],Gt.prototype,"flattenStage",2);g([De("groupStage")],Gt.prototype,"groupStage",2);g([De("aggregationStage")],Gt.prototype,"aggregationStage",2);g([De("pivotStage")],Gt.prototype,"pivotStage",2);g([De("filterAggregatesStage")],Gt.prototype,"filterAggregatesStage",2);g([$],Gt.prototype,"init",1);Gt=g([Y("rowModel")],Gt);var jd=class extends z{execute(t){const{changedPath:e}=t;this.filterService.filter(e)}};g([T("filterService")],jd.prototype,"filterService",2);jd=g([Y("filterStage")],jd);var Ol=class extends z{execute(t){const e=this.sortController.getSortOptions(),i=ge.exists(e)&&e.length>0,s=i&&ge.exists(t.rowNodeTransactions)&&this.gos.get("deltaSort"),r=e.some(n=>this.gos.isColumnsSortingCoupledToGroup()?n.column.isPrimary()&&n.column.isRowGroupActive():!!n.column.getColDef().showRowGroup);this.sortService.sort(e,i,s,t.rowNodeTransactions,t.changedPath,r)}};g([T("sortService")],Ol.prototype,"sortService",2);g([T("sortController")],Ol.prototype,"sortController",2);Ol=g([Y("sortStage")],Ol);var qd=class extends z{execute(t){const e=t.rowNode,i=[],s=this.beans.columnModel.isPivotMode(),r=s&&e.leafGroup,n=r?[e]:e.childrenAfterSort,o=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(o,n,i,s,0);const a=i.length>0;if(!r&&a&&o.grandTotalRow){e.createFooter();const u=o.grandTotalRow==="top";this.addRowNodeToRowsToDisplay(o,e.sibling,i,0,u)}return i}getFlattenDetails(){const t=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!t&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:t,isGroupMultiAutoColumn:this.gos.isGroupMultiAutoColumn(),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:this.gos.getGrandTotalRow(),groupTotalRow:this.gos.getGroupTotalRowCallback()}}recursivelyAddToRowsToDisplay(t,e,i,s,r){if(!ge.missingOrEmpty(e))for(let n=0;n<e.length;n++){const o=e[n],a=o.hasChildren(),l=s&&!a,u=t.groupRemoveSingleChildren&&a&&o.childrenAfterGroup.length===1,d=t.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&o.childrenAfterGroup.length===1,c=s&&o.leafGroup,C=t.hideOpenParents&&o.expanded&&!o.master&&!c;if(!l&&!C&&!u&&!d&&this.addRowNodeToRowsToDisplay(t,o,i,r),!(s&&o.leafGroup)){if(a){const y=u||d;if(o.expanded||y){const _=t.groupTotalRow({node:o});_||o.destroyFooter();const b=y?r:r+1;_==="top"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(t,o.sibling,i,b)),this.recursivelyAddToRowsToDisplay(t,o.childrenAfterSort,i,s,b),_==="bottom"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(t,o.sibling,i,b))}}else if(o.master&&o.expanded){const y=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(t,y,i,r)}}}}addRowNodeToRowsToDisplay(t,e,i,s,r){r?i.unshift(e):i.push(e),e.setUiLevel(t.isGroupMultiAutoColumn?0:s)}createDetailNode(t){if(ge.exists(t.detailNode))return t.detailNode;const e=new ce(this.beans);return e.detail=!0,e.selectable=!1,e.parent=t,ge.exists(t.id)&&(e.id="detail_"+t.id),e.data=t.data,e.level=t.level+1,t.detailNode=e,e}};g([T("beans")],qd.prototype,"beans",2);qd=g([Y("flattenStage")],qd);var Nl=class extends z{sort(t,e,i,s,r,n){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getAllGridColumns().some(C=>C.isRowGroupActive());let l={};i&&s&&(l=this.calculateDirtyNodes(s));const u=this.columnModel.isPivotMode(),d=this.gos.getCallback("postSortRows"),c=C=>{var E;this.pullDownGroupDataForHideOpenParents(C.childrenAfterAggFilter,!0);const y=u&&C.leafGroup;if(o&&a&&!C.leafGroup&&!n){const b=(E=this.columnModel.getRowGroupColumns())==null?void 0:E[C.level+1],R=(b==null?void 0:b.getSort())===null,D=C.childrenAfterAggFilter.slice(0);if(C.childrenAfterSort&&!R){const O={};C.childrenAfterSort.forEach((L,I)=>{O[L.id]=I}),D.sort((L,I)=>{var k,H;return((k=O[L.id])!=null?k:0)-((H=O[I.id])!=null?H:0)})}C.childrenAfterSort=D}else!e||y?C.childrenAfterSort=C.childrenAfterAggFilter.slice(0):i?C.childrenAfterSort=this.doDeltaSort(C,l,r,t):C.childrenAfterSort=this.rowNodeSorter.doFullSort(C.childrenAfterAggFilter,t);if(C.sibling&&(C.sibling.childrenAfterSort=C.childrenAfterSort),this.updateChildIndexes(C),d){const b={nodes:C.childrenAfterSort};d(b)}};r&&r.forEachChangedNodeDepthFirst(c),this.updateGroupDataForHideOpenParents(r)}calculateDirtyNodes(t){const e={},i=s=>{s&&s.forEach(r=>e[r.id]=!0)};return t&&t.forEach(s=>{i(s.add),i(s.update),i(s.remove)}),e}doDeltaSort(t,e,i,s){const r=t.childrenAfterAggFilter,n=t.childrenAfterSort;if(!n)return this.rowNodeSorter.doFullSort(r,s);const o={},a=[];r.forEach(c=>{e[c.id]||!i.canSkip(c)?a.push(c):o[c.id]=!0});const l=n.filter(c=>o[c.id]),u=(c,C)=>({currentPos:C,rowNode:c}),d=a.map(u).sort((c,C)=>this.rowNodeSorter.compareRowNodes(s,c,C));return this.mergeSortedArrays(s,d,l.map(u)).map(({rowNode:c})=>c)}mergeSortedArrays(t,e,i){const s=[];let r=0,n=0;for(;r<e.length&&n<i.length;)this.rowNodeSorter.compareRowNodes(t,e[r],i[n])<0?s.push(e[r++]):s.push(i[n++]);for(;r<e.length;)s.push(e[r++]);for(;n<i.length;)s.push(i[n++]);return s}updateChildIndexes(t){if(ge.missing(t.childrenAfterSort))return;const e=t.childrenAfterSort;for(let i=0;i<e.length;i++){const s=e[i],r=i===0,n=i===t.childrenAfterSort.length-1;s.setFirstChild(r),s.setLastChild(n),s.setChildIndex(i)}}updateGroupDataForHideOpenParents(t){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return ge.warnOnce("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const e=i=>{this.pullDownGroupDataForHideOpenParents(i.childrenAfterSort,!1),i.childrenAfterSort.forEach(s=>{s.hasChildren()&&e(s)})};t&&t.executeFromRootNode(i=>e(i))}pullDownGroupDataForHideOpenParents(t,e){!this.gos.get("groupHideOpenParents")||ge.missing(t)||t.forEach(i=>{this.columnModel.getGroupDisplayColumns().forEach(r=>{const n=r.getColDef().showRowGroup;if(typeof n!="string"){console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");return}const o=n,a=this.columnModel.getPrimaryColumn(o);if(a!==i.rowGroupColumn)if(e)i.setGroupValue(r.getId(),void 0);else{const u=i.getFirstChildOfFirstChild(a);u&&i.setGroupValue(r.getId(),u.key)}})})}};g([T("columnModel")],Nl.prototype,"columnModel",2);g([T("rowNodeSorter")],Nl.prototype,"rowNodeSorter",2);Nl=g([Y("sortService")],Nl);var Kd=class extends z{filter(t){const e=this.filterManager.isChildFilterPresent();this.filterNodes(e,t)}filterNodes(t,e){const i=(s,r)=>{s.hasChildren()&&t&&!r?s.childrenAfterFilter=s.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):s.childrenAfterFilter=s.childrenAfterGroup,s.sibling&&(s.sibling.childrenAfterFilter=s.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const s=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],u=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?s(n.childrenAfterGroup[a],u):i(l,u)}i(n,o)},r=n=>s(n,!1);e.executeFromRootNode(r)}else{const s=r=>i(r,!1);e.forEachChangedNodeDepthFirst(s,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}};g([T("filterManager")],Kd.prototype,"filterManager",2);Kd=g([Y("filterService")],Kd);var pn=class extends z{postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const t=this.gos.exists("getRowId");return this.gos.get("resetRowDataOnUpdate")?!1:t}setRowData(t){const e=this.createTransactionForRowData(t);if(!e)return;const[i,s]=e;this.clientSideRowModel.updateRowData(i,s)}createTransactionForRowData(t){if(ge.missing(this.clientSideRowModel)){console.error("AG Grid: ImmutableService only works with ClientSideRowModel");return}const e=this.gos.getCallback("getRowId");if(e==null){console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");return}const i={remove:[],update:[],add:[]},s=this.clientSideRowModel.getCopyOfNodesMap(),n=this.gos.get("suppressMaintainUnsortedOrder")?void 0:{};return ge.exists(t)&&t.forEach((o,a)=>{const l=e({data:o,level:0}),u=s[l];n&&(n[l]=a),u?(u.data!==o&&i.update.push(o),s[l]=void 0):i.add.push(o)}),ge.iterateObject(s,(o,a)=>{a&&i.remove.push(a.data)}),[i,n]}onRowDataUpdated(){const t=this.gos.get("rowData");t&&(this.isActive()?this.setRowData(t):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(t)))}};g([T("rowModel")],pn.prototype,"rowModel",2);g([T("rowRenderer")],pn.prototype,"rowRenderer",2);g([T("selectionService")],pn.prototype,"selectionService",2);g([$],pn.prototype,"postConstruct",1);pn=g([Y("immutableService")],pn);var IN="31.3.2",LN={version:IN,moduleName:"@ag-grid-community/client-side-row-model",rowModel:"clientSide",beans:[Gt,jd,Ol,qd,Nl,Kd,pn]},FN=Object.defineProperty,MN=Object.getOwnPropertyDescriptor,Ut=(t,e,i,s)=>{for(var r=s>1?void 0:s?MN(e,i):e,n=t.length-1,o;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&FN(e,i,r),r},ON=(t,e)=>(i,s)=>e(i,s,t),kl=class extends cg{constructor(t,e,i){super(t),this.parentCache=e,this.params=i,this.startRow=t*i.blockSize,this.endRow=this.startRow+i.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(t,e,i){ge.exists(e)?t.setDataAndId(e,i.toString()):t.setDataAndId(void 0,void 0)}loadFromDatasource(){const t=this.createLoadParams();if(ge.missing(this.params.datasource.getRows)){console.warn("AG Grid: datasource is missing getRows method");return}window.setTimeout(()=>{this.params.datasource.getRows(t)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(t,e,i){this.rowNodes.forEach((s,r)=>{this.startRow+r<i&&t(s,e.next())})}getLastAccessed(){return this.lastAccessed}getRow(t,e=!1){e||(this.lastAccessed=this.params.lastAccessedSequence.next());const i=t-this.startRow;return this.rowNodes[i]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let t=0;t<this.params.blockSize;t++){const e=this.startRow+t,i=new ce(this.beans);i.setRowHeight(this.params.rowHeight),i.uiLevel=0,i.setRowIndex(e),i.setRowTop(this.params.rowHeight*e),this.rowNodes.push(i)}}processServerResult(t){this.rowNodes.forEach((i,s)=>{const r=t.rowData?t.rowData[s]:void 0;!i.id&&i.alreadyRendered&&r&&(this.rowNodes[s]=new ce(this.beans),this.rowNodes[s].setRowIndex(i.rowIndex),this.rowNodes[s].setRowTop(i.rowTop),this.rowNodes[s].setRowHeight(i.rowHeight),i.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[s],r,this.startRow+s)});const e=t.rowCount!=null&&t.rowCount>=0?t.rowCount:void 0;this.parentCache.pageLoaded(this,e)}destroyRowNodes(){this.rowNodes.forEach(t=>{t.clearRowTopAndRowIndex()})}};Ut([T("beans")],kl.prototype,"beans",2);Ut([$],kl.prototype,"postConstruct",1);Ut([Vt],kl.prototype,"destroyRowNodes",1);var la=class Ab extends z{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}setBeans(e){this.logger=e.create("InfiniteCache")}getRow(e,i=!1){const s=Math.floor(e/this.params.blockSize);let r=this.blocks[s];if(!r){if(i)return;r=this.createBlock(s)}return r.getRow(e)}createBlock(e){const i=this.createBean(new kl(e,this,this.params));return this.blocks[i.getId()]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),this.params.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(i=>i.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroyAllBlocks(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,i){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${e.getId()}, lastRow = ${i}`),this.checkRowCount(e,i),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const i=this.getBlocksInOrder().filter(a=>a!=e),s=(a,l)=>l.getLastAccessed()-a.getLastAccessed();i.sort(s);const r=this.params.maxBlocksInCache>0,n=r?this.params.maxBlocksInCache-1:null,o=Ab.MAX_EMPTY_BLOCKS_TO_KEEP-1;i.forEach((a,l)=>{const u=a.getState()===kl.STATE_WAITING_TO_LOAD&&l>=o,d=r?l>=n:!1;if(u||d){if(this.isBlockCurrentlyDisplayed(a)||this.isBlockFocused(a))return;this.removeBlockFromCache(a)}})}isBlockFocused(e){const i=this.focusService.getFocusCellToUseAfterRefresh();if(!i||i.rowPinned!=null)return!1;const s=e.getStartRow(),r=e.getEndRow();return i.rowIndex>=s&&i.rowIndex<r}isBlockCurrentlyDisplayed(e){const i=e.getStartRow(),s=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(i,s)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,i){if(typeof i=="number"&&i>=0)this.rowCount=i,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const r=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<r&&(this.rowCount=r)}}setRowCount(e,i){this.rowCount=e,ge.exists(i)&&(this.lastRowIndexKnown=i),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const i=new xo;this.getBlocksInOrder().forEach(s=>s.forEachNode(e,i,this.rowCount))}getBlocksInOrder(){const e=(s,r)=>s.getId()-r.getId();return ge.getAllValuesInObject(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const e={type:S.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(i=>{i.getId()*this.params.blockSize>=this.rowCount&&e.push(i)}),e.length>0&&e.forEach(i=>this.destroyBlock(i))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,i){const s=[];let r=-1,n=!1;const o=new xo;ge.missing(e)&&(n=!0);let a=!1;return this.getBlocksInOrder().forEach(u=>{if(!a){if(n&&r+1!==u.getId()){a=!0;return}r=u.getId(),u.forEachNode(d=>{const c=d===e||d===i;(n||c)&&s.push(d),c&&(n=!n)},o,this.rowCount)}}),a||n?[]:s}};la.MAX_EMPTY_BLOCKS_TO_KEEP=2;Ut([T("rowRenderer")],la.prototype,"rowRenderer",2);Ut([T("focusService")],la.prototype,"focusService",2);Ut([ON(0,_i("loggerFactory"))],la.prototype,"setBeans",1);Ut([Vt],la.prototype,"destroyAllBlocks",1);var NN=la,As=class extends z{getRowBounds(t){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*t}}ensureRowHeightsValid(t,e,i,s){return!1}init(){this.gos.isRowModelType("infinite")&&(this.rowHeight=this.gos.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&ge.warnOnce("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,S.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,S.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,S.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this)),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gos.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let t;this.cacheParams?t=this.isSortModelDifferent():t=!0,t&&this.reset()}isSortModelDifferent(){return!ge.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(t){this.destroyDatasource(),this.datasource=t,t&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(t,e){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(t,e):[]}reset(){if(!this.datasource)return;this.gos.getCallback("getRowId")!=null||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:S.EVENT_MODEL_UPDATED,newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:this.gos.getRowHeightAsNumber(),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new xo},this.infiniteCache=this.createBean(new NN(this.cacheParams)),this.eventService.dispatchEventOnce({type:S.EVENT_ROW_COUNT_READY});const t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)});const t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)}getRow(t){if(this.infiniteCache&&!(t>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(t)}getRowNode(t){let e;return this.forEachNode(i=>{i.id===t&&(e=i)}),e}forEachNode(t){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(t)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(t){return t}getRowIndexAtPixel(t){if(this.rowHeight!==0){const e=Math.floor(t/this.rowHeight),i=this.getRowCount()-1;return e>i?i:e}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(t){return!!this.getRowNode(t.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?this.infiniteCache.isLastRowIndexKnown():!1}setRowCount(t,e){this.infiniteCache&&this.infiniteCache.setRowCount(t,e)}};Ut([T("filterManager")],As.prototype,"filterManager",2);Ut([T("sortController")],As.prototype,"sortController",2);Ut([T("selectionService")],As.prototype,"selectionService",2);Ut([T("rowRenderer")],As.prototype,"rowRenderer",2);Ut([T("rowNodeBlockLoader")],As.prototype,"rowNodeBlockLoader",2);Ut([$],As.prototype,"init",1);Ut([Vt],As.prototype,"destroyDatasource",1);As=Ut([Y("rowModel")],As);var kN="31.3.2",GN={version:kN,moduleName:"@ag-grid-community/infinite-row-model",rowModel:"infinite",beans:[As]},VN=Object.defineProperty,BN=Object.getOwnPropertyDescriptor,oi=(t,e,i,s)=>{for(var r=s>1?void 0:s?BN(e,i):e,n=t.length-1,o;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&VN(e,i,r),r},HN=class{setBeans(t){this.beans=t}getFileName(t){const e=this.getDefaultFileExtension();return(t==null||!t.length)&&(t=this.getDefaultFileName()),t.indexOf(".")===-1?`${t}.${e}`:t}getData(t){const e=this.createSerializingSession(t);return this.beans.gridSerializer.serialize(e,t)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},UN=class{constructor(t){this.groupColumns=[];const{columnModel:e,valueService:i,gos:s,processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a}=t;this.columnModel=e,this.valueService=i,this.gos=s,this.processCellCallback=r,this.processHeaderCallback=n,this.processGroupHeaderCallback=o,this.processRowGroupCallback=a}prepare(t){this.groupColumns=t.filter(e=>!!e.getColDef().showRowGroup)}extractHeaderValue(t){const e=this.getHeaderName(this.processHeaderCallback,t);return e??""}extractRowCellValue(t,e,i,s,r){const o=(!this.gos.get("groupHideOpenParents")||r.footer)&&this.shouldRenderGroupSummaryCell(r,t,e)?this.createValueForGroupNode(t,r):this.valueService.getValue(t,r);return this.processCell({accumulatedRowIndex:i,rowNode:r,column:t,value:o,processCellCallback:this.processCellCallback,type:s})}shouldRenderGroupSummaryCell(t,e,i){var s;if(!(t&&t.group))return!1;if(this.groupColumns.indexOf(e)!==-1){if(((s=t.groupData)==null?void 0:s[e.getId()])!=null||this.gos.isRowModelType("serverSide")&&t.group)return!0;if(t.footer&&t.level===-1){const a=e.getColDef();return a==null||a.showRowGroup===!0||a.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const o=this.gos.isGroupUseEntireRow(this.columnModel.isPivotMode());return i===0&&o}getHeaderName(t,e){return t?t(this.gos.addGridCommonParams({column:e})):this.columnModel.getDisplayNameForColumn(e,"csv",!0)}createValueForGroupNode(t,e){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:t,node:e}));const i=this.gos.get("treeData"),s=this.gos.get("suppressGroupMaintainValueType"),r=l=>{var u,d;if(i||s)return l.key;const c=(u=l.groupData)==null?void 0:u[t.getId()];return!c||!l.rowGroupColumn||l.rowGroupColumn.getColDef().useValueFormatterForExport===!1?c:(d=this.valueService.formatValue(l.rowGroupColumn,l,c))!=null?d:c},n=e.footer,o=[r(e)];if(!this.gos.isGroupMultiAutoColumn())for(;e.parent;)e=e.parent,o.push(r(e));const a=o.reverse().join(" -> ");return n?`Total ${a}`:a}processCell(t){var e;const{accumulatedRowIndex:i,rowNode:s,column:r,value:n,processCellCallback:o,type:a}=t;return o?{value:(e=o(this.gos.addGridCommonParams({accumulatedRowIndex:i,column:r,node:s,value:n,type:a,parseValue:l=>this.valueService.parseValue(r,s,l,this.valueService.getValue(r,s)),formatValue:l=>{var u;return(u=this.valueService.formatValue(r,s,l))!=null?u:l}})))!=null?e:""}:r.getColDef().useValueFormatterForExport!==!1?{value:n??"",valueFormatted:this.valueService.formatValue(r,s,n)}:{value:n??""}}},WN=class{static download(t,e){const i=document.defaultView||window;if(!i){console.warn("AG Grid: There is no `window` associated with the current `document`");return}const s=document.createElement("a"),r=i.URL.createObjectURL(e);s.setAttribute("href",r),s.setAttribute("download",t),s.style.display="none",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),document.body.removeChild(s),i.setTimeout(()=>{i.URL.revokeObjectURL(r)},0)}},Sy=`\r
`,zN=class extends UN{constructor(t){super(t),this.isFirstLine=!0,this.result="";const{suppressQuotes:e,columnSeparator:i}=t;this.suppressQuotes=e,this.columnSeparator=i}addCustomContent(t){t&&(typeof t=="string"?(/^\s*\n/.test(t)||this.beginNewLine(),t=t.replace(/\r?\n/g,Sy),this.result+=t):t.forEach(e=>{this.beginNewLine(),e.forEach((i,s)=>{s!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(t,e,i,s){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e),this.appendEmptyCells(s)}appendEmptyCells(t){for(let e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(t,e){e!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(t))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(t,e,i){var s;e!=0&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(t,e,e,"csv",i);this.result+=this.putInQuotes((s=r.valueFormatted)!=null?s:r.value)}putInQuotes(t){if(this.suppressQuotes)return t;if(t==null)return'""';let e;return typeof t=="string"?e=t:typeof t.toString=="function"?e=t.toString():(console.warn("AG Grid: unknown value type during csv conversion"),e=""),'"'+e.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=Sy),this.isFirstLine=!1}},mr=class extends HN{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(t){const e=this.gos.get("defaultCsvExportParams");return Object.assign({},e,t)}export(t){if(this.isExportSuppressed()){console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");return}const e=this.getMergedParams(t),i=this.getData(e),s=new Blob(["\uFEFF",i],{type:"text/plain"}),r=typeof e.fileName=="function"?e.fileName(this.gos.getGridCommonParams()):e.fileName;WN.download(this.getFileName(r),s)}exportDataAsCsv(t){this.export(t)}getDataAsCsv(t,e=!1){const i=e?Object.assign({},t):this.getMergedParams(t);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(t){const{columnModel:e,valueService:i,gos:s}=this,{processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a,suppressQuotes:l,columnSeparator:u}=t;return new zN({columnModel:e,valueService:i,gos:s,processCellCallback:r||void 0,processHeaderCallback:n||void 0,processGroupHeaderCallback:o||void 0,processRowGroupCallback:a||void 0,suppressQuotes:l||!1,columnSeparator:u||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};oi([T("columnModel")],mr.prototype,"columnModel",2);oi([T("valueService")],mr.prototype,"valueService",2);oi([T("gridSerializer")],mr.prototype,"gridSerializer",2);oi([T("gridOptionsService")],mr.prototype,"gos",2);oi([$],mr.prototype,"postConstruct",1);mr=oi([Y("csvCreator")],mr);var xs=class extends z{serialize(t,e={}){const{allColumns:i,columnKeys:s,skipRowGroups:r}=e,n=this.getColumnsToExport(i,r,s);return ge.compose(this.prepareSession(n),this.prependContent(e),this.exportColumnGroups(e,n),this.exportHeaders(e,n),this.processPinnedTopRows(e,n),this.processRows(e,n),this.processPinnedBottomRows(e,n),this.appendContent(e))(t).parse()}processRow(t,e,i,s){const r=e.shouldRowBeSkipped||(()=>!1),n=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),l=e.rowPositions!=null||!!e.onlySelected,u=this.gos.get("groupHideOpenParents")&&!l,d=this.columnModel.isPivotMode()?s.leafGroup:!s.group,c=!!s.footer;e.skipRowGroups;const C=o&&s.leafGroup,E=s.allChildrenCount===1&&(n||C);if(!d&&!c&&(e.skipRowGroups||E||u)||e.onlySelected&&!s.isSelected()||e.skipPinnedTop&&s.rowPinned==="top"||e.skipPinnedBottom&&s.rowPinned==="bottom"||s.level===-1&&!d&&!c||r(this.gos.addGridCommonParams({node:s})))return;const b=t.onNewBodyRow(s);if(i.forEach((R,D)=>{b.onColumn(R,D,s)}),e.getCustomContentBelowRow){const R=e.getCustomContentBelowRow(this.gos.addGridCommonParams({node:s}));R&&t.addCustomContent(R)}}appendContent(t){return e=>{const i=t.appendContent;return i&&e.addCustomContent(i),e}}prependContent(t){return e=>{const i=t.prependContent;return i&&e.addCustomContent(i),e}}prepareSession(t){return e=>(e.prepare(t),e)}exportColumnGroups(t,e){return i=>{if(!t.skipColumnGroupHeaders){const s=new v0,r=this.displayedGroupCreator.createDisplayedGroups(e,s,null);this.recursivelyAddHeaderGroups(r,i,t.processGroupHeaderCallback)}return i}}exportHeaders(t,e){return i=>{if(!t.skipColumnHeaders){const s=i.onNewHeaderRow();e.forEach((r,n)=>{s.onColumn(r,n,void 0)})}return i}}processPinnedTopRows(t,e){return i=>{const s=this.processRow.bind(this,i,t,e);return t.rowPositions?t.rowPositions.filter(r=>r.rowPinned==="top").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedTopRow(r.rowIndex)).forEach(s):this.pinnedRowModel.forEachPinnedTopRow(s),i}}processRows(t,e){return i=>{const s=this.rowModel,r=s.getType(),n=r==="clientSide",o=r==="serverSide",a=!n&&t.onlySelected,l=this.processRow.bind(this,i,t,e),{exportedRows:u="filteredAndSorted"}=t;if(t.rowPositions)t.rowPositions.filter(d=>d.rowPinned==null).sort((d,c)=>d.rowIndex-c.rowIndex).map(d=>s.getRow(d.rowIndex)).forEach(l);else if(this.columnModel.isPivotMode())n?s.forEachPivotNode(l,!0):o?s.forEachNodeAfterFilterAndSort(l,!0):s.forEachNode(l);else if(t.onlySelectedAllPages||a){const d=this.selectionService.getSelectedNodes();this.replicateSortedOrder(d),d.forEach(l)}else u==="all"?s.forEachNode(l):n||o?s.forEachNodeAfterFilterAndSort(l,!0):s.forEachNode(l);return i}}replicateSortedOrder(t){const e=this.sortController.getSortOptions(),i=(s,r)=>{var n,o,a,l;return s.rowIndex!=null&&r.rowIndex!=null?s.rowIndex-r.rowIndex:s.level===r.level?((n=s.parent)==null?void 0:n.id)===((o=r.parent)==null?void 0:o.id)?this.rowNodeSorter.compareRowNodes(e,{rowNode:s,currentPos:(a=s.rowIndex)!=null?a:-1},{rowNode:r,currentPos:(l=r.rowIndex)!=null?l:-1}):i(s.parent,r.parent):s.level>r.level?i(s.parent,r):i(s,r.parent)};t.sort(i)}processPinnedBottomRows(t,e){return i=>{const s=this.processRow.bind(this,i,t,e);return t.rowPositions?t.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedBottomRow(r.rowIndex)).forEach(s):this.pinnedRowModel.forEachPinnedBottomRow(s),i}}getColumnsToExport(t=!1,e=!1,i){const s=this.columnModel.isPivotMode();if(i&&i.length)return this.columnModel.getGridColumns(i);const r=this.gos.get("treeData");let n=[];return t&&!s?n=this.columnModel.getAllGridColumns():n=this.columnModel.getAllDisplayedColumns(),e&&!r&&(n=n.filter(o=>o.getColId()!==_o)),n}recursivelyAddHeaderGroups(t,e,i){const s=[];t.forEach(r=>{const n=r;n.getChildren&&n.getChildren().forEach(o=>s.push(o))}),t.length>0&&t[0]instanceof gt&&this.doAddHeaderHeader(e,t,i),s&&s.length>0&&this.recursivelyAddHeaderGroups(s,e,i)}doAddHeaderHeader(t,e,i){const s=t.onNewHeaderGroupingRow();let r=0;e.forEach(n=>{const o=n;let a;i?a=i(this.gos.addGridCommonParams({columnGroup:o})):a=this.columnModel.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((u,d,c,C)=>{let E=ge.last(u);return d.getColumnGroupShow()==="open"?(!E||E[1]!=null)&&(E=[c],u.push(E)):E&&E[1]==null&&(E[1]=c-1),c===C.length-1&&E&&E[1]==null&&(E[1]=c),u},[]);s.onColumn(o,a||"",r++,o.getLeafColumns().length-1,l)})}};oi([T("displayedGroupCreator")],xs.prototype,"displayedGroupCreator",2);oi([T("columnModel")],xs.prototype,"columnModel",2);oi([T("rowModel")],xs.prototype,"rowModel",2);oi([T("pinnedRowModel")],xs.prototype,"pinnedRowModel",2);oi([T("selectionService")],xs.prototype,"selectionService",2);oi([T("rowNodeSorter")],xs.prototype,"rowNodeSorter",2);oi([T("sortController")],xs.prototype,"sortController",2);xs=oi([Y("gridSerializer")],xs);var $N="31.3.2",jN={version:$N,moduleName:"@ag-grid-community/csv-export",beans:[mr,xs]};_e.__registerModules([LN,GN,jN],!1,void 0);function Yd(t){const e=Math.floor(t/3600),i=Math.floor(t%3600/60),s=t%60,r=Math.round((t-Math.floor(t))*1e3);return`${Ku(e)}:${Ku(i)}:${Ku(s)},${Ku(r,3)}`}function Ku(t,e=2){return("0"+t).slice(-e)}const qN={action:"red",suspense:"orange",love:"pink",sadness:"blue",adventure_hero:"indigo",adventure_villain:"indigo",comedy:"yellow",inspriational:"lilac",magic:"purple",supernatural:"gold"};function KN(t){let e;return{c(){e=ze("section"),we(e,"id","cue-grid"),we(e,"class","ag-theme-alpine-dark svelte-1gge9ka"),xC(e,"height","100%"),xC(e,"width","100%")},m(i,s){pi(i,e,s),t[1](e)},p:Le,i:Le,o:Le,d(i){i&&Zt(e),t[1](null)}}}function YN(t,e,i){let s,r;Zr(t,dr,C=>i(3,s=C)),Zr(t,Qn,C=>i(4,r=C));let n,o;wg(()=>{const C={defaultColDef:{editable:!0,filter:!0,flex:1,minWidth:150,resizable:!0,sortable:!1},columnDefs:[{headerName:"",minWidth:36,width:36,maxWidth:36,editable:!1,flex:0,cellRenderer:y=>{const _=document.createElement("button");return _.innerHTML="▶",_.className="cell-ctrl",_.addEventListener("click",()=>{console.log("btn clicked"),jw.update(b=>(b=y.data.start,b)),SM(y.rowIndex)}),_}},{headerName:"Start",field:"start",valueFormatter:y=>Yd(y.value),cellStyle:{textAlign:"center",width:"10em",fontFamily:"monospace"}},{headerName:"End",field:"end",valueFormatter:y=>Yd(y.value),cellStyle:{textAlign:"center",width:"10em",fontFamily:"monospace"}},{headerName:"Content",field:"content",cellStyle:{textAlign:"left"},cellEditor:"agSelectCellEditor",cellEditorParams:{values:Object.keys(qN)}}],onCellValueChanged:l,onCellEditingStarted:a,onCellClicked:a,rowData:[],getRowClass:u,pagination:!1};o=RN(n,C);const E=dr.subscribe(y=>{o.setGridOption("rowData",y.cues),o.redrawRows(),d(y.currentCueIndex),console.log("timeline subscriber cuegrid ran an update",y)});return()=>{E(),o&&o.destroy()}});function a(){console.log("cell clicked, shall pause"),Pa(Qn,r=!1,r)}function l(C){console.log(C);try{CM(C.rowIndex,C.data.start,C.data.end,C.data.content)}catch{C.node.setDataValue(C.column.colId,C.oldValue),C.api.refreshCells({rowNodes:[C.node],columns:[C.column.colId]})}}function u(C){return C.node.rowIndex===s.currentCueIndex?"highlight-row":""}function d(C){C>Qa&&o.ensureIndexVisible(C,"middle")}function c(C){od[C?"unshift":"push"](()=>{n=C,i(0,n)})}return[n,c]}class XN extends es{constructor(e){super(),Zi(this,e,YN,KN,Oi,{})}}function QN(t){let e,i,s,r,n,o,a,l,u,d,c;return{c(){e=ze("button"),e.textContent="⇧ Upload Subtitles",i=hi(),s=ze("dialog"),r=ze("div"),n=ze("h2"),n.textContent="Upload Subtitles",o=hi(),a=ze("input"),l=hi(),u=ze("button"),u.textContent="Cancel",we(a,"type","file"),we(a,"accept",".srt"),we(r,"class","content svelte-mw109h"),s.open=t[0],we(s,"class","svelte-mw109h")},m(C,E){pi(C,e,E),pi(C,i,E),pi(C,s,E),Ge(s,r),Ge(r,n),Ge(r,o),Ge(r,a),Ge(r,l),Ge(r,u),d||(c=[us(e,"click",t[2]),us(a,"change",t[1]),us(u,"click",t[3]),us(s,"close",t[3])],d=!0)},p(C,[E]){E&1&&(s.open=C[0])},i:Le,o:Le,d(C){C&&(Zt(e),Zt(i),Zt(s)),d=!1,gn(c)}}}function JN(t){return t.trim().split(/\r?\n\s*\r?\n/).map(s=>{const r=s.trim().split(/\r?\n/),n=parseInt(r[0]),[o,a]=r[1].split(" --> ").map(u=>{const[d,c]=u.split(",");return parseInt(d.split(":")[0])*3600+parseInt(d.split(":")[1])*60+parseInt(d.split(":")[2])+parseFloat("0."+c)}),l=r.slice(2).join(`
`);return{id:n,start:o,end:a,content:l}})}function ZN(t,e,i){let s=null,r=!1;function n(l){const u=l.target.files[0],d=new FileReader;d.onload=function(c){s=c.target.result;const C=JN(s);yM(C),a()},d.readAsText(u)}function o(){i(0,r=!0)}function a(){i(0,r=!1)}return[r,n,o,a]}class e1 extends es{constructor(e){super(),Zi(this,e,ZN,QN,Oi,{})}}function t1(t){const e=new Uint8Array([77,84,104,100,0,0,0,6,0,0,0,1,0,120]),i=i1(t),s=new Uint8Array(e.length+i.length);return s.set(e,0),s.set(i,e.length),s}function i1(t){let e=0,i=[];t.forEach(r=>{const{start:n,end:o,content:a}=r,l=n*120,u=(o-n)*120,d=[0,144,36,127],c=[Ey(u),0,128,36,0],C=Ey(e+l);i=i.concat(C),i=i.concat(d),i=i.concat(c);const E=[0,255,1,a.length];for(let y=0;y<a.length;y++)E.push(a.charCodeAt(y));i=i.concat(E),e=0}),i.push(0,255,47,0);const s=s1(i.length);return[].concat(s,i)}function Ey(t){let e=[];do{let i=t&127;t>>=7,t>0&&(i|=128),e.push(i)}while(t>0);return e.reverse()}function s1(t){let e=[];do{let i=t&127;t>>=7,t>0&&(i|=128),e.push(i)}while(t>0);return e.reverse()}function r1(t){let e,i,s;return{c(){e=ze("button"),e.textContent="⇩ MIDI"},m(r,n){pi(r,e,n),i||(s=us(e,"click",t[0]),i=!0)},p:Le,i:Le,o:Le,d(r){r&&Zt(e),i=!1,s()}}}function n1(t){function e(){const i=wh(),s=t1(i),r=document.createElement("a");r.style.display="none",r.href=s,r.download="lyrics.mid",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}return[e]}class o1 extends es{constructor(e){super(),Zi(this,e,n1,r1,Oi,{})}}function a1(t){let e,i,s;return{c(){e=ze("button"),e.textContent="⇩ Subtitles"},m(r,n){pi(r,e,n),i||(s=us(e,"click",t[0]),i=!0)},p:Le,i:Le,o:Le,d(r){r&&Zt(e),i=!1,s()}}}function l1(t){function e(s){let r="";return s.forEach((n,o)=>{const a=o+1,l=Yd(n.start),u=Yd(n.end),d=n.content;r+=`${a}
`,r+=`${l} --> ${u}
`,r+=`${d}

`}),r}function i(){const s=wh(),r=e(s),n=new Blob([r],{type:"text/plain"}),o=URL.createObjectURL(n),a=document.createElement("a");a.style.display="none",a.href=o,a.download="cues.srt",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a)}return[i]}class u1 extends es{constructor(e){super(),Zi(this,e,l1,a1,Oi,{})}}function d1(t){const e=[];e.push('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'),e.push('<!DOCTYPE score-partwise PUBLIC "-//Recordare//DTD MusicXML 3.1 Partwise//EN" "http://www.musicxml.org/dtds/partwise.dtd">'),e.push('<score-partwise version="3.1">'),e.push('<part-list><score-part id="P1"><part-name>Music</part-name></score-part></part-list>'),e.push('<part id="P1">');const i=4;let s=1;return t.forEach(r=>{const n=wy(r.start,i);let a=wy(r.end,i)-n;e.push(`<measure number="${s}">`),e.push("<attributes><divisions>4</divisions><key><fifths>0</fifths><mode>major</mode></key><time><beats>4</beats><beat-type>4</beat-type></time></attributes>"),e.push("<note>"),e.push("<pitch><step>C</step><octave>4</octave></pitch>"),e.push(`<duration>${a}</duration>`),e.push("<type>quarter</type>"),e.push(`<lyric><text>${r.content}</text></lyric>`),e.push("</note>"),e.push("</measure>"),s++}),e.pop(),e.push("</part>"),e.push("</score-partwise>"),e.join(`
`)}function wy(t,e){return Math.round(t*e)}function h1(t){let e,i,s;return{c(){e=ze("button"),e.textContent="⇩ XML"},m(r,n){pi(r,e,n),i||(s=us(e,"click",t[0]),i=!0)},p:Le,i:Le,o:Le,d(r){r&&Zt(e),i=!1,s()}}}function c1(t){async function e(){const i=wh();if(!i||i.length===0){console.warn("No cues defined");return}const s=d1(i);console.log(s);const r=new Blob([s],{type:"text/xml"}),n=window.URL.createObjectURL(r),o=document.createElement("a");o.style.display="none",o.href=n,o.download="lyrics.xml",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(n),document.body.removeChild(o)}return[e]}class p1 extends es{constructor(e){super(),Zi(this,e,c1,h1,Oi,{})}}function g1(t){let e,i=Ty(t[0])+"",s;return{c(){e=ze("span"),s=Eg(i),we(e,"id","time-container"),we(e,"class","svelte-l8276p")},m(r,n){pi(r,e,n),Ge(e,s)},p(r,[n]){n&1&&i!==(i=Ty(r[0])+"")&&Ry(s,i)},i:Le,o:Le,d(r){r&&Zt(e)}}}function Ty(t){const e=Math.floor(t/3600),i=Math.floor(t%3600/60),s=Math.floor(t%60),r=Math.floor(t%1*1e3),n=(e<10?"0":"")+e,o=(i<10?"0":"")+i,a=(s<10?"0":"")+s,l=(r<100?r<10?"00":"0":"")+r;return`${n}:${o}:${a},${l}`}function f1(t,e,i){let s;return Zr(t,Ja,r=>i(0,s=r)),[s]}class m1 extends es{constructor(e){super(),Zi(this,e,f1,g1,Oi,{})}}function C1(t){let e,i=t[1]()+"",s,r,n,o;return{c(){e=ze("button"),s=Eg(i),we(e,"id","cue-toggle-button"),we(e,"class",r=RC(t[0]())+" svelte-syrn48")},m(a,l){pi(a,e,l),Ge(e,s),n||(o=us(e,"click",t[2]),n=!0)},p(a,[l]){l&2&&i!==(i=a[1]()+"")&&Ry(s,i),l&1&&r!==(r=RC(a[0]())+" svelte-syrn48")&&we(e,"class",r)},i:Le,o:Le,d(a){a&&Zt(e),n=!1,o()}}}function v1(t,e,i){let s,r,n;Zr(t,Ja,d=>i(6,n=d));let o=!1,a=null,l=null;const u=()=>{o?(l=n,console.log("Recording end time:",l),vM(a,l,"")):(a=n,console.log("Recording start time:",a)),i(3,o=!o)};return t.$$.update=()=>{t.$$.dirty&8&&i(1,s=()=>o?"End Cue":"Start Cue"),t.$$.dirty&8&&i(0,r=()=>o?"recording":"waiting")},[r,s,u,o]}class y1 extends es{constructor(e){super(),Zi(this,e,v1,C1,Oi,{})}}function S1(t){let e,i,s,r,n,o,a,l,u,d,c,C,E,y,_,b,R,D,O,L,I;return s=new bM({props:{videoUrl:t[0]}}),o=new m1({}),l=new y1({}),c=new XN({}),y=new e1({}),b=new u1({}),D=new o1({}),L=new p1({}),{c(){e=ze("section"),i=ze("div"),os(s.$$.fragment),r=hi(),n=ze("div"),os(o.$$.fragment),a=hi(),os(l.$$.fragment),u=hi(),d=ze("div"),os(c.$$.fragment),C=hi(),E=ze("footer"),os(y.$$.fragment),_=hi(),os(b.$$.fragment),R=hi(),os(D.$$.fragment),O=hi(),os(L.$$.fragment),we(n,"id","controls-container"),we(n,"class","svelte-c80b1o"),we(i,"id","video-and-controls"),we(i,"class","svelte-c80b1o"),we(d,"id","cue-grid"),we(d,"class","svelte-c80b1o"),we(E,"class","svelte-c80b1o"),we(e,"class","svelte-c80b1o")},m(k,H){pi(k,e,H),Ge(e,i),Hi(s,i,null),Ge(i,r),Ge(i,n),Hi(o,n,null),Ge(n,a),Hi(l,n,null),Ge(e,u),Ge(e,d),Hi(c,d,null),Ge(e,C),Ge(e,E),Hi(y,E,null),Ge(E,_),Hi(b,E,null),Ge(E,R),Hi(D,E,null),Ge(E,O),Hi(L,E,null),I=!0},p(k,[H]){const ee={};H&1&&(ee.videoUrl=k[0]),s.$set(ee)},i(k){I||(di(s.$$.fragment,k),di(o.$$.fragment,k),di(l.$$.fragment,k),di(c.$$.fragment,k),di(y.$$.fragment,k),di(b.$$.fragment,k),di(D.$$.fragment,k),di(L.$$.fragment,k),I=!0)},o(k){Ti(s.$$.fragment,k),Ti(o.$$.fragment,k),Ti(l.$$.fragment,k),Ti(c.$$.fragment,k),Ti(y.$$.fragment,k),Ti(b.$$.fragment,k),Ti(D.$$.fragment,k),Ti(L.$$.fragment,k),I=!1},d(k){k&&Zt(e),Ui(s),Ui(o),Ui(l),Ui(c),Ui(y),Ui(b),Ui(D),Ui(L)}}}function E1(t,e,i){let{videoUrl:s}=e;return t.$$set=r=>{"videoUrl"in r&&i(0,s=r.videoUrl)},[s]}class w1 extends es{constructor(e){super(),Zi(this,e,E1,S1,Oi,{videoUrl:0})}}function T1(t){let e,i;return e=new w1({props:{videoUrl:Xd}}),{c(){os(e.$$.fragment)},m(s,r){Hi(e,s,r),i=!0},i(s){i||(di(e.$$.fragment,s),i=!0)},o(s){Ti(e.$$.fragment,s),i=!1},d(s){Ui(e,s)}}}function b1(t){let e,i;return e=new oR({}),{c(){os(e.$$.fragment)},m(s,r){Hi(e,s,r),i=!0},i(s){i||(di(e.$$.fragment,s),i=!0)},o(s){Ti(e.$$.fragment,s),i=!1},d(s){Ui(e,s)}}}function _1(t){let e,i,s,r;const n=[b1,T1],o=[];function a(l,u){return l[0]?1:0}return i=a(t),s=o[i]=n[i](t),{c(){e=ze("main"),s.c(),we(e,"id","cue-app"),we(e,"class","svelte-2d31ix")},m(l,u){pi(l,e,u),o[i].m(e,null),r=!0},p(l,[u]){let d=i;i=a(l),i!==d&&(JD(),Ti(o[d],1,1,()=>{o[d]=null}),ZD(),s=o[i],s||(s=o[i]=n[i](l),s.c()),di(s,1),s.m(e,null))},i(l){r||(di(s),r=!0)},o(l){Ti(s),r=!1},d(l){l&&Zt(e),o[i].d()}}}function D1(t,e,i){let s;return Zr(t,Xd,r=>i(0,s=r)),[s]}class R1 extends es{constructor(e){super(),Zi(this,e,D1,_1,Oi,{})}}new R1({target:document.getElementById("app")});
